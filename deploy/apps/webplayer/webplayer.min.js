var ud={},yd;for(yd in window)ud[yd]=!0;var b4w=function(a){var y={};a.module=y;var e={};a.register=function(a,b){if(y[a])throw Error('Module "'+a+'" already registered');y[a]=b};a.require=function(a,b){if(!y[a])throw Error('Module "'+a+'" not found');b=b||"__B4W_DEF_NS";e[b]||(e[b]=function(a){return function(b){var c=y[b];if(!c)throw Error('Module "'+b+'" not found');c.tj||(c.tj={});c.tj[a]||(c.tj[a]={},c(c.tj[a],e[a]));return c.tj[a]}}(b));return e[b](a)};a.module_check=function(a){return y[a]?!0:!1};return a}({});b4w.module.app=function(a,y){function e(){var a=I.ym();document.addEventListener("visibilitychange",function(){document.hidden?(a=I.ym(),I.pause()):a||I.Fd()},!1)}function c(a,f,d,p){var t=document.createElement("canvas"),b=document.getElementById(a);t.style.position="absolute";t.style.left=0;t.style.top=0;t.style.width=b.offsetWidth+"px";t.style.height=b.offsetHeight+"px";t.width=b.offsetWidth*window.devicePixelRatio;t.height=b.offsetHeight*window.devicePixelRatio;f?(f=document.createElement("canvas"),
f.style.position="absolute",t.style.left=0,t.style.top=0,f.style.pointerEvents="none"):f=null;b||(M.error('Warning: canvas container "'+a+'" not found, appending to body'),b=document.body);b.appendChild(t);if(!I.$b(t,f))return d&&D("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/troubleshooting",p),!1;f&&k.tm(f,"LAST");return!0}function b(a,f){a?(f&&(document.getElementById(f).style.display="block"),L=document.getElementById(a)):(L=document.createElement("div"),
L.innerHTML=0,L.style.cssText="position:absolute;top: 23px;right: 20px;font-size: 45px;line-height: 50px;font-weight: bold;color: #000;",k.tm(L,"JUST_AFTER_CANVAS"))}function h(a,f){var d=String(a);f&&(d+="/"+String(f));L.innerHTML=d}function m(a){a=document.getElementById(a);var f=a.cloneNode(!0);a.parentNode.replaceChild(f,a);return f}function q(){var a=k.Yd();I.resize(a.clientWidth,a.clientHeight,!0)}function u(a,d,t){if(x.bq(a))var b=J.be(a,U),e=x.oF(a,ha),b=p.subtract(b,e,U),b=Math.max(p.len(b),
1);else b=10;e=J.If(a,oa);d=f.va(e,d,U);d[1]=0;p.normalize(d,d);p.scale(d,b*t,d);b=J.be(a,ha);p.add(b,d,b);x.fq(a,b)}function w(a,d){if(x.bq(a)){var b=x.nF(a,X);if(0>b[1]-b[0]){var t=x.Ad(a,ia)[1],b=(b[0]-t)/(b[0]-b[1]),t=x.aF(a),b=Math.max(b,2/t[0]);x.zh(a,0,b*d)}}else b=J.be(a,U),t=p.scale(f.jb,-d,ha),p.add(b,t,b),x.fq(a,b)}function g(a,f,d,p){J.Uc(a,5*f,5*d,5*p)}function l(a,f,d){var b=J.be(a,U),t=x.Sp(a,ha),b=p.dist(b,t),t=Math.abs(f);d=Math.pow(t*d,1-Math.pow(t*d,.15));J.Uc(a,0,0>f?.001<b?-b*
d:0:d/(1-d)*b,0)}function z(a,f,d,p){for(var b=d*f;0<a;--a)d+=b,p+=b,b=d*f;return p}function C(a,f,d,b,t){t?(t=x.Sp(a,U),a=x.Lv(a),a=p.dist(t,a)+b,b=0<f?z(f,-d,a,b):z(-f,d/(1-d),a,b)):b-=2*f*d;return b}function F(a,b){function e(a,v,f,p){if(1==f){var b=h?.003*z[0]:.003*z[1];f=d.vc(a,v,0);d.ae(a,v,0)===d.nl?(sa+="X"==p?-f*b:0,oa+="Y"==p?-f*b:0):d.ae(a,v,0)===d.ll&&(a=h?.003*z[1]:7.5E-4*z[0],Vb+="X"==p?-f*a:0,Oa+="Y"==p?-f*a:0)}}function c(a,v,f,p){if(1==f){f=d.vc(a,v,1);x.hk(a,z);if(h)b=.003*z[0],
t=7.5E-4*z[1];else var b=.003*z[1],t=7.5E-4*z[0];if(1===d.ae(a,v,0))y+="X"==p?-f*b:0,hc+="Y"==p?-f*b:0;else if(2===d.ae(a,v,0)||3===d.ae(a,v,0))vc+="X"==p?-f*t:0,pc+="Y"==p?-f*t:0}}function k(a){return a[0]&&(a[1]||a[2])}function L(a,v,p){if(1==p)switch(p=d.vc(a,v,0),x.hk(a,z),v){case "FORWARD":q?va[0]=1:h?(v=x.Ad(a,ia)[1],v=Math.abs(v)>=Math.PI/4?f.sg:f.Wb,u(a,v,.5*z[0]*p)):m?l(a,-z[2],p):g(a,0,-z[0]*p,0);break;case "BACKWARD":q?va[0]=-1:h?(v=x.Ad(a,ia)[1],v=Math.abs(v)>=Math.PI/4?f.te:f.jb,u(a,
v,.5*z[0]*p)):m?l(a,z[2],p):g(a,0,z[0]*p,0);break;case "UP":h?w(a,30*-z[2]*p):q||g(a,0,0,-z[0]*p);break;case "DOWN":h?w(a,30*z[2]*p):q||g(a,0,0,z[0]*p);break;case "LEFT":q?va[1]=1:h?u(a,f.Pn,.5*z[0]*p):g(a,-z[0]*p,0,0);break;case "RIGHT":q?va[1]=-1:h?u(a,f.tf,.5*z[0]*p):g(a,z[0]*p,0,0);break;case "ROT_LEFT":m?x.cf(a,2*-z[1]*p,0):x.ad(a,2*z[1]*p,0);break;case "ROT_RIGHT":m?x.cf(a,2*z[1]*p,0):x.ad(a,2*-z[1]*p,0);break;case "ROT_UP":m?x.cf(a,0,2*-z[1]*p):x.ad(a,0,2*z[1]*p);break;case "ROT_DOWN":m?x.cf(a,
0,2*z[1]*p):x.ad(a,0,2*-z[1]*p)}else switch(v){case "FORWARD":case "BACKWARD":q&&(va[0]=0);break;case "LEFT":case "RIGHT":q&&(va[1]=0)}q&&(E.sr(q,va[0],va[1]),a=x.gm(a,X),E.hn(q,a[0],a[1]))}N=!0;T=a;Q=b;var n=K.oi(),m=!1,q=null,h=!1;switch(x.Bd(n)){case x.za:m=!a;break;case x.Rb:q=K.Ov();break;case x.ld:return;case x.Hb:h=!0}var z=x.hk(n,ea),v=d.di();if(E.dq(n)){var S=d.Wo(n,null,!0);d.R(n,"CAMERA_COLLISION",d.ia,[S],null,function(a,v,f){if(1==f&&(f=d.ae(a,v,0).coll_dist,0>f)){var b=d.ae(a,v,0).coll_norm;
v=U;p.scale(b,-.25*f,v);f=J.be(a,ha);p.add(f,v,f);J.xr(a,f)}})}if(q){var S=J.be(n),fa=J.If(n),fa=f.Fo(fa);S[1]-=.5;E.mn(q,S,fa);r.RB(n,q);var va=new Float32Array(2),P=!0;E.gn(q,E.Fs);d.ei(n,"TOGGLE_CHAR_MOVE_TYPE",d.Nd,d.pA,function(){P=!P;E.gn(q,P?E.Fs:E.Wz)})}if(b)S=fa=qa=da=B=A=d.Xo(0);else var S=d.nb(d.Qs),fa=d.nb(d.Os),qa=d.nb(d.Js),da=d.nb(d.Ks),B=d.nb(d.vA),A=d.nb(d.qA);var M=d.nb(d.Ps),I=d.nb(d.Ls),F=d.nb(d.Ms),H=d.nb(d.Ns);h||(d.R(n,"FORWARD",d.ia,[v,S],null,L),d.R(n,"BACKWARD",d.ia,[v,fa],
null,L));m?(d.R(n,"ROT_UP",d.ia,[v,M,B],k,L),d.R(n,"ROT_DOWN",d.ia,[v,I,A],k,L),d.R(n,"ROT_LEFT",d.ia,[v,F,qa],k,L),d.R(n,"ROT_RIGHT",d.ia,[v,H,da],k,L)):h?(d.R(n,"LEFT",d.ia,[v,F,qa],k,L),d.R(n,"RIGHT",d.ia,[v,H,da],k,L),d.R(n,"FORWARD",d.ia,[v,M,S],k,L),d.R(n,"BACKWARD",d.ia,[v,I,fa],k,L),d.R(n,"UP",d.ia,[v,A],k,L),d.R(n,"DOWN",d.ia,[v,B],k,L)):(d.R(n,"UP",d.ia,[v,B],k,L),d.R(n,"DOWN",d.ia,[v,A],k,L),d.R(n,"LEFT",d.ia,[v,qa],k,L),d.R(n,"RIGHT",d.ia,[v,da],k,L),d.R(n,"ROT_UP",d.ia,[v,M],k,L),d.R(n,
"ROT_DOWN",d.ia,[v,I],k,L),d.R(n,"ROT_LEFT",d.ia,[v,F],k,L),d.R(n,"ROT_RIGHT",d.ia,[v,H],k,L));var D=0,S=d.Yo(),G=0,fa=d.Tl();d.R(n,"MOUSE_WHEEL",d.Md,[S],null,function(a,v,f){1==f&&(v=d.vc(a,v,0),x.hk(a,z),m||h?D=C(a,v,z[2],D,m):(z[0]*=1+v*z[2],x.XH(a,z)))});d.R(n,"TOUCH_ZOOM",d.Md,[fa],null,function(a,v,f){1==f&&(f=d.vc(a,v,0),x.hk(a,z),d.ae(a,v,0)===d.ml&&(G=C(a,f,.03*z[2],G,m)))});d.R(n,"ZOOM_INTERPOL",d.ia,[v],null,function(a,v,b){if(1==b&&(m||h))if(1E-5<Math.abs(D)||1E-5<Math.abs(G)){v=d.vc(a,
v,0);b=f.fc(D,0,v,.1*t);D-=b;var S=f.fc(G,0,v,.15*t);G-=S;if(h)w(a,-(b+S));else{v=x.Sp(a,U);var e=x.Lv(a,ha);.001<p.dist(v,e)+b+S?J.Uc(a,0,b+S,0):(b=p.subtract(e,v,ha),S=p.normalize(b,R),p.scale(S,.001,S),p.add(v,S,b),J.xr(a,b),G=D=0)}}else G=D=0});var y=0,hc=0,vc=0,pc=0,S=d.fi("X"),fa=d.fi("Y"),qa=d.Ql();d.R(n,"MOUSE_X",d.Md,[qa,S],null,c,"X");d.R(n,"MOUSE_Y",d.Md,[qa,fa],null,c,"Y");var sa=0,oa=0,Vb=0,Oa=0,S=d.Ij("X"),fa=d.Ij("Y");d.R(n,"TOUCH_X",d.Md,[S],null,e,"X");d.R(n,"TOUCH_Y",d.Md,[fa],null,
e,"Y");d.R(n,"ROT_TRANS_INTERPOL",d.ia,[v],null,function(a,v,p){if(1==p&&(1E-5<Math.abs(y)||1E-5<Math.abs(hc)||1E-5<Math.abs(sa)||1E-5<Math.abs(oa)||1E-5<Math.abs(vc)||1E-5<Math.abs(pc)||1E-5<Math.abs(Vb)||1E-5<Math.abs(Oa))){var b=d.vc(a,v,0),S=f.fc(y,0,b,.08*t);v=f.fc(hc,0,b,.08*t);y-=S;hc-=v;var e=f.fc(sa,0,b,.12*t);p=f.fc(oa,0,b,.12*t);sa-=e;oa-=p;var c=f.fc(vc,0,b,.08*t),g=f.fc(pc,0,b,.08*t);vc-=c;pc-=g;var k=f.fc(Vb,0,b,.12*t),b=f.fc(Oa,0,b,.12*t);Vb-=k;Oa-=b;m?(x.cf(a,S+e,v+p),x.CG(a,c+k,g+
b)):h?(S+e&&u(a,f.tf,.2*(S+e)),v+p&&(S=x.Ad(a,ia)[1],u(a,Math.abs(S)>Math.PI/4?f.te:f.jb,.2*(v+p))),x.zh(a,c+k,0)):(x.ad(a,.5*(S+e),.5*(v+p)),q&&(a=x.gm(a,X),E.hn(q,a[0],a[1])))}});d.ei(n,"DEC_STEREO_DIST",d.Nd,d.tA,function(a){x.Ly(a,.9*x.jw(a))});d.ei(n,"INC_STEREO_DIST",d.Nd,d.wA,function(a){x.Ly(a,1.1*x.jw(a))})}function G(){var a=K.oi();N=!1;for(var f="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL".split(" "),
p=0;p<f.length;p++)d.bf(a,f[p]);x.Bd(a)==x.Rb&&K.Ov()&&r.remove(a)}function D(a,f,d,p){var b=document.createElement("div"),t=document.createElement("div"),e=document.createElement("div");if(p)for(var c=0;c<p.length;c++){var g=document.getElementById(p[c]);g&&g.parentNode.removeChild(g)}b.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";t.style.cssText="color:#fff;font-size:24px;";e.style.cssText="color:#fff;font-size:20px;";t.innerHTML=
a;e.innerHTML=f+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+d+'">'+d.replace("https://www.","")+"</a>";b.appendChild(t);b.appendChild(e);document.body.appendChild(b)}function H(a,f,d,p){function b(){var e=performance.now()-t;p(a+e*(f-a)/d);e>=d&&I.jH(b)}var t=performance.now();I.yl(b)}y("animation");var x=y("camera"),A=y("config"),r=y("constraints"),k=y("container"),d=y("controls"),n=y("data"),B=y("debug"),I=y("main"),E=y("physics"),M=y("print"),K=y("scenes"),J=y("transform"),f=y("util"),
p=y("vec3"),t=1,L=null,N=!1,T=!1,Q=!1,X=new Float32Array(2),ia=new Float32Array(2),U=new Float32Array(3),ha=new Float32Array(3),R=new Float32Array(3),oa=new Float32Array(4),ea=new Float32Array(3);a.$b=function(a){function f(){var a=c(N,w,x,L),v=k.Mp();if(a){var d=k.Yd();q();I.tr(u);J&&(b(m,l),I.LH(h));S&&e();r&&I.yl(function(){d.style.height=d.clientWidth/r+"px"});g&&I.yl(function(){var a=d.clientWidth,f=d.clientHeight;a==v.clientWidth&&f==v.clientHeight||I.resize(a,f,!0)});da&&I.yl(function(){k.Cp()});
t(v,!0)}else t(v,!1)}function p(a){a.keyCode==d.uA&&(I.ym()?I.Fd():I.pause())}function t(){}a=a||{};var g=!1,N=null,L=null,m=null,r=0,l=null,u=!1,v=!0,S=!0,x=!0,z=!1,J=!1,E=!1,da=!1,K;for(K in a)switch(K){case "canvas_container_id":N=a.canvas_container_id;break;case "callback":t=a.callback;break;case "autoresize":g=a.autoresize;break;case "do_not_use_onload":break;case "gl_debug":u=a.gl_debug;break;case "show_hud_debug_info":E=a.show_hud_debug_info;break;case "sfx_mix_mode":z=a.sfx_mix_mode;break;
case "show_fps":J=a.show_fps;break;case "track_container_position":da=a.track_container_position;break;case "fps_wrapper_id":l=a.fps_wrapper_id;break;case "fps_elem_id":m=a.fps_elem_id;break;case "error_purge_elements":L=a.error_purge_elements;break;case "report_init_failure":x=a.report_init_failure;break;case "pause_invisible":S=a.pause_invisible;break;case "key_pause_enabled":v=a.key_pause_enabled;break;case "force_container_ratio":r=a.force_container_ratio;break;default:A.set(K,a[K])}v&&document.addEventListener("keydown",
p,!1);A.set("show_hud_debug_info",E);A.set("sfx_mix_mode",z);var w=E||z||null;"complete"==document.readyState?window.setTimeout(f,0):window.addEventListener("load",f,!1);window.addEventListener("unload",function(){n.aa()},!1)};a.uP=q;a.cQ=function(a,f){var d=m(a);d.addEventListener("mouseup",function(){f(d.value)},!1)};a.bQ=function(a,f){var d=m(a);d.addEventListener("change",function(){var a=d.checked;f(void 0!=a?a:d.value)},!1)};a.dQ=function(a,f){var d=m(a);d.addEventListener("keypress",function(a){f(a.keyCode,
d.value)},!1)};a.kE=F;a.HM=G;a.CP=function(a){var f=N;f&&G();var d=K.oi();x.PH(d,a);f&&F(T,Q)};a.PM=function(a){function f(a){return a[0]&&(a[1]||a[2])}function p(a,v,f){if(1==f)switch(f=d.vc(a,v,0),v){case "FORWARD":b?E.mj(a,1):J.Uc(a,0,0,1*f);break;case "BACKWARD":b?E.mj(a,-1):J.Uc(a,0,0,-1*f);break;case "LEFT":b?E.lj(a,-1):J.Uc(a,1*f,0,0);break;case "RIGHT":b?E.lj(a,1):J.Uc(a,-1*f,0,0)}else switch(v){case "FORWARD":case "BACKWARD":b&&E.mj(a,0);break;case "LEFT":case "RIGHT":b&&E.lj(a,0)}}var b=
E.xc(a)||E.yc(a),t=d.di(),e=d.nb(d.Qs),c=d.nb(d.Os),g=d.nb(d.Js),k=d.nb(d.Ks),N=d.nb(d.Ps),n=d.nb(d.Ls),v=d.nb(d.Ms),S=d.nb(d.Ns);d.R(a,"FORWARD",d.ia,[t,e,N],f,p);d.R(a,"BACKWARD",d.ia,[t,c,n],f,p);d.R(a,"LEFT",d.ia,[t,g,v],f,p);d.R(a,"RIGHT",d.ia,[t,k,S],f,p)};a.JM=function(a){for(var f=["FORWARD","BACKWARD","LEFT","RIGHT"],p=0;p<f.length;p++)d.bf(a,f[p])};a.lE=function(){var a,f=k.Yd();a=a||!1;d.ir(document,!1);d.jr(f,!0,a);d.lr(f,!0);d.kr(f,!0);d.hr()};a.IM=function(){var a=k.Yd();d.cs(document);
d.ds(a);d.fs(a);d.es(a);d.bs()};a.OM=function(){d.ei(null,"CAMERA_SHOT",d.Nd,d.rA,function(){B.pG()});d.ei(null,"LIGHT_SHOT",d.Nd,d.sA,function(){B.sG()});d.ei(null,"TELEMETRY",d.Nd,d.xA,function(){B.Wq()})};a.rH=function(a,f){var d=document.body;function p(){document.fullscreenElement===d||document.webkitFullScreenElement===d||document.mozFullScreenElement===d||document.webkitIsFullScreen||document.msFullscreenElement===d?a():(document.removeEventListener("fullscreenchange",p,!1),document.removeEventListener("webkitfullscreenchange",
p,!1),document.removeEventListener("mozfullscreenchange",p,!1),document.removeEventListener("MSFullscreenChange",p,!1),f())}a=a||function(){};f=f||function(){};document.addEventListener("fullscreenchange",p,!1);document.addEventListener("webkitfullscreenchange",p,!1);document.addEventListener("mozfullscreenchange",p,!1);document.addEventListener("MSFullscreenChange",p,!1);d.requestFullScreen=d.requestFullScreen||d.webkitRequestFullScreen||d.mozRequestFullScreen||d.msRequestFullscreen;d.requestFullScreen==
d.webkitRequestFullScreen?d.requestFullScreen(Element.ALLOW_KEYBOARD_INPUT):d.requestFullScreen()};a.oE=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;if("function"!=typeof a)throw"B4W App: exit fullscreen method is not supported";a.apply(document)};a.NC=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?
!0:!1};a.rP=D;a.km=function(a){a=!!a;var f=location.href.toString();if(-1==f.indexOf("?"))return null;for(var f=f.split("?")[1].split("&"),d={},p=0;p<f.length;p++){var b=f[p].split("="),t=b[0];1<b.length?(b=b[1],a?t in d?d[t].push(b):d[t]=[b]:d[t]=b):a?t in d||(d[t]=[]):d[t]=""}return d};a.ic=function(a,f,d,p,b,t,e,c){function g(a){k[f]=t+a+e;if(d>p&&a<=p||d<p&&a>=p)k[f]=t+p+e,c()}if(a&&f&&isFinite(d)&&isFinite(p)&&isFinite(b)){t=t||"";e=e||"";c=c||function(){};var k=a.style;a=f.charAt(0).toUpperCase()+
f.slice(1);if(void 0==k[f])if(void 0!=k["webkit"+a])f="webkit"+a;else if(void 0!=k["ms"+a])f="ms"+a;else if(void 0!=k["moz"+a])f="moz"+a;else return;H(d,p,b,g)}};a.SL=function(a,f,d,p,b,t){function e(b){0<=b&&a.setAttribute(f,b);if(d>p&&b<=p||d<p&&b>=p)a.setAttribute(f,p),t()}a&&f&&isFinite(d)&&isFinite(p)&&isFinite(b)&&(t=t||function(){},H(d,p,b,e))};a.DP=function(a){t=a};a.qN=function(){return t}};b4w.module.animation=function(a,y){var e=y("__animation"),c=y("__constraints");y("__physics");var b=y("__print"),h=y("__util");a.Wa=e.Wa;a.ct=e.ct;a.dt=e.dt;a.et=e.et;a.ft=e.ft;a.gt=e.gt;a.ht=e.ht;a.Vn=e.Vn;a.Wn=e.Wn;a.Us=e.Us;a.Ss=e.Ss;a.Vs=e.Vs;a.Ys=e.Ys;a.Xs=e.Xs;a.Ws=e.Ws;a.Ts=e.Ts;a.Ln=e.Ln;a.Mn=e.Mn;a.Nn=e.Nn;var m=new Float32Array(4);a.Ka=function(a){return e.Ka(a)};a.mN=function(){b.error("get_actions() deprecated, use get_anim_names() instead");for(var a=[],c=e.vv(),m=0;m<c.length;m++)a.push(e.BI(c[m].name));
return a};a.uN=function(e,c){b.error("get_current_action() deprecated, use get_current_anim_name() instead");return a.eF(e,c)};a.xv=function(a){return e.um(a)?e.xv(a):[]};a.eF=function(a,b){if(!e.Ka(a))return null;b=b||e.Wa;return e.WE(a,b)};a.apply=function(a,c,m){if(m>e.Vn)b.error("Can't apply animation to slot "+m+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{m=m||e.Wa;if(e.Ka(a)){var g=e.Tp(a,c);if(-1!=g&&g!=m){b.error('Animation "'+c+'" is already applied to object "'+
a.name+'" (slot "'+g+'").');return}}e.EJ(a,c)?e.apply(a,c,m):b.error('No fcurves in action "'+c+'"')}};a.remove=function(a){e.remove(a)};a.iy=function(a,b){e.Ka(a)&&(b=b||e.Wa,e.iy(a,b))};a.mo=function(a){e.mo(a)};a.play=function(a,c,m){e.Ka(a)?(m=m||e.Wa,e.play(a,c,m),e.ks(a,0,m,!0)):b.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){e.Ka(a)&&(b=b||e.Wa,e.stop(a,b))};a.yi=function(a,b){if(!e.Ka(a))return!1;b=b||e.Wa;return e.yi(a,b)};a.FP=function(e,c,m){b.error("set_current_frame_float() deprecated, use set_frame() instead");
a.ag(e,c,m)};a.Np=function(e,c){b.error("get_current_frame_float() deprecated, use get_frame() instead");return a.Rv(e,c)};a.ag=function(a,b,c){e.Ka(a)&&(c=c||e.Wa,e.ag(a,b,c))};a.MP=function(a,b){e.Ka(a)&&(b=b||e.Wa,e.ag(a,e.em(a,b),b))};a.SP=function(a,b){e.Ka(a)&&(b=b||e.Wa,e.ag(a,e.em(a,b)+e.Kp(a,b)-e.yA,b))};a.Rv=function(a,b){if(!e.Ka(a))return 0;b=b||e.Wa;return e.Np(a,b)};a.Jy=function(a,b,c){e.Ka(a)&&(c=c||e.Wa,e.Jy(a,b||1,c))};a.gw=function(a,b){if(!e.Ka(a))return 0;b=b||e.Wa;return a.D[b]?
e.gw(a,b):0};a.BN=function(a,c){b.error("get_frame_range() deprecated, use get_anim_start_frame() and get_anim_length() instead");if(e.Ka(a)){c=c||e.Wa;var m=a.D[c];if(m)return[m.start,m.start+m.length]}return null};a.em=function(a,b){return e.Ka(a)&&(b=b||e.Wa,a.D[b])?e.em(a,b):-1};a.Kp=function(a,b){return e.Ka(a)&&(b=b||e.Wa,a.D[b])?e.Kp(a,b):-1};a.sc=function(c,m,h){b.error("cyclic() deprecated, use set_behavior() instead");a.fn(c,m?e.Ln:e.Mn,h)};a.xi=function(a,c){b.error("is_cyclic() deprecated, use get_behavior() instead");
if(!e.Ka(a))return!1;c=c||e.Wa;return e.xi(a,c)};a.fn=function(a,b,c){e.Ka(a)&&(c=c||e.Wa,e.fn(a,b,c))};a.Av=function(a,b){if(!e.Ka(a))return null;b=b||e.Wa;return e.Av(a,b)};a.yt=function(a,b,c,g){g=g||e.Wa;e.Ka(a)&&e.yt(a,b,c,g)};a.ks=function(a,b,c,g){e.Ka(a)&&(c=c||e.Wa,e.ks(a,b||0,c,g||!1))};a.mv=function(a){return e.mv(a)};a.pN=function(a,b,e){if(!h.Se(a))return null;e||(e=new Float32Array(3));c.$E(a,b,!1,m,null);e[0]=m[0];e[1]=m[1];e[2]=m[2];return e};a.dk=function(a){return h.ac(a)?e.dk(a):
null};a.Tp=function(a,b){return e.Ka(a)&&b?e.Tp(a,b):null};a.yv=function(a,b){return e.Ka(a)?e.yv(a,b):null};a.zt=function(a,b){return e.zt(a,b)};a.XN=function(a){return a.e.wf};a.Hy=function(a,c,m){h.Se(a)?(c=Math.min(Math.max(c,0),1),a.e.wf!=c&&e.Hy(a,c,m||0)):b.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.__animation=function(a,y){function e(a,v){var f=a.D[v];f&&f.yp&&f.Wj&&(f.Wj=!1,f.yp(a,v))}function c(a,v,f){f=a.D[f];f.type=30;var b=v.frame_start,d=v.frame_end-b+1;f.start=b;f.length=d;f.Nc=b;f.Th=v.name;for(d=b=0;d<a.data.b4w_vertex_anim.length;d++){var p=a.data.b4w_vertex_anim[d];if(p==v)break;else b+=p.frame_end-p.frame_start+1}f.Kz=b}function b(a,v,f){a=a.D[f];a.type=50;a.Th=v.name;f=v.settings;a.start=f.frame_start;a.length=f.frame_end-a.start;v.settings.b4w_cyclic||(a.length+=f.lifetime);
a.Wc=v}function h(a){return a.replace(/_B4W_BAKED$/,"")}function m(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:R.ma("Wrong animation behavior")}}function q(a){var v=[];a=a.data.materials;for(var f=0;f<a.length;f++){var b=a[f].node_tree;b&&u(b,v)}return v}function u(a,v){if(a.animation_data){var f=a.animation_data.action;f&&R.Zd(f.fcurves)&&v.push(f)}for(var f=a.nodes,b=0;b<f.length;b++){var d=f[b];d.node_group&&(d=d.node_group.node_tree)&&
u(d,v)}}function w(a){return R.ac(a)&&a.e.In?!0:!1}function g(a,v,f){if(-1==v)for(v=0;8>v;v++){var b=a[v];b&&f(b)}else(b=a[v])&&f(b)}function l(a,v,f,b){r(a,v,f,b);e(a,f);a.e.xf&&(n(a,v),d(a,v))}function z(a){if(!R.ac(a))return null;a=a.modifiers;for(var v=0;v<a.length;v++){var f=a[v];if("ARMATURE"==f.type)return f.object}return null}function C(a,v,f){var b=v.frame_range;if(b[0]>b[1])return X.warn('Incompatible action "'+v.name+'" has been applied to object "'+a.name+'"'),!1;var d=v.e,p=a.D[f];p.Th=
v.name;p.bo=b;p.pt=d.RG;p.ot=d.oC;p.Ll=d.Ll;p.start=b[0];p.length=b[1]-b[0];p.Nc=b[0];b=R.Zd(d.Hl);if(R.Se(a)&&b){p.type=10;var t=F(a,v);t||(t=B(a,v,H(a)),a.xe.push(v,t));p.h=t.h;p.Ia=t.Ia;var p=a.e,t=p.un,c=a.D[f],d=c.Br,e;a:{e=p.Ty;for(var g=0;g<e.length;g+=2)if(v==e[g]){e=e[g+1];break a}e=null}if(e)c.Br=e;else{for(c=0;c<t.length;c++)e=B(a,v,t[c].pd),d.push(e);p.Ty.push(v,d)}p.xf&&(v=p.Bn,f>v[1]?(p=v[1],v[1]=f,v[0]=p):f>v[0]&&f<v[1]&&(v[0]=f),G(a))}else if(ia.Ve(a)&&(d.eb.volume||d.eb.pitch))p.volume=
d.eb.volume||null,p.pitch=d.eb.pitch||null,p.type=40;else if("MESH"==a.type&&A(v)){p.type=60;d=F(a,v);if(!d){d=[];c=[];e=[];var g=[],k=v.e,N=a.e.Cm,n=a.e.Dm;for(t in k.eb){var m=v.name+"%join%"+t;x(t,m,k,c,d,N);x(t,m,k,g,e,n)}d={DJ:d,values:c,tH:e,uH:g};a.xe.push(v,d)}p.mx=d.DJ;p.ox=d.values;p.lx=d.tH;p.nx=d.uH}else if(t=d.eb.tsr){p.type=20;d=F(a,v);if(!d){d=v.e.sx;c=[];e=[];for(g=0;g<d;g++)c.push(t.subarray(8*g,8*g+4)),e.push(t.subarray(8*g+4,8*g+8));d={h:c,Ia:e};a.xe.push(v,d)}p.h=d.h;p.Ia=d.Ia;
T.cq(a)&&T.oJ(a,p.h[0],p.Ia[0])}else return X.warn('Incompatible action "'+v.name+'" has been applied to object "'+a.name+'"'),!1;R.Se(a)&&!b&&D(a,f);return!0}function F(a,v){for(var f=a.xe,b=0;b<f.length;b+=2)if(v==f[b])return f[b+1];return null}function G(a){var v=a.e.Bn;if(-1!=v[0]&&-1!=v[1]){var f=a.D;a=f[v[1]].Nc;var b=Math.floor(a),d=a-b,v=f[v[0]];a=v.Nc;b=Math.floor(a);v.Nc=b+d}}function D(a,v){var f=a.e.Bn,b=f[1];f[0]=-1;f[1]=-1;if(-1!=v)for(var d=a.D;0<=b;b--){var p=d[b];if(p&&10==p.type)if(b>
f[1])f[1]=b;else{b>f[0]&&(f[1]=b);break}}}function H(a){var v=a.data.bones;a=a.pose.bones;for(var f={},b=0;b<v.length;b++){var d=v[b].name;f[d]={Rt:b,Mj:b,Xq:R.Qp(a,"name",d),Nz:-1}}return f}function x(a,v,f,b,d,p){for(var t=0;t<p.length;t+=2)v==p[t]&&(d.push(p[t+1]),b.push(new Float32Array(f.eb[a])))}function A(a){a=a.e;for(var v in a.eb)if(-1!=v.indexOf("nodes"))return!0;return!1}function r(a,v,f,b){if((f=a.D[f])&&null!=f.type&&(f.play||b)){var d=a.e,p=f.Nc,t=f.start,c=f.length,p=p+f.speed*v*V.Pa,
e=f.type,g=f.speed;if(0<=g&&p>=t+c||0>g&&p<t)switch(b||(f.Wj=!0),f.behavior){case 10:p=0<=g?(p-t)%c+t:t+c-1E-6;break;case 20:p=0<=g?t:t+c-1E-6;f.play=!1;break;case 30:p=0<=g?t+c-1E-6:t,f.play=!1}f.Nc=p;switch(e){case 10:if(!d.xf){b=k(f,p,aa);v=b[0];p=b[1];b=b[2];d.Zc=f.Ia[v];d.Yc=f.Ia[p];d.jd=f.h[v];d.hd=f.h[p];d.Pg=b;d=d.un;f=f.Br;for(t=0;t<d.length;t++)c=d[t],e=f[t],c.Zc=e.Ia[v],c.Yc=e.Ia[p],c.jd=e.h[v],c.hd=e.h[p],c.Pg=b;U.w(a)}break;case 20:c=b=k(f,p,aa);(d=Y)||(d=new Float32Array(4));var p=c[0],
t=c[1],c=c[2],e=f.h,g=e[p][1],N=e[p][2],n=e[t][1],m=e[t][2];d[0]=(1-c)*e[p][0]+c*e[t][0];d[1]=(1-c)*g+c*n;d[2]=(1-c)*N+c*m;p=b;(t=pa)||(t=new Float32Array(4));c=f.Ia;ea.slerp(c[p[0]].subarray(0,4),c[p[1]].subarray(0,4),p[2],t);p=t;t=b[2];c=f.h;b=(1-t)*c[b[0]][3]+t*c[b[1]][3];f.Zr&&(t=O,U.be(a,t),R.Ui(d,t,v,f.Zr,d));f.dr&&(t=na,U.If(a,t),R.$y(p,t,v,f.dr,p));f=f.Ll;f[0]&&U.Hd(a,d);f[1]&&U.gf(a,p);f[2]&&U.ge(a,b);U.w(a);Q.P(a);break;case 30:(a=aa)||(a=Array(3));p-=f.start;0>p&&(p=0);p>=f.length&&(p=
f.length);v=Math.floor(p);b=v+1;p-=v;10!=f.behavior&&b==f.length&&(b=--v,p=1);f=f.Kz;a[0]=v+f;a[1]=b+f;a[2]=p;b=aa;d.ms=b[0];d.Jz=b[2];break;case 40:b=k(f,p,aa);v=b[0];d=b[1];b=b[2];f.volume&&ia.yr(a,(1-b)*f.volume[v]+b*f.volume[d]);f.pitch&&ia.Dk(a,(1-b)*f.pitch[v]+b*f.pitch[d]);break;case 50:T.VH(f.Wc,p/V.Pa);break;case 60:b=k(f,p,aa);v=b[0];d=b[1];b=b[2];e=f.ox;g=f.mx;p=f.nx;f=f.lx;for(t=0;t<g.length;t++)N=e[t],c=g[t],a.e.Tf[c]=(1-b)*N[v]+b*N[d];for(t=0;t<f.length;t++)e=p[t],c=f[t],e=ba.lerp(e.subarray(3*
v,3*v+3),e.subarray(3*d,3*d+3),b,Y),a.e.de[c]=e[0],a.e.de[c+1]=e[1],a.e.de[c+2]=e[2];break;default:R.ma("Unknown animation type:"+e)}}}function k(a,v,f){f||(f=Array(3));var b=a.bo[0],d=a.bo[1]-b;v-=b;0>v&&(v=0);v>=d&&(v=d);v/=a.pt;d=Math.floor(v);a=a.ot[d]?v-d:0;v=Math.ceil(d+a);f[0]=d;f[1]=v;f[2]=a;return f}function d(a,v){var f=a.e,b=f.wf,d=f.Bn,p=d[0],d=d[1];if(-1!=d){if(-1!=p){var t=a.D[p];if(t.play||0==v)var c=k(t,t.Nc,aa),e=c[0],g=c[1],c=c[2],N=t.Ia[e],n=t.Ia[g],e=t.h[e],g=t.h[g];else b=1}else b=
1;d=a.D[d];if(d.play||0==v)var c=k(d,d.Nc,aa),m=c[0],L=c[1],c=c[2];else if(-1!=p&&t.play)b=0;else return;p=d.Ia[m];t=d.Ia[L];m=d.h[m];d=d.h[L];if(1==b)f.Zc.set(p),f.Yc.set(t),f.jd.set(m),f.hd.set(d);else if(0==b)f.Zc.set(N),f.Yc.set(n),f.jd.set(e),f.hd.set(g);else{for(L=0;L<N.length;L+=4){for(var r=pa,l=na,h=0;4>h;h++)r[h]=N[L+h],l[h]=p[L+h];ea.slerp(r,l,b,r);for(h=0;4>h;h++)f.Zc[L+h]=r[h];for(h=0;4>h;h++)r[h]=n[L+h],l[h]=t[L+h];ea.slerp(r,l,b,r);for(h=0;4>h;h++)f.Yc[L+h]=r[h]}R.Ot(e,m,b,f.jd);R.Ot(g,
d,b,f.hd)}U.w(a);b=f.un;N=f.ix;for(L=0;L<b.length;L++){n=b[L];e=N[L];for(g=0;g<e.length;g+=2)for(m=e[g],p=e[g+1],t=0;4>t;t++)n.Zc[m+t]=f.Zc[p+t],n.Yc[m+t]=f.Yc[p+t],n.jd[m+t]=f.jd[p+t],n.hd[m+t]=f.hd[p+t];n.Pg=c}}}function n(a,v){var f=a.e,b=f.wf,d=f.ho;if(0!=d){var b=f.fo-b,p=d*v;R.sign(b)==R.sign(d)&&Math.abs(p)<Math.abs(b)?f.wf+=p:(f.wf=f.fo,f.ho=0)}}function B(a,v,f){for(var b=a.pose.bones,d=[],p=[],t=v.e.sx,c=0;c<t;c++){for(var e=0;e<b.length;e++){var g=b[e],k=ha.create(),N=v.e.Hl[g.name];N&&
ha.copy(N.subarray(8*c,8*c+8),k);g.lt=k;g.ul=!1}e=I(a,f);d.push(e.h);p.push(e.Ia)}return{h:d,Ia:p}}function I(a,v){var f=[],b=[],d=a.pose.bones,p=new Float32Array(4),t=new Float32Array(4),c;for(c in v){var e=v[c],g=e.Mj,k=d[e.Xq],e=p,N=t,n=k.yB,m=n[n.length-1],L=m.ao;m.ul||ha.identity(L);for(m=n.length-1;0<=m;m--){var k=n[m],r=k.ao;if(k.ul)L=r;else{var l=k.mt,h=k.lt;ha.invert(l,ka);ha.multiply(h,ka,ka);ha.multiply(l,ka,ka);ha.multiply(L,ka,r);L=r;k.ul=!0}}k=k.ao;e[0]=k[0];e[1]=k[1];e[2]=k[2];e[3]=
k[3];N[0]=k[4];N[1]=k[5];N[2]=k[6];N[3]=k[7];ea.normalize(N,N);for(e=0;4>e;e++)N=4*g+e,f[N]=p[e],b[N]=t[e]}f=new Float32Array(f);b=new Float32Array(b);return{h:f,Ia:b}}function E(a){var v=[0,0,0],f;for(f in a)"location"==f?v[0]=1:"rotation_quaternion"==f?v[1]=1:"scale"==f&&(v[2]=1);return v}function M(a,v,f,b,d,p,t){var c=a+(v-a)/2,e=K(c,b,d,p,t)-f;return.02>Math.abs(e)?c:0<e?M(a,c,f,b,d,p,t):M(c,v,f,b,d,p,t)}function K(a,v,f,b,d){var p=1-a;return v*p*p*p+3*f*p*p*a+3*b*p*a*a+d*a*a*a}function J(a,
v){if(!a.D.length)for(var f=0;8>f;f++)a.D.push(null);a.D[v]={type:null,Th:null,bo:null,pt:0,ot:null,Ll:null,Ia:null,h:null,Br:[],play:!1,behavior:20,Nc:0,start:0,length:0,Zr:0,dr:0,Wj:!1,Kz:null,speed:1,volume:null,pitch:null,ox:[],mx:[],nx:[],lx:[]};a.xe=a.xe||[];-1==ca.indexOf(a)&&ca.push(a)}function f(a,v){U.w(a);Q.P(a);l(a,0,v,!0)}function p(a,v,d){d=d||0;if(R.ac(a)){var p=R.vb("name",v,a.data.b4w_vertex_anim);if(p)return J(a,d),c(a,p,d),f(a,d),!0;if((p=R.vb("name",v,a.particle_systems))&&"EMITTER"==
p.settings.type)return J(a,d),b(a,p,d),f(a,d),!0}if(p=R.vb("name",v,Z)||R.vb("name",v+"_B4W_BAKED",Z)){J(a,d);if(C(a,p,d))return f(a,d),!0;a.D[d]=null}X.error('Unsupported object: "'+a.name+'" or animation name: "'+v+'"');return!1}function t(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var v=0;v<a.length;v++){var f=a[v],b=f.node_tree;if(f.use_nodes&&b&&L(b))return!0}return!1}function L(a){if(a.animation_data)return!0;a=a.nodes;for(var v=0;v<a.length;v++){var f=a[v];
if(f.node_group&&(f=f.node_group.node_tree)&&L(f))return!0}return!1}var N=y("__config"),T=y("__particles"),Q=y("__physics"),X=y("__print");y("__scenes");var ia=y("__sfx"),U=y("__transform"),ha=y("__tsr"),R=y("__util"),oa=y("__reformer");y("mat4");var ea=y("quat");y("vec4");var ba=y("vec3"),V=N.ze;a.yA=1E-6;a.Us=0;a.Ss=10;a.Vs=20;a.Ys=30;a.Xs=40;a.Ws=50;a.Ts=60;a.Wa=0;a.ct=1;a.dt=2;a.et=3;a.ft=4;a.gt=5;a.ht=6;a.Vn=7;a.Wn=-1;a.Ln=10;a.Mn=20;a.Nn=30;var aa=Array(3),Y=new Float32Array(3),O=new Float32Array(3),
pa=new Float32Array(4),na=new Float32Array(4),ka=new Float32Array(8);new Float32Array(16);var ca=[],Z=[];a.Uv=function(){return R.trunc((N.r.hx-50)/4)};a.mv=function(a){return a/V.Pa};a.update=function(a){for(var v=0;v<ca.length;v++){for(var f=ca[v],b=0;8>b;b++)r(f,a,b);f.e.xf&&(n(f,a),d(f,a))}for(v=0;v<ca.length;v++)for(f=ca[v],b=0;8>b&&f.D.length;b++)e(f,b)};a.vv=function(){return Z};a.xv=function(a){var v=[];if(w(a))for(var f=0;f<a.data.b4w_vertex_anim.length;f++)v.push(a.data.b4w_vertex_anim[f].name);
var b,f=[];for(b=0;b<Z.length;b++){var d=Z[b],p=d.e;R.Zd(d.e.Hl)?"ARMATURE"==a.type&&f.push(d):p.eb.volume||p.eb.pitch?ia.Ve(a)&&f.push(d):!A(d)&&R.Zd(d.fcurves)&&f.push(d)}"MESH"==a.type&&(f=f.concat(q(a)));b=f;for(f=0;f<b.length;f++)v.push(h(b[f].name));if(T.cq(a)&&T.$p(a))for(f=0;f<a.particle_systems.length;f++)v.push(a.particle_systems[f].name);return v};a.BI=h;a.yv=function(a,v){var f=a.D[v];return f?f.type:0};a.mo=function(a){var v=0,d;d=[];var p=a.animation_data;if(p&&p.action&&(p=p.action,
R.Zd(p.fcurves))){var t=R.Zd(p.e.Hl);"ARMATURE"!=a.type&&t||d.push(p)}ia.Ve(a)&&a.data.animation_data&&a.data.animation_data.action&&d.push(a.data.animation_data.action);"MESH"==a.type&&(d=d.concat(q(a)));if(!a.b4w_do_not_render)for(t=a.particle_systems,p=0;p<t.length;p++){var e=t[p],g=e.settings;"EMITTER"==g.type&&(J(a,v),b(a,e,v),f(a,v),a.D[v].behavior=m(a.b4w_anim_behavior),g.b4w_cyclic&&(a.D[v].behavior=10),v++)}for(p=0;p<d.length;p++)t=d[p],J(a,v),C(a,t,v)?(f(a,v),a.D[v].behavior=m(a.b4w_anim_behavior),
v++):a.D[v]=null;w(a)&&(J(a,v),c(a,a.data.b4w_vertex_anim[0],v),f(a,v),a.D[v].behavior=m(a.b4w_anim_behavior))};a.play=function(a,v,f){g(a.D,f,function(a){a.play=!0;a.yp=v?v:null;a.Wj=!1});a.e.xf&&G(a)};a.stop=function(a,v){g(a.D,v,function(a){a.play=!1;a.yp=null;a.Wj=!1})};a.yi=function(a,v){var f=a.D[v];return f?f.play:!1};a.ag=function(a,v,f){var b=a.D;if(-1==f)for(f=0;8>f;f++){var d=b[f];d&&(d.Nc=v,l(a,0,f,!0))}else if(d=b[f])d.Nc=v,l(a,0,f,!0)};a.Np=function(a,v){var f=a.D[v];return f&&f.Nc?
f.Nc:0};a.xi=function(a,v){var f=a.D[v];return f&&10==f.behavior};a.fn=function(a,v,f){g(a.D,f,function(a){a.behavior=v})};a.Av=function(a,v){var f=a.D[v];return f&&f.behavior};a.yt=function(a,v,f,b){g(a.D,b,function(a){a.Zr=v||0;a.dr=f||0})};a.iy=function(a,v){if(-1==v)for(var f=0;8>f;f++)a.D[f]=null;else a.D[v]=null;a.e.xf&&D(a,v)};a.ks=l;a.um=function(a){if("ARMATURE"==a.type||z(a))return!0;var v=a.animation_data;return v&&v.action||"SPEAKER"==a.type&&a.data.animation_data&&a.data.animation_data.action||
T.cq(a)&&T.$p(a)||"MESH"==a.type&&a.data.b4w_vertex_anim.length||t(a)?!0:!1};a.dk=z;a.Ka=function(a){return Boolean(a.D.length)};a.xC=H;a.Tt=I;a.IB=function(a){function v(a,v){for(var f=0;f<v;f++){var b=a.subarray(8*f+4,8*f+8);ea.normalize(b,b)}}function f(a,v){if(-1<a.indexOf("location"))var b=0,d=v;else-1<a.indexOf("rotation_quaternion")?(b=4,d=0==v?3:v-1):-1<a.indexOf("scale")?(b=3,d=0):(b=0,d=v);return b+d}function b(a,v,f,d,c){if(-1<f.search(p)){a=v;f=f.split('"')[1];var e=t}else 8==c?(f="tsr",
e=t):e=1<c?new Float32Array(c):0;if(!a[f]){c=a;v=f;if("object"==typeof e&&e.length)for(var g=e.length,k=new Float32Array(d*g),N=0;N<d;N++)for(var n=0;n<g;n++)k[N*g+n]=e[n];else if("number"==typeof e)for(k=new Float32Array(d),N=0;N<d;N++)k[N]=e;else R.ma("Wrong storage default value");c[v]=k}return a[f]}a.e={};var d=a.e;d.RG=1/V.Qg;var p=new RegExp(/pose.bones\[\".+\"\]/g),t=ha.create(),c=a.fcurves,e={},g={},k=0,N;for(N in c){var n=c[N],m;for(m in n){var L=n[m],r=L.Jc;oa.GC(L,a);L=L.num_channels;k||
(k=r.length);for(var L=b(e,g,N,k,L),l=L.length/k,h=f(N,m|0),x=0;x<k;x++)L[x*l+h]=r[x]}}for(var q in e)"tsr"==q&&v(e[q],k);for(var z in g)v(g[z],k);d.eb=e;d.Hl=g;d.oC=a.xB;d.sx=k;d.Ll="tsr"in e?E(c):null;Z.push(a)};a.YE=function(a,v){return(v-a)*V.Qg+1};a.cC=function(a,v,f,b,d,p){var t,e,c=new Float32Array(2),g=new Float32Array(2),k=new Float32Array(2),N=new Float32Array(2),n=v[1],m=v[2],L=v[a.last_frame_offset+1];a=v[a.last_frame_offset+2];for(var r=0,l=0,h=null;d<=p;d++)if(d<n)for(var x=0;x<V.Qg;x++)f[r++]=
m;else if(d>L)for(x=0;x<V.Qg;x++)f[r++]=a;else{var q=v[l],z=3;0===q&&(z+=2);0===h&&(z+=2);var O=2===q?0:1;if(v[l+1]==v[l+z+1])h=q,l+=z;else{x=0;d==v[l+1]&&(O&&(b[r]=1),f[r]=v[l+2],r++,x++);if(d==L)for(;x<V.Qg;x++)f[r++]=a;else for(c[0]=v[l+1],c[1]=v[l+2],0!==q?(g[0]=0,g[1]=0):0===h?(g[0]=v[l+5],g[1]=v[l+6]):(g[0]=v[l+3],g[1]=v[l+4]),0!==q?(k[0]=0,k[1]=0):(k[0]=v[l+z+3],k[1]=v[l+z+4]),N[0]=v[l+z+1],N[1]=v[l+z+2];x<V.Qg;x++){var J=d+x/V.Qg;switch(q){case 0:t=c;e=g;var E=k,u=N,B=[],A=[],w=void 0,T=void 0,
C=void 0,w=void 0;B[0]=t[0]-e[0];B[1]=t[1]-e[1];A[0]=u[0]-E[0];A[1]=u[1]-E[1];C=u[0]-t[0];w=Math.abs(B[0]);T=Math.abs(A[0]);0!=w+T&&w+T>C&&(w=C/(w+T),e[0]=t[0]-w*B[0],e[1]=t[1]-w*B[1],E[0]=u[0]-w*A[0],E[1]=u[1]-w*A[1]);O&&(b[r]=1);f[r]=K(M(0,1,J,c[0],g[0],k[0],N[0]),c[1],g[1],k[1],N[1]);r++;break;case 1:e=c[0];E=c[1];t=u=(N[1]-E)/(N[0]-e);e=E-u*e;O&&(b[r]=1);f[r]=t*J+e;r++;break;case 2:O&&(b[r]=1);f[r]=v[l+2];r++;break;default:R.ma("Unknown keyframe intepolation mode: "+q)}}d+1==v[l+z+1]&&(h=q,l+=
z)}}};a.$M=function(a){for(var v=0;v<a.length;v++)if(a[v].nL)return a[v];return!1};a.apply=p;a.YB=function(a,v,b){b=b||0;var d=R.vb("uuid",v,Z);if(d){J(a,b);if(C(a,d,b)){f(a,b);return}a.D[b]=null}X.error('Unsupported object: "'+a.name+'" or animation uuid: "'+v+'"')};a.EJ=function(a,v){var f=R.vb("name",v,Z)||R.vb("name",v+"_B4W_BAKED",Z);if(f){if(!R.Zd(f.fcurves))return!1}else if(!(R.vb("name",v,a.particle_systems)||R.ac(a)&&R.vb("name",v,a.data.b4w_vertex_anim)))return!1;return!0};a.Tp=function(a,
v){for(var f=a.D,b=0;b<f.length;b++){var d=f[b];if(d&&h(d.Th)==h(v))return b}return-1};a.WE=function(a,v){var f=a.D[v];return f&&f.Th?h(f.Th):null};a.remove=function(a){a.D.length=0;a=ca.indexOf(a);-1!=a&&ca.splice(a,1)};a.hH=function(a){for(var v=Z.length-1;0<=v;v--)Z[v].zB==a&&Z.splice(v,1)};a.zt=function(a,v){if(!a.D.length)return p(a,v,0)?0:-1;for(var f=0;f<a.D.length;f++)if(!a.D[f])return p(a,v,f)?f:-1};a.Hy=function(a,v,f){a.e.ho=(v-a.e.wf)/f;a.e.fo=v};a.Jy=function(a,v,f){g(a.D,f,function(a){a.speed=
v})};a.gw=function(a,v){return a.D[v].speed};a.em=function(a,v){return a.D[v].start};a.Kp=function(a,v){return a.D[v].length};a.GF=t;a.aa=function(){ca.length=0;Z.length=0};a.wE=function(a){var v=(a[0]||a[1]||a[2]).Jc.length,f=pa,b=Y,d=Boolean(a[0]);d||(a[0]={Jc:new Float32Array(v),num_channels:8});var p=Boolean(a[1]);p||(a[1]={Jc:new Float32Array(v),num_channels:8});var t=Boolean(a[2]);t||(a[2]={Jc:new Float32Array(v),num_channels:8});a[3]={Jc:new Float32Array(v),num_channels:8};for(var e=0;e<v;e++)b[0]=
d?a[0].Jc[e]:0,b[1]=p?a[1].Jc[e]:0,b[2]=t?a[2].Jc[e]:0,R.Gf(b,f),a[0].Jc[e]=f[3],a[1].Jc[e]=f[0],a[2].Jc[e]=f[1],a[3].Jc[e]=f[2]}};b4w.module.__config=function(a,y){function e(){return b4w.module_check(a.mc.Il)}function c(){for(var e=a.mc,c=null,h=document.getElementsByTagName("script"),w=0;w<h.length;w++){for(var g=h[w].src,l=0;l<e.Ww.length;l++)if(0<=g.indexOf(e.Ww[l])){c=g;break}if(null!==c)break}c||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),c=document.location.href);e=c.indexOf("?");0<=e&&(c=c.substring(0,e));return c.substring(0,c.lastIndexOf("/")+1)}var b=y("__print"),
h=y("__util");a.vg=1;a.ug=2;a.Nh=3;a.bt=4;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.hD=h.sa(a.context);a.r={alpha_sort:!0,alpha_sort_threshold:.1,io:!1,qk:[5,4],Cd:1E4,console_verbose:!1,do_not_load_resources:!1,Fn:!1,lv:1.5,zE:10,background_color:[0,0,0,0],hh:.01,render_resolution_factor:1,canvas_resolution_factor:1,yn:3,allow_cors:!1,Bp:!1,xl:!0,show_hud_debug_info:!1,EM:!0,Qk:!0,anaglyph_use:!1,cn:!0,Dc:!0,lf:!0,ji:!0,si:!0,Xh:!0,Gi:!0,ci:!0,antialiasing:!0,smaa:!1,wireframe_debug:!1,
Sz:!1,Xj:!0,yk:!0,Lb:!0,Wm:!0,water_dynamic:!0,dg:!0,qn:!0,bc:1024,kh:512,Fz:!0,precision:"highp",quality:a.ug,eo:!0,EG:!1,Ry:!1,Vu:!1,Mz:!1,$g:!1,Jo:!1,wu:!1,Gw:!1,Lo:!1,sQ:!1,ud:!1,allow_hidpi:!1,gyro_use:!1,hv:!1,Jq:!1,kq:!1,enable_selectable:!0,enable_outlining:!0,Kf:!0,hx:128,hq:!1,Jw:!1,nG:!1,Bq:[0,0]};a.VD=h.sa(a.r);a.ze={Pa:-1,nv:!1,Qg:1};a.controls={BG:1/120};a.Ae={dir:"ASSETS=../../assets/",wG:15,Rx:!0,Hq:!1,gp:!1};a.fC=h.sa(a.Ae);a.mc={shaders_dir:"",eI:"include/",pQ:"postprocessing/",
Il:"built_in_data",Ww:["b4w.min.js","b4w.full.min.js","src/b4w.js","webplayer.min.js"],ly:"./",smaa_search_texture_path:"",smaa_area_texture_path:""};a.fb={enabled:!0,Cd:60,Xk:"",Do:!1,ping:!1};a.QG=h.sa(a.fb);a.Pi={lm:1024,Vl:384,Lu:32,PD:128,OD:256,Ox:.25,TG:.5,SG:1};a.BH=h.sa(a.Pi);a.Jd={ws:!0,Em:!1,Ht:!1,iu:!1,Wu:!1};a.dI=h.sa(a.Jd);a.Vb={outlining_overview_mode:!1,Wf:[1,.4,.05],ee:1,Lm:.2,Mm:3.8,Nm:1};a.hp={enabled:!1,II:"MAIN_OPAQUE",HI:0,hI:"COLOR"};a.RD=h.sa(a.hp);a.bC=function(){var b=a.r,
e=a.fb,c=a.Pi;switch(b.quality){case a.Nh:b.Qk=!0;b.dg=!0;b.lf=!0;b.ji=!0;b.si=!0;b.Xh=!0;b.cn=!0;b.Dc=!0;b.Xj=!0;b.yk=!0;b.Lb=!0;b.Wm=!0;b.render_resolution_factor=1.75;c.lm=2048;b.yn=3;b.xl=!0;b.Fn=!1;b.precision="highp";b.water_dynamic=!0;b.qn=!0;b.antialiasing=!0;b.smaa=!0;b.ci=!0;b.Gi=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.Kf=!0;e.Cd=120;break;case a.ug:b.Qk=!0;b.dg=!0;b.lf=!0;b.ji=!0;b.si=!0;b.Xh=!0;b.cn=!0;b.Dc=!0;b.Xj=!0;b.yk=!0;b.Lb=!0;b.Wm=!0;b.render_resolution_factor=1;c.lm=1024;
b.yn=3;b.xl=!0;b.Fn=!1;b.precision="highp";b.water_dynamic=!0;b.qn=!0;b.antialiasing=!0;b.smaa=!1;b.ci=!0;b.Gi=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.Kf=!0;e.Cd=60;break;case a.vg:b.Qk=!1,b.dg=!1,b.lf=!1,b.ji=!1,b.si=!1,b.Xh=!1,b.cn=!1,b.Dc=!1,b.Xj=!1,b.yk=!1,b.Lb=!1,b.Wm=!1,b.render_resolution_factor=1,c.lm=512,b.yn=2,b.xl=!1,b.Fn=!0,b.precision="mediump",b.water_dynamic=!1,b.qn=!1,b.antialiasing=!1,b.smaa=!1,b.ci=!1,b.Gi=!1,b.allow_hidpi=!1,b.enable_outlining=!1,b.Kf=!1,e.Cd=60}};a.set=function(e,
c){switch(e){case "allow_cors":a.r.allow_cors=c;break;case "allow_hidpi":a.r.allow_hidpi=c;break;case "alpha":a.context.alpha=c;break;case "alpha_sort":a.r.alpha_sort=c;break;case "alpha_sort_threshold":a.r.alpha_sort_threshold=c;break;case "anaglyph_use":a.r.anaglyph_use=c;break;case "animation_framerate":a.ze.Pa=c;break;case "antialiasing":a.r.antialiasing=c;break;case "assets_dds_available":a.Ae.gp=c;break;case "assets_min50_available":a.Ae.Hq=c;break;case "audio":a.Jd.ws=c;break;case "background_color":a.r.background_color=
c;break;case "built_in_module_name":a.mc.Il=c;break;case "canvas_resolution_factor":a.r.canvas_resolution_factor=c;break;case "console_verbose":a.r.console_verbose=c;break;case "do_not_load_resources":a.r.do_not_load_resources=c;break;case "gyro_use":a.r.gyro_use=c;break;case "physics_enabled":a.fb.enabled=c;break;case "physics_uranium_path":a.fb.Xk=c;break;case "physics_calc_fps":a.fb.Do=c;break;case "precision":a.r.precision=c;break;case "quality":a.r.quality=c;break;case "render_resolution_factor":a.r.render_resolution_factor=
c;break;case "sfx_mix_mode":a.Jd.Em=c;break;case "shaders_dir":a.mc.shaders_dir=c;break;case "show_hud_debug_info":a.r.show_hud_debug_info=c;break;case "smaa":a.r.smaa=c;break;case "smaa_search_texture_path":a.mc.smaa_search_texture_path=c;break;case "smaa_area_texture_path":a.mc.smaa_area_texture_path=c;break;case "wireframe_debug":a.r.wireframe_debug=c;break;case "enable_selectable":a.r.enable_selectable=c;break;case "enable_outlining":a.r.enable_outlining=c;break;case "outlining_overview_mode":a.Vb.outlining_overview_mode=
c;break;case "glow_materials":a.r.Kf=c;break;default:b.error("Unknown config property: "+e)}};a.get=function(c){switch(c){case "allow_cors":return a.r.allow_cors;case "allow_hidpi":return a.r.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.r.alpha_sort;case "alpha_sort_threshold":return a.r.alpha_sort_threshold;case "anaglyph_use":return a.r.anaglyph_use;case "animation_framerate":return a.ze.Pa;case "antialiasing":return a.r.antialiasing;case "assets_dds_available":return a.Ae.gp;
case "assets_min50_available":return a.Ae.Hq;case "audio":return a.Jd.ws;case "background_color":return a.r.background_color;case "built_in_module_name":return a.mc.Il;case "canvas_resolution_factor":return a.r.canvas_resolution_factor;case "console_verbose":return a.r.console_verbose;case "do_not_load_resources":return a.r.do_not_load_resources;case "gyro_use":return a.r.gyro_use;case "physics_enabled":return a.fb.enabled;case "physics_uranium_path":return a.fb.Xk;case "physics_calc_fps":return a.fb.Do;
case "precision":return a.r.precision;case "quality":return a.r.quality;case "render_resolution_factor":return a.r.render_resolution_factor;case "sfx_mix_mode":return a.Jd.Em;case "shaders_dir":return a.mc.shaders_dir;case "show_hud_debug_info":return a.r.show_hud_debug_info;case "smaa":return a.r.smaa;case "smaa_search_texture_path":return a.mc.smaa_search_texture_path;case "smaa_area_texture_path":return a.mc.smaa_area_texture_path;case "wireframe_debug":return a.r.wireframe_debug;case "enable_selectable":return a.r.enable_selectable;
case "enable_outlining":return a.r.enable_outlining;case "outlining_overview_mode":return a.Vb.outlining_overview_mode;case "glow_materials":return a.r.Kf;default:b.error("Unknown config property: "+c)}};a.reset=function(){a.context=h.sa(a.hD);a.r=h.sa(a.VD);a.Ae=h.sa(a.fC);a.fb=h.sa(a.QG);a.Pi=h.sa(a.BH);a.Jd=h.sa(a.dI);a.hp=h.sa(a.RD)};a.UF=e;a.RH=function(){var b=a.mc,h=a.fb;e()||""!=b.shaders_dir||(b.shaders_dir=c()+"../shaders/");if(e())b.smaa_search_texture_path="smaa_search_texture.png",b.smaa_area_texture_path=
"smaa_area_texture.png";else if(""==b.smaa_search_texture_path||""==b.smaa_area_texture_path){var u=c()+b.ly;b.smaa_search_texture_path=b.smaa_search_texture_path||u+"smaa_search_texture.png";b.smaa_area_texture_path=b.smaa_area_texture_path||u+"smaa_area_texture.png"}h.enabled&&""==h.Xk&&(u=c()+b.ly,h.Xk=u+"uranium.js")};a.iw=function(){return a.Ae.dir.replace("ASSETS=","")}};b4w.module.__print=function(a){function y(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var e=1;e<a.length;e++)c.push(a[e]);return c}var e=!1,c=0,b=0;a.YH=function(a){e=a};a.Cq=function(){console.log.apply(console,arguments)};a.log=function(){if(e){var a=y(arguments,"B4W LOG");console.log.apply(console,a)}};a.error=function(){c++;var a=y(arguments,"B4W ERROR");console.error.apply(console,a)};a.warn=function(){b++;var a=y(arguments,"B4W WARN");console.warn.apply(console,
a)};a.info=function(){var a=y(arguments,"B4W INFO");console.info.apply(console,a)};a.qE=function(){c++;var a=y(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.rE=function(){b++;var a=y(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){e&&console.time.apply(console,arguments)};a.timeEnd=function(){e&&console.timeEnd.apply(console,arguments)};a.group=function(){e&&console.group.apply(console,arguments)};a.groupCollapsed=function(){e&&console.groupCollapsed.apply(console,
arguments)};a.groupEnd=function(){e&&console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)};a.CF=function(){return b};a.hF=function(){return c};a.mu=function(){c=b=0}};b4w.module.print=b4w.module.__print;b4w.module.__util=function(a,y){function e(a,f,b){for(var d=[],p=b.length,t=0;t<p;t++){var c=b[t];c[a]==f&&d.push(c)}return d}function c(a){return 0<a?1:0>a?-1:0}function b(a){var f=a[0],b=a[1],d=a[2],p=a[3],t=Math.sqrt(f*f+b*b+d*d),t=1/t;a[0]=f*t;a[1]=b*t;a[2]=d*t;a[3]=p*t}function h(a,f){return f[0]*a[0]+f[1]*a[1]+f[2]*a[2]+f[3]}function m(a,f){var b=f;switch(typeof a){case "number":return q(a,b);case "string":return u(a,b);case "boolean":return q(a|0,b);case "function":case "undefined":return q(0,
b);case "object":if(a){var d=a instanceof Array;if(a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength)for(d=0;d<a.length;d++)b=q(a[d],b);else if(d)for(d=0;d<a.length;d++)b=m(a[d],b);else for(var p in a)b=m(a[p],b)}else b=q(0,b)}return b}function q(a,f){var b=f;N[0]=a;b=(b<<5)-b+T[0];b&=b;b=(b<<5)-b+T[1];return b&b}function u(a,f){for(var b=f,d=0;d<a.length;d++)b=(b<<5)-b+a.charCodeAt(d),b&=b;return b}function w(a){return(34*a+1)*a%289}function g(a){return a-Math.floor(a)}function l(a){return z((34*
a+5)*a)}function z(a){return a-289*Math.floor(a/289)}function C(a){return a-7*Math.floor(a/7)}function F(a,f,b){a-=f;b-=f;return f+(a-Math.floor(a/b)*b)}function G(a){return F(a,0,2*Math.PI)}function D(a,f){if(a&&f){var b=a instanceof Array,d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength,p=f.buffer instanceof ArrayBuffer&&"undefined"!==f.byteLength;if(b!=f instanceof Array||d!=p)return!1;if(b){if(a.length!=f.length)return!1;for(b=0;b<a.length;b++)if(!H(a[b],f[b]))return!1}else if(d){if(a.length!=
f.length)return!1;for(b=0;b<a.length;b++)if(a[b]!=f[b])return!1}else{for(var t in a)if(!H(a[t],f[t]))return!1;for(t in f)if(!(t in a))return!1}return!0}return!(a||f)}function H(a,f){if(typeof a!=typeof f)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==f;case "object":return D(a,f);default:return!0}}function x(a){if(""==a)return".";var f=0==a.indexOf("/")|0;f&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(f=2);a=a.split("/");for(var b=[],d=0;d<a.length;d++){var p=a[d];""!=
p&&"."!=p&&(".."!=p||!f&&!b.length||b.length&&".."==b[b.length-1]?b.push(p):b.length&&b.pop())}a=b.join("/");for(d=0;d<f;d++)a="/"+a;return a||"."}var A=y("__print"),r=y("vec3"),k=y("vec4"),d=y("quat"),n=y("mat3"),B=y("mat4"),I=0,E={},M=new Float32Array(3),K=new Float32Array(3),J=new Float32Array(4),f=new Float32Array(4),p=new Float32Array(9),t=new Float32Array(16),L=new Float32Array(16),N=new Float64Array(1),T=new Uint32Array(N.buffer),Q=new Float32Array([0,0,0]),X=new Float32Array([0,0,0,1]),ia=
new Float32Array([0,0,0,1,0,0,0,1]),U=new Float32Array([1,0,0]),ha=new Float32Array([0,1,0]),R=new Float32Array([0,0,1]),oa=new Float32Array([-1,0,0]),ea=new Float32Array([0,-1,0]),ba=new Float32Array([0,0,-1]),V=Math.floor(44488.07041494893),aa=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,
0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.wB=Q;a.qB=X;a.kL=ia;a.tf=U;a.jb=ha;a.te=R;a.Pn=oa;a.Wb=ea;a.sg=ba;a.Zz=aa;a.Xw=e;a.yE=function(a,f){var b=a.length,d=new Float32Array(b+f.length);d.set(a);d.set(f,b);return d};a.UI=function(a,f){var b=a.length,d=new Uint32Array(b+f.length);d.set(a);d.set(f,b);return d};a.MC=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.dC=function(a,f){var b=[],d={},p=f.length,t,c;for(t=0;t<p;t++)d[f[t]]=
!0;p=a.length;for(t=0;t<p;t++)c=a[t],c in d&&b.push(c);return b};a.sign=c;a.KO=function(a,f,b){for(var d=b.length,p=0;p<d;p++)if(b[p][a]==f)return!0;return!1};a.vb=function(a,f,b){for(var d=0;d<b.length;d++){var p=b[d];if(p[a]===f)return p}return null};a.JO=function(a,f,b,d,p){for(var t=0;t<p.length;t++){var c=p[t];if(c[a]==f&&c[b]==d)return c}return null};a.Qp=function(a,f,b){for(var d=0;d<a.length;d++)if(a[d][f]==b)return d;return-1};a.XB=function(a,f){for(var b=0;b<a.length;b++)if(a[b]==f)return;
a.push(f)};a.jM=function(a){for(var f=0;f<a.length-1;f++)for(var b=a[f],d=f+1;d<a.length;d++)if(b==a[d])return!1;return!0};a.fP=function(a,f){for(var b=[],d=0;d<a.length;d++){var p=a[d];p.type==f&&b.push(p)}return b};a.dP=function(a,f){var b=e("name",f,a);1<b.length&&A.error("obj_by_name(): name resolution ambiguity");return b};a.eP=function(a,f){var b=e("name",f,a),d=b.length;1<d&&A.error("obj_by_name(): name resolution ambiguity");if(0>=d)return[];for(var p=[],t=0;t<d;t++){var c=b[t];if("EMPTY"==
c.type&&c.dupli_group)for(var c=c.dupli_group.objects,v=0;v<c.length;v++)p.push(c[v])}return b=b.concat(p)};a.QI=function(a,f,b,d){d||(d=new Float32Array(16));B.identity(d);d[12]=a;d[13]=f;d[14]=b};var Y=1;a.dH=function(){Y=(69069*Y+5)%Math.pow(2,32);return Math.round(Y/65536)%32768/32767};a.yI=function(a){Y=a};a.td=function(a){var f=a[0]%V*48271-3399*Math.floor(a[0]/V);a[0]=0<f?f:f+2147483647;return(a[0]-1)/2147483646};a.rm=function(a,f){f||(f=[]);f[0]=5E4+Math.floor(a);return f};a.Gf=function(a,
f){f||(f=new Float32Array(4));var b=Math.cos(a[1]/2),d=Math.cos(a[2]/2),p=Math.cos(a[0]/2),t=Math.sin(a[1]/2),c=Math.sin(a[2]/2),v=Math.sin(a[0]/2);f[0]=t*c*p+b*d*v;f[1]=t*d*p+b*c*v;f[2]=b*c*p-t*d*v;f[3]=b*d*p-t*c*v;return f};a.nE=function(a){var f=n.create(),b=Math.cos(a[0]),d=Math.cos(a[1]),p=Math.cos(a[2]),t=Math.sin(a[0]),c=Math.sin(a[1]);a=Math.sin(a[2]);var v=b*p,e=b*a,g=t*p,k=t*a;f[0]=d*p;f[1]=d*a;f[2]=-c;f[3]=c*g-e;f[4]=c*k+v;f[5]=d*t;f[6]=c*v+k;f[7]=c*e-g;f[8]=d*b;return f};a.Yx=function(a,
f){var b=a[0],d=a[1],p=a[2],t=a[3],c=p*p,v=b*d+p*t;.499999<v?(f[0]=0,f[1]=2*Math.atan2(b,t),f[2]=Math.PI/2):-.499999>v?(f[0]=0,f[1]=-2*Math.atan2(b,t),f[2]=-Math.PI/2):(f[0]=Math.atan2(2*b*t-2*d*p,1-2*b*b-2*c),f[1]=Math.atan2(2*d*t-2*b*p,1-2*d*d-2*c),f[2]=Math.asin(2*b*d+2*p*t));return f};a.va=function(a,f,b){b||(b=new Float32Array(3));r.transformQuat(f,a,b);return b};a.GM=function(a,f,b){b||(b=new Float32Array(4));a=r.normalize(a,M);var d=r.dot(f,a);a=r.cross(f,a,K);d=Math.acos(d);b[0]=a[0]*Math.sin(d/
2);b[1]=a[1]*Math.sin(d/2);b[2]=a[2]*Math.sin(d/2);b[3]=Math.cos(d/2);return b};a.RI=function(a,f,b,d){d||(d=new Float32Array(4));r.transformQuat(b,f,d);d[3]=-r.dot(a,d)};a.cE=function(a){var f=a.e.quat;switch(a.type){case "CAMERA":M[0]=0;M[1]=-1;M[2]=0;r.transformQuat(M,f,M);K[0]=0;K[1]=0;K[2]=-1;break;case "MESH":M[0]=0;M[1]=0;M[2]=1;r.transformQuat(M,f,M);K[0]=0;K[1]=0;K[2]=1;break;case "EMPTY":M[0]=0,M[1]=1,M[2]=0,r.transformQuat(M,f,M),K[0]=0,K[1]=1,K[2]=0}M[1]=0;r.normalize(M,M);a=r.dot(M,K);
return Math.acos(a)*(0<-M[0]*K[2]?-1:1)};a.Ot=function(a,f,b,d){if(0!=b){d=d||[];for(var p=0;p<a.length;p++)d[p]=(1-b)*a[p]+b*f[p]}};a.HQ=function(){I++;return I.toString(16)};a.Vk=function(a){E[a]||(E[a]=0);var f=a+E[a];E[a]++;return f};a.yd=function(){return{a_position:new Float32Array(0),a_tangent:new Float32Array(0),a_normal:new Float32Array(0)}};a.yb=function(a){var f={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};return{name:a,N:0,la:null,A:[],K:f,
ca:[]}};a.Gg=function(a){return JSON.parse(JSON.stringify(a))};a.sa=function(f){if(!(f instanceof Object))return f;var b;b=f.constructor;switch(b){case Float32Array:case Uint32Array:case Uint16Array:b=new b(f);break;case Array:b=new b(f.length);for(var d=0;d<f.length;d++)b[d]=a.sa(f[d]);break;default:for(d in b=new b,f)b[d]=a.sa(f[d])}return b};a.Ej=function(a){var f=a instanceof Array?[]:{},b;for(b in a)if(a[b]instanceof Object){var d=a[b].constructor;switch(d){case Float32Array:case Uint32Array:case Uint16Array:f[b]=
new d(a[b]);break;case Array:f[b]=a[b].slice(0);break;default:f[b]=a[b]}}else f[b]=a[b];return f};a.ac=function(a){return"MESH"===a.type?!0:!1};a.vm=function(a){return"EMPTY"===a.type?!0:!1};a.Se=function(a){return"ARMATURE"===a.type?!0:!1};a.Sf=function(a,f){f||(f=new Float32Array(4));n.fromMat4(a,p);var b=p[0],t=p[3],c=p[6],e=p[1],g=p[4],v=p[7],k=p[2],N=p[5],L=p[8],b=Math.sqrt(b*b+t*t+c*c)||1,e=Math.sqrt(e*e+g*g+v*v)||1,k=Math.sqrt(k*k+N*N+L*L)||1;p[0]/=b;p[3]/=b;p[6]/=b;p[1]/=e;p[4]/=e;p[7]/=e;
p[2]/=k;p[5]/=k;p[8]/=k;d.fromMat3(p,f);return f};a.Ci=function(a,f){f||(f=new Float32Array(3));f[0]=a[12];f[1]=a[13];f[2]=a[14];return f};a.Fq=function(a){J[0]=.577350269189626;J[1]=.577350269189626;J[2]=.577350269189626;J[3]=0;k.transformMat4(J,a,J);return k.length(J)};a.vp=function(a,f){var d=f.left,p=f.right,t=f.top,c=f.bottom,e=f.cb,v=f.$a;d[0]=a[3]+a[0];d[1]=a[7]+a[4];d[2]=a[11]+a[8];d[3]=a[15]+a[12];p[0]=a[3]-a[0];p[1]=a[7]-a[4];p[2]=a[11]-a[8];p[3]=a[15]-a[12];t[0]=a[3]-a[1];t[1]=a[7]-a[5];
t[2]=a[11]-a[9];t[3]=a[15]-a[13];c[0]=a[3]+a[1];c[1]=a[7]+a[5];c[2]=a[11]+a[9];c[3]=a[15]+a[13];e[0]=a[3]+a[2];e[1]=a[7]+a[6];e[2]=a[11]+a[10];e[3]=a[15]+a[14];v[0]=a[3]-a[2];v[1]=a[7]-a[6];v[2]=a[11]-a[10];v[3]=a[15]-a[14];b(d);b(p);b(t);b(c);b(e);b(v)};a.tI=function(a,f,b){return b<-h(a,f.left)||b<-h(a,f.right)||b<-h(a,f.top)||b<-h(a,f.bottom)||b<-h(a,f.cb)||b<-h(a,f.$a)?!0:!1};a.jE=function(a,f,b,d,p){t=r.dot(b,f.$a);c=r.dot(d,f.$a);v=r.dot(p,f.$a);t=Math.sqrt(t*t+c*c+v*v);if(t<-h(a,f.cb)||t<-h(a,
f.$a))return!0;var t=r.dot(b,f.left),c=r.dot(d,f.left),v=r.dot(p,f.left);if(Math.sqrt(t*t+c*c+v*v)<-h(a,f.left))return!0;t=r.dot(b,f.right);c=r.dot(d,f.right);v=r.dot(p,f.right);if(Math.sqrt(t*t+c*c+v*v)<-h(a,f.right))return!0;t=r.dot(b,f.top);c=r.dot(d,f.top);v=r.dot(p,f.top);if(Math.sqrt(t*t+c*c+v*v)<-h(a,f.top))return!0;t=r.dot(b,f.bottom);c=r.dot(d,f.bottom);v=r.dot(p,f.bottom);return Math.sqrt(t*t+c*c+v*v)<-h(a,f.bottom)?!0:!1};a.Yf=function(a,f,b,d){d||(d=0);for(var p=a.length,t=0;t<p;t+=3){var c=
a[t],v=a[t+1],e=a[t+2];b[d+t]=f[0]*c+f[4]*v+f[8]*e+f[12];b[d+t+1]=f[1]*c+f[5]*v+f[9]*e+f[13];b[d+t+2]=f[2]*c+f[6]*v+f[10]*e+f[14]}};a.HJ=function(a,f,b){for(var d=0,d=0,p=a.length,t=0;t<p;t+=3){var c=a[t],v=a[t+1],e=a[t+2];b[d+t]=f[0]*c+f[4]*v+f[8]*e;b[d+t+1]=f[1]*c+f[5]*v+f[9]*e;b[d+t+2]=f[2]*c+f[6]*v+f[10]*e}};a.MI=function(a,f,b){for(var d=0,d=0,p=a.length,t=0;t<p;t+=4){var c=a[t],v=a[t+1],e=a[t+2];b[d+t]=f[0]*c+f[4]*v+f[8]*e;b[d+t+1]=f[1]*c+f[5]*v+f[9]*e;b[d+t+2]=f[2]*c+f[6]*v+f[10]*e;b[d+t+3]=
a[t+3]}};a.FJ=function(a,f,b){b||(b=new Float32Array(3));J[0]=a[0];J[1]=a[1];J[2]=a[2];J[3]=0;k.transformMat4(J,f,J);b[0]=J[0];b[1]=J[1];b[2]=J[2]};a.aN=function(a,f){var b=a.length;if(!b)throw"flatten(): Wrong or empty array";var d=a[0].length;if(!d)throw"flatten(): Wrong or empty subarray";f||(f=new Float32Array(b*d));for(var p=0;p<b;p++)for(var t=0;t<d;t++)f[p*d+t]=a[p][t];return f};a.GJ=function(a){for(var f=[],b=0;b<a.length;b+=3){var d=new Float32Array([a[b],a[b+1],a[b+2]]);f[b/3]=d}return f};
a.Fl=function(f,b,d,p){if(p<d)return d;var t=d+Math.floor((p-d)/2);return f[t]>b?a.Fl(f,b,d,t-1):f[t]<b?a.Fl(f,b,t+1,p):t};a.Bf=function(a,f){for(var b=0;b<a.length;b++)if(a[b]!=f[b])return!1;return!0};a.tM=function(a,f,b){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-f[d])>b)return!1;return!0};a.zH=function(a,f,b){b||(b=new Float32Array(16));for(var d=0;12>d;d++)b[d]=a[d]*f;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15]};a.$r=function(a,f,b,d){d||(d=new Float32Array(16));f=B.fromRotationTranslation(f,
b,t);B.multiply(f,a,d)};a.Fh=function(a,f,b,d,p){p||(p=new Float32Array(3));b=B.fromRotationTranslation(b,d,t);1!==f&&(d=B.identity(L),f=r.set(f,f,f,M),B.scale(d,f,d),B.multiply(b,d,b));r.transformMat4(a,b,p);return p};a.as=function(a,f,b,d){d||(d=new Float32Array(4));f=B.fromRotationTranslation(f,b,t);k.transformMat4(a,f,d)};a.xO=function(a,f,b,d,p){p||(p=new Float32Array(3));f=B.fromRotationTranslation(b,d,t);B.invert(f,f);r.transformMat4(a,f,p);return p};a.DQ=function(a,f,b){b||(b=new Float32Array(16));
B.fromRotationTranslation(f,a,b);a=a[3];for(f=0;12>f;f++)b[f]*=a;return b};a.UO=function(f,b,d){a.Ci(f,b);b[3]=a.Fq(f);a.Sf(f,d)};a.HL=function(a){for(var f=[],b=0;b<a.length;b++)f.push(a[b]);return JSON.stringify(f)};a.vH=function(a,f,b,d){d||(d=new Float32Array(3));r.subtract(f,a,M);r.transformQuat(M,b,M);r.subtract(f,M,d)};a.KE=function(){M[0]=0;M[1]=0;M[2]=0;var a=new Float32Array(16),f=new Float32Array(16),b=new Float32Array(16),d=new Float32Array(16),p=new Float32Array(16),t=new Float32Array(16);
B.lookAt(M,[-1,0,0],[0,-1,0],a);B.scale(a,[-1,1,1],a);B.scale(a,[-1,1,-1],f);B.lookAt(M,[0,-1,0],[0,0,-1],b);B.scale(b,[1,1,-1],b);B.scale(b,[1,-1,-1],d);B.lookAt(M,[0,0,-1],[0,-1,0],p);B.scale(p,[-1,1,1],p);B.scale(p,[-1,1,-1],t);return[a,f,b,d,p,t]};a.OE=function(){M[0]=0;M[1]=0;M[2]=0;var a=new Float32Array(16),f=new Float32Array(16),b=new Float32Array(16),d=new Float32Array(16),p=new Float32Array(16),t=new Float32Array(16);B.lookAt(M,[1,0,0],[0,-1,0],a);B.scale(a,[-1,1,-1],f);B.lookAt(M,[0,1,
0],[0,0,1],b);B.scale(b,[1,-1,-1],d);B.lookAt(M,[0,0,1],[0,-1,0],p);B.scale(p,[-1,1,-1],t);return[a,f,b,d,p,t]};a.Zh=function(a,f){return m(a,f)};a.Bw=m;a.rO=u;a.TO=function(a,f,b){var d=f[0],p=f[1];f=f[2];var t,c,v,e,g,k,N,n,L,r,l,m;if(!b||a===b)return a[12]=a[0]*d+a[4]*p+a[8]*f+a[12],a[13]=a[1]*d+a[5]*p+a[9]*f+a[13],a[14]=a[2]*d+a[6]*p+a[10]*f+a[14],a[15]=a[3]*d+a[7]*p+a[11]*f+a[15],a;t=a[0];c=a[1];v=a[2];e=a[3];g=a[4];k=a[5];N=a[6];n=a[7];L=a[8];r=a[9];l=a[10];m=a[11];b[0]=t;b[1]=c;b[2]=v;b[3]=
e;b[4]=g;b[5]=k;b[6]=N;b[7]=n;b[8]=L;b[9]=r;b[10]=l;b[11]=m;b[12]=t*d+g*p+L*f+a[12];b[13]=c*d+k*p+r*f+a[13];b[14]=v*d+N*p+l*f+a[14];b[15]=e*d+n*p+m*f+a[15];return b};a.tG=function(a,f){f[15]=1;f[14]=0;f[13]=0;f[12]=0;f[11]=0;f[10]=a[8];f[9]=a[7];f[8]=a[6];f[7]=0;f[6]=a[5];f[5]=a[4];f[4]=a[3];f[3]=0;f[2]=a[2];f[1]=a[1];f[0]=a[0];return f};a.Xx=function(a,f){f||(f=a);var b=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<b?(f[3]=2*Math.acos(a[3]),b=1/Math.sqrt(b),f[0]=a[0]*b,f[1]=a[1]*b,f[2]=a[2]*b):(f[3]=0,f[0]=1,
f[1]=0,f[2]=0);return f};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.Ym=function(a){return a*Math.PI/180};a.WD=function(a){return 180*a/Math.PI};a.Gr=function(a){var f=.366025403784439*a[0]+.366025403784439*a[1],b=Math.floor(a[0]+f),d=Math.floor(a[1]+f),p=.211324865405187*b+.211324865405187*d,f=a[0]-b+p;a=a[1]-d+p;var t=f>a?1:0,c=1-t,p=f+.211324865405187-t,v=a+.211324865405187-c,e=f+-.577350269189626,k=a+-.577350269189626,b=b%289,d=d%289,N=w(w(d)+b),c=w(w(d+c)+b+t),n=w(w(d+
1)+b+1),b=Math.max(.5-(f*f+a*a),0),d=Math.max(.5-(p*p+v*v),0),t=Math.max(.5-(e*e+k*k),0),L=2*g(.024390243902439*N)-1,r=2*g(.024390243902439*c)-1,l=2*g(.024390243902439*n)-1,N=Math.abs(L)-.5,c=Math.abs(r)-.5,n=Math.abs(l)-.5,L=L-Math.floor(L+.5),r=r-Math.floor(r+.5),l=l-Math.floor(l+.5),b=b*b*b*b*(1.79284291400159-.85373472095314*(L*L+N*N)),d=d*d*d*d*(1.79284291400159-.85373472095314*(r*r+c*c)),t=t*t*t*t*(1.79284291400159-.85373472095314*(l*l+n*n));return 130*(b*(L*f+N*a)+d*(r*p+c*v)+t*(l*e+n*k))};
a.Yt=function(a){var f=1/7,b=f/2,d=z(Math.floor(a[0])),p=z(Math.floor(a[1])),t=g(a[0]);a=g(a[1]);var c=t-.5,v=t-1.5,t=a-.5;a-=1.5;var e=l(d),k=l(d+1),N=e,d=k,e=l(e+p),k=l(k+p),N=l(N+p+1),d=l(d+p+1),p=c+.7*(C(e)*f+b),n=v+.7*(C(k)*f+b),c=c+.7*(C(N)*f+b),v=v+.7*(C(d)*f+b),e=t+.7*(C(Math.floor(e*f))*f+b),t=t+.7*(C(Math.floor(k*f))*f+b),N=a+.7*(C(Math.floor(N*f))*f+b),f=a+.7*(C(Math.floor(d*f))*f+b);return Math.min(p*p+e*e,n*n+t*t,c*c+N*N,v*v+f*f)};a.cr=function(a,f,b,t,c){c||(c=new Float32Array(4));a=
r.transformQuat(f,a,M);f=b[0];var e=b[1];b=b[2];p[0]=e*e+b*b;p[1]=-e*f;p[2]=-b*f;p[3]=-f*e;p[4]=f*f+b*b;p[5]=-b*e;p[6]=-f*b;p[7]=-e*b;p[8]=f*f+e*e;r.transformMat3(a,p,a);r.normalize(a,a);d.rotationTo(t,a,c);return c};a.Fo=function(a,b){b||(b=new Float32Array(4));var p=J,t=f,p=d.setAxisAngle([0,1,0],Math.PI,d.create()),t=d.setAxisAngle([1,0,0],Math.PI/2,d.create());d.multiply(p,t,p);d.multiply(a,p,b);return b};a.aa=function(){I=0;E={}};a.qa=function(a,f,b){return Math.min(Math.max(a,f),b)};a.fc=function(a,
f,b,d){b=Math.exp(-b/d);return(1-b)*a+b*f};a.Ui=function(a,f,b,d,p){p||(p=new Float32Array(a.length));b=Math.exp(-b/d);for(d=0;d<p.length;d++)p[d]=(1-b)*a[d]+b*f[d];return p};a.$y=function(a,f,b,p,t){t||(t=new Float32Array(a.length));d.slerp(a,f,Math.exp(-b/p),t)};a.yO=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.We=function(a,f){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(f&&f==a.length||!f)return!0;return!1};a.So=function(a,b){var t=
n.fromQuat(a,p);K[0]=0;K[1]=1;K[2]=0;M[0]=t[3];M[1]=t[4];M[2]=t[5];var c=r.cross(K,M,M);r.normalize(c,c);var e=t[7];!b&&0<e&&(c[0]*=-1,c[1]*=-1,c[2]*=-1);K[0]=t[0];K[1]=t[1];K[2]=t[2];r.normalize(K,K);d.rotationTo(K,c,f);d.multiply(f,a,a)};a.zv=function(a,f,b,d){b=b*f-.5;var p=d*f-.5;d=b-Math.floor(b);var t=p-Math.floor(p);b=Math.floor(b);var p=Math.floor(p),c=f-1,v=a[p*f+b],e=a[p*f+Math.min(b+1,c)],g=a[Math.min(p+1,c)*f+b];a=a[Math.min(p+1,c)*f+Math.min(b+1,c)];return(v*(1-d)+e*d)*(1-t)+(g*(1-d)+
a*d)*t};a.yh=function(a){for(var f=0,b=0;3>b;b++)0<(a&1<<b)&&f++;return f};a.my=function(a){for(var f=[0,0,0],b=0;3>b;b++)0<(a&1<<b)&&(f[2-b]=1);return f};a.Mk=function(a,f){var b=0;(1==f||2==f)&&0<(a&4)&&b++;2==f&&0<(a&2)&&b++;return b};a.sv=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var f=16*Math.random()|0;return("x"==a?f:f&3|8).toString(16)})};a.Zd=function(a){var f=0,b;for(b in a)a.hasOwnProperty(b)&&f++;return f};a.$x=function(a){if(!a.length)return null;
var f=Math.floor(Math.random()*a.length);return a[f]};a.Uz=function(a,f,b){b||(b=new Float32Array(3));b[0]=a[0]-f[0];b[1]=0;b[2]=a[2]-f[2];r.normalize(b,b)};a.SI=function(a,f,b){var d=a[0],p=a[1];a=a[2];var t=f[0],c=f[1],v=f[2];f=f[3];var e=c*a-v*p,g=v*d-t*a,k=t*p-c*d,N=c*k-v*g,v=v*e-t*k,t=t*g-c*e;b[0]=d+2*e*f+2*N;b[1]=p+2*g*f+2*v;b[2]=a+2*k*f+2*t};a.assert=function(a){if(!a)throw Error("Assertion failed");};a.ma=function(a){a&&A.error.apply(A,arguments);throw"panic: see above for possible error messages";
};a.ye=F;a.Qd=G;a.Op=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.lz=function(a,f){for(var b in a){var d=!0,p=a[b],t=f[b];switch(typeof p){case "number":case "string":case "boolean":d=p==t;break;case "object":d=D(p,t)}if(!d)return!1}return!0};a.br=function(a,f){var b=a[0],d=a[2],p=a[3];f[0]=a[1];f[1]=d;f[2]=p;f[3]=b};a.qv=function(a){a+=1;132651<a&&A.error("Color ID pool depleted");var f=Math.floor(a/2601);a%=2601;var b=Math.floor(a/51);return new Float32Array([f/51,b/51,a%51/51])};a.yq=function(a,
b,d,p,t){J.set(a);J[3]=b;f.set(p);f[3]=0;a=k.dot(J,f);if(0==a)return null;f.set(d);f[3]=1;a=-k.dot(J,f)/a;t[0]=d[0]+a*p[0];t[1]=d[1]+a*p[1];t[2]=d[2]+a*p[2];return t};a.tF=function(a,f,b,d){var p=f[0]-a[0],t=b[0]-a[0],c=f[1]-a[1],v=b[1]-a[1];f=f[2]-a[2];a=b[2]-a[2];d[0]=c*a-f*v;d[1]=t*f-p*a;d[2]=p*v-c*t;return d};a.wM=function(a,f){for(var b=0;b<a.length;b++)f[b]=a[b];return f};a.xH=function(a,f,b){var p=r.dot(a,f);-.9999999>p?(r.cross(U,a,M),1E-6>r.length(M)&&r.cross(ha,a,M),r.normalize(M,M),d.setAxisAngle(M,
Math.PI,b)):(r.cross(a,f,M),b.set(M),b[3]=1+p,d.normalize(b,b));return b};a.zf=function(a,f,b){if(f==b)return b-a;a=G(a);f=G(f);b=G(b);var d=Math.abs(f-b);if(.001>d||.001>Math.abs(d-2*Math.PI))return 0;f=2*Math.PI-f;b=G(b+f);a=G(a+f);return a>b?(b-=a,a=2*Math.PI-a,-b>a?a:b):0};a.Fr=function(a,f,b){isFinite(f)&&isFinite(b)&&(a=clamp(a,f,b));return a*a*(3-2*a)};a.lerp=function(a,f,b){return f+a*(b-f)};a.eC=function(a,f){for(var b=0;b<a.length;b++)for(var d=0;d<f.length;d++)if(f[d]==a[b])return!0;return!1};
a.zM=function(a){for(var f=Array(a),b=0;b<a;b++)f[b]=0;return f};a.Lz=function(a,f){for(var b=Math.max(a.length,f.length),d=0;d<b;d++){var p=c((d>=a.length?0:a[d])-(d>=f.length?0:f[d]));if(p)return p}return 0};a.Hn=function(a){return a.join(".")};a.AI=function(a){return a.split(".").map(function(a){return a|0})};a.xQ=function(a,f){f[0]=Math.pow(a[0],2.2);f[1]=Math.pow(a[1],2.2);f[2]=Math.pow(a[2],2.2);return f};a.MO=function(a,f){f[0]=Math.pow(a[0],1/2.2);f[1]=Math.pow(a[1],1/2.2);f[2]=Math.pow(a[2],
1/2.2);return f};a.Hm=function(a){var f=a.split("://",2);return 1<f.length?(f[1]=x(f[1]),f.join("://")):x(a)}};b4w.module.__vec3=function(a){var y="undefined"!==typeof Float32Array?Float32Array:Array,e=Math.random;a.create=function(){var a=new y(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new y(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,e){var m=new y(3);m[0]=a;m[1]=b;m[2]=e;return m};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,e,m){m[0]=a;m[1]=b;m[2]=e;return m};a.add=function(a,b,e){e[0]=a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];
return e};a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],
b[2]);return e};a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;return e};a.scaleAndAdd=function(a,b,e,m){m[0]=a[0]+b[0]*e;m[1]=a[1]+b[1]*e;m[2]=a[2]+b[2]*e;return m};a.distance=function(a,b){var e=b[0]-a[0],m=b[1]-a[1],q=b[2]-a[2];return Math.sqrt(e*e+m*m+q*q)};a.dist=a.distance;a.squaredDistance=function(a,b){var e=b[0]-a[0],m=b[1]-a[1],q=b[2]-a[2];return e*e+m*m+q*q};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],e=a[1];a=a[2];return Math.sqrt(b*b+e*e+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],e=a[1];a=a[2];return b*b+e*e+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var e=a[0],m=a[1],q=a[2],e=e*e+m*m+q*q;0<e&&(e=1/Math.sqrt(e),b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,e){var m=a[0],q=a[1];a=a[2];var u=b[0],w=b[1];b=b[2];
e[0]=q*b-a*w;e[1]=a*u-m*b;e[2]=m*w-q*u;return e};a.lerp=function(a,b,e,m){var q=a[0],u=a[1];a=a[2];m[0]=q+e*(b[0]-q);m[1]=u+e*(b[1]-u);m[2]=a+e*(b[2]-a);return m};a.random=function(a,b){a=a||1;var h=2*e()*Math.PI,m=2*e()-1,q=Math.sqrt(1-m*m)*a;b[0]=Math.cos(h)*q;b[1]=Math.sin(h)*q;b[2]=m*a;return b};a.transformMat4=function(a,b,e){var m=a[0],q=a[1];a=a[2];var u=b[3]*m+b[7]*q+b[11]*a+b[15],u=u||1;e[0]=(b[0]*m+b[4]*q+b[8]*a+b[12])/u;e[1]=(b[1]*m+b[5]*q+b[9]*a+b[13])/u;e[2]=(b[2]*m+b[6]*q+b[10]*a+b[14])/
u;return e};a.transformMat3=function(a,b,e){var m=a[0],q=a[1];a=a[2];e[0]=m*b[0]+q*b[3]+a*b[6];e[1]=m*b[1]+q*b[4]+a*b[7];e[2]=m*b[2]+q*b[5]+a*b[8];return e};a.transformQuat=function(a,b,e){var m=a[0],q=a[1],u=a[2];a=b[0];var w=b[1],g=b[2];b=b[3];var l=b*m+w*u-g*q,z=b*q+g*m-a*u,C=b*u+a*q-w*m,m=-a*m-w*q-g*u;e[0]=l*b+m*-a+z*-g-C*-w;e[1]=z*b+m*-w+C*-a-l*-g;e[2]=C*b+m*-g+l*-w-z*-a;return e};a.rotateX=function(a,b,e,m){var q=[],u=[];q[0]=a[0]-b[0];q[1]=a[1]-b[1];q[2]=a[2]-b[2];u[0]=q[0];u[1]=q[1]*Math.cos(e)-
q[2]*Math.sin(e);u[2]=q[1]*Math.sin(e)+q[2]*Math.cos(e);m[0]=u[0]+b[0];m[1]=u[1]+b[1];m[2]=u[2]+b[2];return m};a.rotateY=function(a,b,e,m){var q=[],u=[];q[0]=a[0]-b[0];q[1]=a[1]-b[1];q[2]=a[2]-b[2];u[0]=q[2]*Math.sin(e)+q[0]*Math.cos(e);u[1]=q[1];u[2]=q[2]*Math.cos(e)-q[0]*Math.sin(e);m[0]=u[0]+b[0];m[1]=u[1]+b[1];m[2]=u[2]+b[2];return m};a.rotateZ=function(a,b,e,m){var q=[],u=[];q[0]=a[0]-b[0];q[1]=a[1]-b[1];q[2]=a[2]-b[2];u[0]=q[0]*Math.cos(e)-q[1]*Math.sin(e);u[1]=q[0]*Math.sin(e)+q[1]*Math.cos(e);
u[2]=q[2];m[0]=u[0]+b[0];m[1]=u[1]+b[1];m[2]=u[2]+b[2];return m};a.forEach=function(){var e=a.create();return function(a,h,m,q,u,w){h||(h=3);m||(m=0);for(q=q?Math.min(q*h+m,a.length):a.length;m<q;m+=h)e[0]=a[m],e[1]=a[m+1],e[2]=a[m+2],u(e,w,e),a[m]=e[0],a[m+1]=e[1],a[m+2]=e[2];return a}}();a.qL=function(e,b){var h=a.fromValues(e[0],e[1],e[2]),m=a.fromValues(b[0],b[1],b[2]);a.normalize(h,h);a.normalize(m,m);h=a.dot(h,m);return 1<h?0:Math.acos(h)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+
a[2]+")"};"undefined"!==typeof a&&(a.vec3=a)};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var y="undefined"!==typeof Float32Array?Float32Array:Array,e=Math.random;a.create=function(){var a=new y(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new y(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,e,m){var q=new y(4);q[0]=a;q[1]=b;q[2]=e;q[3]=m;return q};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,e,m,q){q[0]=a;q[1]=b;q[2]=e;q[3]=m;return q};a.add=function(a,b,e){e[0]=
a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];e[3]=a[3]+b[3];return e};a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];e[3]=a[3]-b[3];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];e[3]=a[3]*b[3];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];e[3]=a[3]/b[3];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);e[3]=
Math.min(a[3],b[3]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],b[2]);e[3]=Math.max(a[3],b[3]);return e};a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;e[3]=a[3]*b;return e};a.scaleAndAdd=function(a,b,e,m){m[0]=a[0]+b[0]*e;m[1]=a[1]+b[1]*e;m[2]=a[2]+b[2]*e;m[3]=a[3]+b[3]*e;return m};a.distance=function(a,b){var e=b[0]-a[0],m=b[1]-a[1],q=b[2]-a[2],u=b[3]-a[3];return Math.sqrt(e*e+m*m+q*q+u*u)};a.dist=a.distance;a.squaredDistance=
function(a,b){var e=b[0]-a[0],m=b[1]-a[1],q=b[2]-a[2],u=b[3]-a[3];return e*e+m*m+q*q+u*u};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],e=a[1],m=a[2];a=a[3];return Math.sqrt(b*b+e*e+m*m+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],e=a[1],m=a[2];a=a[3];return b*b+e*e+m*m+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var e=a[0],m=a[1],q=a[2],u=a[3],e=e*e+m*m+q*q+u*u;0<e&&(e=1/Math.sqrt(e),b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e,b[3]=a[3]*e);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,e,m){var q=a[0],u=a[1],w=a[2];a=a[3];m[0]=q+e*(b[0]-q);m[1]=u+e*(b[1]-u);m[2]=w+e*(b[2]-w);m[3]=a+e*(b[3]-a);return m};a.random=function(c,b){c=c||1;b[0]=e();b[1]=e();b[2]=e();b[3]=e();a.normalize(b,b);a.scale(b,c,b);return b};a.transformMat4=function(a,b,e){var m=a[0],
q=a[1],u=a[2];a=a[3];e[0]=b[0]*m+b[4]*q+b[8]*u+b[12]*a;e[1]=b[1]*m+b[5]*q+b[9]*u+b[13]*a;e[2]=b[2]*m+b[6]*q+b[10]*u+b[14]*a;e[3]=b[3]*m+b[7]*q+b[11]*u+b[15]*a;return e};a.transformQuat=function(a,b,e){var m=a[0],q=a[1],u=a[2],w=b[0],g=b[1],l=b[2];b=b[3];var z=b*m+g*u-l*q,C=b*q+l*m-w*u,F=b*u+w*q-g*m,m=-w*m-g*q-l*u;e[0]=z*b+m*-w+C*-l-F*-g;e[1]=C*b+m*-g+F*-w-z*-l;e[2]=F*b+m*-l+z*-g-C*-w;e[3]=a[3];return e};a.forEach=function(){var e=a.create();return function(a,h,m,q,u,w){h||(h=4);m||(m=0);for(q=q?Math.min(q*
h+m,a.length):a.length;m<q;m+=h)e[0]=a[m],e[1]=a[m+1],e[2]=a[m+2],e[3]=a[m+3],u(e,w,e),a[m]=e[0],a[m+1]=e[1],a[m+2]=e[2],a[m+3]=e[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.vec4=a)};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,y){var e=y("__vec3"),c=y("__vec4"),b=y("__mat3"),h="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new h(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=e.create(),c=e.fromValues(1,0,0),u=e.fromValues(0,1,0);return function(h,g,l){var z=e.dot(h,g);if(-.9999999>z)return e.cross(c,h,b),1E-6>e.length(b)&&e.cross(u,h,b),e.normalize(b,b),a.setAxisAngle(b,Math.PI,l),l;if(.9999999<z)return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l;e.cross(h,
g,b);l[0]=b[0];l[1]=b[1];l[2]=b[2];l[3]=1+z;return a.normalize(l,l)}}();a.setAxes=function(){var e=b.create();return function(b,c,h,g){e[0]=c[0];e[3]=c[1];e[6]=c[2];e[1]=h[0];e[4]=h[1];e[7]=h[2];e[2]=-b[0];e[5]=-b[1];e[8]=-b[2];return a.normalize(a.fromMat3(e,g),g)}}();a.clone=c.clone;a.fromValues=c.fromValues;a.copy=c.copy;a.set=c.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,e){b*=.5;var c=Math.sin(b);e[0]=c*a[0];e[1]=c*a[1];e[2]=c*a[2];e[3]=Math.cos(b);
return e};a.add=c.add;a.multiply=function(a,b,e){var c=a[0],g=a[1],l=a[2];a=a[3];var z=b[0],h=b[1],F=b[2];b=b[3];e[0]=c*b+a*z+g*F-l*h;e[1]=g*b+a*h+l*z-c*F;e[2]=l*b+a*F+c*h-g*z;e[3]=a*b-c*z-g*h-l*F;return e};a.mul=a.multiply;a.scale=c.scale;a.rotateX=function(a,b,e){b*=.5;var c=a[0],g=a[1],l=a[2];a=a[3];var z=Math.sin(b);b=Math.cos(b);e[0]=c*b+a*z;e[1]=g*b+l*z;e[2]=l*b-g*z;e[3]=a*b-c*z;return e};a.rotateY=function(a,b,e){b*=.5;var c=a[0],g=a[1],l=a[2];a=a[3];var z=Math.sin(b);b=Math.cos(b);e[0]=c*
b-l*z;e[1]=g*b+a*z;e[2]=l*b+c*z;e[3]=a*b-g*z;return e};a.rotateZ=function(a,b,e){b*=.5;var c=a[0],g=a[1],l=a[2];a=a[3];var z=Math.sin(b);b=Math.cos(b);e[0]=c*b+g*z;e[1]=g*b-c*z;e[2]=l*b+a*z;e[3]=a*b-l*z;return e};a.calculateW=function(a,b){var e=a[0],c=a[1],g=a[2];b[0]=e;b[1]=c;b[2]=g;b[3]=Math.sqrt(Math.abs(1-e*e-c*c-g*g));return b};a.dot=c.dot;a.lerp=c.lerp;a.slerp=function(a,b,e,c){var g=a[0],l=a[1],z=a[2];a=a[3];var h=b[0],F=b[1],G=b[2];b=b[3];var D,H,x;H=g*h+l*F+z*G+a*b;0>H&&(H=-H,h=-h,F=-F,
G=-G,b=-b);1E-6<1-H?(D=Math.acos(H),x=Math.sin(D),H=Math.sin((1-e)*D)/x,e=Math.sin(e*D)/x):H=1-e;c[0]=H*g+e*h;c[1]=H*l+e*F;c[2]=H*z+e*G;c[3]=H*a+e*b;return c};a.invert=function(a,b){var e=a[0],c=a[1],g=a[2],l=a[3],z=e*e+c*c+g*g+l*l,z=z?1/z:0;b[0]=-e*z;b[1]=-c*z;b[2]=-g*z;b[3]=l*z;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};a.length=c.length;a.len=a.length;a.squaredLength=c.squaredLength;a.sqrLen=a.squaredLength;a.normalize=c.normalize;a.fromMat3=function(a,
b){var e=a[0]+a[4]+a[8];if(0<e)e=Math.sqrt(e+1),b[3]=.5*e,e=.5/e,b[0]=(a[5]-a[7])*e,b[1]=(a[6]-a[2])*e,b[2]=(a[1]-a[3])*e;else{var c=0;a[4]>a[0]&&(c=1);a[8]>a[3*c+c]&&(c=2);var g=(c+1)%3,l=(c+2)%3,e=Math.sqrt(a[3*c+c]-a[3*g+g]-a[3*l+l]+1);b[c]=.5*e;e=.5/e;b[3]=(a[3*g+l]-a[3*l+g])*e;b[g]=(a[3*g+c]+a[3*c+g])*e;b[l]=(a[3*l+c]+a[3*c+l])*e}return b};a.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.quat=a)};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var y="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new y(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[4];c[4]=a[5];c[5]=a[6];c[6]=a[8];c[7]=a[9];c[8]=a[10];return c};a.clone=function(a){var c=new y(9);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=
a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],h=a[2],m=a[5];c[1]=a[3];c[2]=a[6];c[3]=b;c[5]=a[7];c[6]=h;c[7]=m}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c};a.invert=function(a,c){var b=a[0],h=a[1],m=a[2],q=a[3],u=a[4],w=a[5],g=a[6],l=a[7],z=a[8],C=z*u-w*l,F=-z*q+w*g,G=
l*q-u*g,D=b*C+h*F+m*G;if(!D)return null;D=1/D;c[0]=C*D;c[1]=(-z*h+m*l)*D;c[2]=(w*h-m*u)*D;c[3]=F*D;c[4]=(z*b-m*g)*D;c[5]=(-w*b+m*q)*D;c[6]=G*D;c[7]=(-l*b+h*g)*D;c[8]=(u*b-h*q)*D;return c};a.adjoint=function(a,c){var b=a[0],h=a[1],m=a[2],q=a[3],u=a[4],w=a[5],g=a[6],l=a[7],z=a[8];c[0]=u*z-w*l;c[1]=m*l-h*z;c[2]=h*w-m*u;c[3]=w*g-q*z;c[4]=b*z-m*g;c[5]=m*q-b*w;c[6]=q*l-u*g;c[7]=h*g-b*l;c[8]=b*u-h*q;return c};a.determinant=function(a){var c=a[3],b=a[4],h=a[5],m=a[6],q=a[7],u=a[8];return a[0]*(u*b-h*q)+a[1]*
(-u*c+h*m)+a[2]*(q*c-b*m)};a.multiply=function(a,c,b){var h=a[0],m=a[1],q=a[2],u=a[3],w=a[4],g=a[5],l=a[6],z=a[7];a=a[8];var C=c[0],F=c[1],G=c[2],D=c[3],H=c[4],x=c[5],A=c[6],r=c[7];c=c[8];b[0]=C*h+F*u+G*l;b[1]=C*m+F*w+G*z;b[2]=C*q+F*g+G*a;b[3]=D*h+H*u+x*l;b[4]=D*m+H*w+x*z;b[5]=D*q+H*g+x*a;b[6]=A*h+r*u+c*l;b[7]=A*m+r*w+c*z;b[8]=A*q+r*g+c*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var h=a[0],m=a[1],q=a[2],u=a[3],w=a[4],g=a[5],l=a[6],z=a[7];a=a[8];var C=c[0];c=c[1];b[0]=h;b[1]=m;b[2]=q;
b[3]=u;b[4]=w;b[5]=g;b[6]=C*h+c*u+l;b[7]=C*m+c*w+z;b[8]=C*q+c*g+a;return b};a.rotate=function(a,c,b){var h=a[0],m=a[1],q=a[2],u=a[3],w=a[4],g=a[5],l=a[6],z=a[7];a=a[8];var C=Math.sin(c);c=Math.cos(c);b[0]=c*h+C*u;b[1]=c*m+C*w;b[2]=c*q+C*g;b[3]=c*u-C*h;b[4]=c*w-C*m;b[5]=c*g-C*q;b[6]=l;b[7]=z;b[8]=a;return b};a.scale=function(a,c,b){var h=c[0];c=c[1];b[0]=h*a[0];b[1]=h*a[1];b[2]=h*a[2];b[3]=c*a[3];b[4]=c*a[4];b[5]=c*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.EE=function(a,c){c[0]=1;c[1]=0;c[2]=
0;c[3]=0;c[4]=1;c[5]=0;c[6]=a[0];c[7]=a[1];c[8]=1;return c};a.CE=function(a,c){var b=Math.sin(a),h=Math.cos(a);c[0]=h;c[1]=b;c[2]=0;c[3]=-b;c[4]=h;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.DE=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=a[1];c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.fromMat2d=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=0;c[3]=a[2];c[4]=a[3];c[5]=0;c[6]=a[4];c[7]=a[5];c[8]=1;return c};a.fromQuat=function(a,c){var b=a[0],h=a[1],m=a[2],q=a[3],u=b+b,w=h+h,g=m+m,b=b*u,l=h*u,h=h*w,z=m*u,C=
m*w,m=m*g,u=q*u,w=q*w,q=q*g;c[0]=1-h-m;c[3]=l-q;c[6]=z+w;c[1]=l+q;c[4]=1-b-m;c[7]=C-u;c[2]=z-w;c[5]=C+u;c[8]=1-b-h;return c};a.normalFromMat4=function(a,c){var b=a[0],h=a[1],m=a[2],q=a[3],u=a[4],w=a[5],g=a[6],l=a[7],z=a[8],C=a[9],F=a[10],G=a[11],D=a[12],H=a[13],x=a[14],A=a[15],r=b*w-h*u,k=b*g-m*u,d=b*l-q*u,n=h*g-m*w,B=h*l-q*w,I=m*l-q*g,E=z*H-C*D,M=z*x-F*D,z=z*A-G*D,K=C*x-F*H,C=C*A-G*H,F=F*A-G*x,G=r*F-k*C+d*K+n*z-B*M+I*E;if(!G)return null;G=1/G;c[0]=(w*F-g*C+l*K)*G;c[1]=(g*z-u*F-l*M)*G;c[2]=(u*C-w*
z+l*E)*G;c[3]=(m*C-h*F-q*K)*G;c[4]=(b*F-m*z+q*M)*G;c[5]=(h*z-b*C-q*E)*G;c[6]=(H*I-x*B+A*n)*G;c[7]=(x*d-D*I-A*k)*G;c[8]=(D*B-H*d+A*r)*G;return c};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.BE=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof a&&(a.mat3=a)};
b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var y="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new y(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var c=new y(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.copy=function(a,c){c[0]=a[0];
c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],h=a[2],m=a[3],q=a[6],u=a[7],w=a[11];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=h;c[9]=q;c[11]=a[14];c[12]=m;c[13]=
u;c[14]=w}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c};a.invert=function(a,c){var b=a[0],h=a[1],m=a[2],q=a[3],u=a[4],w=a[5],g=a[6],l=a[7],z=a[8],C=a[9],F=a[10],G=a[11],D=a[12],H=a[13],x=a[14],A=a[15],r=b*w-h*u,k=b*g-m*u,d=b*l-q*u,n=h*g-m*w,B=h*l-q*w,I=m*l-q*g,E=z*H-C*D,M=z*x-F*D,K=z*A-G*D,J=C*x-F*H,f=C*A-G*H,p=F*A-G*x,t=r*p-k*f+d*J+n*K-B*M+I*E;if(!t)return null;
t=1/t;c[0]=(w*p-g*f+l*J)*t;c[1]=(m*f-h*p-q*J)*t;c[2]=(H*I-x*B+A*n)*t;c[3]=(F*B-C*I-G*n)*t;c[4]=(g*K-u*p-l*M)*t;c[5]=(b*p-m*K+q*M)*t;c[6]=(x*d-D*I-A*k)*t;c[7]=(z*I-F*d+G*k)*t;c[8]=(u*f-w*K+l*E)*t;c[9]=(h*K-b*f-q*E)*t;c[10]=(D*B-H*d+A*r)*t;c[11]=(C*d-z*B-G*r)*t;c[12]=(w*M-u*J-g*E)*t;c[13]=(b*J-h*M+m*E)*t;c[14]=(H*k-D*n-x*r)*t;c[15]=(z*n-C*k+F*r)*t;return c};a.adjoint=function(a,c){var b=a[0],h=a[1],m=a[2],q=a[3],u=a[4],w=a[5],g=a[6],l=a[7],z=a[8],C=a[9],F=a[10],G=a[11],D=a[12],H=a[13],x=a[14],A=a[15];
c[0]=w*(F*A-G*x)-C*(g*A-l*x)+H*(g*G-l*F);c[1]=-(h*(F*A-G*x)-C*(m*A-q*x)+H*(m*G-q*F));c[2]=h*(g*A-l*x)-w*(m*A-q*x)+H*(m*l-q*g);c[3]=-(h*(g*G-l*F)-w*(m*G-q*F)+C*(m*l-q*g));c[4]=-(u*(F*A-G*x)-z*(g*A-l*x)+D*(g*G-l*F));c[5]=b*(F*A-G*x)-z*(m*A-q*x)+D*(m*G-q*F);c[6]=-(b*(g*A-l*x)-u*(m*A-q*x)+D*(m*l-q*g));c[7]=b*(g*G-l*F)-u*(m*G-q*F)+z*(m*l-q*g);c[8]=u*(C*A-G*H)-z*(w*A-l*H)+D*(w*G-l*C);c[9]=-(b*(C*A-G*H)-z*(h*A-q*H)+D*(h*G-q*C));c[10]=b*(w*A-l*H)-u*(h*A-q*H)+D*(h*l-q*w);c[11]=-(b*(w*G-l*C)-u*(h*G-q*C)+z*
(h*l-q*w));c[12]=-(u*(C*x-F*H)-z*(w*x-g*H)+D*(w*F-g*C));c[13]=b*(C*x-F*H)-z*(h*x-m*H)+D*(h*F-m*C);c[14]=-(b*(w*x-g*H)-u*(h*x-m*H)+D*(h*g-m*w));c[15]=b*(w*F-g*C)-u*(h*F-m*C)+z*(h*g-m*w);return c};a.determinant=function(a){var c=a[0],b=a[1],h=a[2],m=a[3],q=a[4],u=a[5],w=a[6],g=a[7],l=a[8],z=a[9],C=a[10],F=a[11],G=a[12],D=a[13],H=a[14];a=a[15];return(c*u-b*q)*(C*a-F*H)-(c*w-h*q)*(z*a-F*D)+(c*g-m*q)*(z*H-C*D)+(b*w-h*u)*(l*a-F*G)-(b*g-m*u)*(l*H-C*G)+(h*g-m*w)*(l*D-z*G)};a.multiply=function(a,c,b){var h=
a[0],m=a[1],q=a[2],u=a[3],w=a[4],g=a[5],l=a[6],z=a[7],C=a[8],F=a[9],G=a[10],D=a[11],H=a[12],x=a[13],A=a[14];a=a[15];var r=c[0],k=c[1],d=c[2],n=c[3];b[0]=r*h+k*w+d*C+n*H;b[1]=r*m+k*g+d*F+n*x;b[2]=r*q+k*l+d*G+n*A;b[3]=r*u+k*z+d*D+n*a;r=c[4];k=c[5];d=c[6];n=c[7];b[4]=r*h+k*w+d*C+n*H;b[5]=r*m+k*g+d*F+n*x;b[6]=r*q+k*l+d*G+n*A;b[7]=r*u+k*z+d*D+n*a;r=c[8];k=c[9];d=c[10];n=c[11];b[8]=r*h+k*w+d*C+n*H;b[9]=r*m+k*g+d*F+n*x;b[10]=r*q+k*l+d*G+n*A;b[11]=r*u+k*z+d*D+n*a;r=c[12];k=c[13];d=c[14];n=c[15];b[12]=r*h+
k*w+d*C+n*H;b[13]=r*m+k*g+d*F+n*x;b[14]=r*q+k*l+d*G+n*A;b[15]=r*u+k*z+d*D+n*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var h=c[0],m=c[1];c=c[2];var q,u,w,g,l,z,C,F,G,D,H,x;a===b?(b[12]=a[0]*h+a[4]*m+a[8]*c+a[12],b[13]=a[1]*h+a[5]*m+a[9]*c+a[13],b[14]=a[2]*h+a[6]*m+a[10]*c+a[14],b[15]=a[3]*h+a[7]*m+a[11]*c+a[15]):(q=a[0],u=a[1],w=a[2],g=a[3],l=a[4],z=a[5],C=a[6],F=a[7],G=a[8],D=a[9],H=a[10],x=a[11],b[0]=q,b[1]=u,b[2]=w,b[3]=g,b[4]=l,b[5]=z,b[6]=C,b[7]=F,b[8]=G,b[9]=D,b[10]=H,b[11]=x,
b[12]=q*h+l*m+G*c+a[12],b[13]=u*h+z*m+D*c+a[13],b[14]=w*h+C*m+H*c+a[14],b[15]=g*h+F*m+x*c+a[15]);return b};a.scale=function(a,c,b){var h=c[0],m=c[1];c=c[2];b[0]=a[0]*h;b[1]=a[1]*h;b[2]=a[2]*h;b[3]=a[3]*h;b[4]=a[4]*m;b[5]=a[5]*m;b[6]=a[6]*m;b[7]=a[7]*m;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;b[11]=a[11]*c;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,c,b,h){var m=b[0],q=b[1];b=b[2];var u=Math.sqrt(m*m+q*q+b*b),w,g,l,z,C,F,G,D,H,x,A,r,k,d,n,B,I,E,M,K;if(1E-7>Math.abs(u))return null;
u=1/u;m*=u;q*=u;b*=u;w=Math.sin(c);g=Math.cos(c);l=1-g;c=a[0];u=a[1];z=a[2];C=a[3];F=a[4];G=a[5];D=a[6];H=a[7];x=a[8];A=a[9];r=a[10];k=a[11];d=m*m*l+g;n=q*m*l+b*w;B=b*m*l-q*w;I=m*q*l-b*w;E=q*q*l+g;M=b*q*l+m*w;K=m*b*l+q*w;m=q*b*l-m*w;q=b*b*l+g;h[0]=c*d+F*n+x*B;h[1]=u*d+G*n+A*B;h[2]=z*d+D*n+r*B;h[3]=C*d+H*n+k*B;h[4]=c*I+F*E+x*M;h[5]=u*I+G*E+A*M;h[6]=z*I+D*E+r*M;h[7]=C*I+H*E+k*M;h[8]=c*K+F*m+x*q;h[9]=u*K+G*m+A*q;h[10]=z*K+D*m+r*q;h[11]=C*K+H*m+k*q;a!==h&&(h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]);
return h};a.rotateX=function(a,c,b){var h=Math.sin(c);c=Math.cos(c);var m=a[4],q=a[5],u=a[6],w=a[7],g=a[8],l=a[9],z=a[10],C=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=m*c+g*h;b[5]=q*c+l*h;b[6]=u*c+z*h;b[7]=w*c+C*h;b[8]=g*c-m*h;b[9]=l*c-q*h;b[10]=z*c-u*h;b[11]=C*c-w*h;return b};a.rotateY=function(a,c,b){var h=Math.sin(c);c=Math.cos(c);var m=a[0],q=a[1],u=a[2],w=a[3],g=a[8],l=a[9],z=a[10],C=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=m*c-g*h;b[1]=q*c-l*h;b[2]=u*c-z*h;b[3]=w*c-C*h;b[8]=m*h+g*c;b[9]=q*h+l*c;b[10]=u*h+z*c;b[11]=w*h+C*c;return b};a.rotateZ=function(a,c,b){var h=Math.sin(c);c=Math.cos(c);var m=a[0],q=a[1],u=a[2],w=a[3],g=a[4],l=a[5],z=a[6],C=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=m*c+g*h;b[1]=q*c+l*h;b[2]=u*c+z*h;b[3]=w*c+C*h;b[4]=g*c-m*h;b[5]=l*c-q*h;b[6]=z*c-u*h;b[7]=C*c-w*h;return b};
a.EE=function(a,c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c};a.DE=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a[1];c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=a[2];c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.CE=function(a,c,b){var h=c[0],m=c[1];c=c[2];var q=Math.sqrt(h*h+m*m+c*c),u;if(1E-7>Math.abs(q))return null;q=1/q;h*=q;m*=q;c*=q;q=Math.sin(a);a=Math.cos(a);u=1-a;b[0]=h*h*u+a;b[1]=m*h*u+c*
q;b[2]=c*h*u-m*q;b[3]=0;b[4]=h*m*u-c*q;b[5]=m*m*u+a;b[6]=c*m*u+h*q;b[7]=0;b[8]=h*c*u+m*q;b[9]=m*c*u-h*q;b[10]=c*c*u+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.dN=function(a,c){var b=Math.sin(a),h=Math.cos(a);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=h;c[6]=b;c[7]=0;c[8]=0;c[9]=-b;c[10]=h;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.eN=function(a,c){var b=Math.sin(a),h=Math.cos(a);c[0]=h;c[1]=0;c[2]=-b;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=b;c[9]=0;c[10]=h;c[11]=0;c[12]=0;c[13]=0;
c[14]=0;c[15]=1;return c};a.fN=function(a,c){var b=Math.sin(a),h=Math.cos(a);c[0]=h;c[1]=b;c[2]=0;c[3]=0;c[4]=-b;c[5]=h;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromRotationTranslation=function(a,c,b){var h=a[0],m=a[1],q=a[2],u=a[3],w=h+h,g=m+m,l=q+q;a=h*w;var z=h*g,h=h*l,C=m*g,m=m*l,q=q*l,w=u*w,g=u*g,u=u*l;b[0]=1-(C+q);b[1]=z+u;b[2]=h-g;b[3]=0;b[4]=z-u;b[5]=1-(a+q);b[6]=m+w;b[7]=0;b[8]=h+g;b[9]=m-w;b[10]=1-(a+C);b[11]=0;b[12]=c[0];b[13]=c[1];b[14]=c[2];
b[15]=1;return b};a.fromQuat=function(a,c){var b=a[0],h=a[1],m=a[2],q=a[3],u=b+b,w=h+h,g=m+m,b=b*u,l=h*u,h=h*w,z=m*u,C=m*w,m=m*g,u=q*u,w=q*w,q=q*g;c[0]=1-h-m;c[1]=l+q;c[2]=z-w;c[3]=0;c[4]=l-q;c[5]=1-b-m;c[6]=C+u;c[7]=0;c[8]=z+w;c[9]=C-u;c[10]=1-b-h;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.frustum=function(a,c,b,h,m,q,u){var w=1/(c-a),g=1/(h-b),l=1/(m-q);u[0]=2*m*w;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=2*m*g;u[6]=0;u[7]=0;u[8]=(c+a)*w;u[9]=(h+b)*g;u[10]=(q+m)*l;u[11]=-1;u[12]=0;u[13]=0;u[14]=
q*m*2*l;u[15]=0;return u};a.perspective=function(a,c,b,h,m){a=1/Math.tan(a/2);var q=1/(b-h);m[0]=a/c;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=a;m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[10]=(h+b)*q;m[11]=-1;m[12]=0;m[13]=0;m[14]=2*h*b*q;m[15]=0;return m};a.jP=function(a,c,b,h){var m=Math.tan(a.IQ*Math.PI/180),q=Math.tan(a.KM*Math.PI/180),u=Math.tan(a.LO*Math.PI/180);a=Math.tan(a.vP*Math.PI/180);var w=2/(u+a),g=2/(m+q);h[0]=w;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=g;h[6]=0;h[7]=0;h[8]=-((u-a)*w*.5);h[9]=(m-q)*g*.5;h[10]=b/
(c-b);h[11]=-1;h[12]=0;h[13]=0;h[14]=b*c/(c-b);h[15]=0;return h};a.ortho=function(a,c,b,h,m,q,u){var w=1/(a-c),g=1/(b-h),l=1/(m-q);u[0]=-2*w;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=-2*g;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=2*l;u[11]=0;u[12]=(a+c)*w;u[13]=(h+b)*g;u[14]=(q+m)*l;u[15]=1;return u};a.lookAt=function(e,c,b,h){var m,q,u,w,g,l,z,C,F=e[0],G=e[1];e=e[2];u=b[0];w=b[1];q=b[2];z=c[0];b=c[1];m=c[2];if(1E-7>Math.abs(F-z)&&1E-7>Math.abs(G-b)&&1E-7>Math.abs(e-m))return a.identity(h);c=F-z;b=G-b;z=e-m;C=1/Math.sqrt(c*
c+b*b+z*z);c*=C;b*=C;z*=C;m=w*z-q*b;q=q*c-u*z;u=u*b-w*c;(C=Math.sqrt(m*m+q*q+u*u))?(C=1/C,m*=C,q*=C,u*=C):u=q=m=0;w=b*u-z*q;g=z*m-c*u;l=c*q-b*m;(C=Math.sqrt(w*w+g*g+l*l))?(C=1/C,w*=C,g*=C,l*=C):l=g=w=0;h[0]=m;h[1]=w;h[2]=c;h[3]=0;h[4]=q;h[5]=g;h[6]=b;h[7]=0;h[8]=u;h[9]=l;h[10]=z;h[11]=0;h[12]=-(m*F+q*G+u*e);h[13]=-(w*F+g*G+l*e);h[14]=-(c*F+b*G+z*e);h[15]=1;return h};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+
a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.BE=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!==typeof a&&(a.mat4=a)};b4w.module.mat4=b4w.module.__mat4;b4w.module.__particles=function(a,y){function e(){throw"_rand() undefined";}function c(a,b,c,g,e,l,r){var k=a.W.ip,d=a.W.Wd,n=a.W.time;a=a.W.Qx;for(var m=b?4:1,h=0;h<k.length;h+=m){var E=k[h];if(n>a&&n>=E&&E>a||n<a&&(E>a||n>=E))for(E=0;8>E;E++)d[8*h+E]=e[E];for(E=0;8>E;E++)z[E]=d[8*h+E];E=C;E[0]=c[3*h];E[1]=c[3*h+1];E[2]=c[3*h+2];w.Fh(E,z,E);l[3*h]=E[0];l[3*h+1]=E[1];l[3*h+2]=E[2];var u=C;u[0]=g[3*h];u[1]=g[3*h+1];u[2]=g[3*h+2];w.Eh(u,z,u);r[3*h]=u[0];r[3*h+1]=u[1];r[3*h+2]=u[2];if(b)for(E=1;4>E;E++)l[3*
(h+E)]=l[3*h],l[3*(h+E)+1]=l[3*h+1],l[3*(h+E)+2]=l[3*h+2],r[3*(h+E)]=u[0],r[3*(h+E)+1]=u[1],r[3*(h+E)+2]=u[2]}}function b(a){a?(u.yI(a),e=function(){return u.dH()}):e=function(){return Math.random()}}var h=y("__config"),m=y("__geometry"),q=y("__scenes"),u=y("__util"),w=y("__tsr"),g=y("vec3"),l=h.ze,z=new Float32Array(8),C=new Float32Array(3);a.cq=function(a){return 0<a.particle_systems.length?!0:!1};a.$p=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;
return!1};a.lO=function(a){for(var b=0;b<a.particle_systems.length;b++)if("HAIR"==a.particle_systems[b].settings.type)return!0;return!1};a.JF=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.LE=function(a,z,h,q){h.W=h.W||{};var x=m.fv(z,["a_position","a_normal"],null),A=h.settings.count,r=h.settings.frame_start/l.Pa,k=h.settings.frame_end/l.Pa,d=h.settings.lifetime/l.Pa,n=h.settings.lifetime_random,
B=h.settings.emit_from,w=h.settings.factor_random,E=h.settings.angular_velocity_mode,C=h.settings.angular_velocity_factor,K=h.settings.b4w_randomize_emission,J=h.settings.b4w_cyclic;b(h.seed);var f=h.W.CJ="WORLD"==h.settings.b4w_coordinate_system?!0:!1;h.W.frame=0;if(z=!a.Wg){var p;p=[];for(var t=0;t<A;t++)p.push(-.5,-.5,-.5,.5,.5,.5,.5,-.5);p=new Float32Array(p);for(var t=[],L=0;L<A;L++)t.push(4*L,4*L+2,4*L+1,4*L,4*L+3,4*L+2);t=new Uint16Array(t)}switch(B){case "VERT":for(var L=x.A[0].a_position,
x=x.A[0].a_normal,N=L.length/3,B=[],T=0;T<A;T++){var Q=Math.round((N-1)*e());B.push(Q);z&&(B.push(Q),B.push(Q),B.push(Q))}N=[];for(T=0;T<B.length;T++)N.push(L[3*B[T]]),N.push(L[3*B[T]+1]),N.push(L[3*B[T]+2]);L=new Float32Array(N);N=[];for(T=0;T<B.length;T++)N.push(x[3*B[T]]),N.push(x[3*B[T]+1]),N.push(x[3*B[T]+2]);B=new Float32Array(N);break;case "FACE":L=[];B=[];T=[];u.rm(0,T);N=m.Ip(x,A,!1,T);u.rm(0,T);x=m.Ip(x,A,!0,T);for(T=0;T<N.length;T++)L.push(N[T][0],N[T][1],N[T][2]),z&&(L.push(N[T][0],N[T][1],
N[T][2]),L.push(N[T][0],N[T][1],N[T][2]),L.push(N[T][0],N[T][1],N[T][2])),B.push(x[T][0],x[T][1],x[T][2]),z&&(B.push(x[T][0],x[T][1],x[T][2]),B.push(x[T][0],x[T][1],x[T][2]),B.push(x[T][0],x[T][1],x[T][2]));L=new Float32Array(L);B=new Float32Array(B);break;case "VOLUME":throw"Particle emission from volume is not supported";default:throw"Wrong emit from option";}B=[L,B];x=B[0];B=B[1];h.W.Ek=new Float32Array(x);h.W.HG=new Float32Array(B);h.W.WG=new Float32Array(x.length);h.W.IG=new Float32Array(B.length);
h.W.time=0;h.W.Qx=-1;L=[];k=(k-r)/A;for(N=0;N<A;N++)T=K?k*N+10*k*(.5-e()):k*N,J||(T+=r),L.push(T),z&&(L.push(T),L.push(T),L.push(T));r=new Float32Array(L);h.W.ip=new Float32Array(r);h.W.Su=new Float32Array(r);h.W.Wd=new Float32Array(8*r.length);for(K=0;K<8*r.length;K++)for(J=0;8>J;J++)h.W.Wd[8*K+J]=q[J];f&&c(h,z,x,B,q,x,B);h=[];q=d*n;for(n=0;n<A;n++)f=q*e(),h.push(d-f),z&&(h.push(d-f),h.push(d-f),h.push(d-f));d=new Float32Array(h);h=[];for(q=0;q<A;q++){n=[e()-.5,e()-.5,e()-.5];g.normalize(n,n);h.push(w*
n[0]);h.push(w*n[1]);h.push(w*n[2]);switch(E){case "NONE":h.push(0);break;case "SPIN":case "VELOCITY":h.push(C);break;case "RAND":h.push(2*C*(e()-.5));break;default:throw"Undefined velocity factor";}if(z)for(n=h.slice(-4),f=0;12>f;f++)h.push(n[f%4])}A=new Float32Array(h);w=u.yb("EMITTER_PARTICLES");E=u.yd();E.a_position=x;E.a_normal=B;w.A[0]=E;z?(a.Ef=m.il,w.la=t):(a.Ef=m.Gs,w.la=new Uint16Array(0));w.N=x.length/3;w.K.a_p_delay=r;w.K.a_p_lifetime=d;w.K.a_p_vels=A;z&&(w.K.a_p_bb_vertex=p);return w};
a.dJ=function(a){for(var b=a.o,g=0;g<b.length;g++){var e=b[g],l=b[g].Wc;if(l){var z=e.ja;if(!l.W.CJ)break;var r=l.W.WG,k=l.W.IG;c(l,!e.Wg,l.W.Ek,l.W.HG,a.e.Pb,r,k);m.rG(z);m.gs(z,"a_position",3,r);m.gs(z,"a_normal",3,k)}}};a.KH=function(a,b,c){var g=b.settings.lifetime/l.Pa,e=b.settings.normal_factor,z=9.81*b.settings.effector_weights.gravity,r=b.settings.effector_weights.wind,k=b.settings.mass,d=b.settings.b4w_fade_in/l.Pa,n=b.settings.b4w_fade_out/l.Pa,h=b.settings.b4w_cyclic;a.Fx=b.settings.frame_end/
l.Pa-b.settings.frame_start/l.Pa;a.Bx=h?1:0;a.Rq=e;a.Ex=z;e=q.DF();a.Om[0]=e[0]*r;a.Om[1]=e[1]*r;a.Om[2]=e[2]*r;a.Hx=g;a.Gx=k;a.Cx=d;a.Dx=n;a.Wg?(g=c.halo.size,r=c.halo.hardness,30>r?(r=.5,k=.9):40>r?(r=.1,k=1):50>r?(r=0,k=.8):(r=0,k=.5)):(g=b.settings.particle_size,k=r=1);a.Sq=g;a.yx=r;a.xx=k;g=b.settings.texture_slots;b=[-1,0,-1,0,-1,0,-1,0];if(g[0]&&g[0].use_map_size&&g[0].texture&&"BLEND"==g[0].texture.type&&g[0].texture.use_color_ramp){g=g[0].texture.color_ramp.elements;r=Math.min(2*g.length,
b.length);for(k=0;k<r;k+=2)d=g[k/2],b[k]=d.position,b[k+1]=(d.color[0]+d.color[1]+d.color[2])/3;a.Jx=g.length}a.Ix.set(b);b=c.texture_slots;c=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(b[0]&&"STRAND"==b[0].texture_coords&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp){g=b[0].texture.color_ramp.elements;r=Math.min(4*g.length,c.length);for(k=0;k<r;k+=4)d=g[k/4],c[k]=d.position,c[k+1]=d.color[0],c[k+2]=d.color[1],c[k+3]=d.color[2];a.Ax=g.length}a.zx.set(c)};a.VH=function(a,b){a.W.Qx=
a.W.time;a.W.time=b};a.ZG=function(a){for(var b=a.N,c=a.A[0].a_position,g=a.K.a_texcoord,e=[],l=[],r=0;r<b;r++)l.push(c[3*r]),l.push(c[3*r+1]),e.push(c[3*r+2]);e=new Float32Array(e);l=new Float32Array(l);a.K.a_lf_dist=e;a.K.a_lf_bb_vertex=l;a.K.a_texcoord=g;return a};a.lQ=function(a,b,c){a=a.o;for(var g=0;g<a.length;g++){var e=a[g],l=e.Wc;l&&l.name==b&&(e.Sq=c)}};a.aQ=function(a,b,c){a=a.o;for(var g=0;g<a.length;g++){var e=a[g],l=e.Wc;l&&l.name==b&&(e.Rq=c)}};a.LP=function(a,b,c){a=a.o;for(var g=
0;g<a.length;g++){var e=a[g],l=e.Wc;if(l&&l.name==b){var r=l.W.ip;if(1==c)l=r;else if(0==c)for(var k=!e.Wg,d=k?4:1,l=l.W.Su,n=0;n<l.length;n+=d)l[n]=1E4,k&&(l[n+1]=l[n],l[n+2]=l[n],l[n+3]=l[n]);else for(var z=1/c,l=l.W.Su,d=(k=!e.Wg)?4:1,h=0,n=0;n<l.length;n+=d)n>=h?(l[n]=r[n],h+=z):l[n]=1E4,k&&(l[n+1]=l[n],l[n+2]=l[n],l[n+3]=l[n]);m.gs(e.ja,"a_p_delay",1,l)}}};a.oJ=function(a,b,c){a=a.particle_systems;for(var g=0;g<a.length;g++){var e=a[g];if("EMITTER"==e.settings.type)for(var l=e.W.ip,g=0;g<8*l.length;g++)e.W.Wd[8*
g]=b[0],e.W.Wd[8*g+1]=b[1],e.W.Wd[8*g+2]=b[2],e.W.Wd[8*g+3]=b[3],e.W.Wd[8*g+4]=c[0],e.W.Wd[8*g+5]=c[1],e.W.Wd[8*g+6]=c[2],e.W.Wd[8*g+7]=c[3]}}};b4w.module.__geometry=function(a,y){function e(a){return 65536<a.N?B.Jv()?!1:!0:!1}function c(a){return 0<a.la.length?!0:!1}function b(a,b,d){if(!c(a))return a;d||k.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.N*(b||1)+", will use drawArrays","color: #aa0");b=a.la;d=a.N;var g=a.K,e=a.A,n;for(n in g){var l=g[n],r=F(l,d);g[n]=h(b,l,r)}for(g=0;g<e.length;g++){var z=e[g];for(n in z)l=z[n],r=F(l,d),z[n]=h(b,l,r)}for(g=0;g<a.ca.length;g++){n=a.ca[g].jc;for(var x in n)l=n[x],
r=F(l,d),n[x]=h(b,l,r)}a.N=b.length;a.la=new Uint16Array(0);return a}function h(a,b,d){if(0==b.length)return new Float32Array(0);for(var c=new Float32Array(a.length*d),g=0;g<a.length;g++)for(var e=a[g],k=0;k<d;k++)c[d*g+k]=b[d*e+k];return c}function m(a,b){var d=a.pf,c=a.Ki[b];if(c)return d.subarray(c.offset,c.offset+c.length);throw"extract_array() failed; invalid name: "+b;}function q(b,d){var t,c;switch(d){case a.rj:case a.jl:t=J.TRIANGLES;c=J.STATIC_DRAW;break;case a.Hs:t=J.POINTS;c=J.STATIC_DRAW;
break;case a.il:t=J.TRIANGLES;c=J.DYNAMIC_DRAW;break;case a.Gs:t=J.POINTS;c=J.DYNAMIC_DRAW;break;case a.Xz:t=J.LINES;c=J.STATIC_DRAW;break;default:throw"Wrong draw_mode";}b.mode=t;b.Yk=c}function u(a){a.Xg?(a.Re||(a.Re=J.createBuffer()),J.bindBuffer(J.ELEMENT_ARRAY_BUFFER,a.Re),J.bufferData(J.ELEMENT_ARRAY_BUFFER,a.Xg,a.Yk),a.Wl=a.Xg.byteLength):a.Wl=0;a.ng||(a.ng=J.createBuffer());J.bindBuffer(J.ARRAY_BUFFER,a.ng);J.bufferData(J.ARRAY_BUFFER,a.pf,a.Yk);a.Qu=a.pf.byteLength}function w(a){for(var b=
n.yb("JOIN_"+a.length+"_SUBMESHES"),d=0,c=0;c<a.length;c++)d+=a[c].la.length;b.la=new Uint32Array(d);var g=d=0,k=0;if(0<a[0].ca.length)for(var e=0;e<a[0].ca.length;e++){for(c=0;c<a.length;c++)d+=a[c].ca[e].jc.a_position.length,g+=a[c].ca[e].jc.a_normal.length,k+=a[c].ca[e].jc.a_tangent.length;c={a_position:new Float32Array(d),a_normal:new Float32Array(g),a_tangent:new Float32Array(k)};b.ca.push({sm:a[0].ca[e].sm,jc:c})}for(c=d=0;c<a.length;c++)d+=a[c].N;b.N=d;var g=a[0],l;for(l in g.K){for(c=d=0;c<
a.length;c++)d+=a[c].K[l].length;b.K[l]=new Float32Array(d)}for(l in g.A[0]){for(c=d=0;c<a.length;c++)d+=a[c].A[0][l].length;for(c=0;c<g.A.length;c++)b.A[c]=b.A[c]||{},b.A[c][l]=new Float32Array(d)}for(l=g=d=0;l<a.length;l++){for(var k=a[l],r=k.la,e=k.N,z=k.K,c=0;c<r.length;c++)b.la[d+c]=r[c]+g;var d=d+r.length,x;for(x in z){var r=z[x],h=g*F(r,e);b.K[x].set(r,h)}for(c=0;c<k.A.length;c++){var z=k.A[c],E=b.A[c];for(x in z)r=z[x],h=g*F(r,e),E[x].set(r,h)}g+=e}if(0<b.ca.length)for(l=0;l<b.ca.length;l++)for(x=
b.ca[l].jc,c=k=g=d=0;c<a.length;c++)e=a[c].ca[l].jc,x.a_position.set(e.a_position,d),x.a_normal.set(e.a_normal,g),x.a_tangent.set(e.a_tangent,k),d+=e.a_position.length,g+=e.a_normal.length,k+=e.a_tangent.length;return b}function g(a,d,t,c,g,e){var r=n.yb("SUBMESH_"+a.name+"_"+d),h=a.submeshes[d],E=h.base_length,J=a.materials[d];r.N=E;var m=!1;if(z(t,"a_texcoord")){var K=null,u=a.materials[d];d=a.submeshes[d];if(u.texture_slots.length)switch(u=u.texture_slots[0],u.texture_coords){case "UV":u=a.uv_textures.indexOf(u.uv_layer);
0==u||-1==u?K=new Float32Array(d.texcoord):1==u&&(K=new Float32Array(d.texcoord2));break;case "ORCO":for(var q=a.b4w_bounding_box_source,K=new Float32Array(2*d.base_length),u=(q.max_x+q.min_x)/2,B=(q.max_z+q.min_z)/2,w=q.max_x-q.min_x,q=q.max_z-q.min_z,A=0,M=0;M<d.position.length;M+=3)K[A++]=(d.position[M]-u)/w+.5,K[A++]=(B-d.position[M+2])/q+.5}null===K&&(K=new Float32Array(d.texcoord));d=K}else d=new Float32Array(0);if(z(t,"a_orco_tex_coord")){K=a.b4w_bounding_box_source;u=new Float32Array(3*h.base_length);
B=K.max_x-K.min_x;w=K.max_z-K.min_z;q=K.max_y-K.min_y;for(M=A=0;M<h.position.length;M+=3)0==B?u[A++]=-1:u[A++]=parseFloat(((h.position[M]-K.min_x)/B).toFixed(3)),0==w?u[A++]=-1:u[A++]=parseFloat(((-K.min_z-h.position[M+2])/w).toFixed(3)),0==q?u[A++]=-1:u[A++]=parseFloat(((h.position[M+1]-K.min_y)/q).toFixed(3));K=u}else K=new Float32Array(0);var I,u=h.group;if(z(t,"a_influence")&&c){B=new Float32Array(4*E);w=u.length/E;q=new Float32Array(w);for(A=0;A<w;A++)for(I in q[A]=-1,c)if(M=c[I],M.Nz===A){q[A]=
M.Mj;break}var H=3<w?w:4;c=new Float32Array(H);I=new Uint32Array(H);for(var A=new Float32Array(4),M=new Float32Array(H),H=new Uint32Array(H),F=new Float32Array(4),D=0;D<E;D++)c.set(M),I.set(H),A.set(F),B.set(C(u,w,D,E,q,c,I,A),4*D)}else B=new Float32Array(0);I=B;c=g?n.sa(g):{};c.a_color={Sg:!0};c.a_color.src=z(t,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,rd:7}]:[];g={a_texcoord:d,a_influence:I,a_orco_tex_coord:K};I=h.vertex_colors;d=h.color;K=a.name;u=[];for(B=0;B<I.length;B++)u.push(I[B].name);
for(var G in c)if(B=c[G].src,B.length){for(q=w=0;q<B.length;q++)w+=n.yh(B[q].rd);g[G]=new Float32Array(w*E);for(q=A=0;q<B.length;q++){var y=B[q].name,M=B[q].rd,H=n.my(M),wa=u.indexOf(y);-1==wa&&n.ma('vertex color "'+y+'" for mesh "'+K+'" not found.');F=I[wa].mask;D=n.yh(F);(M&F)!==M&&k.error("Wrong color extraction from "+y+" to "+G+".");for(var v=y=0;v<wa;v++)y+=n.yh(I[v].mask);wa=y*E;for(y=0;y<E;y++)for(v=0;3>v;v++)H[v]&&(g[G][y*w+(A+n.Mk(M,v))]=d[wa+y*D+n.Mk(F,v)]);A+=D}}else g[G]=new Float32Array(0);
G=a.uv_textures;c=h.texcoord;I=h.texcoord2;d=a.name;if(e)for(var S in e){K=G.indexOf(S);-1==K&&n.ma('uv map "'+S+'" for mesh "'+d+'" not found');if(0==K)var fa=new Float32Array(c);else 1==K&&(fa=new Float32Array(I));g[e[S]]=fa}r.K=g;r.la=new Uint32Array(h.indices);e=h.position.length/E/3;fa=(S=z(t,"a_normal")&&h.normal.length?!0:!1)&&z(t,"a_tangent")&&h.tangent.length?!0:!1;G=J.texture_slots[0];G=S&&J.texture_slots.length&&z(t,"a_tangent")&&"ORCO"==G.texture_coords&&G.use_map_normal?!0:!1;0<a.b4w_shape_keys.length&&
(m=!0);for(g=0;g<e;g++){J=l(h,t,E,S,fa,G,g,a.name);if(m)if(c={},c.name=a.b4w_shape_keys[g].name,r.ca.push(c),0!=g){c.jc=J;c.sm=a.b4w_shape_keys[g].value;continue}else c.jc=l(h,t,E,S,fa,G,g,a.name),c.sm=1;r.A.push(J)}if(1<e&&!m){a=r.A[0];var J={},va;for(va in a)J[va]=new Float32Array(a[va]);r.A.push(J)}z(t,"a_polyindex")&&(b(r,1,!0),r.K.a_polyindex=x(r));return r}function l(a,b,d,c,g,e,l,r){var x={},h=new Float32Array(3*d),J=new Float32Array(c?3*d:0),m=new Float32Array(g||e?4*d:0),K=l*d*3;h.set(a.position.subarray(K,
K+3*d),0);c&&(K=l*d*3,J.set(a.normal.subarray(K,K+3*d),0));if(g)K=l*d*4,m.set(a.tangent.subarray(K,K+4*d),0);else if(e)for(a=m,k.warn('Not precise tangents calculation for normalmap using GENERATED texture coordinates in mesh: "'+r+'". Please add a UV-map.'),r=0;r<d;r++)b=E,c=M,b[0]=J[3*r],b[1]=J[3*r+1],b[2]=J[3*r+2],I.cross(b,n.te,c),0==I.length(c)&&I.cross(b,n.tf,c),I.normalize(c,c),a[4*r]=c[0],a[4*r+1]=c[1],a[4*r+2]=c[2],a[4*r+3]=1;else if(c&&z(b,"a_tangent"))for(m=new Float32Array(4*d),d=0;d<
m.length;d++)m[d]=1;x.a_position=h;x.a_normal=J;x.a_tangent=m;return x}function z(a,b){return-1<a.indexOf(b)?!0:!1}function C(b,d,t,c,g,e,k,l){for(var n=!0,r=0;r<d;r++){var z=b[r*c+t];if(-1!==z){var x=g[r];-1!==x&&(e[r]=z,k[r]=x,n=!1)}}if(n)return l;G(e,k,a.Xn,!1);for(r=b=0;4>r;r++)b+=e[r];if(.01>b)return l;for(r=0;4>r;r++)e[r]/=b;if(.01>Math.abs(e[0]-1))l[0]=k[0]+1;else for(r=0;4>r;r++)l[r]=k[r]+e[r];return l}function F(a,b){if(0==b)return 0;var d=a.length,c=d/b;if(c!=Math.floor(c))throw"Array size mismatch during geometry calculation: array length="+
d+", base length="+b;return c}function G(b,d,t,c){for(var g=b.length,e=g,k=!1,l=c?-1:1;1<e||k;){1<e&&(e=Math.floor(e/1.247330950103979));for(var k=!1,n=0;e+n<g;n++)if(t==a.Xn?0>l*(b[n]-b[n+e]):b[n]<b[n+e]&&c)k=b[n],b[n]=b[n+e],b[n+e]=k,k=d[n],d[n]=d[n+e],d[n+e]=k,k=!0}}function D(a,b,d){var c=[],g=[];I.subtract(b,a,c);I.subtract(d,a,g);I.normalize(c,c);I.normalize(g,g);return Math.acos(I.dot(c,g))}function H(a,b,d){b||(b=[]);d=d?a.A[0].a_normal:a.A[0].a_position;if(c(a)){a=a.la;for(var g=a.length/
3,e=0;e<g;e++){var k=new Float32Array(9),l=a[3*e];k[0]=d[3*l];k[1]=d[3*l+1];k[2]=d[3*l+2];l=a[3*e+1];k[3]=d[3*l];k[4]=d[3*l+1];k[5]=d[3*l+2];l=a[3*e+2];k[6]=d[3*l];k[7]=d[3*l+1];k[8]=d[3*l+2];b[e]=k}}else for(e=0;e<d.length;e++)k=new Float32Array(9),k[0]=d[9*e],k[1]=d[9*e+1],k[2]=d[9*e+2],k[3]=d[9*e+3],k[4]=d[9*e+4],k[5]=d[9*e+5],k[6]=d[9*e+6],k[7]=d[9*e+7],k[8]=d[9*e+8],b[e]=k;return b}function x(a){for(var b=new Float32Array(a.N),d=0;d<a.N;d++)b[d]=d%3;return b}function A(a,b,d){var c=I.dist(a,
b);a=I.dist(a,d);b=I.dist(b,d);d=(c+a+b)/2;return d*(d-c)*(d-a)*(d-b)}function r(a,b,d,c,g){d-=b;for(var e=0;e<d;e+=c)e%c==g&&vec3.normalize(a.subarray(e+b-g,e+b+1),a.subarray(e+b-g,e+b+1))}var k=y("__print"),d=y("__tsr"),n=y("__util"),B=y("__extensions"),I=y("vec3"),E=new Float32Array(3),M=new Float32Array(3),K=new Float32Array(3);a.we=10;a.jt=20;a.mL=30;a.jl=10;a.Hs=20;a.il=30;a.Gs=40;a.Xz=50;a.Xn=0;a.rB=1;a.rj=a.jl;var J=null;a.Id=function(a){J=a};a.DM=function(a){var b=_buffers[a];J.deleteBuffer(b.Re);
J.deleteBuffer(b.ng);delete _buffers[a]};a.FI=function(f,d,t,g){e(f)&&b(f);var k=f.la,l=f.N,n=f.A,r={},z;for(z in f.K)z in g&&!g[z].Sg||(r[z]=f.K[z]);g={Xg:null,pf:null,gq:0,count:0,Ki:{},mode:0,Yk:0,Wl:0,Qu:0,ng:null,Re:null,qm:null,ca:null};if(0<f.ca.length){z=n[0];for(var x=1;x<f.ca.length;x++){for(var h=f.ca[x].jc,E=h.a_position,m=h.a_normal,K=z.a_position,B=z.a_normal,w=E.length,A=f.ca[x].sm,C=0;C<w;C++)K[C]+=A*E[C],B[C]+=A*m[C];h=h.a_tangent;E=z.a_tangent;m=h.length;for(C=0;C<m;C++)E[C]+=A*
h[C]}}if(k.length)if(z=k.length,65536>=l)var x=new Uint16Array(k),M=J.UNSIGNED_SHORT;else x=new Uint32Array(k),M=J.UNSIGNED_INT;else z=l,x=null;var A=0,C=n.length,I;for(I in n[0])h=n[0][I],A+=h.length*C;for(I in r)h=r[I],A+=h.length;I=new Float32Array(A);var A=0,C={},H;for(H in r)if(E=r[H],h=E.length)I.set(E,A),C[H]={TL:H,nh:F(E,l),offset:A,frames:1,length:h},A+=h;r=n.length;for(H in n[0])if(E=n[0][H],h=E.length,E=F(E,l),h)for(C[H]={nh:E,offset:A,frames:r,length:h},1<r&&(C[H+"_next"]={nh:E,offset:A+
h,frames:r,length:h}),m=0;m<r;m++)E=n[m][H],I.set(E,A),A+=h;g.count=z;g.Xg=x;g.pf=I;g.gq=M;g.Ki=C;q(g,t);u(g);d!=a.we&&c(f)&&(g.qm={zG:new Float32Array(k.length),AG:new Float32Array(k.length),dE:new Float32Array(k.length/3),type:d});g.ca=f.ca;return g};a.$F=e;a.YF=c;a.Qr=b;a.KQ=function(a,b,d){q(a,b);a.count=d.length;a.Xg=d;a.gq=d instanceof Uint16Array?J.UNSIGNED_SHORT:J.UNSIGNED_INT;return a};a.gs=function(a,b,d,c){var g=a.pf,e=a.Ki,k=e[b];k?(d&&k.nh!=d&&n.ma('invalid num_comp for "'+b+'"'),g.set(c,
k.offset)):(g=g.length,k=new Float32Array(g+c.length),k.set(a.pf),k.set(c,g),a.pf=k,e[b]={nh:d,offset:g});u(a)};a.RM=m;a.SO=function(a){a.Yk=J.STATIC_DRAW};a.rG=function(a){a.Yk=J.DYNAMIC_DRAW};a.eJ=u;a.ju=function(a){a.Re&&J.deleteBuffer(a.Re);a.ng&&J.deleteBuffer(a.ng)};a.zw=function(a,b){return a.submeshes[b].base_length?!1:!0};a.mz=function(a,b){for(var t=0;t<a.A.length;t++){var c=a.A[t].a_position;d.ij(c,b,c,0);c=a.A[t].a_normal;0<c.length&&d.zn(c,b,c,0);c=a.A[t].a_tangent;0<c.length&&d.An(c,
b,c,0)}(t=a.K.au_center_pos)&&t.length&&d.ij(t,b,t,0);return a};a.DI=function(a,b){var t=a.K.au_center_pos;if(t&&t.length){var c=new Float32Array(t);d.ij(c,b,c,0);for(var g=0;g<a.A.length;g++)for(var e=0;e<c.length;e++)a.A[g].a_position[e]+=c[e]-t[e];t.set(c)}else throw'Attribute "au_center_pos" is missing in particle submesh';};a.CI=function(a,b){var d=a.N,c;for(c in b){var g=b[c].length;a.K[c]=new Float32Array(g*d);for(var e=0;e<d;e++)for(var k=0;k<g;k++)a.K[c][e*g+k]=b[c][k]}};a.EI=w;a.qG=function(a,
p,t){if(!a.N)return n.yb("EMPTY");var c=t.length;65536<a.N*c&&!B.Jv()&&b(a,c);var g=a.la,e=a.N,k=a.K;a=a.A;for(var l in p){var r=p[l].length,z=r*e;k[l]=new Float32Array(z);for(var h=0;h<e;h++)for(z=0;z<r;z++)k[l][h*r+z]=p[l][z]}p=n.yb("CLONE_"+c+"_SUBMESHES");p.N=e*c;p.la=new Uint32Array(g.length*c);for(h=0;h<c;h++)for(r=g.length*h,l=e*h,z=0;z<g.length;z++)p.la[r+z]=g[z]+l;for(var x in k)for(g=k[x],z=g.length*c,r=F(g,e),p.K[x]=new Float32Array(z),h=0;h<c;h++)l=e*r*h,p.K[x].set(g,l);for(x in a[0])for(h=
0;h<a.length;h++)for(g=a[h][x],z=g.length*c,r=F(g,e),p.A[h]=p.A[h]||{},p.A[h][x]=new Float32Array(z),z=0;z<c;z++)switch(k=t[z],l=e*r*z,x){case "a_position":d.ij(g,k,p.A[h][x],l);break;case "a_normal":d.zn(g,k,p.A[h][x],l);break;case "a_tangent":d.An(g,k,p.A[h][x],l);break;default:throw"Wrong attribute name: "+x;}return p};a.ev=g;a.uE=function(a){var b=a.N,d=a.A[0].a_position,c=new Float32Array(12*b),g=new Float32Array(8*b);a=new Uint16Array(4*a.la.length);for(var e=0;e<b;e++)c[12*e]=d[3*e],c[12*e+
1]=d[3*e+1],c[12*e+2]=d[3*e+2],c[12*e+3]=d[3*e],c[12*e+4]=d[3*e+1],c[12*e+5]=d[3*e+2],c[12*e+6]=d[3*e],c[12*e+7]=d[3*e+1],c[12*e+8]=d[3*e+2],c[12*e+9]=d[3*e],c[12*e+10]=d[3*e+1],c[12*e+11]=d[3*e+2],g[8*e]=-.5,g[8*e+1]=-.5,g[8*e+2]=-.5,g[8*e+3]=.5,g[8*e+4]=.5,g[8*e+5]=.5,g[8*e+6]=.5,g[8*e+7]=-.5,a[6*e]=4*e+2,a[6*e+1]=4*e+1,a[6*e+2]=4*e,a[6*e+3]=4*e+2,a[6*e+4]=4*e,a[6*e+5]=4*e+3;d=n.yb("HALO");d.A=[];d.A[0]={};d.N=4*b;d.A[0].a_position=c;d.K.a_halo_bb_vertex=g;d.la=a;return d};a.HF=z;a.fv=function(a,
b,d){for(var c=[],e=0;e<a.submeshes.length;e++){var k=g(a,e,b,null,d,null);k.N&&c.push(k)}return 0==c.length?n.yb("EMPTY"):1==c.length?c[0]:w(c)};a.$I=function(a,b,d){for(var c=a.Xg,g=m(a,"a_position"),e=a.qm,k=e.zG,l=e.AG,e=e.dE,r=c,z=r.length/3,h=0;h<z;h++){var x=r[3*h],E=r[3*h+1],K=r[3*h+2],u=g[3*x+1],q=g[3*x+2],B=g[3*E+1],A=g[3*E+2],w=g[3*K+1],C=g[3*K+2];k[3*h]=(g[3*x]+g[3*E]+g[3*K])/3;k[3*h+1]=(u+B+w)/3;k[3*h+2]=(q+A+C)/3}n.Yf(k,b,l);b=l.length/3;for(g=0;g<b;g++)k=l[3*g]-d[0],r=l[3*g+1]-d[1],
z=l[3*g+2]-d[2],e[g]=k*k+r*r+z*z;d=c;c=e.length;if(!(2>c))for(l=c,g=!1;1<l||g;)for(1<l&&(l=Math.floor(l/1.247330950103979)),g=!1,b=0;l+b<c;b++)0>e[b]-e[b+l]&&(g=e[b],e[b]=e[b+l],e[b+l]=g,g=d,k=b,r=b+l,z=g[3*k],h=g[3*k+1],x=g[3*k+2],g[3*k]=g[3*r],g[3*k+1]=g[3*r+1],g[3*k+2]=g[3*r+2],g[3*r]=z,g[3*r+1]=h,g[3*r+2]=x,g=!0);c=d;J.bindBuffer(J.ELEMENT_ARRAY_BUFFER,a.Re);J.bufferData(J.ELEMENT_ARRAY_BUFFER,c,J.DYNAMIC_DRAW)};a.az=G;a.yC=function(a,b,d){for(var c=b.length/3,g=a.length/3,e=[],k=Array(3),l=Array(3),
n=Array(3),r=0;r<g;r++){for(var z=a[3*r],h=a[3*r+1],x=a[3*r+2],E=0;3>E;E++)k[E]=b[3*z+E],l[E]=b[3*h+E],n[E]=b[3*x+E];if(d)var E=D(k,l,n),J=D(l,n,k),m=Math.PI-E-J;else m=J=E=1;var K=e,u;u=k;var q=n,B=[],A=[],w=[];I.subtract(l,u,B);I.subtract(q,u,A);I.cross(B,A,w);I.normalize(w,w);u=w;for(q=0;3>q;q++)B=3*h+q,A=3*x+q,K[3*z+q]=E*u[q],K[B]=J*u[q],K[A]=m*u[q]}if(d)for(var C in d)for(r=d[C],a=0;3>a;a++){b=3*r[0]+a;for(g=1;g<r.length;g++)k=3*r[g]+a,e[b]+=e[k];for(g=1;g<r.length;g++)k=3*r[g]+a,e[k]=e[b]}for(r=
0;r<c;r++){d=r;C=e;a=new Float32Array(3);for(b=0;3>b;b++)g=3*d+b,a[b]=C[g];I.normalize(a,a);for(b=0;3>b;b++)g=3*d+b,C[g]=a[b]}return e};a.zC=function(a,b,d){for(var c={},g=b.length/3,e=0;e<g;e++){var k=String(b[3*e])+String(b[3*e+1])+String(b[3*e+2]);c[k]=[]}g=a.length;for(e=0;e<g;e++)b=a[e],k=String(d[3*b])+String(d[3*b+1])+String(d[3*b+2]),k in c&&c[k].push(b);return c};a.Ip=function(a,b,d,c){var g=H(a,null,!1);if(d)var e=H(a,null,!0);var k=g.length,l=new Float32Array(k),r=E,z=M;for(a=0;a<k;a++){var h=
g[a];r.set(h.subarray(0,3));z.set(h.subarray(3,6));K.set(h.subarray(6));l[a]=Math.sqrt(A(r,z,K))}r=new Float32Array(k);r[0]=l[0];for(a=1;a<k;a++)r[a]=r[a-1]+l[a];k=r[l.length-1];l=[];for(a=0;a<b;a++){var z=k*n.td(c),z=n.Fl(r,z,0,r.length-1),h=d?e[z]:g[z],z=a,x=h,J=c,h=void 0,h=new Float32Array(3),m=x[0],u=x[1],q=x[2],B=x[3],w=x[4],C=x[5],I=x[6],F=x[7],D=x[8],x=n.td(J),J=n.td(J);1<x+J&&(x=1-x,J=1-J);var G=1-x-J,u=G*u+x*w+J*F,q=G*q+x*C+J*D;h[0]=G*m+x*B+J*I;h[1]=u;h[2]=q;l[z]=h}return l};a.SM=H;a.dv=
x;a.GQ=A;a.AH=function(a,b,d){a=a.A[0].a_position;for(var c=0;c<a.length;c+=3)a[c]=(a[c]-d[0])*b[0]+d[0],a[c+1]=(a[c+1]-d[1])*b[1]+d[1],a[c+2]=(a[c+2]-d[2])*b[2]+d[2]};a.FL=function(a,b,d){var c=a.o;a=a.e.cg;for(var g=1;g<a.length;g++)a[g].name==b&&(a[g].value=d);for(g=0;g<c.length;g++)if(!c[g].Og&&c[g].oe&&!c[g].gi){var e=c[g].ja.Ki;b=c[g].ja.pf;J.bindBuffer(J.ARRAY_BUFFER,c[g].ja.ng);if(e.a_position){var k=e.a_position.offset,l=e.a_position.length+k,n=c[g].ja.ca[0].jc.a_position;for(d=k;d<l;d++)b[d]=
n[d-k];for(n=1;n<c[g].ja.ca.length;n++){var z=c[g].ja.ca[n].jc.a_position,h=a[n].value;if(h)for(d=k;d<l;d++)b[d]+=h*z[d-k]}J.bufferSubData(J.ARRAY_BUFFER,4*k,b.subarray(k))}if(e.a_normal){k=e.a_normal.offset;l=e.a_normal.length+k;n=c[g].ja.ca[0].jc.a_normal;for(d=k;d<l;d++)b[d]=n[d-k];for(n=1;n<c[g].ja.ca.length;n++)if(z=c[g].ja.ca[n].jc.a_normal,h=a[n].value)for(d=k;d<l;d++)b[d]+=h*z[d-k];r(b,k,l,3,2);J.bufferSubData(J.ARRAY_BUFFER,4*k,b.subarray(k))}if(e.a_tangent){k=e.a_tangent.offset;e=e.a_tangent.length+
k;n=c[g].ja.ca[0].jc.a_tangent;for(d=k;d<e;d++)b[d]=n[d-k];for(n=1;n<c[g].ja.ca.length;n++)if(l=c[g].ja.ca[n].jc.a_tangent,h=a[n].value)for(d=k;d<e;d++)b[d]+=h*l[d-k];r(b,k,e,4,3);J.bufferSubData(J.ARRAY_BUFFER,4*k,b.subarray(k))}}};a.iM=function(a){return a.e.oe};a.WN=function(a){var b=[];if(a.e)for(var d=1;d<a.e.cg.length;d++)b.push(a.e.cg[d].name);return b};a.VN=function(a,b){if(a.e)for(var d=1;d<a.e.cg.length;d++)if(b==a.e.cg[d].name)return a.e.cg[d].value;return 0};a.oO=function(a,b){var d=a.e.cg;
if(d)for(var c=1;c<d.length;c++)if(d[c].name==b)return!0;return!1};a.kO=function(a){return a&&a.e&&a.e.Vd?!0:!1}};b4w.module.__tsr=function(a,y){function e(a,b,c,e){e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=b;e[4]=c[0];e[5]=c[1];e[6]=c[2];e[7]=c[3]}function c(a,b,c){var e=b[0],h=b[1],m=b[2],u=b[3],q=b[4],x=b[5],A=b[6];b=b[7];var r=a[0]*u,k=a[1]*u,d=a[2]*u;a=b*r+x*d-A*k;var u=b*k+A*r-q*d,n=b*d+q*k-x*r,r=-q*r-x*k-A*d;c[0]=a*b+r*-q+u*-A-n*-x;c[1]=u*b+r*-x+n*-q-a*-A;c[2]=n*b+r*-A+a*-x-u*-q;c[0]+=e;c[1]+=h;c[2]+=m;return c}var b=y("__mat4"),h=y("__quat"),m=y("__util"),q=y("__vec3"),u=new Float32Array(3),w=new Float32Array(4);
new Float32Array(16);a.create=function(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a};a.ov=function(a,b,c,e,h,m,u,q){var x=new Float32Array(8);x[0]=a;x[1]=b;x[2]=c;x[3]=e;x[4]=h;x[5]=m;x[6]=u;x[7]=q;return x};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b};a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.Cf=function(a,b,c,h){h||(h=new Float32Array(8));e(a,b,c,h);return h};a.Bh=e;a.ln=function(a,
b){b[0]=a[0];b[1]=a[1];b[2]=a[2]};a.ge=function(a,b){b[3]=a};a.wr=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.Ok=function(a,b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3]};a.ri=function(a){return a.subarray(0,3)};a.Vg=function(a){return a[3]};a.qi=function(a){return a.subarray(4)};a.invert=function(a,b){var c=1/a[3];if(!c)return null;var e=a[0],m=a[1],u=a[2];w[0]=a[4];w[1]=a[5];w[2]=a[6];w[3]=a[7];h.invert(w,w);var q=w[0],H=w[1],x=w[2],A=w[3],e=e*c,m=m*c,r=u*c,u=A*e+H*r-x*m,k=A*m+x*e-q*r,
d=A*r+q*m-H*e,e=-q*e-H*m-x*r;b[0]=-(u*A+e*-q+k*-x-d*-H);b[1]=-(k*A+e*-H+d*-q-u*-x);b[2]=-(d*A+e*-x+u*-H-k*-q);b[3]=c;b[4]=q;b[5]=H;b[6]=x;b[7]=A;return b};a.sz=function(a,c){var e=a[3];b.fromRotationTranslation(a.subarray(4),a.subarray(0,3),c);for(var h=0;12>h;h++)c[h]*=e;return c};a.cm=function(a,b){var c=m.Ci(a,u),h=m.Fq(a),q=m.Sf(a,w);e(c,h,q,b);return b};a.multiply=function(a,b,e){c(b,a,e);e[3]=a[3]*b[3];var h=a[4],m=a[5],u=a[6];a=a[7];var q=b[4],w=b[5],x=b[6];b=b[7];e[4]=h*b+a*q+m*x-u*w;e[5]=
m*b+a*w+u*q-h*x;e[6]=u*b+a*x+h*w-m*q;e[7]=a*b-h*q-m*w-u*x;return e};a.Fh=c;a.uz=function(a,b,c){var e=b[3],h=a[0]-b[0],m=a[1]-b[1],u=a[2]-b[2];a=b[4];var q=b[5],x=b[6];b=b[7];var A=a*a+q*q+x*x+b*b,A=A?1/A:0;a=-a*A;q=-q*A;x=-x*A;b*=A;var A=b*h+q*u-x*m,r=b*m+x*h-a*u,k=b*u+a*m-q*h,h=-a*h-q*m-x*u;c[0]=A*b+h*-a+r*-x-k*-q;c[1]=r*b+h*-q+k*-a-A*-x;c[2]=k*b+h*-x+A*-q-r*-a;c[0]/=e;c[1]/=e;c[2]/=e;return c};a.ij=function(a,b,c,e){e||(e=0);var h=a.length,m=b[0],u=b[1],q=b[2],x=b[3],A=b[4],r=b[5],k=b[6];b=b[7];
for(var d=0;d<h;d+=3){var n=a[d]*x,B=a[d+1]*x,w=a[d+2]*x,E=b*n+r*w-k*B,M=b*B+k*n-A*w,K=b*w+A*B-r*n,n=-A*n-r*B-k*w;c[e+d]=E*b+n*-A+M*-k-K*-r;c[e+d+1]=M*b+n*-r+K*-A-E*-k;c[e+d+2]=K*b+n*-k+E*-r-M*-A;c[e+d]+=m;c[e+d+1]+=u;c[e+d+2]+=q}return c};a.zn=function(a,b,c,e){e||(e=0);var h=a.length,m=b[3],u=b[4],q=b[5],x=b[6];b=b[7];for(var w=0;w<h;w+=3){var r=a[w]*m,k=a[w+1]*m,d=a[w+2]*m,n=b*r+q*d-x*k,B=b*k+x*r-u*d,I=b*d+u*k-q*r,r=-u*r-q*k-x*d;c[e+w]=n*b+r*-u+B*-x-I*-q;c[e+w+1]=B*b+r*-q+I*-u-n*-x;c[e+w+2]=I*
b+r*-x+n*-q-B*-u}return c};a.Eh=function(a,b,c){var e=b[3],h=b[4],m=b[5],u=b[6];b=b[7];var q=a[0]*e,x=a[1]*e,w=a[2]*e;a=b*q+m*w-u*x;var e=b*x+u*q-h*w,r=b*w+h*x-m*q,q=-h*q-m*x-u*w;c[0]=a*b+q*-h+e*-u-r*-m;c[1]=e*b+q*-m+r*-h-a*-u;c[2]=r*b+q*-u+a*-m-e*-h;return c};a.An=function(a,b,c,e){e||(e=0);var h=a.length,m=b[3],u=b[4],q=b[5],x=b[6];b=b[7];for(var w=0;w<h;w+=4){var r=a[w]*m,k=a[w+1]*m,d=a[w+2]*m,n=b*r+q*d-x*k,B=b*k+x*r-u*d,I=b*d+u*k-q*r,r=-u*r-q*k-x*d;c[e+w]=n*b+r*-u+B*-x-I*-q;c[e+w+1]=B*b+r*-q+
I*-u-n*-x;c[e+w+2]=I*b+r*-x+n*-q-B*-u;c[e+w+3]=a[w+3]}return c};a.translate=function(a,b,c){var e=a[3],h=a[4],m=a[5],u=a[6],q=a[7],x=b[0]*e,w=b[1]*e,r=b[2]*e;b=q*x+m*r-u*w;var e=q*w+u*x-h*r,k=q*r+h*w-m*x,x=-h*x-m*w-u*r;c[0]=a[0]+b*q+x*-h+e*-u-k*-m;c[1]=a[1]+e*q+x*-m+k*-h-b*-u;c[2]=a[2]+k*q+x*-u+b*-m-e*-h;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.lq=function(a,b,c,e){e||(e=new Float32Array(8));q.lerp(a.subarray(0,3),b.subarray(0,3),c,e.subarray(0,3));var m=a[3];e[3]=m+c*(b[3]-m);
h.slerp(a.subarray(4),b.subarray(4),c,e.subarray(4));return e};a.TM=function(a,b,c,e){e||(e=new Float32Array(8));var m=a.subarray(0,3),u=b.subarray(0,3),q=e.subarray(0,3);q[0]=u[0]*(c+1)-m[0]*c;q[1]=u[1]*(c+1)-m[1]*c;q[2]=u[2]*(c+1)-m[2]*c;e[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4);b=b.subarray(4);m=e.subarray(4);m[0]=b[0]*(c+1)-a[0]*c;m[1]=b[1]*(c+1)-a[1]*c;m[2]=b[2]*(c+1)-a[2]*c;m[3]=b[3]*(c+1)-a[3]*c;h.normalize(m,m);return e};a.QF=function(a,b,c,e,h){h[0]=a[0]+b*c[0];h[1]=a[1]+b*c[1];h[2]=a[2]+b*
c[2];h[3]=a[3];c=e[0];var m=e[1];e=e[2];var u=a[4],q=a[5],x=a[6],w=a[7];h[4]=.5*(c*w+m*x-e*q);h[5]=.5*(m*w+e*u-c*x);h[6]=.5*(e*w+c*q-m*u);h[7]=.5*(-c*u-m*q-e*x);h[4]=a[4]+h[4]*b;h[5]=a[5]+h[5]*b;h[6]=a[6]+h[6]*b;h[7]=a[7]+h[7]*b;a=h[4];b=h[5];c=h[6];m=h[7];a=a*a+b*b+c*c+m*m;0<a&&(a=1/Math.sqrt(a),h[4]*=a,h[5]*=a,h[6]*=a,h[7]*=a)}};b4w.module.__extensions=function(a,y){function e(a){if(a in h)return h[a];var e=b.getExtension(a)||null;h[a]=e;c.log("%cGET EXTENSION","color: #"+(e?"0a0":"a00"),a);return e}var c=y("__print"),b=null,h={};a.Id=function(a){b=a};a.bw=function(){return e("WEBGL_compressed_texture_s3tc")||e("WEBKIT_WEBGL_compressed_texture_s3tc")||e("MOZ_WEBGL_compressed_texture_s3tc")};a.fF=function(){return e("WEBGL_depth_texture")||e("WEBKIT_WEBGL_depth_texture")||e("MOZ_WEBGL_depth_texture")};a.XE=function(){return e("EXT_texture_filter_anisotropic")||
e("WEBKIT_EXT_texture_filter_anisotropic")||e("MOZ_EXT_texture_filter_anisotropic")};a.Gv=function(){return e("WEBGL_debug_shaders")};a.aw=function(){return e("WEBGL_debug_renderer_info")};a.Jv=function(){return e("OES_element_index_uint")};a.xF=function(){return e("OES_standard_derivatives")};a.aa=function(){h={}}};b4w.module.__scenes=function(a,y){function e(){nb||(nb=c(Ca));return nb}function c(a){for(var b=0;b<a.length;b++){var d=a[b];if(!d.Pd||!d.Pd.length)return d}return null}function b(){if(!Pa)throw"No active scene available";return Pa}function h(a,b,d,f){for(var v=null,c=0;c<b.length;c++){var p=b[c];if((d?p.origin_name:p.name)==a&&p.e.Oc==f){v=p;break}}return v}function m(a,b){b||(b="ALL");var d=[];q(a.objects,b,d);return d}function q(a,b,d){for(var f=0;f<a.length;f++){var v=a[f];"ALL"!=b&&b!=v.type||
d.push(v);(v=v.dupli_group)&&q(v.objects,b,d)}}function u(b){if(Ga.Qk)switch(b.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var d=!1,f=!1,v=Y(b,"LAMP",a.L),c=Ga.lf&&b.b4w_enable_ssao;if(0==v.length&&!c)return!1;b=Y(b,"MESH",a.L);for(v=0;v<b.length;v++){var p=b[v];p.b4w_shadow_cast&&(d=!0);p.b4w_shadow_receive&&(f=!0);if((c||d)&&f)return!0}return!1}function w(a){if(!a.ya)return!1;a=a.ya.LAMP;for(var b=0;b<a.length;b++)if("SUN"==a[b].rb.type)return!0;return!1}function g(a){if(!Ga.dg)return!1;
a=O(a);for(var b=0;b<a.length;b++){var d=a[b];if(d.b4w_water&&d.b4w_water_shore_smoothing)return!0}return!1}function l(b){b=Y(b,"MESH",a.L);for(var d=0;d<b.length;d++)for(var f=b[d].particle_systems,v=0;v<f.length;v++){var c=f[v].settings;if(c.b4w_enable_soft_particles&&0<c.b4w_particles_softness)return!0}return!1}function z(b){var d=O(b),f=[];b=Y(b,"MESH",a.L);for(var v=0;v<d.length;v++){var c=d[v];if(c.b4w_water){for(var p={},e=0;e<b.length;e++)for(var t=b[e],k=t.data.materials,g=0;g<k.length;g++)k[g]==
c&&(p.pg=t.location[1]);p.Qc=c.b4w_water_fog_color.slice(0);p.Qc.push(c.b4w_water_fog_density);c.b4w_water_dynamic?(p.Sj=!0,p.waves_height=c.b4w_waves_height,p.waves_length=c.b4w_waves_length,p.dst_noise_scale0=c.b4w_water_dst_noise_scale0,p.dst_noise_scale1=c.b4w_water_dst_noise_scale1,p.dst_noise_freq0=c.b4w_water_dst_noise_freq0,p.dst_noise_freq1=c.b4w_water_dst_noise_freq1,p.dir_min_shore_fac=c.b4w_water_dir_min_shore_fac,p.dir_freq=c.b4w_water_dir_freq,p.dir_noise_scale=c.b4w_water_dir_noise_scale,
p.dir_noise_freq=c.b4w_water_dir_noise_freq,p.dir_min_noise_fac=c.b4w_water_dir_min_noise_fac,p.dst_min_fac=c.b4w_water_dst_min_fac,p.waves_hor_fac=c.b4w_water_waves_hor_fac):(p.Sj=!1,p.waves_height=0,p.waves_length=0);p.Ee=c.b4w_water_enable_caust;p.DC=c.b4w_water_caust_scale;p.CC=c.b4w_water_caust_brightness;p.EC=new Float32Array([.3,.7]);p.tn=null;c=c.texture_slots;for(e=0;e<c.length;e++)t=c[e].texture,!0===t.b4w_shore_dist_map&&(p.tn=t.image,p.Si=t.image.size[0],p.fI=t.b4w_shore_boundings,p.Ei=
t.b4w_max_shore_dist);f.push(p)}}if(0<f.length){p=f[0];if(!p.Sj)for(v=0;v<f.length;v++)f[v].Sj&&(p=f[v]);return p}return null}function C(a){function b(a){if(a){a=a.nodes;for(var f=0;f<a.length;f++){var v=a[f];"GROUP"==v.type&&v.node_group&&b(v.node_group.node_tree);"GROUP"==v.type&&"B4W_REFRACTION"==v.node_tree_name&&(d.Dc=!0)}}}var d={Dc:!1};a=O(a);for(var f=0;f<a.length;f++){var v=a[f];v.b4w_refractive&&(d.Dc=!0);v.node_tree&&b(v.node_tree)}return d}function F(b){if(Ga.cn)switch(b.b4w_render_reflections){case "OFF":return!1}else return!1;
for(var d=[],f=0,v=Y(b,"MESH",a.L),c=0;c<v.length;c++){var p=v[c];if(p.e.$c)if("CUBE"==p.e.af)f++;else{var e=p.$n;p.$n=null;if(e){-1==b.ya.EMPTY.indexOf(e)&&(b.ya.ALL.push(e),b.ya.EMPTY.push(e));e.e||Oa.Dn(e,!1);for(var p=null,t=0;t<d.length;t++)if(d[t]==e){p=t;break}null==p&&d.push(e)}}}return{an:d,qx:f,Ul:[],Ck:[]}}function G(a,b){var d={},f=a.world.b4w_sky_settings;d.mH=f.render_sky;d.procedural_skydome=f.procedural_skydome&&b;d.use_as_environment_lighting=f.use_as_environment_lighting;d.Ti=f.color;
d.rayleigh_brightness=f.rayleigh_brightness;d.mie_brightness=f.mie_brightness;d.spot_brightness=f.spot_brightness;d.scatter_strength=f.scatter_strength;d.rayleigh_strength=f.rayleigh_strength;d.mie_strength=f.mie_strength;d.rayleigh_collection_power=f.rayleigh_collection_power;d.mie_collection_power=f.mie_collection_power;d.mie_distribution=f.mie_distribution;d.nc=f.reflexible;d.dc=f.reflexible_only;!b&&f.procedural_skydome&&Za.warn("There is no sun on the scene. Procedural sky won't be rendered");
return d}function D(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.LF=a.hemisphere;b.tC=a.blur_depth;b.Qt=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.yH=a.samples;return b}function H(a){var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.gE=a.edge_lum;b.key=a.key;return b}function x(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function A(a){var b={};a=a.b4w_color_correction_settings;
b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function r(a){var b={};a=a.b4w_god_rays_settings;b.RF=a.intensity;b.Di=a.max_ray_length;b.bj=a.steps_per_pass;return b}function k(a){var b={};b.Wf=a.b4w_outline_color;b.vk=a.b4w_outline_factor;return b}function d(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=
a.large_glow_mask_width;return b}function n(a,b){var d=a.world,f=d.light_settings,v={};v.Ff=f.environment_energy;v.ls=f.use_environment_light;v.qp=f.environment_color;v.Mf=d.horizon_color.slice(0);v.rg=d.zenith_color.slice(0);v.AJ=d.use_sky_paper;v.zJ=d.use_sky_blend;v.BJ=d.use_sky_real;v.Yy=null;v.Dr=null;v.rp=null;if(v.ls&&"SKY_TEXTURE"==v.qp&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var f=null,c=0;c<d.texture_slots.length;c++)if(d.texture_slots[c].texture.b4w_use_as_environment_lighting){f=
d.texture_slots[c];break}f?v.rp=f:(Za.warn("environment lighting is set to 'Sky Texture', but there is no world texture with 'Sky Texture Usage' property set to 'ENVIRONMENT_LIGHTING'"),v.ls=!1)}for(c=0;c<d.texture_slots.length;c++)if(d.texture_slots[c].texture.b4w_use_as_skydome){d=d.texture_slots[c];v.Yy=d;v.Dr={qC:d.blend_factor,MF:d.horizon_factor,QJ:d.zenith_up_factor,PJ:d.zenith_down_factor,color:d.color,Ca:d.default_value,invert:d.invert,yJ:d.use_rgb_to_intensity,rC:d.blend_type,uJ:d.use_map_blend,
vJ:d.use_map_horizon,xJ:d.use_map_zenith_up,wJ:d.use_map_zenith_down};break}return v}function B(b){if(!Ga.Lb)return!1;var d=!1,f=!1;b=Y(b,"MESH",a.L);for(var v=0;v<b.length;v++){for(var c=b[v],p=c.data.materials,e=0;e<p.length;e++)p[e].b4w_terrain&&(d=!0);c=c.particle_systems;for(e=0;e<c.length;e++)p=c[e].settings,"HAIR"==p.type&&p.b4w_dynamic_grass&&(f=!0);if(d&&f)return!0}return!1}function I(b){if(Xb.outlining_overview_mode)return!0;if(Ga.enable_selectable)switch(b.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":b=Y(b,"MESH",a.L);for(var d=0;d<b.length;d++)if(b[d].e.Ah)return!0;return!1}else return!1}function E(b){if(Xb.outlining_overview_mode)return!0;if(Ga.enable_outlining)switch(b.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":b=Y(b,"MESH",a.L);for(var d=0;d<b.length;d++)if(b[d].e.Vb)return!0;return!1}else return!1}function M(b){if(Ga.Kf)switch(b.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":b=Y(b,"MESH",a.L);for(var d=
0;d<b.length;d++)for(var f=b[d].data.materials,v=0;v<f.length;v++)if(Vb.eu(f[v]))return!0;return!1}else return!1}function K(a,b){if(Ga.Dc)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.Dc}else return!1}function J(b){b=Y(b,"MESH",a.L);for(var d=0;d<b.length;d++)for(var f=b[d].data.materials,v=0;v<f.length;v++){var c=f[v],p=c.game_settings.alpha_blend;if(c.b4w_render_above_all&&"OPAQUE"!=p&&"CLIP"!=p)return!0}return!1}function f(b){switch(b.b4w_enable_anchors_visibility){case "OFF":return!1;
case "ON":return!0}b=Y(b,"EMPTY",a.L);for(var d=0;d<b.length;d++){var f=b[d];if(f.b4w_anchor&&f.b4w_anchor.detect_visibility)return!0}return!1}function p(a,b,d){var f=sa.lh(a,b);sa.of(a,f,function(a,b,f){if(f.Xa){switch(f.T){case "COLOR":case "CUBEMAP":a=b.j.tb;break;case "DEPTH":a=b.j.qd;break;case "SCREEN":a=null;break;case "MAIN_CUBE_REFLECT":return;default:throw"Wrong slink";}switch(f.wa){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "u_cube_reflection":case "u_plane_reflection":break;
default:if(!a)throw"Connection of SCREEN is forbidden";if(a.og)throw"Batch texture can't use renderbuffer";ga.hu(d.pc,f.wa)&&la.Vh(d,a,f.wa)}}});for(a=0;a<b.na.length;a++){var f=b.na[a],v=b.le[a];switch(f.wa){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":break;default:if(v.og)throw"Batch texture can't use renderbuffer";ga.hu(d.pc,f.wa)&&la.Vh(d,v,f.wa)}}}function t(a,b){return{Za:!0,np:[!0,!0,!0,!0,!0,!0],Dd:a,B:b}}function L(a,b,d,f,v){switch(a.type){case "MAIN_OPAQUE":N(a,
b,d,"OPAQUE",f,v);break;case "MAIN_BLEND":N(a,b,d,"BLEND",f,v);break;case "MAIN_XRAY":N(a,b,d,"XRAY",f,v);break;case "MAIN_GLOW":N(a,b,d,"GLOW",f,v);break;case "MAIN_PLANE_REFLECT":case "MAIN_CUBE_REFLECT":for(var c=b.e,e=b.o,k=0;k<e.length;k++){var g=e[k];if(("MAIN"==g.type||"PARTICLES"==g.type)&&"REFLECT"==g.Qa){if("MAIN_PLANE_REFLECT"==a.type){var n;a:{if(f.e.Nb){n=f.e.Nb.Ck;for(var r=0;r<n.length;r++)if(n[r]==a){n=r;break a}}n=null}if(n==c.Xc)continue}else{a:{if(f.e.Nb)for(n=f.e.Nb.Ul,r=0;r<n.length;r++)if(n[r]==
a){n=r;break a}n=null}if(n==c.Mc)continue}v||(T(g,a,b,d,"REFLECT",f),n=g.Ob,ga.F(n,"DISABLE_FOG",0),ga.F(n,"WATER_EFFECTS",0),"special_skydome.glslf"==ga.Pv(n)&&ga.F(n,"REFLECTION_PASS",1),ga.F(n,"TEXTURE_NORM",0),X(f,g),la.Qb(g),ia(g));a.q.push(t(c,g))}}break;case "DEPTH":c=b.o;for(e=0;e<c.length;e++)k=c[e],"DEPTH"!=k.type||k.Fc||"DEPTH"!=k.Qa&&"NODES"!=k.Qa||(v||(T(k,a,b,d,"DEPTH",f),la.Qb(k),ia(k)),a.q.push(t(b.e,k)),p(d,a,k),U(k));break;case "SHADOW_CAST":c=!1;e=b.e;b=b.o;k=ma.Oa(d,"GRASS_MAP");
for(g=0;g<b.length;g++)n=b[g],"DEPTH"==n.type&&"SHADOW_CAST"==n.Qa&&(c=!0,v||(ga.F(n.Ob,"SHADOW_USAGE","SHADOW_CASTING"),n.Lb&&k&&ha(n,k,e),la.ff(n,"SHADOW_TEX_RES",ga.O(f.e.hf.csm_resolution)),la.Qb(n),ia(n)),a.q.push(t(e,n)));c&&oa(a,ma.Oa(d,"MAIN_OPAQUE"),a.q,f,!0);break;case "COLOR_PICKING":ba(a,b,d,f,v);break;case "COLOR_PICKING_XRAY":ba(a,b,d,f,v);break;case "OUTLINE_MASK":d=b.e;f=b.o;for(b=0;b<f.length;b++)c=f[b],"COLOR_ID"==c.type&&"OUTLINE"==c.Qa&&(v||(la.ff(c,"USE_OUTLINE",1),la.Qb(c),ia(c)),
a.q.push(t(d,c)));break;case "GRASS_MAP":d=b.e;f=b.o;for(b=0;b<f.length;b++)c=f[b],"GRASS_MAP"==c.type&&(v||(la.Qb(c),ia(c)),a.q.push(t(d,c)),c=a.j,n=d.sb,e=a.wc[0],k=a.wc[1],g=a.wc[2],0==e&&0==k?(e=n.min_y,k=n.max_y):(e=Math.min(e,n.min_y),k=Math.max(k,n.max_y)),n=1E-4*(k-e),a.wc[0]=e-n,a.wc[1]=k+n,ob.jn(c,g/2,-k,-e,g/2),ob.bg(c));break;case "WIREFRAME":for(f=b.e,b=b.o,c=0;c<b.length;c++)e=b[c],"WIREFRAME"==e.type&&(v||(e.Lb&&(k=ma.Oa(d,"GRASS_MAP"))&&ha(e,k,f),la.Qb(e),ia(e)),a.q.push(t(f,e)),p(d,
a,e),U(e))}}function N(a,b,d,f,v,c){for(var e=b.e,k=b.o,g=0;g<k.length;g++){var n=k[g];n.Fc||n.dc||"MAIN"!=n.type&&"NODES_GLOW"!=n.type&&"PARTICLES"!=n.type||!("OPAQUE"==n.Qa&&"OPAQUE"==f||"BLEND"==n.Qa&&"BLEND"==f||"XRAY"==n.Qa&&"XRAY"==f||"NODES_GLOW"==n.type&&"GLOW"==f)||(c||(T(n,a,b,d,f,v),X(v,n),la.Qb(n),ia(n)),a.q.push(t(e,n)),p(d,a,n),U(n))}a.q.sort(function(a,b){var d;if(a.B&&b.B){d=a.B.Ja;var f=b.B.Ja;(d=d==f?0:d>f?1:-1)||(d=a.B.ph,f=b.B.ph,d=d==f?0:d>f?1:-1)}else d=0;return d})}function T(a,
b,d,f,v,c){var p=d.e,e="NO_SHADOWS",t=ma.Oa(f,"SHADOW_CAST");if(t&&a.Gc){switch(v){case "OPAQUE":e="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":e="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":e="NO_SHADOWS";break;case "DEPTH":e="SHADOW_MASK_GENERATION";break;default:throw"Wrong subscene type";}la.Dt(a,c.e.hf,t)}t=a.Ob;ga.F(t,"SHADOW_USAGE",e);a.Lb&&(e=ma.Oa(f,"GRASS_MAP"))&&ha(a,e,p);if("DEPTH"!=a.type&&"COLOR_ID"!=v||a.ti){v=b.oh;ga.F(t,"NUM_LIGHTS",v);ga.F(t,
"NUM_LFACTORS",0==v%2?v/2:Math.floor(v/2)+1);"special_skydome.glslf"==ga.Pv(t)&&ga.F(t,"REFLECTION_PASS",0);ga.F(t,"SSAO_ONLY",0);b.qb&&b.Ld?ga.F(t,"WATER_EFFECTS",1):ga.F(t,"WATER_EFFECTS",0);b.qb&&b.Ee&&p.Ee?(ga.F(t,"CAUSTICS",1),ga.F(t,"CAUST_SCALE",ga.O(b.Wt)),ga.F(t,"CAUST_SPEED",ga.O(b.Xt,2)),ga.F(t,"CAUST_BRIGHT",ga.O(b.Vt))):ga.F(t,"CAUSTICS",0);b.qb&&(ga.F(t,"WAVES_HEIGHT",ga.O(b.qg)),ga.F(t,"WAVES_LENGTH",ga.O(b.Mh)),ga.F(t,"WATER_LEVEL",ga.O(b.pg)));-1!==a.fd.indexOf("u_mirrormap")?ga.F(t,
"REFLECTION_TYPE","REFL_MIRRORMAP"):a.$c?null!=p.Mc&&ma.Oa(f,"MAIN_CUBE_REFLECT")?(d=c.e.Nb?c.e.Nb.Ul[d.e.Mc]:null)?(d=d.j.tb,la.Vh(a,d,"u_cube_reflection"),ga.F(t,"REFLECTION_TYPE","REFL_CUBE")):ga.F(t,"REFLECTION_TYPE","REFL_NONE"):null!=p.Xc&&ma.Oa(f,"MAIN_PLANE_REFLECT")?(d=c.e.Nb?c.e.Nb.Ck[d.e.Xc]:null)?(d=d.j.tb,la.Vh(a,d,"u_plane_reflection"),ga.F(t,"REFLECTION_TYPE","REFL_PLANE")):ga.F(t,"REFLECTION_TYPE","REFL_NONE"):ga.F(t,"REFLECTION_TYPE","REFL_NONE"):ga.F(t,"REFLECTION_TYPE","REFL_NONE");
(p=ma.Oa(f,"SKY"))?a.Tx?(d=p.j.tb,la.Vh(a,d,"u_sky")):Ga.Wm?(a.Lc=p.Lc,ga.F(t,"PROCEDURAL_FOG",1)):ga.F(t,"PROCEDURAL_FOG",0):ga.F(t,"PROCEDURAL_FOG",0);d=c.e.ys;d.ls&&(ga.F(t,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==d.qp?(d=d.rp?la.ZE(d.rp,!1):p.j.tb,ga.F(t,"SKY_TEXTURE",1),la.Vh(a,d,"u_sky_texture")):"SKY_COLOR"==d.qp&&ga.F(t,"SKY_COLOR",1));a.gr?(Ga.Nj&&ga.F(t,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.ti||"NODES_GLOW"==a.type?(ga.F(t,"REFRACTIVE",1),c.e.Dc?ga.F(t,"USE_REFRACTION",1):ga.F(t,
"USE_REFRACTION",0)):c.e.Dc?ga.F(t,"REFRACTIVE",1):ga.F(t,"REFRACTIVE",0)):(ga.F(t,"REFRACTIVE",0),ga.F(t,"USE_REFRACTION",0),ga.F(t,"USE_REFRACTION_CORRECTION",0));a.Lh&&(Ga.dg&&a.vs&&ma.Oa(f,"DEPTH")?ga.F(t,"SHORE_SMOOTHING",1):ga.F(t,"SHORE_SMOOTHING",0),a.water_dynamic&&b.qb&&b.qg?ga.F(t,"DYNAMIC",1):ga.F(t,"DYNAMIC",0));"PARTICLES"==a.type&&(ga.F(t,"SIZE_RAMP_LENGTH",a.Jx),ga.F(t,"COLOR_RAMP_LENGTH",a.Ax));if(!a.Og)for(b=a.X,f=0;f<b.length;f++)if(d=b[f],"SCENE"==d.source)for(p=0;p<Ca.length;p++){v=
Ca[p];for(var e=Ca[p].Pd,k=0;k<e.length;k++)e[k].e==d&&sa.m(jb,v,c,null)}if(a.Ai){b=0;for(var g in a.Ai)b++;a.tq=new Float32Array(3*b);a.rq=new Float32Array(3*b);a.qq=new Float32Array(3*b);a.sq=new Float32Array(4*b);ga.F(t,"NUM_LAMP_LIGHTS",b);for(f=0;f<c.ya.LAMP.length;f++)Q(a,c.ya.LAMP[f])}}}function Q(a,b){var d=b.uuid;if(d in a.Ai){d=a.Ai[d];a.tq.set(b.e.h,3*d);a.rq.set(b.rb.direction,3*d);a.qq.set(b.rb.bi,3*d);var f=ra,v=b.rb;f[0]=-1;f[1]=-1;f[2]=-1;f[3]=v.mg?1:0;switch(v.type){case "POINT":f[2]=
v.distance;break;case "SPOT":f[2]=v.distance;var c=f[0]=Math.cos(v.ie/2);f[1]=v.Wi*(1-c)}a.sq.set(f,4*d)}}function X(b,d){var f=Y(b,"LAMP",a.L);d.Ob.xq=[];for(var v=ea(f)||f[0],c=0;c<f.length;c++){var p=f[c].rb;if("AREA"!=p.type){if("SPOT"==p.type||"POINT"==p.type)var e=Math.cos(p.ie/2);if("SPOT"==p.type)var t=p.Wi*(1-e);var k=p.index;d.Ob.xq.push({type:p.type,index:k,jG:Math.floor(k/2),iG:0==k%2?"rg":"ba",ie:e,Wi:t,distance:p.distance,bG:p.Hh||p.mg,GE:k==v.rb.index})}}}function ia(a){var b=a.pc.attributes,
d=a.ja.Ki,f;for(f in b)d[f]||Sa.ma('missing data for "'+f+'" attribute');if("MAIN"==a.type||"NODES_GLOW"==a.type)if(b=ga.zF(a.pc.ss),10<b&&("MAIN"==a.type&&Za.warn("Varying limit exceeded for main shader - "+b+', materials: "'+a.Rf.join(", ")+'"'),"MAIN"==a.type&&a.ti||"NODES_GLOW"==a.type))f=d=0,a.Jh&&(d=Sa.Zd(a.Jh)),a.Gb&&(f=Sa.Zd(a.Gb)),Za.warn("Varying limit exceeded for node shader - "+b+", uv: "+d+", vc: "+f+', materials: "'+a.Rf.join(", ")+'"')}function U(a){8<a.X.length&&Za.warn(a.type,"too many textures used - "+
a.X.length+' (max 8), materials "'+a.Rf.join(", ")+'"')}function ha(a,b,d){a.wc=b.wc;var f=b.wc[0],v=b.wc[1],c=b.wc[2];d=d.hc;d=Math.max(d.max_x-d.min_x,d.max_z-d.min_z);c=0==c?d:Math.max(c,d);b.wc[2]=c;b=b.j;ob.jn(b,c/2,-v,-f,c/2);ob.bg(b);f=a.Wp||0;f=0==f?d:Math.max(f,d);a.Wp=f}function R(a){var b=ka(a,"MAIN_OPAQUE"),d=!0;sa.V(a.e.ub,function(f,v){"SHADOW_CAST"===v.type&&(oa(v,b,v.q,a,d),d=!1)})}function oa(b,d,f,v,c){if(0!=f.length){var p=b.j;d=d.j;var e=Y(v,"LAMP",a.L);if(e=ea(e)||e[0]){var t=
e.e;ob.Ny(p,t.h,t.quat);Fb.copy(d.Hf,p.Hf);sb.copy(d.xa,p.Sy);if("SPOT"==e.rb.type||"POINT"==e.rb.type)ob.bg(p,p.Ga);else{e=W;xa.re(e);for(t=0;t<f.length;t++){var k=f[t].Dd;0==t?xa.uu(k.sb,e):xa.av(e,k.sb)}f=xa.sE(e,ya);Sa.Yf(f,p.xa,f);if(v.e.hf.enable_csm){v=Fb.copy(d.Jj[b.$o],za);e=sb.invert(d.xa,jc);Sa.Yf(v,e,v);Sa.Yf(v,p.xa,v);b=d.ap[b.$o];if(c)for(Aa=0,ua=-Infinity,c=2;c<f.length;c+=3)Aa=Math.min(Aa,f[c]),ua=Math.max(ua,f[c]);c=W;c.max_x=v[0]+b;c.max_y=v[1]+b;c.max_z=ua;c.min_x=v[0]-b;c.min_y=
v[1]-b;c.min_z=Aa}else{b=c=W;d=Yb;d.set(f);v=Ka/9;f=sb.identity(jc);sb.rotate(f,v,Sa.sg,f);t=e=-1;for(k=0;10>k;k++){var g=xa.nC(d,Rb),n=(g.max_x-g.min_x)*(g.max_y-g.min_y);if(-1==e||n<e)e=n,t=k,xa.uu(g,b);Sa.Yf(d,f,d)}b=t*v;0<b&&(d=sb.identity(jc),sb.rotate(d,b,Sa.sg,d),sb.multiply(d,p.xa,p.xa));b=c.max_x-c.min_x;d=c.max_y-c.min_y;b&&d&&(v=Math.abs(b-d)/2,2<b/d?(c.max_y+=v,c.min_y-=v):2<d/b&&(c.max_x+=v,c.min_x-=v));c.max_x+=.005;c.max_y+=.005;c.max_z+=.005;c.min_x-=.005;c.min_y-=.005;c.min_z-=.005}ob.MH(p,
c.min_x,c.max_x,c.min_y,c.max_y,-c.max_z,-c.min_z);ob.bg(p)}Sa.vp(p.pe,p.dm)}}}function ea(a){for(var b=0;b<a.length;b++){var d=a[b];if(d.data.b4w_generate_shadows)return d}return!1}function ba(a,b,d,f,v){for(var c=b.e,p=b.o,e=0;e<p.length;e++){var k=p[e];"COLOR_ID"==k.type&&(v||(T(k,a,b,d,"COLOR_ID",f),la.Qb(k),ia(k)),"COLOR_PICKING"==a.type&&"COLOR_ID"==k.Qa||"COLOR_PICKING_XRAY"==a.type&&"COLOR_ID_XRAY"==k.Qa)&&(v||(la.ff(k,"USE_OUTLINE",0),la.Qb(k),ia(k)),a.q.push(t(c,k)))}}function V(a,b){for(var d=
na(b,Ha),f=a.rb,v=a.e,c=f.index,p=0;p<d.length;p++){var e=d[p];e.Pf.set(v.h,3*c);e.dh.set(f.direction,3*c);e.bh.set(f.bi,3*c);switch(f.type){case "SUN":if(e.oz.set(v.quat),e.nz=f.bi,"SKY"===e.type){var t=za;t[0]=t[1]=t[2]=1;var k=Math.acos(Fb.dot(e.xn,t)),t=Math.acos(Fb.dot(f.direction,t));e.Fm=Math.floor(k/.025)!=Math.floor(t/.025)?!0:!1;Fb.copy(f.direction,e.xn);aa(b,e)}else Fb.copy(f.direction,e.xn);case "HEMI":case "POINT":case "SPOT":break;default:Za.error("Unknown light type: "+f.type+'".')}k=
Ba;k[0]=f.Hh?1:0;k[1]=f.mg?1:0;e.eh.set(k,2*c);e.ua=!0;for(k=0;k<e.q.length;k++)t=e.q[k].B,t.Ai&&Q(t,a)}}function aa(a,b){oc.Rj(b);if(b.Fm)for(var d=na(a,["MAIN_OPAQUE","MAIN_BLEND","MAIN_XRAY","MAIN_GLOW"]),f=0;f<d.length;f++)for(var v=d[f].q,c=0;c<v.length;c++){var p=v[c];p.Za&&(p=p.B,la.IC(p)&&oc.ZI(p))}}function Y(b,d,f){if(!b.ya)throw"Access to uninitialized scene";b=b.ya[d]||[];if(f==a.L)return b;d=[];for(var v=0;v<b.length;v++){var c=b[v];c.e.Oc==f&&d.push(c)}return d}function O(b){var d=[];
b=Y(b,"MESH",a.L);for(var f=0;f<b.length;f++)for(var v=b[f].data,c=0;c<v.materials.length;c++){var p=v.materials[c];-1==d.indexOf(p)&&d.push(p)}return d}function pa(a,b,d){for(var f=a.e,v=a.camera.e.J,c=0;c<v.length;c++){var p=v[c];ob.bg(p,b/d);f.or&&ob.hs(p,f.hf)}f.or&&(f.Gm=!0,ka(a,"DEPTH").ua=!0,ka(a,"MAIN_BLEND").ua=!0);var e=f.ub;ma.TI(e,function(f,v,c){if(f.jj){var p=f.hg*b,t=f.hg*d;if(v)for(v=0;v<c.na.length;v++)c.na[v]==f&&Ab.resize(f.Ba,p,t);else switch(Ab.nk(f.Ba)&&Ab.resize(f.Ba,p,t),f=
c.j,f.width=p,f.height=t,c.type){case "DOF":ca(a,{dof_power:c.j.dof_power,dof_on:c.j.dof_on});break;case "GLOW_COMBINE":wa(a,{small_glow_mask_width:c.small_glow_mask_width,large_glow_mask_width:c.large_glow_mask_width});break;case "BLOOM":Z(a,{bloom_blur:c.bloom_blur});break;case "OUTLINE":c=ma.Na(e,c,"POSTPROCESSING");p=ma.Na(e,c,"POSTPROCESSING");t=ma.Na(e,p,"POSTPROCESSING");f=ma.Na(e,t,"POSTPROCESSING");ma.bd(c,1/b,1/d);ma.bd(p,1/b,1/d);ma.bd(t,1/b,1/d);ma.bd(f,1/b,1/d);break;default:ma.bd(c,
1/b,1/d)}}})}function na(a,b){for(var d=[],f=0;f<b.length;f++){var v=b[f];sa.V(a.e.ub,function(a,b){b.type==v&&d.push(b)})}return d}function ka(a,b){return ma.Oa(a.e.ub,b)}function ca(a,b){var d=ka(a,"DOF");if(!d)return Za.error("DOF is not enabled on the scene. Check camera settings"),0;var f=a.e.ub;"boolean"==typeof b.dof_on&&(d.j.dof_on=parseFloat(b.dof_on));"number"==typeof b.dof_distance&&(d.j.dof_distance=b.dof_distance);"number"==typeof b.dof_front&&(d.j.dof_front=b.dof_front);"number"==typeof b.dof_rear&&
(d.j.dof_rear=b.dof_rear);if("number"==typeof b.dof_power){d.j.dof_power=b.dof_power;var v=ma.Na(f,d,"POSTPROCESSING"),f=ma.Na(f,v,"POSTPROCESSING");ma.ec(v,d.j.dof_power);ma.bd(v,1/d.j.width,1/d.j.height);ma.ec(f,d.j.dof_power);ma.bd(f,1/d.j.width,1/d.j.height)}d.ua=!0}function Z(a,b){var d=ka(a,"LUMINANCE_TRUNCED"),f=ka(a,"BLOOM");if(!d||!f)return Za.error("Bloom is not enabled on the scene"),0;"number"==typeof b.bloom_key&&(d.bloom_key=b.bloom_key,d.ua=!0);"number"==typeof b.bloom_edge_lum&&(d.bloom_edge_lum=
b.bloom_edge_lum,d.ua=!0);if("number"==typeof b.bloom_blur){var v=a.e.ub,d=ma.Na(v,f,"BLOOM_BLUR"),v=ma.Na(v,d,"BLOOM_BLUR");f.bloom_blur=b.bloom_blur;ma.ec(d,b.bloom_blur);ma.bd(d,1/f.j.width,1/f.j.height);ma.ec(v,b.bloom_blur);ma.bd(v,1/f.j.width,1/f.j.height)}}function wa(a,b){var d=ka(a,"GLOW_COMBINE");if(!d)return Za.error("Glow is not enabled on the scene"),null;for(var f=a.e.ub,v=ma.pF(f,d),c=0;c<v.length;++c){var p=v[c];if("POSTPROCESSING"===p.type&&"GLOW_MASK_LARGE"===p.Qa)var e=p;if("POSTPROCESSING"===
p.type&&"GLOW_MASK_SMALL"===p.Qa)var t=p}v=ma.Na(f,e,"POSTPROCESSING");f=ma.Na(f,t,"POSTPROCESSING");"number"==typeof b.small_glow_mask_coeff&&(d.small_glow_mask_coeff=b.small_glow_mask_coeff,d.ua=!0);"number"==typeof b.large_glow_mask_coeff&&(d.large_glow_mask_coeff=b.large_glow_mask_coeff,d.ua=!0);"number"==typeof b.small_glow_mask_width&&(d.small_glow_mask_width=b.small_glow_mask_width,ma.ec(t,b.small_glow_mask_width),ma.bd(t,1/d.j.width,1/d.j.height),t.ua=!0,ma.ec(f,b.small_glow_mask_width),ma.bd(f,
1/d.j.width,1/d.j.height),f.ua=!0);"number"==typeof b.large_glow_mask_width&&(d.large_glow_mask_width=b.large_glow_mask_width,ma.ec(e,b.large_glow_mask_width),ma.bd(e,1/d.j.width,1/d.j.height),e.ua=!0,ma.ec(v,b.large_glow_mask_width),ma.bd(v,1/d.j.width,1/d.j.height),v.ua=!0)}function v(a,b){var d=ka(Pa,"MAIN_OPAQUE");if(!d||!d.qb)return Za.error("get_water_surface_level() - no water parameters on the scene"),0;var f=d.qg,v=d.Mh,c=d.pg,p=d.qb;if(!f||!p.Sj)return p.pg;var e=Fb.length(d.bl),t=d.time;
e&&(t*=e);var k=Ba;k[0]=20/v*(a-.25*t);k[1]=20/v*(b-.25*t);e=Sa.Yt(k);k[0]=17/v*(b+.1*t);k[1]=17/v*(a+.1*t);var k=Sa.Yt(k),e=e+k-1,g=p.dst_noise_scale0,k=p.dst_noise_scale1,n=p.dst_noise_freq0,r=p.dst_noise_freq1,h=Ba;h[0]=g*(a+n*t);h[1]=g*(b+n*t);g=Sa.Gr(h);h[0]=k*(b-r*t);h[1]=k*(a-r*t);k=Sa.Gr(h);k*=f*g;if(d.Gn)if(r=(a-d.eg[0])/d.fg[0],h=(d.eg[1]+b)/d.fg[1],r+=.5,h+=.5,1<r||0>r||1<h||0>h)f=k;else var r=Sa.zv(Pa.e.zr,d.Si,r,h),g=p.dir_freq,l=p.dir_noise_scale,x=p.dir_noise_freq,n=p.dir_min_noise_fac,
h=p.dst_min_fac,d=v/d.Ei/Math.PI,l=[l/v*(a+x*t),l/v*(b+x*t)],v=Math.sqrt(r),f=f*Math.max(r,p.dir_min_shore_fac)*Math.sin(v/d+g*t)*Math.max(Sa.Gr(l),n),p=Math.max(v,h),f=f*(1-p)+k*p,e=e*r;else f=k;return c+(f+.05*e)}function S(a,b){a.lk&&"POSTPROCESSING"==a.type&&b.Za!=a.Za&&(a.Za=b.Za);b.Za||"OUTLINE"!=a.type||(a.op=0)}function fa(a,b,d,f){var v=sa.ab(a,b);ob.en(v.j,d,f);v.po=!0;sa.lg(a,b,function(b,v,c){c.Xa&&c.T==d&&ma.SC(c)&&va(a,b,c.wa,f)});sa.of(a,b,function(b,v,c){c.Xa&&c.T==d&&c.T==c.wa&&fa(a,
b,d,f)})}function va(a,b,d,f){a=sa.ab(a,b).q;for(b=0;b<a.length;b++)la.qH(a[b].B,f,d)}function P(a){var b=ka(a,"GRASS_MAP");if(b){var d=b.j,f=a.camera.e,v=f.h;a=za;a[0]=0;a[1]=-b.wc[2]/2;a[2]=0;Fb.transformQuat(a,f.quat,a);a[0]+=v[0];a[1]=0;a[2]+=v[2];b=Mb;b[0]=0;b[1]=0;b[2]=0;b[3]=1;ob.Ny(d,a,b)}}function qa(a,b){sa.V(a,function(d,f){if("MOTION_BLUR"==f.type){if(!f.na[0]||!f.le[0])throw"Wrong MOTION_BLUR subscene";var v=f.na[0],c=f.le[0];f.le[0]=f.j.tb;sa.lg(a,d,function(b,d,f){f.Xa&&va(a,b,f.wa,
c)});fa(a,d,v.T,c);va(a,d,v.wa,f.le[0]);f.jx=Math.exp(-b/f.mb_factor)}})}function da(b,d){var f=0,v=b.CB;0==v.Wr&&(v.Wr=d);var c=d-v.Wr;if(v.fy&&c/v.sd>=v.fy)a.Dj(b);else{c%=v.sd;if(c<v.vx)switch(v=c/(v.vx/5),c=Math.floor(v),c){case 0:f=(v-c)/2;break;case 1:f=(v-c)/2+.5;break;case 2:f=1;break;case 3:f=1-(v-c)/2;break;case 4:f=.5-(v-c)/2}b.e.ee=f}}function Fa(a){sa.V(a.e.ub,function(a,b){b.ua=!0})}function Ib(a){if("WIND"==a.field.type){a=a.e;Sa.va(a.quat,Sa.jb,Wa);Fb.normalize(Wa,Wa);Fb.scale(Wa,
a.Dp,Wa);a=Ca;for(var b=0;b<a.length;b++)for(var d=na(a[b],Ra),f=0;f<d.length;f++)d[f].bl.set(Wa)}}function vb(a){var d=b();if(d=ka(d,"OUTLINE"))d.Wf.set(a),d.ua=!0}var la=y("__batch"),xa=y("__boundings"),ob=y("__camera"),Qb=y("__config"),$a=y("__container"),Pc=y("__constraints"),hc=y("__data"),vc=y("__debug"),pc=y("__geometry"),sa=y("__graph"),Dc=y("__hud"),Vb=y("__nodemat"),Oa=y("__objects");y("__particles");var uc=y("__physics"),mb=y("__prerender"),Hb=y("__primitives"),Za=y("__print"),oc=y("__renderer"),
ma=y("__scenegraph"),Qc=y("__sfx"),ga=y("__shaders"),Ab=y("__textures"),Sa=y("__util"),Fb=y("vec3"),sb=y("mat4"),Ga=Qb.r,Xb=Qb.Vb,bb=Qb.Pi,rc=Qb.ze,bd="ARMATURE CAMERA EMPTY LAMP MESH SPEAKER".split(" "),cd=["ARMATURE","EMPTY","MESH","SPEAKER"],cb="GRASS_MAP SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY DEPTH OUTLINE_MASK WIREFRAME".split(" ");a.jL=cb;var Ha="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT GOD_RAYS GOD_RAYS_COMBINE SKY LUMINANCE_TRUNCED".split(" "),
fb="MAIN_OPAQUE SSAO MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),Ra="SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY DEPTH GOD_RAYS OUTLINE_MASK WIREFRAME".split(" "),Va="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),Zb=0,nb=null,Pa=null,Ca=[],jb=null,La=[],Ka=Math.PI/2;a.tg=0;a.Tn=1;a.Un=2;a.L=-1;var Ba=new Float32Array(2),za=new Float32Array(3);
new Float32Array(4);var ra=new Float32Array(4),Mb=new Float32Array(4),jc=new Float32Array(16),ya=new Float32Array(24),Yb=new Float32Array(24),W=xa.re(),Rb=xa.re(),Wa=new Float32Array(3),Aa=0,ua=-Infinity;a.rr=function(a){Pa=a;Qc.HH(a)};a.aH=function(a,b){var d=a.e,f=ma.CD(d.ub);if(a==b){pa(a,$a.BF(),$a.AF());for(var v=0;v<f.length;v++)a.e.wh.push(f[v])}else for(v=a.Pd[0],pa(a,v.e.Ch,v.e.Ch),v=0;v<f.length;v++)b.e.wh.push(f[v]);f=na(a,Ra);for(v=0;v<f.length;v++)f[v].bl.set(Wa);for(v=0;v<d.wh.length;v++)"SHADOW_CAST"==
d.wh[v].type&&oc.Rj(d.wh[v])};a.pi=e;a.xp=c;a.p=b;a.pa=function(){return Pa?!0:!1};a.fm=function(a){return a.camera};a.ck=function(){return Ca};a.uF=function(){if(1==Ca.length)return Ca;for(var a=0;a<Ca.length;a++){var b=Ca[a].e.ub;sa.V(b,function(b,d){for(var f=0;f<d.q.length;f++){for(var v=d.q[f].B.X,c=null,p=0;p<v.length;p++)if("SCENE"==v[p].source&&v[p].Hr==Ca[a].name&&"COPY"!=d.type){Za.error('Texture-scene loop detected. A scene is rendered to texture "'+v[p].name+'" yet this texture belongs to the same scene.');
sa.lh(jb,Ca[a]);c=d.q[f].B;break}c&&(c.X=[],c.fd=[],la.YI(c,null),la.Qb(c))}})}for(var d=[],a=0;a<Ca.length;a++)if(b=Ca[a],!b.Pd.length){b=sa.lh(jb,b);sa.mE(jb,b);b=sa.Pr(jb,b,sa.Qn);b=sa.Yr(b);sa.V(b,function(a,b){d.push(b)});break}return d};a.$d=function(b,d,f,v){for(var c=Ca,p=null,e=0;e<c.length;e++){var t=Y(c[e],"ALL",a.L);switch(b){case a.tg:p=h(d,t,!1,f);break;case a.Tn:p=null;(t=h(d,t,!1,v))&&t.dupli_group&&(p=h(f,t.dupli_group.objects,!0,v));break;case a.Un:for(var p=null,k=0;k<d.length;k++)if((p=
h(d[k],t,0!=k,f))&&p.dupli_group)t=p.dupli_group.objects;else break}if(p)break}return p};a.UB=function(a,b,d){for(var f in cd){var v=cd[f],c=m(a,v),p=b.e.nj,e=!1;for(f=0;f<d.length;f++)if(e=!0,d[f].e&&d[f].e.ah){for(var t=0;t<p.length;t++)p[t]==d[f]&&(e=!1);e&&p.push(d[f])}v in b.ya||(b.ya[v]=[]);for(t=0;t<c.length;t++)Sa.Se(c[t])&&c[t].proxy||(b.ya.ALL.push(c[t]),b.ya[v].push(c[t]))}};a.NB=function(b,v){b.ya={ALL:[]};for(var c in bd){var p=bd[c],e=m(b,p);b.ya[p]=[];for(var t=0;t<e.length;t++)Sa.Se(e[t])&&
e[t].proxy||(b.ya.ALL.push(e[t]),b.ya[p].push(e[t]))}b.Pd=b.Pd||[];b.e=b.e||{};b.oa=null;p=b.e;e=b.camera.e;c=b.b4w_shadow_settings;t=p.hf={};c.csm_resolution>Ga.bc?(t.csm_resolution=Ga.bc,Za.error("Shadow map texture has unsupported size. Changed to "+Ga.bc+".")):t.csm_resolution=c.csm_resolution;t.self_shadow_polygon_offset=c.self_shadow_polygon_offset;t.self_shadow_normal_offset=c.self_shadow_normal_offset;t.enable_csm=c.b4w_enable_csm;var h=Y(b,"LAMP",a.L);if(h=ea(h)||h[0])t.uq=h.rb.type,t.ie=
h.rb.ie,t.distance=h.rb.distance,"SPOT"!=t.uq&&"POINT"!=t.uq||!t.enable_csm||(Za.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),t.enable_csm=!1);t.enable_csm?(t.csm_num=c.csm_num,t.csm_first_cascade_border=c.csm_first_cascade_border,t.first_cascade_blur_radius=c.first_cascade_blur_radius,t.csm_last_cascade_border=c.csm_last_cascade_border,t.last_cascade_blur_radius=c.last_cascade_blur_radius,t.fade_last_cascade=c.fade_last_cascade,t.blend_between_cascades=c.blend_between_cascades):
(t.csm_num=1,t.csm_first_cascade_border=c.csm_first_cascade_border,t.first_cascade_blur_radius=c.first_cascade_blur_radius,t.csm_last_cascade_border=c.csm_last_cascade_border,t.last_cascade_blur_radius=c.last_cascade_blur_radius,t.fade_last_cascade=!1,t.blend_between_cascades=!1);p.nj=[];for(c=0;c<v.length;c++)v[c].e&&v[c].e.ah&&p.nj.push(v[c]);t=b.world.b4w_fog_color;h=b.world.b4w_fog_density;c=C(b);p.Qc=new Float32Array([t[0],t[1],t[2],h]);p.Dh=w(b);p.vn=G(b,p.Dh);p.ys=n(b,p.vn);p.gG=Y(b,"LAMP",
a.L).length;p.qb=z(b);p.uG=c;p.rf=J(b);p.GB=f(b);p.rx=0;e.J[0].type!=ob.Xb&&Ga.anaglyph_use?(Za.warn("Anaglyph stereo is disabled for the non-perspective camera"),t=!1):t=Ga.anaglyph_use;p.anaglyph_use=t;p.or=Ga.Nj&&u(b);p.bN=b.world.b4w_fog_color;p.dg=g(b);p.jI=l(b);p.Nb=F(b);p.sC=H(b);p.yG=x(b);p.FC=A(b);p.EF=r(b);p.MG=k(b);p.Lf=d(b);p.ji=Ga.ji&&(0<e.dof_distance||e.Me);p.Lb=B(b);p.Gi=Ga.Gi&&b.b4w_enable_motion_blur;p.ci=Ga.ci&&b.b4w_enable_color_correction;p.antialiasing=Ga.antialiasing&&b.b4w_enable_antialiasing;
p.Xh=Ga.Xh&&b.b4w_enable_bloom&&p.Dh;p.lf=Ga.lf&&b.b4w_enable_ssao;p.zI=D(b);p.si=Ga.si&&b.b4w_enable_god_rays&&p.Dh;p.Dc=K(b,c);p.$D=Ga.Nj;p.aD=I(b);p.outline=E(b);p.Kf=M(b);p.Vp=b.world.b4w_render_glow_over_blend;switch(b.b4w_reflection_quality){case "LOW":p.Kg=bb.Lu;p.Bk=bb.Ox;break;case "MEDIUM":p.Kg=bb.PD;p.Bk=bb.TG;break;case "HIGH":p.Kg=bb.OD;p.Bk=bb.SG;break;default:p.Kg=bb.Lu,p.Bk=bb.Ox}c=b.Pd.sort(function(a,b){return b.e.Ch-a.e.Ch});p.ub=ma.BD(p,e,c);p.wh=[];p.Gm=!1;p.Lq=!1;Ca.push(b);
jb||(jb=sa.create());sa.u(jb,b)};a.Po=m;a.Pp=function(a){return a.e.ub};a.HE=function(a){sa.V(a,function(b,d){var f=null;switch(d.type){case "POSTPROCESSING":f=la.Fu(d.Vm);break;case "SSAO":f=la.HD(d);break;case "SSAO_BLUR":f=la.ID(d);break;case "DEPTH_PACK":f=la.qD();break;case "REFRACT":case "COPY":f=la.Fu("NONE");break;case "GOD_RAYS":ma.Na(a,d,"WIREFRAME")||ma.Na(a,d,"MAIN_BLEND")||ma.Na(a,d,"GOD_RAYS");f=la.uD(d.Kx,d.Lh,d.bj);break;case "GOD_RAYS_COMBINE":ma.Na(a,d,"WIREFRAME")||ma.Na(a,d,"MAIN_BLEND");
ma.Na(a,d,"GOD_RAYS");f=la.vD();break;case "MOTION_BLUR":f=la.yD();break;case "DOF":var f=la.rD(),v=ma.Na(a,d,"POSTPROCESSING"),c=ma.Na(a,v,"POSTPROCESSING");ma.ec(v,d.j.dof_power);ma.ec(c,d.j.dof_power);break;case "OUTLINE":var f=la.zD(),v=ma.Na(a,d,"POSTPROCESSING"),c=ma.Na(a,v,"POSTPROCESSING"),e=ma.Na(a,c,"POSTPROCESSING"),k=ma.Na(a,e,"POSTPROCESSING");ma.ec(c,d.xo);ma.ec(v,d.xo);ma.ec(k,d.up*d.vk);ma.ec(e,d.up*d.vk);break;case "GLOW_COMBINE":f=la.tD();break;case "COMPOSITING":f=la.oD();break;
case "ANTIALIASING":f=la.kD();break;case "SMAA_RESOLVE":case "SMAA_EDGE_DETECTION":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_NEIGHBORHOOD_BLENDING":f=la.FD(d.type);break;case "ANAGLYPH":f=la.iD();break;case "SKY":f=la.AD();break;case "LUMINANCE":f=la.wD();break;case "AVERAGE_LUMINANCE":f=la.lD();break;case "LUMINANCE_TRUNCED":f=la.xD();break;case "BLOOM_BLUR":f=la.mD();break;case "BLOOM":f=ma.Na(a,d,"BLOOM_BLUR");v=ma.Na(a,f,"BLOOM_BLUR");ma.ec(f,d.bloom_blur);ma.ec(v,d.bloom_blur);f=la.nD();
break;case "VELOCITY":f=la.LD();break;case "ANCHOR_VISIBILITY":f=la.jD()}f&&(v=t(Oa.Rl("NONE"),f),ia(f),d.q.push(v),p(a,d,f),U(f))})};a.yf=function(a,b,d){switch(b.type){case "MESH":var f=a.e.ub,v=b.e;!ma.Oa(f,"SHADOW_CAST")&&v.Gc&&(v.Gc=!1);v=na(a,cb);d&&(uc.C(b)&&uc.yf(b,a),a.ya.ALL.push(b),a.ya[b.type].push(b),b.Fa&&b.Fa.dupli_group.objects&&(b.origin_name=b.name,b.Fa.dupli_group.objects.push(b)));for(var c=0;c<v.length;c++)L(v[c],b,f,a,d);break;case "LAMP":b.rb.index=a.e.rx++;d=na(a,Ha);for(f=
0;f<d.length;f++)d[f].oh++;V(b,a)}};a.hy=function(a){if(!a.e.mq)return!1;var d=b();hc.$G(d,a,!1);var f=d.ya.ALL.indexOf(a);-1!=f&&d.ya.ALL.splice(f,1);f=d.ya[a.type].indexOf(a);-1!=f&&d.ya[a.type].splice(f,1);a.Fa&&a.Fa.dupli_group.objects&&(f=a.Fa.dupli_group.objects.indexOf(a),-1!=f&&a.Fa.dupli_group.objects.splice(f,1));Pc.LC(a)&&Pc.remove(a);return!0};a.oL=L;a.qr=function(a){a.e.Gm=!0};a.dF=function(a,b){for(var d=a.e.hf,f=new Float32Array(d.csm_num),v=0;v<d.csm_num;v++)f[v]=ob.ND(d,b,v);return f};
a.ik=function(a){a.e.ui=!0};a.Ar=function(a){a.e.ui=!1};a.oq=function(a){return a.e.ui};a.kH=function(a,b,d){b=b.e;a=na(a,cb);for(var f=0;f<a.length;f++)for(var v=a[f].q,c=v.length-1;0<=c;c--){var p=v[c];p.Dd==b&&(p.B&&d&&pc.ju(p.B.ja),v.splice(c,1))}};a.fu=function(a,b){return b.ya[a.type]&&-1<b.ya[a.type].indexOf(a)?!0:!1};a.mI=function(a){var b=a.ya.LAMP;if(b.length==a.e.rx){for(var d=[],f=0;f<b.length;f++)d[b[f].rb.index]=f;for(f=0;f<d.length-1;f++)for(var v=f+1;v<d.length;v++){var c=b[d[f]].rb,
p=b[d[v]].rb;if(p.Hh&&p.mg&&(!c.Hh||!c.mg)||!c.Hh&&(p.Hh||!c.mg&&p.mg))c=d[f],d[f]=d[v],d[v]=c}for(f=0;f<d.length;f++)b[d[f]].rb.index=f,V(b[d[f]],a)}};a.fJ=V;a.aa=function(){for(var a=0;a<Ca.length;a++){var b=Ca[a];sa.V(b.e.ub,function(a,b){if("SINK"!=b.type){var d=b.j;oc.nH(d.Oe,d.tb,d.qd,d.width,d.height);for(var d=b.q,f=0;f<d.length;f++){var v=d[f].B;v&&la.$C(v)}}});b.e.ub=[];b.e.wh=[]}Pa=nb=null;Ca.length=0;jb=null;La.length=0;Wa[0]=0;Wa[1]=0;Wa[2]=0};a.ex=function(a,b,d){a=ob.tE(a,a.cb,a.$a,
null,!0);var f=Hb.ME(a);a=Oa.Rl("DYNAMIC");a.sb=a.hc={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.Kb=a.xd=xa.pC();var v=a.Kb.La;a.Cg=a.Bg=xa.Uo([v,0,0],[0,v,0],[0,0,v],a.Kb.G);d=la.ED(f,d);b.q.push(t(a,d))};a.Ab=Y;a.SN=function(a){return[a.frame_start,a.frame_end]};a.Qy=function(a,b,d){$a.cI(a,b,d);Pa&&pa(Pa,a,b)};a.GI=na;a.ea=ka;a.Kv=function(a){a=na(a,Ha)[0];var b=a.Mf,d=a.rg,f=[],v=[];f[0]=b[0];f[1]=b[1];f[2]=b[2];v[0]=d[0];v[1]=d[1];v[2]=d[2];return[a.Ff,f,v]};a.Ay=
function(a,b,d,f){a=na(a,Ha);for(var v=0;v<a.length;v++){var c=a[v];isNaN(b)||(c.Ff=b);d&&c.Mf.set(d);f&&c.rg.set(f);c.ua=!0}};a.fw=function(a){if(a=ka(a,"SKY")){var b={};b.color=Array(3);Fb.copy(a.Ti,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;
b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.Iy=function(a,b){var d=ka(a,"SKY");d&&("number"==typeof b.procedural_skydome&&(d.procedural_skydome=b.procedural_skydome),"number"==typeof b.use_as_environment_lighting&&(d.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&d.Ti.set(b.color),"number"==typeof b.rayleigh_brightness&&
(d.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(d.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(d.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(d.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(d.rayleigh_strength=b.rayleigh_strength),"number"==typeof b.mie_strength&&(d.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(d.rayleigh_collection_power=b.rayleigh_collection_power),
"number"==typeof b.mie_collection_power&&(d.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(d.mie_distribution=b.mie_distribution),d.ua=!0,d.Fm=!0,aa(a,d))};a.Qv=function(a,b){var d=b||[],f=na(a,fb)[0].Qc;d[0]=f[0];d[1]=f[1];d[2]=f[2];d[3]=f[3];return d};a.Cy=function(a,b){for(var d=na(a,fb),f=0;f<d.length;f++){var v=d[f];v.Qc.set(b);v.ua=!0}};a.hw=function(a){var b=ka(a,"SSAO");a=ka(a,"SSAO_BLUR");if(!b)return null;var d=b.q[0].B,f={};f.ssao_quality=la.Lp(d,"SSAO_QUALITY")[1];
f.ssao_hemisphere=b.ssao_hemisphere;f.ssao_blur_depth=a.ssao_blur_depth;f.Qt=a.ssao_blur_discard_value;f.radius_increase=b.Zi;f.influence=b.Yi;f.dist_factor=b.Xi;f.ssao_only=b.ssao_only;f.ssao_white=la.Lp(d,"SSAO_WHITE")[1];return f};a.Ky=function(a,b){var d=ka(a,"SSAO"),f=ka(a,"SSAO_BLUR");if(!d)return Za.error("SSAO is not enabled on the scene"),0;if("string"==typeof b.ssao_quality){var v=d.q[0].B;la.ff(v,"SSAO_QUALITY",b.ssao_quality);la.Qb(v,!0)}"number"==typeof b.ssao_hemisphere&&(v=d.q[0].B,
la.ff(v,"SSAO_HEMISPHERE",b.ssao_hemisphere),la.Qb(v,!0));"number"==typeof b.ssao_blur_depth&&(v=f.q[0].B,la.ff(v,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),la.Qb(v,!0));"number"==typeof b.ssao_blur_discard_value&&(f.ssao_blur_discard_value=b.ssao_blur_discard_value);"number"==typeof b.Zi&&(d.Zi=b.Zi);"number"==typeof b.Yi&&(d.Yi=b.Yi);"number"==typeof b.Xi&&(d.Xi=b.Xi);if("number"==typeof b.ssao_only){d=ka(a,"MAIN_OPAQUE");d.ssao_only=b.ssao_only;for(var c=0;c<d.q.length;c++)v=d.q[c].B,la.ff(v,"SSAO_ONLY",
b.ssao_only),la.Qb(v,!0)}"number"==typeof b.ssao_white&&(v=d.q[0].B,la.ff(v,"SSAO_WHITE",b.ssao_white),la.Qb(v,!0));d.ua=!0;f.ua=!0};a.Hv=function(a){a=ka(a,"DOF");if(!a)return null;var b={};b.dof_distance=a.j.dof_distance;b.dof_front=a.j.dof_front;b.dof_rear=a.j.dof_rear;b.dof_power=a.j.dof_power;b.Me=a.j.Me;return b};a.zy=ca;a.Tv=function(a){var b=na(a,["GOD_RAYS"]);a=ka(a,"GOD_RAYS_COMBINE");if(!b||!a)return null;var d={};d.god_rays_max_ray_length=b[0].Di;d.god_rays_intensity=a.god_rays_intensity;
d.god_rays_steps=la.Lp(b[0].q[0].B,"STEPS_PER_PASS")[1];return d};a.Ey=function(a,b){var d=na(a,["GOD_RAYS"]),f=ka(a,"GOD_RAYS_COMBINE");if(!d||!f)return Za.error("God Rays are not enabled on the scene"),0;"number"==typeof b.god_rays_intensity&&(f.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var v=b.god_rays_max_ray_length,c=0;c<d.length;c++)d[c].Di=v,d[c].Zm=v/d[c].bj/(c+1),d[c].ua=!0;if("number"==typeof b.god_rays_steps)for(var p=ga.O(b.god_rays_steps,
1),v=d[0].Di,c=0;c<d.length;c++){d[c].bj=p;d[c].Zm=v/p/(c+1);d[c].ua=!0;var e=d[c].q[0].B;la.ff(e,"STEPS_PER_PASS",p);la.Qb(e,!0)}f.ua=!0};a.Bv=function(a){var b=ka(a,"LUMINANCE_TRUNCED");a=ka(a,"BLOOM");if(!b||!a)return null;var d={};d.bloom_key=b.bloom_key;d.bloom_edge_lum=b.bloom_edge_lum;d.bloom_blur=a.bloom_blur;return d};a.qy=Z;a.Sv=function(a){a=ka(a,"GLOW_COMBINE");if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=
a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.Dy=wa;a.pw=function(){var a=Wa,b=Fb.length(a);if(0==b)return null;var d={};d.wind_dir=180*Math.atan(a[0]/a[2])/Math.PI;d.wind_strength=b;return d};a.Py=function(b,d){for(var f=Y(b,"ALL",a.L),v=0;v<f.length;v++){var c=f[v];if("EMPTY"===c.type&&c.field&&"WIND"===c.field.type)var p=c}if(!p)return Za.error("There is no wind on the scene"),0;f=p.e;"number"==typeof d.wind_dir&&(za=[0,d.wind_dir/180*Math.PI,-Math.PI/2],Sa.Gf(za,
Mb),f.quat.set(Mb),Ib(p));"number"==typeof d.wind_strength&&(f.Dp=d.wind_strength,Ib(p));Fa(b)};a.CH=function(a){a.e.Lq=!0};a.nw=v;a.mw=function(a,b){var d=ka(a,"MAIN_OPAQUE");if(d&&(b.waves_height=d.qg,b.waves_length=d.Mh,d.Ld)){b.water_fog_density=d.Ld[3];var f=b.water_fog_color=[];f[0]=d.Ld[0];f[1]=d.Ld[1];f[2]=d.Ld[2]}};a.Oy=function(a,b){var d=ka(a,"MAIN_OPAQUE");if(!d||!d.qb)return Za.error("set_water_params() - no water parameters on the scene"),null;d=d.qb;"number"==typeof b.dst_noise_scale0&&
(d.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(d.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&(d.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(d.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(d.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(d.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(d.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&
(d.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(d.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&(d.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(d.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(d.Sj=b.water_dynamic);for(var f=na(a,Va),v=0;v<f.length;v++){var c=f[v];"number"==typeof b.water_fog_density&&d.Qc&&(c.Ld[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&d.Qc&&c.Ld.set(b.water_fog_color);"number"==
typeof b.waves_height&&(c.qg=b.waves_height);"number"==typeof b.waves_length&&(c.Mh=b.waves_length);c.ua=!0}};a.dw=function(a,b){var d=ka(Pa,"MAIN_OPAQUE");if(!d.Gn)return 100;var f=d.Ei,v=d.pg,c=(a[0]-d.eg[0])/d.fg[0],p=(d.eg[1]+a[2])/d.fg[1],c=c+.5,p=p+.5;if(1<c||0>c||1<p||0>p)v=1;else return d=f*Sa.zv(Pa.e.zr,d.Si,c,p),v=(v-a[1])*b,v=Math.sqrt(d*d+v*v)};a.update=function(a,d){for(var f=b().camera.e,c=0;c<Ca.length;c++){var p=Ca[c],e=p.e.ub;if(p.e.qb)var t=f.h[1]-v(f.h[0],f.h[2]);for(var k=p.e.nj,
g=0;g<k.length;g++){var n=k[g].e,r=n.Va,h=n.mi+n.ta;if(r){var l=Math.round(r.currentTime*n.uc),x=n.ta/n.uc;if(l<n.ta-(Ga.$g?5:0)||k[g].e.Gh&&l>h)r.currentTime=x;!n.Gh&&l>h&&r.pause();2<=r.readyState&&!r.paused&&Ab.pJ(n)}else if(n.Qi){r=Math.min(n.Qi.length,n.mi+n.ta);if(n.ef<n.ta||n.Gh&&n.ef>=r)n.ef=n.ta;!n.Gh&&n.ef>=r&&(n.Ri=!1);r=Math.round(a*rc.Pa/n.uc)*n.py;r!=Zb&&n.Ri&&(Ab.mJ(n),n.ef++);Zb=r}}sa.V(e,function(b,d){-1<Ra.indexOf(d.type)&&(d.time=a);p.e.qb&&(d.Go=t)})}for(c=0;c<Ca.length;c++)if(p=
Ca[c],g=p.e,f=g.wh,g.Gm&&(R(p),g.Gm=!1),g.Lq&&(P(p),g.Lq=!1),f.length){p.b4w_enable_motion_blur&&qa(g.ub,d);if(g.outline){for(var m=0,c=0;c<p.ya.MESH.length;c++)g=p.ya.MESH[c],m+=g.e.ee,-1!=La.indexOf(g)&&da(g,a);sa.V(p.e.ub,function(a,b){"OUTLINE"===b.type&&(b.op=m)})}e=null;for(g=0;g<f.length;g++)"OUTLINE_MASK"==f[g].type&&(e=g);for(g=0;g<f.length;g++)k=f[g],mb.Yq(k),null!==e&&S(k,f[e]),oc.Rj(k)}Ga.show_hud_debug_info&&Dc.gI(Ca,d)};a.Jp=function(a){var b=[];sa.V(a.e.ub,function(a,d){b.push(d)});
return b};a.Wh=function(a,b,d,f){a.CB={Wr:0,vx:b,sd:d,fy:f};-1==La.indexOf(a)&&La.push(a)};a.Dj=function(a){a.e.ee=0;a=La.indexOf(a);-1!=a&&La.splice(a,1)};a.kM=function(){La=[]};a.Cv=function(){var a=ka(Pa,"MAIN_BLEND"),b=Pa;return a||b.e.qb?a.Go:null};a.Xv=function(a){return a.e.Oc};a.Ez=Fa;a.aI=function(a,b){switch(b){case "WM_NONE":a.Za=!1;break;case "WM_OPAQUE_WIREFRAME":case "WM_TRANSPARENT_WIREFRAME":case "WM_FRONT_BACK_VIEW":case "WM_DEBUG_SPHERES":for(var d=0;d<a.q.length;d++)a.q[d].B.wireframe_mode=
vc.it[b];a.Za=!0}a.Ja="WM_TRANSPARENT_WIREFRAME"==b;a.ua=!0};a.$H=function(a,b){for(var d=0;d<a.q.length;d++)a.q[d].B.wireframe_edge_color=b,a.ua=!0};a.rt=function(a,b){for(var d=0;d<b.length;d++)a.ya.ALL.push(b[d]),a.ya.MESH.push(b[d])};a.Cz=Ib;a.Um=function(b,d){var f=e();if(!f)return Za.error("No active scene"),null;var v=ka(f,"COLOR_PICKING");if(v){var c=$a.Ho(b,d,Ba,v.j);mb.Yq(v);oc.Rj(v);var p=ka(f,"COLOR_PICKING_XRAY");p?(mb.Yq(p),oc.Rj(p),v=p.j):v=v.j;c[1]=v.height-c[1];p=oc.dy(v.Oe,c[0],
c[1]);c=Y(f,"MESH",a.L);for(v=0;v<c.length;v++){var t=c[v].e,k=t.Nl;if(k&&3>Math.abs(255*k[0]-p[0])&&3>Math.abs(255*k[1]-p[1])&&3>Math.abs(255*k[2]-p[2]))return t.Vb&&t.ux&&(Xb.outlining_overview_mode?(vb(Xb.Wf),t.ee=Xb.ee,a.Wh(c[v],Xb.Lm,Xb.Mm,Xb.Nm)):(vb(f.b4w_outline_color),t.ee=f.b4w_outline_factor,f=t.uk,a.Wh(c[v],f.Lm,f.Mm,f.Nm))),c[v]}}else Za.error("Object Selection is not available on the scene");return null};a.ur=vb;a.DF=function(){return Wa};a.vF=function(b){var d=[];b=Y(b,"MESH",a.L);
for(var f=0;f<b.length;f++){var v=b[f];v.e.Ah&&d.push(v)}return d};a.ek=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.JQ=function(){for(var b=Pa,d=Y(b,"MESH",a.L),f=0;f<d.length;f++)for(var v=d[f].o,c=0;c<v.length;c++){var p=v[c];"MAIN"==p.type&&(X(b,p),la.Qb(p))}};a.Bz=function(a,b){var d=b.e.Kb.G,f=a.e.Nb?a.e.Nb.Ul[b.e.Mc]:null;if(f){var v=za;Fb.negate(d,v);for(d=0;6>d;d++){var c=f.Kj[d],p=f.bp[d],e=f.j;sb.translate(Sa.Zz[d],
v,c);sb.multiply(e.Aa,c,e.pe);Sa.vp(e.pe,p)}}};a.jC=function(a,b){b.e.Nb&&(a.e.Cc=b.e.Nb.Ck[a.e.Xc].j.Cc)};a.Dz=function(a,b){var d=b.e.Nb.an[a],f=b.e.Nb.Ck[a].j;Sa.RI(d.e.h,d.e.quat,Sa.jb,f.Cc);ob.ZH(f,b.camera)};a.gx=function(a,b){return a.timeline_markers[b]}};b4w.module.__batch=function(a,y){function e(a){a={type:a,Qa:"",id:0,lH:0,Ji:"",X:[],fd:[],Rf:[],Gj:[],Jh:null,Gb:{},pc:null,Ob:null,Gt:[],Wc:null,ja:null,pd:null,oe:!1,gi:!1,Pu:!1,wireframe_mode:0,Qq:0,sk:0,Uw:0,Vw:0,qw:0,Wp:0,wc:new Float32Array(3),Lc:new Float32Array(16),Ja:!1,su:!1,da:!1,rf:!1,Sa:!1,Kd:!1,Vd:!1,cd:!1,Fc:!1,Gc:!1,nc:!1,dc:!1,$c:!1,Lb:!1,Tx:!1,Ef:Q.rj,sf:Q.we,Og:!1,ar:"",qQ:"",rw:!1,vw:0,sw:0,ww:0,xw:0,uw:new Float32Array(3),tw:new Float32Array(3),Wg:!1,Rh:0,ki:0,Pj:1,bn:0,dz:0,
Ir:1,Pm:0,Oj:0,xj:1,px:0,Iq:0,ph:0,ey:0,Pc:Array(2),Vi:new Float32Array(3),kg:new Float32Array(3),Rk:new Float32Array(3),Je:new Float32Array(4),Rg:new Float32Array(4),Ai:null,tq:null,rq:null,qq:null,sq:null,ti:!1,Lh:!1,water_dynamic:!1,vs:!1,Pz:!1,Qz:0,Rz:0,Oz:0,Kn:.1,on:0,sn:0,bm:0,jv:new Float32Array(2),iv:new Float32Array(2),Ap:new Float32Array(2),nn:new Float32Array(3),rn:new Float32Array(3),mh:null,gr:!1,Fx:0,Bx:0,Rq:0,Ex:0,Hx:0,Gx:0,Cx:0,Dx:0,Sq:0,yx:0,xx:0,Jx:0,Ax:0,Om:new Float32Array(3),
Ix:new Float32Array(8),zx:new Float32Array(16)};a.Je[3]=1;a.su=!0;a.da=!0;return a}function c(a){switch(a.type){case "MAIN":case "PARTICLES":a.Qa=a.Ja?a.rf?"XRAY":"BLEND":"OPAQUE";break;case "DEPTH":a.Qa=a.ti?"NODES":"DEPTH";break;case "COLOR_ID":a.Qa=a.rf?"COLOR_ID_XRAY":"COLOR_ID"}}function b(a){var b=a.ja,d=a.Wc;a.ja=null;a.Wc=null;var f=U.vu(a);a.ja=b;f.ja=b;a.Wc=d;f.Wc=d;return f}function h(a,b){for(var d=[],f=0;f<a.length;f++){var c=a[f],e=c.e,t=u(c.data.b4w_bounding_box),k=c.data.b4w_bounding_cylinder_radius,
g=c.data.b4w_bounding_sphere_radius,n=c.data.b4w_bounding_sphere_center,r=c.data.b4w_bounding_ellipsoid_axes,h=c.data.b4w_bounding_ellipsoid_center;if(e.Sd){var g=Math.max(Math.abs(t.max_x),Math.abs(t.min_x)),k=Math.max(Math.abs(t.max_y),Math.abs(t.min_y)),l=Math.max(Math.abs(t.max_z),Math.abs(t.min_z)),l=Math.sqrt(g*g+k*k+l*l),g=Math.sqrt(g*g+k*k);t.max_x=t.max_y=t.max_z=l;t.min_x=t.min_y=t.min_z=-l;k=g;g=l;n[0]=n[1]=n[2]=0;r[0]=r[1]=r[2]=l;h[0]=h[1]=h[2]=0}e.hc=t;l=p.zo(t,e.Z);e.sb=l;var l=e,x=
k;l.to=p.zu(x,t);l.ro=p.xu(k,t);l.so=p.yu(x,t);n=p.Vo(g,n);e.xd=n;n=p.Bo(n,e.Z);e.Kb=n;r=p.Uo([r[0],0,0],[0,r[1],0],[0,0,r[2]],h);e.Bg=r;r=p.Ao(r,e.Pb);e.Cg=r;d=d.concat(q(c,e,b))}return d}function m(a,b,d){for(var f=[],c=[],e={},t=0;t<a.length;t++){var k=a[t],g=k.e,n=u(k.data.b4w_bounding_box),h=p.zo(n,g.Z),l=p.Vo(k.data.b4w_bounding_sphere_radius,k.data.b4w_bounding_sphere_center),x=p.Bo(l,g.Z),m=k.data.b4w_bounding_ellipsoid_axes,m=p.Uo([m[0],0,0],[0,m[1],0],[0,0,m[2]],k.data.b4w_bounding_ellipsoid_center),
N=p.Ao(m,g.Pb);g.hc=n;g.sb=h;g.xd=l;g.Kb=x;g.Bg=m;g.Cg=N;n={};n.cd=g.cd;n.Fc=g.Fc;n.Gc=g.Gc;n.Ah=g.Ah;n.Km=g.Km;n.Vb=g.Vb;n.Jm=g.Jm;n.uk=g.uk;n.nc=g.nc;n.dc=g.dc;n.$c=g.$c;n.Mc=g.Mc;n.Xc=g.Xc;n.af=g.af;n.Ee=g.Ee;n.kd=g.kd;n.Ye=g.Ye;n.Zb=g.Zb;n.Sd=g.Sd;n.Aj=g.Aj;n.zj=g.zj;n.Lb=g.Lb;n.ii=g.ii;n.Xl=g.Xl;n.Tf=g.Tf;n.jh=g.jh;n.Cm=g.Cm;n.de=g.de;n.ih=g.ih;n.Dm=g.Dm;n.Vd=g.Vd;h=g.Kb.G;n.FF=0==d?[0,0]:[Math.floor(h[0]/d),Math.floor(h[2]/d)];n.Qf=g.Qf;n.pk=g.pk;n.hh=g.hh;g=JSON.stringify(n);e[g]=e[g]||[];
e[g].push(k)}for(var J in e){n=JSON.parse(J);d=e[J];var k=U.Rl("STATIC"),z;for(z in n)k[z]=n[z];k.Oc=a[0].e.Oc;k.qe=0;k.qf=0;k.Ie=0;k.He=0;k.Ce=0;k.ui=!1;for(t=0;t<d.length;t++)g=d[t],0==t?(k.sb=O.sa(g.e.sb),k.Kb=O.sa(g.e.Kb),k.Bg=O.sa(g.e.Bg),k.Cg=O.sa(g.e.Cg)):(p.av(k.sb,g.e.sb),p.pE(k.Kb,g.e.Kb));k.hc=O.sa(k.sb);k.xd=O.sa(k.Kb);c.push({oc:k,$e:d})}for(a=0;a<c.length;a++)for(e=c[a].oc,t=c[a].$e,J=0;J<t.length;J++){z=t[J];d=q(z,e,b);z.e.Sd&&!z.e.wo?(k=Y.create(),Y.ln(z.e.h,k)):(k=z.e,k=Y.Cf(k.h,
k.scale,k.quat));g={};if(e.kd||e.Sd)g.au_center_pos=[k[0],k[1],k[2]];e.kd&&(g.au_wind_bending_amp=[z.e.qe],g.au_wind_bending_freq=[z.b4w_wind_bending_freq],g.au_detail_bending_amp=[z.b4w_detail_bending_amp],g.au_detail_bending_freq=[z.b4w_detail_bending_freq],g.au_branch_bending_amp=[z.b4w_branch_bending_amp]);for(n=0;n<d.length;n++)x=d[n].oc,h=d[n].ed,l=d[n].B,x.xm?x.Sd?Q.DI(h,k):Q.mz(h,k):("COLOR_ID"==l.type&&(x=d[n].oc=z.e,l.Ji=z.uuid,r(l,x),E(l,O.Zh(x,0))),h=Q.mz(h,k),Q.CI(h,g));f=f.concat(d)}return f}
function q(a,b,f){var c=[],p=w(f,b),t=O.Zh(b,0),k=a.data,n=k.materials,h=Array(n.length),l=ba.Oa(f,"MAIN_OPAQUE"),x=!1;l&&(x=l.Pf.length?!0:!1);for(var m=0;m<p.length;m++){var J=p[m];if(!a.b4w_do_not_render||"PHYSICS"==J)for(var z=0;z<n.length;z++){var u=n[z];if(("LENS_FLARES"!=u.name||x)&&!Q.zw(k,z)){var q=e(J);"MAIN"==J&&(h[z]=q);if(I(q,u)){"DEPTH"==J&&h[z]&&(q.Kd=h[z].Kd);q.Ef=b.oe||b.Vd?Q.il:Q.rj;r(q,b);for(var K=q,L=a.particle_systems,A=0;A<L.length;A++){var M=L[A].settings.b4w_vcol_from_name,
C=L[A].settings.b4w_vcol_to_name;""!==M&&""!==C&&(K.Gb[M]={Sg:!1,src:[{name:M,rd:7}]})}"DYNAMIC"==b.type&&(q.Ji=a.uuid);E(q,t);var H=Q.ev(k,z,q.Gj,q.pd,q.Gb,q.Jh);"LENS_FLARES"==u.name&&(H=ha.ZG(H));c.push({B:q,ed:H,zc:[u.name],oc:b,Ed:[a]})}}}}var T=a.particle_systems;if(0<T.length&&c.length){for(var F=!1,y=!1,m=0;m<T.length;m++){var D=T[m],G=D.settings;G.use_render_emitter&&(F=!0);"HAIR"!=G.type||"OBJECT"!=G.render_type&&"GROUP"!=G.render_type&&D.transforms.length||(y=!0);if(F&&y)break}var X=c[0].B.Gb,
wa;if(y){var ia;if(1<n.length){for(var U={},Ab=0;Ab<T.length;Ab++){var R=T[Ab].settings;if("HAIR"==R.type&&("OBJECT"==R.render_type||"GROUP"==R.render_type)){var aa=R.b4w_vcol_from_name,sb=R.b4w_vcol_to_name;""!==aa&&""!==sb&&(U[aa]=O.sa(X[aa]))}}"a_bending_col_main"in X&&(U.a_bending_col_main=O.sa(X.a_bending_col_main));"a_bending_col_detail"in X&&(U.a_bending_col_detail=O.sa(X.a_bending_col_detail));ia=Q.fv(k,[],U)}else ia=c[0].ed;wa=ia}else wa=null;for(var Y,na=wa,bb=[],ea=a.particle_systems,ka=
a.data,Z=0;Z<ea.length;Z++){var cb=ea[Z],Ha=cb.settings;if(Ha.count)if("EMITTER"==Ha.type){if("DYNAMIC"==b.type){var fb=e("PARTICLES"),Ra,Va=ka.materials,Zb=cb.settings.material-1;Zb>=Va.length&&(N.warn('Wrong material used for rendering particle system "'+cb.name+'"'),Zb=0);Ra=Va[Zb];"HALO"===cb.settings.render_type&&(fb.Wg=!0);g(fb,Ra);r(fb,b);var nb=fb,Pa=cb.settings;switch(Pa.b4w_billboard_align){case "VIEW":d(nb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":d(nb,"BILLBOARD_ALIGN",
"BILLBOARD_ALIGN_XY");break;case "YZ":d(nb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":d(nb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:throw"Wrong billboard align value";}d(nb,"BILLBOARD",0);d(nb,"SOFT_PARTICLES",Pa.b4w_enable_soft_particles&&0<Pa.b4w_particles_softness&&ca.Nj?1:0);d(nb,"SOFT_STRENGTH",V.O(Pa.b4w_particles_softness));V.F(nb.Ob,"WORLD_SPACE","WORLD"==Pa.b4w_coordinate_system?1:0);fb.Vd=!0;fb.Ji=a.name+"_"+Ha.uuid;fb.ar=cb.name;E(fb,t);fb.Wc=cb;var Ca=ha.LE(fb,
ka,cb,a.e.Pb);ha.KH(fb,cb,Ra);bb.push({B:fb,ed:Ca,zc:[Ra.name],oc:b,Ed:[a]})}}else if("HAIR"==Ha.type){var jb=O.rm(cb.seed);Ha.b4w_dynamic_grass&&(b.ii=!0);var La=oa.gu(ca.Bq)&&!Ha.b4w_initial_rand_rotation&&!Ha.b4w_hair_billboard,Ka=4;La&&(Ka=8);if(cb.transforms.length)var Ba=cb.transforms;else for(var za=Q.Ip(na,Ha.count,!1,jb),Ba=new Float32Array(za.length*Ka),ra=0;ra<za.length;ra++){var Mb=.75+.5*O.td(jb);Ba[ra*Ka]=za[ra][0];Ba[ra*Ka+1]=za[ra][1];Ba[ra*Ka+2]=za[ra][2];Ba[ra*Ka+3]=Mb;La&&(Ba[ra*
Ka+4]=1,Ba[ra*Ka+5]=0,Ba[ra*Ka+6]=0,Ba[ra*Ka+7]=0)}var jc=ba.Oa(f,"GRASS_MAP")?!0:!1;if("OBJECT"==Ha.render_type)var ya=[w(f,Ha.dupli_object.e,!0)],Yb=B(a,b,X,na,[Ha.dupli_object],ya,[Ba],Ha,cb,jc,jb,!1),bb=bb.concat(Yb);else if("GROUP"==Ha.render_type){for(var W=Ha.dupli_group.objects,Rb=!1,ya=[],ra=0;ra<W.length;ra++){var Wa=w(f,Ha.dupli_group.objects[ra].e,!0);ya.push(Wa)}if(Ha.use_whole_group){for(var Aa,ua=Ba,Wb=W,qc=La,pb=Ka,Qa={},rb=new Float32Array([0,0,0,1]),Ia=0;Ia<ua.length;Ia+=pb)for(var ib=
0;ib<Wb.length;ib++){var ic=pa.create();pa.scale(Wb[ib].e.h,Wb[ib].e.scale,ic);var Jb=pa.clone([ua[Ia],ua[Ia+1],ua[Ia+2]]);Qa[ib]||(Qa[ib]=new Float32Array(ua.length));qc&&(Qa[ib][Ia+4]=rb[0]=ua[Ia+4],Qa[ib][Ia+5]=rb[1]=ua[Ia+5],Qa[ib][Ia+6]=rb[2]=ua[Ia+6],Qa[ib][Ia+7]=rb[3]=ua[Ia+7],O.br(rb,rb),O.SI(ic,rb,ic));pa.add(Jb,ic,Jb);Qa[ib][Ia]=Jb[0];Qa[ib][Ia+1]=Jb[1];Qa[ib][Ia+2]=Jb[2];Qa[ib][Ia+3]=ua[Ia+3]}Aa=Qa;Rb=!0}else{var ab;if(Ha.use_group_count){for(var Kb=Ba,Ec=W,Lb=Ha.dupli_weights,Fc=jb,Ua=
La,eb=Ka,qb={},Sb=[],gb=0;gb<Ec.length;gb++)for(var Tb=Ec[gb],Gb=Tb.origin_name||Tb.name,kc=0;kc<Lb.length;kc++){var ta=Lb[kc];Gb==ta.name.split(": ")[0]&&Sb.push(ta)}Lb.length!=Sb.length&&N.error("dupli weights match failed");for(gb=0;gb<Kb.length;gb+=eb){for(var Ta,Xa=Sb,$b=[0],Da=0;Da<Xa.length;Da++)$b[Da+1]=$b[Da]+Xa[Da].count;for(var wc=$b[$b.length-1]*O.td(Fc),wb=0,Da=0;Da<$b.length;Da++)if(wc>=$b[Da]&&wc<$b[Da+1]){wb=Da;break}Ta=wb;qb[Ta]=qb[Ta]||[];qb[Ta].push(Kb[gb],Kb[gb+1],Kb[gb+2],Kb[gb+
3]);Ua&&qb[Ta].push(Kb[gb+4],Kb[gb+5],Kb[gb+6],Kb[gb+7])}for(Ta in qb)qb[Ta]=new Float32Array(qb[Ta]);ab=qb}else{for(var Ma=Ba,kb=jb,Ub=La,Bb=Ka,xc=W.length,tb={},lb=0;lb<Ma.length;lb+=Bb){var Cb=Math.floor(xc*O.td(kb));tb[Cb]=tb[Cb]||[];tb[Cb].push(Ma[lb],Ma[lb+1],Ma[lb+2],Ma[lb+3]);Ub&&tb[Cb].push(Ma[lb+4],Ma[lb+5],Ma[lb+6],Ma[lb+7])}for(Cb in tb)tb[Cb]=new Float32Array(tb[Cb]);ab=tb}Aa=ab}Yb=B(a,b,X,na,W,ya,Aa,Ha,cb,jc,jb,Rb);bb=bb.concat(Yb)}"INSTANCE"==Ha.b4w_wind_bend_inheritance&&a.e.kd&&N.warn('Emitter object "'+
a.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else throw"Unknown particle settings type";}Y=bb;c=F?c.concat(Y):Y}return c}function u(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}}function w(a,b,d){var f=["MAIN","NODES_GLOW"];(b.Ah&&ba.Oa(a,"COLOR_PICKING")||b.Vb&&ba.Oa(a,"OUTLINE_MASK"))&&!d&&f.push("COLOR_ID");ba.Oa(a,"WIREFRAME")&&
f.push("WIREFRAME");f.push("PHYSICS");(ba.Oa(a,"DEPTH")||ba.Oa(a,"SHADOW_CAST"))&&f.push("DEPTH");ba.Oa(a,"GRASS_MAP")&&f.push("GRASS_MAP");if(b.Fc||b.dc)for(a=null,b.Fc&&(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","WIREFRAME"]),b.dc&&(b=["COLOR_ID","PHYSICS","DEPTH","WIREFRAME"],a=null!==a?O.dC(a,b):b),b=a,a=0;a<b.length;a++)d=f.indexOf(b[a]),-1!==d&&f.splice(d,1);return f}function g(a,b){var f;switch(a.type){case "MAIN":if(b.b4w_do_not_render)f=!1;else{if(b.use_nodes)x(a,b,"MAIN");else{z(a,b);
var c=b.game_settings.alpha_blend;a.rf=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.ph=b.offset_z;a.kg.set([1,1,1]);var p=b.texture_slots;na.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Je);switch(b.name){case "LENS_FLARES":K(a,"special_lens_flares.glslv","special_lens_flares.glslf");k(a,"a_position");k(a,"a_texcoord");var e=C(p[0],null);J(a,e);break;default:K(a,"main.glslv","main.glslf");var t=F("use_map_color_diffuse",p),g=F("use_map_color_spec",p),n=F("use_map_normal",
p),r=F("use_map_mirror",p),e=F("use_stencil",p);f=t[0];g=g[0];n=n[0];r=r[0];t=t[1];p=e[0]&&F("use_rgb_to_intensity",p)[0];if(f){switch(f.blend_type){case "MIX":d(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":d(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e=C(f,null);J(a,e,"u_colormap0");ca.io&&"CLIP"==c&&aa.Nk(e,aa.Hc,aa.Hc);a.Oj=f.diffuse_color_factor;a.xj=f.use_map_alpha?f.alpha_factor:0;a.kg.set(f.scale)}c=f&&f==g;g&&(c||(e=C(g,null),J(a,e,"u_specmap0")),a.dz=
g.specular_color_factor);if(n&&(k(a,"a_normal"),k(a,"a_tangent"),e=C(n,null),J(a,e,"u_normalmap0"),a.px=n.normal_factor,e=n.texture,e.b4w_use_map_parallax&&ca.yk)){var h=V.O(e.b4w_parallax_steps),m=V.O(e.b4w_parallax_lod_dist);d(a,"PARALLAX",1);d(a,"PARALLAX_STEPS",h);d(a,"PARALLAX_LOD_DIST",m);a.Pm=e.b4w_parallax_scale}r&&(e=C(r,null),J(a,e,"u_mirrormap"),a.Iq=r.mirror_factor);if(r=f&&t&&p?1:0)e=C(t,null),J(a,e,"u_colormap1"),e=C(p,null),J(a,e,"u_stencil0");(e=f||g||n)&&a.kg.set(e.scale);d(a,"TEXTURE_SPEC",
void 0==g?0:1);d(a,"ALPHA_AS_SPEC",c?1:0);d(a,"TEXTURE_STENCIL_ALPHA_MASK",r);k(a,"a_position");k(a,"a_normal");(f||g||n)&&k(a,"a_texcoord");if(b.b4w_water){a.Lh=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.Ja?(N.warn('Material: "'+b.name+'" is opaque.',"Disabling shore smoothing."),a.vs=!1):a.vs=b.b4w_water_shore_smoothing;K(a,"special_water.glslv","special_water.glslf");k(a,"a_position");ca.Sz?(k(a,"a_polyindex"),a.da=!0,a.wireframe_edge_color=[0,0,0],d(a,"DEBUG_WIREFRAME",
1)):d(a,"DEBUG_WIREFRAME",0);c=b.texture_slots;r=F("use_map_normal",c);e=F("use_map_mirror",c)[0];r.length&&(h=C(r[0]),J(a,h,"u_normalmap0"),a.Kn=b.b4w_water_norm_uv_velocity);d(a,"NUM_NORMALMAPS",r.length);a.mh=Array(r.length);for(h=0;h<r.length;h++)a.mh[h]=new Float32Array(2),a.mh[h].set([r[h].scale[0],r[h].scale[1]]);e&&(h=C(e),J(a,h,"u_mirrormap"),a.Iq=e.mirror_factor);e=null;if(ca.Xj)for(h=0;h<c.length;h++){var E=c[h];if(!0===E.texture.b4w_water_foam){e=E;break}}e?(d(a,"FOAM",1),h=C(e),J(a,h,
"u_foam"),a.bm=b.b4w_foam_factor,a.jv.set(e.texture.b4w_foam_uv_freq),a.iv.set(e.texture.b4w_foam_uv_magnitude),a.Ap[0]=e.scale[0],a.Ap[1]=e.scale[1]):d(a,"FOAM",0);for(h=0;h<c.length;h++)if(E=c[h],!0===E.texture.b4w_shore_dist_map){var q=E;break}q&&ca.eo?(q=C(q),J(a,q,"u_shore_dist_map"),d(a,"SHORE_PARAMS",1),q=E.texture.b4w_shore_boundings,d(a,"MAX_SHORE_DIST",V.O(E.texture.b4w_max_shore_dist)),d(a,"SHORE_MAP_SIZE_X",V.O(q[0]-q[1])),d(a,"SHORE_MAP_SIZE_Y",V.O(q[2]-q[3])),d(a,"SHORE_MAP_CENTER_X",
V.O((q[0]+q[1])/2)),d(a,"SHORE_MAP_CENTER_Y",V.O((q[2]+q[3])/2))):d(a,"SHORE_PARAMS",0);if(b.b4w_generated_mesh&&ca.Nj)d(a,"GENERATED_MESH",1),a.Pz=!0,a.Qz=b.b4w_water_num_cascads,a.Rz=b.b4w_water_subdivs,a.Oz=b.b4w_water_detailed_dist;else{k(a,"a_normal");if(e||r.length)k(a,"a_texcoord"),k(a,"a_tangent");d(a,"GENERATED_MESH",0)}if(b.b4w_water_dynamic){var E=V.O(b.b4w_water_dst_noise_scale0),q=V.O(b.b4w_water_dst_noise_scale1),r=V.O(b.b4w_water_dst_noise_freq0),c=V.O(b.b4w_water_dst_noise_freq1),
e=V.O(b.b4w_water_dir_min_shore_fac),h=V.O(b.b4w_water_dir_freq),m=V.O(b.b4w_water_dir_noise_scale),u=V.O(b.b4w_water_dir_noise_freq),L=V.O(b.b4w_water_dir_min_noise_fac),w=V.O(b.b4w_water_dst_min_fac),B=V.O(b.b4w_water_waves_hor_fac);d(a,"DST_NOISE_SCALE_0",E);d(a,"DST_NOISE_SCALE_1",q);d(a,"DST_NOISE_FREQ_0",r);d(a,"DST_NOISE_FREQ_1",c);d(a,"DIR_MIN_SHR_FAC",e);d(a,"DIR_FREQ",h);d(a,"DIR_NOISE_SCALE",m);d(a,"DIR_NOISE_FREQ",u);d(a,"DIR_MIN_NOISE_FAC",L);d(a,"DST_MIN_FAC",w);d(a,"WAVES_HOR_FAC",
B)}D(a,b);H(a,b);a.nn.set(b.b4w_shallow_water_col);a.rn.set(b.b4w_shore_water_col);a.on=b.b4w_shallow_water_col_fac;a.sn=b.b4w_shore_water_col_fac;d(a,"ABSORB",V.O(b.b4w_water_absorb_factor));d(a,"SSS_STRENGTH",V.O(b.b4w_water_sss_strength));d(a,"SSS_WIDTH",V.O(b.b4w_water_sss_width))}"HALO"===b.type&&(E=b.halo,K(a,"halo.glslv","halo.glslf"),d(a,"NUM_RINGS",E.ring_count),d(a,"NUM_LINES",E.line_count),d(a,"NUM_STARS",E.star_tip_count),d(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0),a.Gj=["a_position"],a.vw=
E.size,a.sw=E.hardness/20,a.uw.set(E.b4w_halo_rings_color),a.tw.set(E.b4w_halo_lines_color),a.ww=1/b.b4w_halo_stars_blend_height,a.xw=b.b4w_halo_stars_min_height,a.rw=!0);d(a,"TEXCOORD",0);d(a,"NORMAL_TEXCOORD",0);f&&l(a,f,"TEXTURE_COLOR0_CO");t&&l(a,t,"TEXTURE_COLOR1_CO");p&&l(a,p,"TEXTURE_STENCIL_ALPHA_MASK_CO");g&&l(a,g,"TEXTURE_SPEC_CO");n&&l(a,n,"TEXTURE_NORM_CO");d(a,"SHADELESS",b.use_shadeless?1:0);a.Kd=b.use_shadeless}c=b.game_settings.alpha_blend;d(a,"ALPHA","OPAQUE"===c?0:1);d(a,"ALPHA_CLIP",
"CLIP"===c?1:0);d(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);b.use_vertex_color_paint?(d(a,"VERTEX_COLOR",1),k(a,"a_color")):d(a,"VERTEX_COLOR",0);a.Rh=b.ambient;a.Pj=b.diffuse_intensity;a.ki=b.emit;a.Rk.set(b.specular_color);a.Ir=b.specular_alpha;D(a,b);H(a,b);b.b4w_wettable?d(a,"WETTABLE",1):d(a,"WETTABLE",0);G(a,b);a.gr=b.b4w_refractive;a.ey=b.b4w_refr_bump}f=!0}break;case "NODES_GLOW":f=x(a,b,"GLOW");break;case "DEPTH":if("LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||
"HALO"===b.type)f=!1;else if(z(a,b),a.Ja)f=!1;else{g=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==g?x(a,b,"DEPTH"):K(a,"depth.glslv","depth.glslf");k(a,"a_position");k(a,"a_normal");d(a,"ALPHA","OPAQUE"===g?0:1);a.kg.set([1,1,1]);if((f=F("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===g){a.kg.set(f.scale);d(a,"TEXTURE_COLOR",1);k(a,"a_texcoord");if("IMAGE"==f.texture.e.source||"ENVIRONMENT_MAP"==f.texture.e.source)g=C(f),J(a,g,"u_colormap0");"NONE"==f.texture.e.source&&(g=C(f),J(a,g,"u_colormap0"))}else d(a,
"TEXTURE_COLOR",0);f=!0}break;case "PHYSICS":b.b4w_collision?(a.tJ=b.b4w_use_ghost,a.Ya=b.b4w_collision_id,a.qu=b.b4w_collision_margin,a.pu=b.b4w_collision_group,a.ru=b.b4w_collision_mask,a.$j=b.physics.friction,a.Tj=b.physics.elasticity,f=!0):b.b4w_water?(a.Lh=!0,a.LJ=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,
a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,f=!0):f=!1;break;case "COLOR_ID":if("LENS_FLARES"===b.name||b.b4w_do_not_render||"HALO"===b.type)f=!1;else{z(a,b);a.sf=Q.we;a.da=!0;a.Ja=!1;g=b.game_settings.alpha_blend;a.rf=b.b4w_render_above_all&&"OPAQUE"!=g&&"CLIP"!=g;b.use_nodes&&"CLIP"==g?x(a,
b,"COLOR_ID"):K(a,"color_id.glslv","color_id.glslf");k(a,"a_position");d(a,"ALPHA","OPAQUE"===g?0:1);a.kg.set([1,1,1]);if((f=F("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===g){a.kg.set(f.scale);d(a,"TEXTURE_COLOR",1);k(a,"a_texcoord");if("IMAGE"==f.texture.e.source||"ENVIRONMENT_MAP"==f.texture.e.source)g=C(f),J(a,g,"u_colormap0");"NONE"==f.texture.e.source&&(g=C(f),J(a,g,"u_colormap0"))}else d(a,"TEXTURE_COLOR",0);f=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?f=!1:(z(a,
b),a.Ja=!1,a.sf=Q.we,a.da=!0,K(a,"grass_map.glslv","grass_map.glslf"),k(a,"a_position"),f=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,g=b.b4w_dynamic_grass_color?b.b4w_dynamic_grass_color:null,a.Gb.a_grass_size={Sg:!0,src:[]},f?(a.Gb.a_grass_size.src.push({name:f,rd:4}),d(a,"DYNAMIC_GRASS_SIZE",1)):d(a,"DYNAMIC_GRASS_SIZE",0),a.Gb.a_grass_color={Sg:!0,src:[]},g?(a.Gb.a_grass_color.src.push({name:g,rd:7}),d(a,"DYNAMIC_GRASS_COLOR",1)):d(a,"DYNAMIC_GRASS_COLOR",0),f=!0);break;case "WIREFRAME":"LENS_FLARES"===
b.name||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type?f=!1:(K(a,"wireframe.glslv","wireframe.glslf"),k(a,"a_position"),k(a,"a_normal"),k(a,"a_polyindex"),a.da=!0,a.wireframe_mode=0,a.wireframe_edge_color=[0,0,0],f=!0);break;case "PARTICLES":if(b.b4w_do_not_render)f=!1;else{f=b.texture_slots;if(a.Wg)K(a,"particles_color.glslv","particles_color.glslf");else if(K(a,"particles_texture.glslv","particles_texture.glslf"),f=F("use_map_color_diffuse",f)[0]){d(a,"TEXTURE_COLOR",1);switch(f.blend_type){case "MIX":d(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":d(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Oj=f.diffuse_color_factor;a.xj=f.use_map_alpha?f.alpha_factor:0;f=C(f);J(a,f)}na.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Je);a.Rh=b.ambient;a.Pj=b.diffuse_intensity;a.ki=b.emit;a.Rk.set(b.specular_color);a.Ir=b.specular_alpha;k(a,"a_position");k(a,"a_normal");f=b.game_settings.alpha_blend;d(a,"ALPHA","OPAQUE"===f?0:1);d(a,"ALPHA_CLIP","CLIP"===
f?1:0);d(a,"PARTICLES_SHADELESS",b.use_shadeless?1:0);D(a,b);H(a,b);z(a,b);f=b.game_settings.alpha_blend;a.rf=b.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f;a.ph=b.offset_z;f=!0}break;default:throw"Wrong batch type: "+a.type;}return f}function l(a,b,f){switch(b.texture_coords){case "UV":case "ORCO":d(a,f,"TEXTURE_COORDS_UV_ORCO");d(a,"TEXCOORD",1);break;case "NORMAL":d(a,f,"TEXTURE_COORDS_NORMAL");d(a,"NORMAL_TEXCOORD",1);break;default:d(a,f,0)}}function z(a,b){var d=b.game_settings,f=d.alpha_blend;
switch(f){case "ALPHA_SORT":a.Ja=!0;a.sf=Q.jt;a.da=!0;break;case "ALPHA":a.Ja=!0;a.sf=Q.we;a.da=!0;break;case "CLIP":a.Ja=!1;a.sf=Q.we;a.da=!0;break;case "ADD":a.Ja=!0;a.sf=Q.we;a.da=!1;break;case "OPAQUE":a.Ja=!1;a.sf=Q.we;a.da=!0;break;default:throw Error("Unknown alpha blend mode: "+f);}a.Sa=d.use_backface_culling}function C(a,b){var d=a.texture,f=d.e,d=d.image;f&&b&&d&&aa.Wk(f,b,d.Ic,d.filepath);return f}function F(a,b){for(var d=[],f=b.length,c=0;c<f;c++){var p=b[c];1==p[a]&&p.texture&&p.texture.e&&
d.push(p)}return d}function G(a,b){var d=b.raytrace_transparency;a.Rg[0]=d.fresnel;a.Rg[1]=1-d.fresnel_factor/5;d=b.raytrace_mirror;a.bn=d.reflect_factor;a.Rg[2]=d.fresnel;a.Rg[3]=1-d.fresnel_factor/5}function D(a,b){var f,c=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":d(a,"SPECULAR_SHADER","SPECULAR_PHONG");f=b.specular_hardness;break;case "WARDISO":d(a,"SPECULAR_SHADER","SPECULAR_WARDISO");f=b.specular_slope;break;case "TOON":d(a,"SPECULAR_SHADER","SPECULAR_TOON");f=b.specular_toon_size;
c=b.specular_toon_smooth;break;case "BLINN":d(a,"SPECULAR_SHADER","SPECULAR_BLINN");f=b.specular_ior;c=b.specular_hardness;break;default:N.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),f=b.specular_hardness}a.Vi[0]=b.specular_intensity;a.Vi[1]=f;a.Vi[2]=c}function H(a,b){switch(b.diffuse_shader){case "LAMBERT":d(a,"DIFFUSE_SHADER","DIFFUSE_LAMBERT");a.Pc[0]=0;a.Pc[1]=0;break;case "OREN_NAYAR":d(a,"DIFFUSE_SHADER","DIFFUSE_OREN_NAYAR");a.Pc[0]=b.roughness;a.Pc[1]=
0;break;case "FRESNEL":d(a,"DIFFUSE_SHADER","DIFFUSE_FRESNEL");a.Pc[0]=b.diffuse_fresnel;a.Pc[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":d(a,"DIFFUSE_SHADER","DIFFUSE_MINNAERT");a.Pc[0]=b.darkness;a.Pc[1]=0;break;case "TOON":d(a,"DIFFUSE_SHADER","DIFFUSE_TOON");a.Pc[0]=b.diffuse_toon_size;a.Pc[1]=b.diffuse_toon_smooth;break;default:N.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.Pc[0]=0,a.Pc[1]=0}}function x(a,b,f){if(!b.use_nodes||b.b4w_do_not_render)return!1;
var c;switch(f){case "MAIN":K(a,"main.glslv","main.glslf");c=!1;break;case "GLOW":K(a,"main.glslv","main.glslf");c=!0;break;case "DEPTH":K(a,"depth.glslv","depth.glslf");c=!1;break;case "COLOR_ID":K(a,"color_id.glslv","color_id.glslf"),c=!1}f=ia.bD(b.node_tree,b.uuid,!1,b.name,f);if(!f)return N.error('Failed to create node graph for material "'+b.name+'", disable nodes'),A(a,b),!0;a.ti=!0;d(a,"NODES",1);d(a,"NODES_GLOW",c?1:0);var p=b.game_settings.alpha_blend;d(a,"ALPHA","OPAQUE"===p?0:1);d(a,"ALPHA_CLIP",
"CLIP"===p?1:0);d(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);k(a,"a_position");b.use_orco_tex_coord&&k(a,"a_orco_tex_coord");z(a,b);a.ph=b.offset_z;p=b.game_settings.alpha_blend;a.rf=b.b4w_render_above_all&&"OPAQUE"!=p&&"CLIP"!=p;na.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Je);a.ki=b.emit;a.Rh=b.ambient;G(a,b);b.b4w_wettable?d(a,"WETTABLE",1):d(a,"WETTABLE",0);a.Ob.Nq=ia.cD(f);var e=!1;X.V(f,function(b,f){switch(f.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var c=
f.data.name,t=f.data.value;a.Jh||(a.Jh={});a.Jh[t]=c;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":c=f.data.name;a.Gb[c]={Sg:!0,src:[{name:f.data.value}]};t=0;if("GEOMETRY_VC"==f.type)t=7;else for(var g=0;g<f.Ea.length;g++){var n="RGB".indexOf(f.Ea[g].identifier);-1<n&&(t|=1<<2-n)}a.Gb[c].src[0].rd=t;break;case "TEX_COORD_NO":case "GEOMETRY_NO":k(a,"a_normal");break;case "MATERIAL":case "MATERIAL_EXT":c=f.data.value;k(a,"a_normal");d(a,"DIFFUSE_SHADER","DIFFUSE_"+
c.bE);d(a,"SPECULAR_SHADER","SPECULAR_"+c.sI);d(a,"SHADELESS_MAT",c.Kd?1:0);a.Kd=c.Kd;e=!0;break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":c=f.data.name;t=f.data.value;!1!==t.e.wl&&(t.e.wl="TEXTURE_ENVIRONMENT"!=f.type?!0:!1);J(a,t.e,c);ca.io&&"CLIP"==p&&aa.Nk(f.data.value.e,aa.Hc,aa.Hc);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":d(a,"CALC_TBN_SPACE",1);k(a,"a_normal");k(a,"a_tangent");c=f.data.name;t=f.data.value;t.e.wl=!1;J(a,t.e,c);break;case "LAMP":f.data&&(a.Ai=f.data);break;case "B4W_REFRACTION":a.gr=
!0}});e||(a.Kd=!0);return!0}function A(a,b){switch(a.type){case "DEPTH":K(a,"depth.glslv","depth.glslf");break;case "COLOR_ID":K(a,"color_id.glslv","color_id.glslf");break;default:K(a,"main.glslv","main.glslf")}d(a,"SHADELESS",1);k(a,"a_position");k(a,"a_normal");na.set(1,0,1,1,a.Je);if(b){var f=b.game_settings.alpha_blend;d(a,"ALPHA","OPAQUE"===f?0:1);d(a,"ALPHA_CLIP","CLIP"===f?1:0);d(a,"VERTEX_COLOR",0);a.ph=b.offset_z;z(a,b)}return!0}function r(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.xm?
d(a,"AU_QUALIFIER","attribute"):d(a,"AU_QUALIFIER","uniform"),d(a,"STATIC_BATCH",0)):(d(a,"AU_QUALIFIER","attribute"),d(a,"STATIC_BATCH",1));"WIREFRAME"==a.type&&(T.xF()?d(a,"WIREFRAME_QUALITY",1):d(a,"WIREFRAME_QUALITY",0),a.gi?(d(a,"DEBUG_SPHERE",1),a.Pu?d(a,"DEBUG_SPHERE_DYNAMIC",1):d(a,"DEBUG_SPHERE_DYNAMIC",0)):d(a,"DEBUG_SPHERE",0),d(a,"ALPHA",1));b.oe&&(a.oe=b.oe);b.kd?(""!==b.Ye?(a.Gb.a_bending_col_main={Sg:!0,src:[{name:b.Ye,rd:4}]},k(a,"a_bending_col_main"),""!==b.Zb.$w&&""!==b.Zb.Zw&&""!==
b.Zb.wx?(a.Gb.a_bending_col_detail={Sg:!0,src:[{name:b.Zb.$w,rd:4},{name:b.Zb.Zw,rd:2},{name:b.Zb.wx,rd:1}]},k(a,"a_bending_col_detail"),k(a,"a_normal"),d(a,"DETAIL_BEND",1)):d(a,"DETAIL_BEND",0),d(a,"MAIN_BEND_COL",1)):d(a,"MAIN_BEND_COL",0),d(a,"WIND_BEND",1)):d(a,"WIND_BEND",0);b.El?d(a,"BEND_CENTER_ONLY",1):d(a,"BEND_CENTER_ONLY",0);d(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.wo|0);b.Sd?d(a,"BILLBOARD",1):d(a,"BILLBOARD",0);b.Sd&&b.xm?d(a,"HAIR_BILLBOARD",1):d(a,"HAIR_BILLBOARD",0);b.zj?d(a,"BILLBOARD_SPHERICAL",
1):d(a,"BILLBOARD_SPHERICAL",0);switch(b.Aj){case "RANDOM":d(a,"BILLBOARD_RANDOM",1);d(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":d(a,"BILLBOARD_RANDOM",0);d(a,"BILLBOARD_JITTERED",1);break;default:d(a,"BILLBOARD_RANDOM",0),d(a,"BILLBOARD_JITTERED",0)}b.Lb&&ca.eo?d(a,"DYNAMIC_GRASS",1):d(a,"DYNAMIC_GRASS",0);a.Lb=b.Lb;a.Vd=b.Vd;a.cd=b.cd;a.Fc=b.Fc;a.Gc=b.Gc&&!a.Kd&&!(a.Ja&&ca.Vu);a.nc=b.nc;a.dc=b.dc;a.$c=b.$c;b.zi?(k(a,"a_influence"),d(a,"SKINNED",1),b.Zj?d(a,"FRAMES_BLENDING",1):d(a,"FRAMES_BLENDING",
0),d(a,"MAX_BONES",b.Ze)):(d(a,"SKINNED",0),d(a,"FRAMES_BLENDING",0));b.In?(d(a,"VERTEX_ANIM",1),ca.Mz?d(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):d(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):d(a,"VERTEX_ANIM",0);if(b.zi&&b.In)throw"Skinning and vertex animation are mutually exlusive";b.Xl?d(a,"DISABLE_FOG",1):d(a,"DISABLE_FOG",0);b.pd&&(a.pd=b.pd);if(a.ti){for(var f=a.Ob.Nq,c=b.jh,p=b.ih,e=0;e<f.length;e++){var t=f[e];switch(t.id){case "VALUE":var g=t.Qm[0];if(g)for(var n=0;n<c.length;n+=
2)if(c[n]==g){t.Ke.push(["VALUE_IND",c[n+1]]);break}break;case "RGB":if(g=t.Qm[0])for(n=0;n<p.length;n+=2)if(p[n]==g){t.Ke.push(["RGB_IND",p[n+1]]);break}}}d(a,"NUM_VALUES",b.Tf.length);d(a,"NUM_RGBS",b.de.length)}}}function k(a,b){var d=a.Gj;-1==d.indexOf(b)&&d.push(b)}function d(a,b,d){V.F(a.Ob,b,d)}function n(a,b){if("PHYSICS"==a.type)a.ed=b;else{var d=a.sf,f=a.Ef;a.rw&&(b=Q.uE(b));a.Pz&&(b=R.QE(a.Qz,a.Rz,a.Oz));d=Q.FI(b,d,f,a.Gb);a.ja=d;a.Vd||d.qm||a.oe||(d.Xg=null,d.pf=null);d=b.A.length;a.Qq=
b.N*d;a:switch(a.Ef){case Q.rj:case Q.jl:case Q.il:f=!0;break a;default:f=!1}f?Q.YF(b)?a.sk=b.la.length/3*d:a.sk=b.N/3*d:a.sk=0}}function B(a,b,d,f,c,p,t,k,g,n,h,l){var x=[],m=k.b4w_dynamic_grass;if(!n&&m)return x;for(var q="INSTANCE"==k.b4w_wind_bend_inheritance,J="INSTANCE"==k.b4w_shadow_inheritance,z="INSTANCE"==k.b4w_reflection_inheritance,u=[],K=[],L=0;L<c.length;L++){var w=c[L],B=O.Ej(b);B.Sd=k.b4w_hair_billboard;B.Aj=k.b4w_hair_billboard_type;B.zj="SPHERICAL"==k.b4w_hair_billboard_geometry;
B.Lb=m;B.xm=!0;B.Tf=w.e.Tf;B.jh=w.e.jh;B.de=w.e.de;B.ih=w.e.ih;q?(B.kd=w.e.kd,B.cl=w.e.cl,B.qf=w.e.qf,B.Ie=w.e.Ie,B.Ye=w.e.Ye,B.He=w.e.He,B.Ce=w.e.Ce,B.qe=w.e.qe,B.Zb=w.e.Zb,B.El=!1):(B.kd=a.e.kd,B.cl=a.e.cl,B.qf=a.e.qf,B.Ie=a.e.Ie,B.Ye=a.e.Ye,B.He=a.e.He,B.Ce=a.e.Ce,B.qe=a.e.qe,B.Zb=a.e.Zb,B.El=!0);J?(B.cd=w.e.cd,B.Fc=w.e.Fc,B.Gc=w.e.Gc):(B.cd=a.e.cd,B.Fc=a.e.Fc,B.Gc=a.e.Gc);z?(B.nc=w.e.nc,B.dc=w.e.dc,B.$c=w.e.$c,B.Mc=w.e.Mc,B.Xc=w.e.Xc,B.af=w.e.af):(B.nc=a.e.nc,B.dc=a.e.dc,B.$c=a.e.$c,B.Mc=a.e.Mc,
B.Xc=a.e.Xc,B.af=a.e.af);u.push(B);var A=t[L];A||(A=new Float32Array);l&&O.rm(g.seed,h);var M=new Float32Array(3),C=new Float32Array([0,0,0,1]),H=[],T=oa.gu(ca.Bq)&&!k.b4w_initial_rand_rotation&&!k.b4w_hair_billboard,F=4;T&&(F=8);for(var y=0;y<A.length;y+=F){M[0]=A[y];M[1]=A[y+1];M[2]=A[y+2];var D=A[y+3]*w.e.scale;if(k.b4w_initial_rand_rotation){switch(k.b4w_rotation_type){case "XYZ":var G=new Float32Array([O.td(h),O.td(h),O.td(h)]);pa.normalize(G,G);break;case "Z":G=new Float32Array([0,1,0]);break;
default:throw"Unsupported random rotation type: "+k.b4w_rotation_type;}ka.setAxisAngle(G,k.b4w_rand_rotation_strength*(2*Math.PI*O.td(h)-Math.PI),C)}else T&&(C.set(A.subarray(y+4,y+8)),O.br(C,C),k.use_whole_group||(k.use_rotation_dupli?ka.multiply(C,w.e.quat,C):ka.multiply(C,wa,C)));var X=Y.Cf(M,D,C);H.push(X)}K.push(H)}for(var ia={},L=0;L<c.length;L++){var U=p[L],B=u[L],R={};B.kd&&(R.au_wind_bending_amp=[B.qe],R.au_wind_bending_freq=[B.qf],R.au_detail_bending_freq=[B.Ie],R.au_detail_bending_amp=
[B.He],R.au_branch_bending_amp=[B.Ce],B.qe=0,B.qf=0,B.Ie=0,B.He=0,B.Ce=0);var aa=O.Zh(B,0),H=K[L];if(H.length)for(var ha=c[L].data,bb=ha.materials,V=Array(bb.length),y=0;y<bb.length;y++)if(!Q.zw(ha,y))for(var ea=0;ea<U.length;ea++){var ba=U[ea],Z=e(ba),Ha=bb[y];"MAIN"==ba&&(V[y]=Z);if(I(Z,Ha)){"DEPTH"==ba&&V[y]&&(Z.Kd=V[y].Kd);Z.Ef=Q.rj;r(Z,B);Z.Ji=k.uuid;"JITTERED"==k.b4w_hair_billboard_type&&(Z.Uw=k.b4w_hair_billboard_jitter_amp,Z.Vw=k.b4w_hair_billboard_jitter_freq);m&&(Z.qw=k.b4w_dynamic_grass_scale_threshold);
q||(delete Z.Gb.a_bending_col_main,delete Z.Gb.a_bending_col_detail);E(Z,aa);var fb=Q.ev(ha,y,Z.Gj,Z.pd,Z.Gb,Z.Jh),Ra=Q.qG(fb,R,H),Va=Ra,Zb=H;Va.K.au_center_pos=new Float32Array(3*Va.N);for(var nb=Zb.length,Pa=Va.N/nb,Ca=0;Ca<nb;Ca++)for(var jb=Zb[Ca],La=3*Pa*Ca,Ka=0;Ka<Pa;Ka++)Va.K.au_center_pos[La+3*Ka]=jb[0],Va.K.au_center_pos[La+3*Ka+1]=jb[1],Va.K.au_center_pos[La+3*Ka+2]=jb[2];Ra=Va;if(B.kd&&B.El){var Ba=Ra,za=a.e.Z;Ba.K.a_emitter_center=new Float32Array(3*Ba.N);var ra=na.fromValues(0,0,0,1);
na.transformMat4(ra,za,ra);for(var Mb=0;Mb<Ba.N;Mb++)Ba.K.a_emitter_center[3*Mb]=ra[0],Ba.K.a_emitter_center[3*Mb+1]=ra[1],Ba.K.a_emitter_center[3*Mb+2]=ra[2];Ra=Ba}var jc=k.b4w_vcol_from_name,ya=k.b4w_vcol_to_name,Yb=Z,W=d,Rb=!q,Wa=ha,Aa=[];if(""!==jc&&""!==ya){var ua,Wb=ya,qc=Yb.Gb,pb=[],Qa=void 0;for(Qa in qc)for(var rb=qc[Qa].src,Ia=0,ib=0;ib<rb.length;ib++){var ic=rb[ib].rd;Wb==rb[ib].name&&pb.push(Qa,ic,Ia);Ia+=O.yh(ic)}ua=pb;if(0<ua.length)for(var Jb=0;Jb<ua.length;Jb+=3)Aa.push({Uj:jc,$l:7,
Rm:ua[Jb],Sm:ua[Jb+1],Yl:ua[Jb+2]});else Q.HF(Yb.Gj,"a_color")&&ya==Wa.active_vcol_name&&Aa.push({Uj:jc,$l:7,Rm:"a_color",Sm:7,Yl:0})}Rb&&("a_bending_col_main"in W&&Aa.push({Uj:"a_bending_col_main",$l:4,Rm:"a_bending_col_main",Sm:4,Yl:0}),"a_bending_col_detail"in W&&Aa.push({Uj:"a_bending_col_detail",$l:7,Rm:"a_bending_col_detail",Sm:7,Yl:0}));for(var ab=Ra,Kb=H,Ec=f,Lb=Aa,Fc=Z.Gb,Ua=!1,eb=0;eb<Lb.length;eb++){var qb=Lb[eb].Uj,Sb=Ec.K[qb];if(Sb&&0<Sb.length){Ua=!0;break}}if(Ua){var gb,Tb=a.e.hc,Gb=
Ec.A[0].a_position,kc=Kb,ta=ia,Ta=new Float32Array(3),Xa=new Float32Array(3),$b=new Uint32Array(kc.length);if(!("verts_indices"in ta)){ta.Fe=new Float32Array(3);ta.Be=new Float32Array(3);ta.rs=new Uint32Array(Gb.length/3);ta.tk=new Uint32Array(Gb.length/3);ta.Fe[0]=(Tb.max_x-Tb.min_x)/20;ta.Fe[1]=(Tb.max_y-Tb.min_y)/20;ta.Fe[2]=(Tb.max_z-Tb.min_z)/20;ta.Be[0]=Tb.min_x;ta.Be[1]=Tb.min_y;ta.Be[2]=Tb.min_z;for(var Da=0;Da<Gb.length/3;Da++){var wc=O.trunc((Gb[3*Da]-ta.Be[0])/ta.Fe[0]),wb=O.trunc((Gb[3*
Da+1]-ta.Be[1])/ta.Fe[1]),Ma=O.trunc((Gb[3*Da+2]-ta.Be[2])/ta.Fe[2]),wc=O.qa(wc,0,19),wb=O.qa(wb,0,19),Ma=O.qa(Ma,0,19);ta.rs[Da]=Da;ta.tk[Da]=Ma*Math.pow(20,2)+20*wb+wc}Q.az(ta.tk,ta.rs,Q.Xn,!0);ta.Kh=new Uint32Array(Math.pow(20,3));for(Da=0;Da<ta.tk.length;Da++)ta.Kh[ta.tk[Da]]++;delete ta.tk;for(Da=1;Da<ta.Kh.length;Da++)ta.Kh[Da]+=ta.Kh[Da-1]}for(var kb=0;kb<kc.length;kb++){Ta[0]=kc[kb][0];Ta[1]=kc[kb][1];Ta[2]=kc[kb][2];for(var Ub=1E10,Bb=-1,xc=O.trunc((Ta[0]-ta.Be[0])/ta.Fe[0]),tb=O.trunc((Ta[1]-
ta.Be[1])/ta.Fe[1]),lb=O.trunc((Ta[2]-ta.Be[2])/ta.Fe[2]),xc=O.qa(xc,0,19),tb=O.qa(tb,0,19),lb=O.qa(lb,0,19),Cb=lb*Math.pow(20,2)+20*tb+xc,lc=ta.Kh[Cb],ub=0==Cb?0:ta.Kh[Cb-1];ub<lc;ub++){var ac=ta.rs[ub];Xa[0]=Gb[3*ac];Xa[1]=Gb[3*ac+1];Xa[2]=Gb[3*ac+2];pa.sub(Xa,Ta,Xa);var xb=pa.sqrLen(Xa);xb<=Ub&&(Ub=xb,Bb=ac)}if(-1==Bb)for(ub=0;ub<Gb.length/3;ub++)Xa[0]=Gb[3*ub],Xa[1]=Gb[3*ub+1],Xa[2]=Gb[3*ub+2],pa.sub(Xa,Ta,Xa),xb=pa.sqrLen(Xa),xb<=Ub&&(Ub=xb,Bb=ub);$b[kb]=Bb}gb=$b;for(var bc=ab.N/Kb.length,eb=
0;eb<Lb.length;eb++){var Db=Lb[eb].Rm,Nb=Lb[eb].Sm,qb=Lb[eb].Uj,Rc=Lb[eb].$l,Sb=Ec.K[qb];switch(Db){case "a_bending_col_main":var Eb=1;break;case "a_bending_col_detail":Eb=3;break;case "a_color":Eb=3;break;default:for(var Ea=Eb=0;Ea<Fc[Db].src.length;Ea++)Eb+=O.yh(Fc[Db].src[Ea].rd)}if(Sb&&0<Sb.length){var dd=O.yh(Rc),yc=O.yh(Nb),Ob=Rc&Nb,mc=O.my(Ob);Ob!=Nb&&N.error("Wrong color extraction from "+qb+" to "+Db+".");if("a_bending_col_main"==Db||"a_bending_col_detail"==Db)ab.K[Db]=new Float32Array(ab.N*
yc);for(Ea=0;Ea<Kb.length;Ea++){var Gc=gb[Ea],Ja=Gc*dd,Ya=Ea*bc*Eb;if(-1!=Gc)for(var zc=0;zc<bc;zc++)for(var sd=zc*Eb,ec=0;ec<mc.length;ec++)mc[ec]&&(ab.K[Db][Ya+sd+(Lb[eb].Yl+O.Mk(Nb,ec))]=Sb[Ja+O.Mk(Rc,ec)])}}else ab.K[Db]=new Float32Array(0)}}Ra=ab;x.push({B:Z,ed:Ra,zc:[Ha.name],oc:B,Ed:[a]})}}}return x}function I(a,b){var d=!0;"NODES_GLOW"==a.type&&(d=ia.eu(b));return d=d&&g(a,b)}function E(a,b){for(var d=null,f=null,c=0;c<a.X.length;c++){var p=a.X[c].De;p&&(d||(d={}),d[c]=p,a.X[c].De=null);if(p=
a.X[c].Va)f||(f={}),f[c]=p,a.X[c].Va=null}a.id=0;a.lH=b;a.id=O.Zh(a,b);if(d)for(var e in d)a.X[e].De=d[e];if(f)for(e in f)a.X[e].Va=f[e]}function M(a,b,d,f,c){var p=e("WIREFRAME");K(p,"wireframe.glslv","wireframe.glslf");p.wireframe_mode=0;p.gi=!0;p.da=!0;p.Ji=d;c&&(p.Pu=!0);r(p,b);E(p,O.Zh(b,0));f?(b=R.uv(1,a.G),Q.AH(b,[a.yg[0],a.zg[1],a.Ag[2]],a.G)):b=R.uv(a.La,a.G);Q.Qr(b,1,!0);b.K.a_polyindex=Q.dv(b);n(p,b);return p}function K(a,b,d){a.Ob={$k:b,Yj:d,Df:[],xq:[],Nq:[]};V.JH(a.Ob)}function J(a,
b,d){1==a.X.length&&0==a.fd.length&&a.fd.push("default0");d=d||"default"+String(a.X.length);-1==a.fd.indexOf(d)&&(a.X.push(b),a.fd.push(d));a.pc&&ea.Et(a)}function f(a){if(!a.Ob)throw"No shaders info for batch "+a.name;a.pc=V.bF(a.Ob);ea.kC(a.pc);ea.gC(a);ea.Et(a)}var p=y("__boundings"),t=y("__camera"),L=y("__config"),N=y("__print"),T=y("__extensions"),Q=y("__geometry"),X=y("__graph"),ia=y("__nodemat"),U=y("__objects"),ha=y("__particles"),R=y("__primitives"),oa=y("__reformer"),ea=y("__renderer"),
ba=y("__scenegraph"),V=y("__shaders"),aa=y("__textures"),Y=y("__tsr"),O=y("__util"),pa=y("vec3"),na=y("vec4"),ka=y("quat"),ca=L.r,Z=["MAIN"],wa=new Float32Array([0,-Math.sqrt(.5),0,Math.sqrt(.5)]);a.uO=e;a.PE=function(a,b,d,f){for(var p=[],e=[],t=[],k=0;k<d.length;k++){var g=d[k];U.Sc(g)?e.push(g):t.push(g)}k=[];k=k.concat(h(e,a));e=k=k.concat(m(t,a,b));k=[];g=[];t={};for(a=0;a<e.length;a++){var r=e[a].B,l=e[a].oc,x=null;if(r.id in t){var E=t[r.id],N=g[E].B,q=g[E].oc,J=null,z=null;for(b=0;b<r.X.length;b++){var u=
r.X[b].De;u&&(J||(J={}),J[b]=u,r.X[b].De=null);if(u=r.X[b].Va)z||(z={}),z[b]=u,r.X[b].Va=null}O.lz(r,N)&&O.lz(l,q)&&(x=g[E]);if(J)for(b in J)r.X[b].De=J[b];if(z)for(b in z)r.X[b].Va=z[b];if(!x){do r.id++;while(t[r.id])}}x||(x={B:r,oc:e[a].oc,Ed:[],Rr:[],zc:[]},t[r.id]=g.length,g.push(x));x.Ed=x.Ed.concat(e[a].Ed);e[a].ed&&e[a].ed.N&&x.Rr.push(e[a].ed);if(x.zc.length)for(b=0;b<e[a].zc.length;b++)r=e[a].zc[b],-1==x.zc.indexOf(r)&&x.zc.push(r);else x.zc=e[a].zc;Q.az(x.zc,x.Rr,Q.rB,!1)}for(a=0;a<g.length;a++){e=
g[a].Rr;if(0==e.length)b=O.yb(O.Vk("%empty"));else if(1==e.length)b=e[0];else{t=[];for(b=0;b<e.length;b++)Q.$F(e[b])||t.push(b);if(t.length<e.length)for(b=0;b<t.length;b++)Q.Qr(e[t[b]]);b=Q.EI(e)}k.push({B:g[a].B,oc:g[a].oc,ed:b,zc:g[a].zc,Ed:g[a].Ed})}p.push.apply(p,k);for(k=0;k<p.length;k++)p[k].B.Rf=p[k].zc,n(p[k].B,p[k].ed);for(k=0;k<p.length;k++)if(b=p[k].B,"STATIC"==p[k].oc.type&&"COLOR_ID"!=b.type)g=U.Fw(O.Vk("%meta%"),"MESH",!0),g.e=p[k].oc,g.o=[b],f.push(g);else for(e=[],a=0;a<p[k].Ed.length;a++)if(g=
p[k].Ed[a],-1==e.indexOf(g.name)){for(t=0;t<g.o.length;t++)if(g.o[t]==b)throw"Batch already exist in object";g.o.push(b);e.push(g.name)}if(ca.wireframe_debug){for(k=0;k<p.length;k++)if(b=p[k].oc,"DYNAMIC"==b.type&&(g=p[k].Ed[0],-1<Z.indexOf(p[k].B.type))){e=!1;for(a=0;a<g.o.length;a++)g.o[a].gi&&(e=!0);e||(a=M(b.Bg,b,g.name,!0,!0),g.o.push(a))}for(k=0;k<f.length;k++)g=f[k],b=g.e,-1<Z.indexOf(g.o[0].type)&&(a=M(b.xd,b,g.name,!1),g.o.push(a))}for(k=0;k<d.length;k++)for(a=0;a<d[k].o.length;a++)c(d[k].o[a]);
for(k=0;k<f.length;k++)for(a=0;a<f[k].o.length;a++)c(f[k].o[a])};a.SE=function(a,b){var f=e("MAIN");K(f,"special_skydome.glslv","special_skydome.glslf");if(b.procedural_skydome)d(f,"PROCEDURAL_SKYDOME",1),f.Tx=!0;else{var t=a.Dr;if(t){d(f,"WO_SKYTEX",1);var g=C(a.Yy,null);J(f,g,"u_sky");t.invert&&d(f,"MTEX_NEGATIVE",1);t.yJ&&d(f,"MTEX_RGBTOINT",1);d(f,"BLENDTYPE",t.rC);t.uJ&&d(f,"WOMAP_BLEND",1);t.vJ&&d(f,"WOMAP_HORIZ",1);t.xJ&&d(f,"WOMAP_ZENUP",1);t.wJ&&d(f,"WOMAP_ZENDOWN",1)}a.zJ&&d(f,"WO_SKYBLEND",
1);a.AJ&&d(f,"WO_SKYPAPER",1);a.BJ&&d(f,"WO_SKYREAL",1)}b.nc&&(f.nc=!0,b.dc&&(f.dc=!0));f.ph=99999;k(f,"a_position");t=R.NE();n(f,t);c(f);t=U.Fw(O.Vk("%meta_sky%"),"MESH",!0);t.e=U.Rl("DYNAMIC");t.e.ii=!0;t.e.hc=p.re();t.e.xd=p.dl();t.e.sb=p.re();t.e.Kb=p.dl();t.o=[f];return t};a.Bu=function(a,d){for(var f=[],c=ba.Oa(d,"SHADOW_CAST"),p=ba.Oa(d,"MAIN_PLANE_REFLECT"),e=ba.Oa(d,"MAIN_CUBE_REFLECT"),t=ba.Oa(d,"OUTLINE_MASK"),k=ba.Oa(d,"COLOR_PICKING"),g=0;g<a.o.length;g++){var n=a.o[g],r=null;"DEPTH"==
n.type&&c&&n.cd&&(r=b(n),r.Qa="SHADOW_CAST");"MAIN"!=n.type&&"PARTICLES"!=n.type||!p&&!e||n.Ja||!n.nc||(r=b(n),r.Qa="REFLECT");"COLOR_ID"==n.type&&(t&&k?(r=b(n),r.Qa="OUTLINE"):t&&!k&&(n.Qa="OUTLINE"));r&&(r.Og=!0,E(r,a.e.id),f.push(r))}a.o.push.apply(a.o,f)};a.MJ=function(a,b,d){if(b)b=d*(b.max_y-b.min_y);else throw"No bounding box for mesh";return 0==b?0:.5*(Math.sqrt(2*Math.sqrt(4*b*Math.tan(a/180*Math.PI)+1)+2)/2-1)/b};a.mC=u;a.ZE=C;a.YI=A;a.Dt=function(a,b,f){f&&f.j.type==t.Xb&&d(a,"PERSPECTIVE_SHADOW_CAST",
1);d(a,"CSM_SECTION0",0);d(a,"CSM_SECTION1",0);d(a,"CSM_SECTION2",0);d(a,"CSM_SECTION3",0);for(f=0;f<b.csm_num;f++)d(a,"CSM_SECTION"+String(f),1);d(a,"SHADOW_TEX_RES",V.O(b.csm_resolution));d(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);d(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)};a.ff=d;a.Lp=function(a,b){return V.gF(a.Ob,b)};a.XI=E;a.Vh=J;a.qH=function(a,b,d){d=a.fd.indexOf(d);-1<d&&(a.X[d]=b)};a.ED=function(a,b){var c=e("MAIN");c.Ja=!0;na.set(b[0],b[1],b[2],.5,c.Je);c.Ef=
Q.jl;n(c,a);K(c,"main.glslv","main.glslf");d(c,"SHADELESS",1);f(c);return c};a.Qb=f;a.IC=function(a){return a.pc.zk.length?a.pc.Uq.u_cube_fog?!0:!1:!1};a.qD=function(){var a=e("DEPTH_PACK");a.Sa=!0;a.da=!1;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");f(a);return a};a.Fu=function(a){var b=e("POSTPROCESSING");K(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":d(b,"POST_EFFECT","POST_EFFECT_NONE");
break;case "GRAYSCALE":d(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":d(b,"POST_EFFECT","POST_EFFECT_X_BLUR");break;case "Y_BLUR":d(b,"POST_EFFECT","POST_EFFECT_Y_BLUR");break;case "X_GLOW_BLUR":d(b,"POST_EFFECT","POST_EFFECT_X_GLOW_BLUR");break;case "Y_GLOW_BLUR":d(b,"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR");break;case "X_EXTEND":d(b,"POST_EFFECT","POST_EFFECT_X_EXTEND");break;case "Y_EXTEND":d(b,"POST_EFFECT","POST_EFFECT_Y_EXTEND");break;default:throw"Wrong postprocessing effect: "+
a;}b.Sa=!0;b.da=!1;a=R.zb();n(b,a);f(b);return b};a.HD=function(a){var b=e("SSAO");b.da=!1;b.Sa=!0;var c=R.zb();n(b,c);K(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");d(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.hz);d(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={texture:aa.TE(a)};c={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,
233,88,189,0,144,25,203,0,117,73,12,0])};a=C(a,c);J(b,a,"u_ssao_special_tex");f(b);return b};a.ID=function(a){var b=e("SSAO_BLUR");b.da=!1;b.Sa=!0;var c=R.zb();n(b,c);K(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");d(b,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);f(b);return b};a.rD=function(){var a=e("DOF");a.da=!1;a.Sa=!0;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");d(a,"DEPTH_RGBA",1);f(a);return a};a.zD=function(){var a=e("OUTLINE");
a.da=!1;a.Sa=!0;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");f(a);return a};a.tD=function(){var a=e("GLOW_COMBINE");a.da=!1;a.Sa=!0;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");f(a);return a};a.uD=function(a,b,c){var p=e("GOD_RAYS");p.da=!1;p.Sa=!0;var t=R.IE();n(p,t);K(p,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");d(p,"DEPTH_RGBA",a?1:0);d(p,"WATER_EFFECTS",b?1:0);d(p,"STEPS_PER_PASS",
V.O(c,1));f(p);return p};a.vD=function(){var a=e("GOD_RAYS_COM");a.da=!1;a.Sa=!0;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");f(a);return a};a.AD=function(){var a=e("SKY");a.da=!1;a.Sa=!0;var b=R.JE();n(a,b);K(a,"procedural_skydome.glslv","procedural_skydome.glslf");d(a,"WATER_EFFECTS",1);f(a);return a};a.kD=function(){var a=e("ANTIALIASING");a.da=!1;a.Sa=!0;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");
d(a,"AA_METHOD","AA_METHOD_FXAA_QUALITY");f(a);return a};a.FD=function(a){var b=e("SMAA"),c=R.zb();n(b,c);K(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");d(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");d(b,"SMAA_PASS",a);d(b,"SMAA_PREDICATION",0);d(b,"SMAA_REPROJECTION",0);f(b);b.da=!1;b.Sa=!0;return b};a.oD=function(){var a=e("COMPOSITING");a.da=!1;a.Sa=!0;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");f(a);return a};a.yD=function(){var a=e("MOTION_BLUR");
a.Sa=!0;a.da=!1;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");f(a);return a};a.iD=function(){var a=e("ANAGLYPH");a.Sa=!0;a.da=!1;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/anaglyph.glslf");f(a);return a};a.wD=function(){var a=e("LUMINANCE");a.da=!1;a.Sa=!0;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");f(a);return a};a.lD=function(){var a=e("LUMINANCE");a.da=!1;a.Sa=
!0;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");f(a);return a};a.xD=function(){var a=e("LUMINANCE_X_BLUR");a.da=!1;a.Sa=!0;var b=R.zb();n(a,b);K(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");f(a);return a};a.mD=function(){var a=e("POSTPROCESSING");a.Sa=!0;a.da=!1;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");f(a);return a};a.nD=function(){var a=e("BLOOM");
a.da=!1;a.Sa=!0;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");f(a);return a};a.LD=function(){var a=e("VELOCITY");a.da=!1;a.Sa=!0;var b=R.zb();n(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");f(a);return a};a.jD=function(){var a=e("ANCHOR_VISIBILITY");a.da=!0;a.Sa=!0;a.Ef=Q.Hs;K(a,"anchors.glslv","anchors.glslf");var b=R.tv(1);n(a,b);d(a,"ANCHOR_NUM",1);f(a);a.Ek=new Float32Array([0,0,0]);return a};a.WI=function(a,
b){var c=b.length/3;if(c!=a.Ek.length/3){var p=R.tv(c);n(a,p);d(a,"ANCHOR_NUM",c);f(a)}a.Ek=b};a.XM=function(a,b,d){for(var f=0;f<a.o.length;f++)if(a.o[f].type==d&&!a.o[f].Og&&-1!=a.o[f].Rf.indexOf(b))return a.o[f];return null};a.YM=function(a,b,d){for(var f=0;f<a.o.length;f++)if(a.o[f].type==d&&a.o[f].Og&&-1!=a.o[f].Rf.indexOf(b))return a.o[f];return null};a.ZP=function(a,b){a.Je.set(b.Je);a.Pj=b.Pj;a.Rk.set(b.Rk);a.Vi.set(b.Vi);a.ki=b.ki;a.Rh=b.Rh;a.Oj=b.Oj;a.xj=b.xj;a.bn=b.bn;a.Rg.set(b.Rg);a.Pm=
b.Pm;a.nn.set(b.nn);a.on=b.on;a.rn.set(b.rn);a.sn=b.sn;a.bm=b.bm;a.Kn=b.Kn};a.$L=function(a,b){for(var d=a.o,f=0;f<d.length;f++)if(d[f].type==b)return!0;return!1};a.$C=function(a){for(var b=a.X,d=0;d<b.length;d++)aa.ZD(b[d].ib);Q.ju(a.ja)}};b4w.module.__boundings=function(a,y){function e(a,b){for(var c=a[0],e=a[1],g=a[2],h=a[0],l=a[1],m=a[2],r=3;r<a.length;r+=3)var k=a[r],d=a[r+1],n=a[r+2],c=Math.max(c,k),e=Math.max(e,d),g=Math.max(g,n),h=Math.min(h,k),l=Math.min(l,d),m=Math.min(m,n);b.max_x=c;b.max_y=e;b.max_z=g;b.min_x=h;b.min_y=l;b.min_z=m;return b}function c(a,b){b||(b=new Float32Array(24));var c=a.max_x,e=a.max_y,g=a.max_z,h=a.min_x,l=a.min_y,m=a.min_z;b[0]=h;b[1]=l;b[2]=m;b[3]=c;b[4]=l;b[5]=m;b[6]=c;b[7]=e;b[8]=m;b[9]=h;b[10]=
e;b[11]=m;b[12]=h;b[13]=l;b[14]=g;b[15]=c;b[16]=l;b[17]=g;b[18]=c;b[19]=e;b[20]=g;b[21]=h;b[22]=e;b[23]=g;return b}function b(a,b,c){q.add(b,c,a.G);q.scale(a.G,.5,a.G);a.La=q.distance(a.G,b);return a}var h=y("__util"),m=y("__tsr"),q=y("vec3"),u=new Float32Array(24),w=new Float32Array(3),g=new Float32Array(3),l=new Float32Array(3);a.uu=function(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z};a.UL=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,
min_y:-1E12,max_z:1E12,min_z:-1E12}};a.re=function(a){a||(a={});a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0;return a};a.av=function(a,b){var c=a.max_y,e=a.max_z,g=a.min_x,h=a.min_y,l=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,e);a.min_x=Math.min(b.min_x,g);a.min_y=Math.min(b.min_y,h);a.min_z=Math.min(b.min_z,l)};a.nC=e;a.zo=function(b,g,l){l||(l=a.re());b=c(b,u);h.Yf(b,g,b);return e(b,l)};a.sE=c;a.rQ=function(b,c,e){e||(e=a.re());
var g=c.min_x,h=c.max_x,l=c.min_y,m=c.max_y,q=c.min_z;c=c.max_z;if(g>=b.max_x||h<=b.min_x||l>=b.max_y||m<=b.min_y||q>=b.max_z||c<=b.min_z)return e.min_x=-.1,e.max_x=.1,e.min_y=-.1,e.max_y=.1,e.min_z=-.2,e.max_z=-.1,e;e.min_x=Math.max(b.min_x,g);e.max_x=Math.min(b.max_x,h);e.min_y=Math.max(b.min_y,l);e.max_y=Math.min(b.max_y,m);e.min_z=Math.max(b.min_z,q);e.max_z=Math.min(b.max_z,c);return e};a.AQ=function(b,c,e){e||(e=a.re());var g=b.max_x-b.min_x,h=b.max_y-b.min_y,l=b.max_z-b.min_z;e.min_x=b.min_x-
.5*(c-1)*g;e.max_x=b.max_x+.5*(c-1)*g;e.min_y=b.min_y-.5*(c-1)*h;e.max_y=b.max_y+.5*(c-1)*h;e.min_z=b.min_z-.5*(c-1)*l;e.max_z=b.max_z+.5*(c-1)*l;return e};a.Bo=function(b,c,e){e||(e=a.dl());q.transformMat4(b.G,c,e.G);e.La=b.La*h.Fq(c);return e};a.Ao=function(a,b,c){c||(c={yg:new Float32Array(3),zg:new Float32Array(3),Ag:new Float32Array(3),G:new Float32Array([0,0,0])});m.Fh(a.G,b,c.G);q.copy(a.yg,c.yg);q.copy(a.zg,c.zg);q.copy(a.Ag,c.Ag);m.Eh(c.yg,b,c.yg);m.Eh(c.zg,b,c.zg);m.Eh(c.Ag,b,c.Ag);return c};
a.Vo=function(a,b){return{La:a,G:new Float32Array(b)}};a.dl=function(){return{G:new Float32Array([0,0,0]),La:0}};a.Uo=function(a,b,c,e){return{yg:new Float32Array(a),zg:new Float32Array(b),Ag:new Float32Array(c),G:new Float32Array([e[0],e[1],e[2]])}};a.pC=function(){return{G:new Float32Array([0,0,0]),La:1E12}};a.pE=function(a,b){var c=q.subtract(b.G,a.G,q.create());0==q.length(c)&&q.set(1,0,0,c);var e=q.normalize(c,q.create()),c=q.scale(e,a.La,q.create());q.add(c,a.G,c);var g=q.scale(e,-a.La,q.create());
q.add(g,a.G,g);var h=q.scale(e,b.La,q.create());q.add(h,b.G,h);var l=q.scale(e,-b.La,q.create());q.add(l,b.G,l);c=[c,g,h,l];e=q.normalize(e,q.create());g=c[0];h=c[0];for(l=1;l<c.length;l++){var m=q.dot(c[l],e);m<q.dot(g,e)&&(g=c[l]);m>q.dot(h,e)&&(h=c[l])}e=[g,h];c=e[0];e=e[1];a.G=q.scale(q.add(c,e,q.create()),.5,q.create());a.La=q.length(q.subtract(e,c,q.create()))/2};a.xu=function(a,b){var c=b.max_y,e=b.min_y,g=Math.max(0,c-e-2*a);return{La:a,height:g,G:new Float32Array([0,(c+e)/2,0])}};a.zu=function(a,
b){var c=b.max_y,e=b.min_y,g=Math.max(0,c-e);return{La:a,height:g,G:new Float32Array([0,(c+e)/2,0])}};a.yu=function(a,b){var c=b.max_y,e=b.min_y,g=Math.max(0,c-e);return{La:a,height:g,G:new Float32Array([0,(c+e)/2,0])}};a.aM=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.eH=function(a){for(var b=0,c=0,e=0,g=0,h=0,l=0,m=0,r=0,k=0;k<a.submeshes.length;k++){var d=a.submeshes[k];if(d.position.length){b=g=d.position[0];
c=h=d.position[1];e=l=d.position[2];break}}for(k=0;k<a.submeshes.length;k++)for(var d=a.submeshes[k],d=d.position,n=0;n<d.length/3;n++)var q=d[3*n],u=d[3*n+1],E=d[3*n+2],b=Math.max(q,b),c=Math.max(u,c),e=Math.max(E,e),g=Math.min(q,g),h=Math.min(u,h),l=Math.min(E,l),m=Math.max(Math.sqrt(q*q+u*u+E*E),m),r=Math.max(Math.sqrt(q*q+E*E),r);a.b4w_bounding_box.max_x=b;a.b4w_bounding_box.min_x=g;a.b4w_bounding_box.max_y=c;a.b4w_bounding_box.min_y=h;a.b4w_bounding_box.max_z=e;a.b4w_bounding_box.min_z=l;a.b4w_bounding_box_source.max_x=
b;a.b4w_bounding_box_source.min_x=g;a.b4w_bounding_box_source.max_y=c;a.b4w_bounding_box_source.min_y=h;a.b4w_bounding_box_source.max_z=e;a.b4w_bounding_box_source.min_z=l;a.b4w_bounding_sphere_radius=m;a.b4w_bounding_cylinder_radius=r};a.lF=function(c){var e=c.subarray(0,3),m=c.subarray(6,9),u=c.subarray(12,15),y=c.subarray(18,21);c=q.subtract(m,e,w);q.normalize(c,c);var H=h.tF(e,m,u,g),H=q.cross(H,c,H);q.normalize(H,H);var x=q.create(),A=q.create();q.subtract(m,e,l);A[0]=q.dot(l,c);A[1]=q.dot(l,
H);m=q.create();q.subtract(u,e,l);m[0]=q.dot(l,c);m[1]=q.dot(l,H);u=q.create();q.subtract(y,e,l);u[0]=q.dot(l,c);u[1]=q.dot(l,H);y=a.dl();u=[x,A,m,u];x=b(y,u[0],u[1]);for(y=2;y<u.length;y++)if(q.distance(x.G,u[y])>x.La){for(var r=x,x=u,A=u[y],m=y-1,r=b(r,A,x[0]),k=1;k<=m;k++)if(q.distance(r.G,x[k])>r.La){for(var d=r,r=x,n=A,B=x[k],I=k-1,d=b(d,n,B),E=0;E<=I;E++)if(q.distance(d.G,r[E])>d.La){var M=n,K=B,J=r[E],f=q.subtract(K,J,l),f=q.squaredLength(f),p=q.subtract(M,J,l),t=q.squaredLength(p),p=q.subtract(M,
K,l),L=q.squaredLength(p),p=f*(t+L-f),N=t*(L+f-t),f=L*(f+t-L),t=p+N+f;q.copy(M,d.G);q.scale(d.G,p/t,d.G);q.scaleAndAdd(d.G,K,N/t,d.G);q.scaleAndAdd(d.G,J,f/t,d.G);d.La=q.distance(d.G,M)}r=d}x=r}y=x;c=q.scale(c,y.G[0],l);q.scaleAndAdd(c,H,y.G[1],c);q.add(c,e,y.G);return y}};b4w.module.__camera=function(a,y){function e(b){b=b.e;switch(b.Da){case a.za:b.vi=X.dist(b.h,b.cc);b.wi=b.J[0].top;break;case a.Hb:b.hb&&(b.vi=X.dist(b.h,b.lc),b.wi=b.J[0].top)}}function c(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),cb:new Float32Array([0,0,0,0]),$a:new Float32Array([0,0,0,0])}}function b(b){switch(b){case "STATIC":return a.ld;case "TARGET":return a.za;case "EYE":return a.Rb;case "HOVER":return a.Hb;
default:throw"Unknown move style";}}function h(b){var d={type:b,name:"",hg:1,width:0,height:0,Oe:null,tb:null,qd:null,Ga:0,Rc:0,cb:0,$a:0,left:0,right:0,top:0,bottom:0,Hf:new Float32Array(3),gv:new Float32Array(3),quat:new Float32Array(4),xa:new Float32Array(16),VL:new Float32Array(16),Aa:new Float32Array(16),oj:new Float32Array(16),cH:new Float32Array(16),he:new Float32Array(16),Sy:new Float32Array(16),pe:new Float32Array(16),dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,Me:null,dof_on:0,dm:c(),
Tk:0,ke:0,Cc:null,Jj:null,ap:null,Ku:new Float32Array(4),Tm:new Float32Array(4)};if(b==a.Ib)return d;switch(b){case a.Xb:w(d,40,.1,1E3);break;case a.md:w(d,2.5,.1,1E3);break;case a.ve:break;case a.uf:break;case a.wg:break;case a.Jb:case a.Sb:throw"Stereo camera may only be created from perspective one";default:throw"Unknown camera type";}return d}function m(b,f,c){if(b.type!=a.Jb&&b.type!=a.Sb)throw"set_stereo_params(): wrong camera type";b.Tk=f;b.ke=c;d(b,b.Ga);if(T.pa())for(f=T.p(),b=f.e.hf,f=T.fm(f).e.J,
c=0;c<f.length;c++)K(f[c],b)}function q(a,b){return u(a.e.quat,b)}function u(a,b){var d=Q.va(a,Q.jb,V),f=Q.va(a,Q.te,aa),c=-Math.asin(d[1]/X.length(d)),d=Math.abs(c)>Math.PI/4?X.scale(f,-Q.sign(c),Y):X.scale(d,-Q.sign(f[1]),Y),p=Math.atan(Math.abs(d[0]/d[2]));0<f[1]&&(c=Q.sign(c)*Math.PI-c);f=p;0>d[2]&&(f=Math.PI-f);0>d[0]&&(f=2*Math.PI-f);b[0]=f;b[1]=c;return b}function w(b,d,f,c,p){switch(b.type){case a.Xb:case a.Jb:case a.Sb:b.Rc=d;b.Ga=1;break;case a.md:b.top=d;b.Ga=1;break;case a.ve:delete b.Rc;
b.Rc=d;b.Ga=p/d;break;case a.uf:b.top=d;b.Ga=p/d;break;default:N.error("set_frustum(): Unsupported camera type: "+b.type)}b.cb=f;b.$a=c}function g(b,f){var c=f.e.h,p=f.e.quat,e=Z;R.rotateX(f.e.Z,-Math.PI/2,e);R.invert(e,b.xa);if(b.Cc){var e=b.Cc[0],t=b.Cc[1],k=b.Cc[2],g=b.Cc[3],r=Z;r[0]=1-2*e*e;r[1]=-2*e*t;r[2]=-2*e*k;r[3]=0;r[4]=-2*e*t;r[5]=1-2*t*t;r[6]=-2*t*k;r[7]=0;r[8]=-2*e*k;r[9]=-2*t*k;r[10]=1-2*k*k;r[11]=0;r[12]=-2*e*g;r[13]=-2*t*g;r[14]=-2*k*g;r[15]=1;R.multiply(b.xa,r,b.xa);d(b,b.Ga,!0);
e=na;t=Z;R.invert(b.xa,t);R.transpose(t,t);ia.transformMat4(b.Cc,t,e);t=ka;t[0]=(Q.sign(e[0])+b.Aa[8])/b.Aa[0];t[1]=(Q.sign(e[1])+b.Aa[9])/b.Aa[5];t[2]=-1;t[3]=(1+b.Aa[10])/b.Aa[14];ia.scale(e,2/(e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]),e);b.Aa[2]=e[0];b.Aa[6]=e[1];b.Aa[10]=e[2]+1;b.Aa[14]=e[3]}b.type==a.Jb?b.xa[12]+=b.ke/2:b.type==a.Sb&&(b.xa[12]-=b.ke/2);R.multiply(b.Aa,b.xa,b.pe);B(b);n(b);X.copy(b.Hf,b.gv);X.copy(c,b.Hf);U.copy(p,b.quat)}function l(b,d,f,c){R.lookAt(d,f,c,b.xa);b.type==a.Jb?b.xa[12]+=
b.ke/2:b.type==a.Sb&&(b.xa[12]-=b.ke/2);R.multiply(b.Aa,b.xa,b.pe);B(b);n(b);X.copy(d,b.Hf)}function z(a){var b=a.e.J;if(!b)throw"Wrong object";for(var d=a.e,f=0;f<b.length;f++){var c=b[f];g(c,a);Q.vp(c.pe,c.dm);if(c.Me)if(c.dof_on){var p=X.dist(d.h,c.Me.location);c.dof_distance=p}else c.dof_distance=0}}function C(b){b=b.e;if(b.Da==a.za){var d=Q.va(b.quat,Q.te,V);b.Tr=0<d[1]}}function F(b,d){var f=b.e,c=f.kc;!c||f.Da!=a.Rb&&f.Da!=a.za||(d&&(f=q(b,ea),c.left+=f[0],c.right+=f[0]),c.left=Q.Qd(c.left),
c.right=Q.Qd(c.right))}function G(b,d){var f=b.e,c=f.qc;!c||f.Da!=a.Rb&&f.Da!=a.za||(d&&(f=q(b,ea),c.gb+=f[1],c.Ta+=f[1]),c.gb=Q.ye(c.gb,-Math.PI,Math.PI),c.Ta=Q.ye(c.Ta,-Math.PI,Math.PI))}function D(b){var f=b.e;if(E(b)&&f.J[0].type===a.md){if(f.Da===a.za)var c=X.dist(f.h,f.cc),f=c/f.vi*f.wi;else f.hb&&f.Da===a.Hb?(c=X.distance(f.h,f.lc),f=c/f.vi*f.wi):f=b.e.J[0].top;for(var p in b.e.J)c=b.e.J[p],c.top=f,d(c,c.Ga);z(b)}}function H(a,b,d,f,c){var p=a.e,e=b,t=d;if(f||c)a=q(a,ba),f&&(e=b-a[0]),c&&(t=
d-a[1]);if(e||t)b=U.identity(O),e&&(e=U.setAxisAngle(Q.jb,e,pa),U.multiply(b,e,b)),t&&(e=Q.va(p.quat,Q.tf,V),t=U.setAxisAngle(e,t,pa),U.normalize(t,t),U.multiply(b,t,b)),U.multiply(b,p.quat,p.quat)}function x(a,b,d,f,c){var p=a.e,e=b,t=d;if(f||c){var k=q(a,ba);f&&(e=b-k[0]);c&&(t=d-k[1])}r(a,a.e.cc,e,t);a=q(a,ba);a=Q.ye(a[1],-Math.PI,Math.PI);p.Tr=Math.abs(a)>Math.PI/2}function A(a,b,d,f,c){var p=a.e,e=b,t=d;if(f||c){var g=q(a,ba);f&&(e=b-g[0]);c&&(t=d-g[1])}p.pp||(e=0);r(a,p.lc,e,t);t&&k(a)}function r(a,
b,d,f){var c=a.e;if(d||f){var p=U.identity(O);d&&(d=U.setAxisAngle(Q.jb,d,pa),U.multiply(p,d,p));a=M(a);f&&(!a||a&&c.hb)&&(a=Q.va(c.quat,Q.tf,V),f=U.setAxisAngle(a,f,pa),U.normalize(f,f),U.multiply(p,f,p));Q.vH(c.h,b,p,c.h);U.multiply(p,c.quat,c.quat)}}function k(a){var b=a.e;if(b.hb){var d=q(a,ea)[1];a=a.e;a.Mb.Ta-a.Mb.gb?(d=(a.Mb.Ta-d)/(a.Mb.Ta-a.Mb.gb),d=Math.max(d,0)):d=0;d=d*(a.Lg-a.Le)+a.Le;a=Q.va(b.quat,Q.Wb,V);X.normalize(a,a);X.scale(a,d,a);X.subtract(b.lc,a,b.h)}}function d(b,d,f){switch(b.type){case a.Xb:if(!d)throw"No aspect ratio";
b.Ga=d;case a.ve:R.perspective(Q.Ym(b.Rc),b.Ga,b.cb,b.$a,b.Aa);break;case a.md:if(!d)throw"No aspect ratio";b.Ga=d;case a.uf:d=b.top*b.Ga;R.ortho(-d,d,-b.top,b.top,b.cb,b.$a,b.Aa);break;case a.wg:R.ortho(b.left,b.right,b.bottom,b.top,b.cb,b.$a,b.Aa);break;case a.Jb:case a.Sb:if(!d)throw"No aspect ratio";b.Ga=d;var c=Math.tan(b.Rc*Math.PI/360);d=b.cb*c;var p=b.Ga*b.Tk*c;b.type==a.Jb?(c=p-b.ke/2,p+=b.ke/2):(c=p+b.ke/2,p-=b.ke/2);c=-(b.cb/b.Tk*c);p*=b.cb/b.Tk;R.frustum(c,p,-d,d,b.cb,b.$a,b.Aa);b.left=
c;b.right=p;break;case a.Ib:return;default:throw"Wrong camera type: "+b.type;}f||(R.multiply(b.Aa,b.xa,b.pe),B(b),n(b))}function n(a){R.copy(a.xa,a.he);a.he[12]=0;a.he[13]=0;a.he[14]=0;a.he[15]=1;R.multiply(a.Aa,a.he,a.he);R.invert(a.he,a.he)}function B(a){R.copy(a.xa,a.oj);R.multiply(a.Aa,a.oj,a.oj);R.invert(a.oj,a.oj)}function I(b,d,f,c,p){c||(c=new Float32Array(24));d||(d=b.cb);f||(f=b.$a);var e,t,k,g,n,r,h,l;switch(b.type){case a.Ib:throw"Extraction from NONE camera is not possible";case a.Xb:case a.ve:e=
d*Math.tan(b.Rc*Math.PI/360);g=-e;t=e*b.Ga;k=-t;n=f/d*e;l=-n;r=n*b.Ga;h=-r;break;case a.md:case a.uf:k=b.top*b.Ga;e=n=b.top;t=r=k;g=l=-b.top;k=h=-k;break;case a.wg:e=n=b.top;t=r=b.right;g=l=b.bottom;k=h=b.left;break;case a.Jb:case a.Sb:n=d/b.cb;e=d*Math.tan(b.Rc*Math.PI/360);g=-e;t=b.right*n;k=b.left*n;h=f/d;n=e*h;l=-n;r=t*h;h*=k;break;default:throw"Wrong camera type: "+b.type;}c[0]=k;c[1]=g;c[2]=-d;c[3]=t;c[4]=g;c[5]=-d;c[6]=t;c[7]=e;c[8]=-d;c[9]=k;c[10]=e;c[11]=-d;c[12]=h;c[13]=l;c[14]=-f;c[15]=
h;c[16]=n;c[17]=-f;c[18]=r;c[19]=n;c[20]=-f;c[21]=r;c[22]=l;c[23]=-f;p&&(d=Z,R.invert(b.xa,d),Q.Yf(c,d,c,0));return c}function E(a){return"CAMERA"===a.type?!0:!1}function M(b){return E(b)&&b.e&&b.e.Da==a.Hb?!0:!1}function K(a,b){if(b.enable_csm){var d=b.csm_num;if(!a.Jj){var c=b.csm_num;a.Jj=Array(c);for(var e=0;e<c;e++)a.Jj[e]=new Float32Array(3);a.ap=new Float32Array(c)}for(c=0;c<d;c++){var e=0==c?a.cb:J(b,a,c-1),t=J(b,a,c),e=I(a,e,t,wa),e=p.lF(e);a.Jj[c].set(e.G);a.ap[c]=e.La;a.Ku[c]=X.length(e.G);
a.Tm[c]=f(b.first_cascade_blur_radius,b.last_cascade_blur_radius,d,c)}}else a.Tm[0]=b.first_cascade_blur_radius}function J(a,b,d){var c=a.csm_num,p=Q.qa(a.csm_first_cascade_border,b.cb,b.$a);a=Q.qa(a.csm_last_cascade_border,b.cb,b.$a);return Q.qa(f(p,a,c,d),b.cb,b.$a)}function f(a,b,d,f){switch(f){case 0:break;case d-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,f/(d-1))}return a}var p=y("__boundings");y("__config");var t=y("__constraints"),L=y("__container"),N=y("__print"),T=y("__scenes"),Q=y("__util"),
X=y("vec3"),ia=y("vec4"),U=y("quat"),ha=y("mat3"),R=y("mat4");a.Ib=10;a.Xb=20;a.md=30;a.ve=40;a.uf=50;a.wg=60;a.Jb=70;a.Sb=80;a.ld=0;a.za=2;a.Rb=3;a.Hb=4;var oa=Math.PI/180/2,ea=new Float32Array(2),ba=new Float32Array(2),V=new Float32Array(3),aa=new Float32Array(3),Y=new Float32Array(3),O=new Float32Array(4),pa=new Float32Array(4),na=new Float32Array(4),ka=new Float32Array(4),ca=new Float32Array(16),Z=new Float32Array(16),wa=new Float32Array(24);a.BC=function(d){var f=d.e,c=d.data;switch(c.type){case "PERSP":var p=
h(a.Xb);if(c.angle_y)var t=c.angle_y/Math.PI*180;w(p,t,c.clip_start,c.clip_end);break;case "ORTHO":p=h(a.md),w(p,c.ortho_scale/2,c.clip_start,c.clip_end)}p.name=d.name;f.xz=!1;f.Da=b(c.b4w_move_style);f.dof_distance=d.data.dof_distance;f.Me=d.data.dof_object;f.dof_front=d.data.b4w_dof_front;f.dof_rear=d.data.b4w_dof_rear;f.dof_power=d.data.b4w_dof_power;f.pp=d.data.b4w_enable_hover_hor_rotation;f.J=[p];f.ps=d.data.b4w_trans_velocity;f.os=d.data.b4w_rot_velocity;f.qs=d.data.b4w_zoom_velocity;f.Da==
a.za&&(f.cc.set(c.b4w_target),C(d));c=d.e;t=c.Da;if(t===a.za||t===a.Rb||t===a.Hb){var g=d.data,n=null,r=null,l=null;t===a.za||t===a.Rb?(g.b4w_use_panning&&(c.Gz=g.b4w_use_panning),g.b4w_use_horizontal_clamping&&(n={left:g.b4w_rotation_left_limit,right:g.b4w_rotation_right_limit}),g.b4w_use_vertical_clamping&&(r={Ta:g.b4w_rotation_down_limit,gb:g.b4w_rotation_up_limit}),t===a.za&&(c.hb=g.b4w_use_distance_limits&&g.b4w_distance_min<=g.b4w_distance_max,c.hb&&(c.Le=g.b4w_distance_min,c.Lg=g.b4w_distance_max))):
t===a.Hb&&(g.b4w_use_horizontal_clamping&&g.b4w_horizontal_translation_min<=g.b4w_horizontal_translation_max&&(n={left:g.b4w_horizontal_translation_min,right:g.b4w_horizontal_translation_max}),g.b4w_use_vertical_clamping&&g.b4w_vertical_translation_min<=g.b4w_vertical_translation_max&&(r={Ta:g.b4w_vertical_translation_min,gb:g.b4w_vertical_translation_max}),c.hb=g.b4w_use_distance_limits&&g.b4w_hover_angle_min<=g.b4w_hover_angle_max&&g.b4w_distance_min<=g.b4w_distance_max,c.hb&&(l={Ta:g.b4w_hover_angle_min,
gb:g.b4w_hover_angle_max},c.Le=g.b4w_distance_min,c.Lg=g.b4w_distance_max));var m=n;m&&t==a.Rb&&(m.left*=-1,m.right*=-1);if(m=r)switch(t){case a.za:m.Ta*=-1;m.gb*=-1;break;case a.Hb:var x=-m.Ta;m.Ta=-m.gb;m.gb=x}(m=l)&&t==a.Hb&&(m.Ta*=-1,m.gb*=-1);c.kc=n;c.qc=r;c.Mb=l;F(d,"LOCAL"==g.b4w_horizontal_clamping_type);G(d,"LOCAL"==g.b4w_vertical_clamping_type)}if(f.Da===a.Hb)if(f=d.e,f.hb){c=d.e;t=Q.va(c.quat,Q.Wb,V);g=na;g.set(Q.jb);g[3]=0;t=Q.yq(g,-d.data.b4w_hover_zero_level,c.h,t,c.lc);g=q(d,ea)[1];
if(!t||Math.abs(g)<oa)N.warn("Active hover camera view vector and the supporting plane are parallel to each other. Set hover pivot based on the camera position."),c.lc[0]=c.h[0],c.lc[1]=0,c.lc[2]=c.h[2];c=q(d,ea);f=Q.zf(c[1],f.Mb.gb,f.Mb.Ta);0<c[1]&&N.warn("Active hover camera has wrong orientation");f?A(d,0,f):k(d)}else f.pp=!1;p.type==a.md&&e(d)};a.OF=e;a.sD=c;a.xb=h;a.ZL=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.tb);case "DEPTH":return Boolean(a.qd);case "SCREEN":return!Boolean(a.tb)&&
!Boolean(a.qd);default:throw"Wrong attachment type: "+b;}};a.en=function(a,b,d){switch(b){case "COLOR":case "CUBEMAP":a.tb=d;break;case "DEPTH":a.qd=d;break;case "SCREEN":a.tb=null;a.qd=null;break;default:throw"Wrong attachment type: "+b;}};a.oN=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.tb;case "DEPTH":return a.qd;case "SCREEN":return null;default:throw"Wrong attachment type: "+b;}};a.fx=function(b,d){if(b.type!=a.Xb||d!=a.Jb&&d!=a.Sb)throw"make_stereo(): wrong camera type";b.type=
d;m(b,6,.065)};a.UH=m;a.Ad=q;a.Dv=u;a.gm=function(a,b){q(a,b);b[0]=Q.Qd(b[0]+Math.PI);b[1]*=-1;return b};a.wv=function(a,b){var d=a.e,f=Q.va(d.quat,Q.Wb,V),c=Math.asin(f[1]/X.length(f));0==f[0]&&0==f[2]?d=0:(Math.abs(c)>Math.PI/4&&(f=0>=c?Q.va(d.quat,Q.sg,aa):Q.va(d.quat,Q.te,aa)),d=Math.atan(Math.abs(f[0]/f[2])),0<f[2]&&(d=Math.PI-d),0<f[0]&&(d=2*Math.PI-d));b[0]=d;b[1]=c;return b};a.jn=w;a.MH=function(b,d,f,c,p,e,t){switch(b.type){case a.wg:b.left=d;b.right=f;b.bottom=c;b.top=p;b.cb=e;b.$a=t;break;
default:N.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.Bd=function(a){return a.e.Da};a.ZH=g;a.oQ=l;a.Ny=function(a,b,d){var f=V;f[0]=0;f[1]=-1;f[2]=0;X.transformQuat(f,d,f);f[0]+=b[0];f[1]+=b[1];f[2]+=b[2];var c=aa;c[0]=0;c[1]=0;c[2]=-1;X.transformQuat(c,d,c);l(a,b,f,c)};a.vE=function(a,b,d,f,c){f[0]=a[0];f[1]=a[1];f[2]=a[2];R.lookAt(a,b,d,Z);R.invert(Z,Z);R.rotateX(Z,Math.PI/2,Z);ha.fromMat4(Z,ca);U.fromMat3(ca,c)};a.bJ=z;a.aJ=function(b){var d=b.e,f=b.e;if(f.Da===a.za||
f.Da===a.Rb){if(f.kc){var c=f.kc.left,p=f.kc.right,e=q(b,ea);(e=f.Da==a.za?Q.zf(e[0],c,p):Q.zf(e[0],p,c))&&(f.Da==a.za?x(b,e,0):H(b,e,0))}f.qc&&(c=f.qc.Ta,p=f.qc.gb,e=q(b,ea),(e=f.Da==a.za?Q.zf(e[1],p,c):Q.zf(e[1],c,p))&&(f.Da==a.za?x(b,0,e):H(b,0,e)));f.Da===a.za&&f.hb&&(e=b.e,c=X.subtract(e.h,e.cc,V),p=X.length(c),p>e.Lg?(X.scale(c,e.Lg/p,c),X.add(e.cc,c,e.h)):p<e.Le&&(p=Q.va(e.quat,Q.Wb,aa),X.scale(p,100*e.Le,p),X.add(c,p,c),X.scale(c,-e.Le/X.length(c),c),X.add(e.cc,c,e.h)))}f.Da===a.Hb&&(f=b.e,
e=f.hb?f.lc:f.h,f.kc&&(c=Q.qa(e[0],f.kc.left,f.kc.right)-e[0],e[0]+=c,f.hb&&(f.h[0]+=c)),f.qc&&(c=Q.qa(e[2],f.qc.Ta,f.qc.gb)-e[2],e[2]+=c,f.hb&&(f.h[2]+=c)),f=b.e,f.hb&&f.Mb&&(e=q(b,ea)[1],e=Q.zf(e,f.Mb.gb,f.Mb.Ta),Q.va(f.quat,Q.Wb,V),e&&A(b,0,e)));D(b);switch(d.Da){case a.za:t.wH(d.h,d.quat,d.cc);t.Pl(b,Q.jb);break;case a.Rb:b.kb||t.Pl(b,Q.jb)}C(b)};a.js=C;a.YG=F;a.bH=G;a.jJ=D;a.ad=H;a.cf=x;a.zh=A;a.NF=k;a.CO=function(b){switch(b.type){case a.Xb:case a.md:case a.Jb:case a.Sb:return!0;default:return!1}};
a.VE=function(b){b=b.e.J[0];switch(b.type){case a.Xb:case a.ve:case a.Jb:case a.Sb:return Math.PI*b.Rc/180;default:return N.error("get_min_fov(): Unsupported camera type: "+b.type),0}};a.bg=d;a.Eo=n;a.Ut=B;a.tE=I;a.hC=function(a){a=a.e;var b=p.re();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.hc=b;var d=p.Vo(1,[0,0,0]);a.xd=d;a.ro=p.xu(1,b);a.to=p.zu(1,b);a.so=p.yu(1,b)};a.Te=E;a.Cb=function(b){return E(b)&&b.e&&b.e.Da==a.za?!0:!1};a.Tc=function(b){return E(b)&&b.e&&b.e.Da==a.Rb?
!0:!1};a.bb=M;a.hs=K;a.ND=J;a.Zq=function(b,d,f){b=b.e.J[0];switch(b.type){case a.Xb:case a.ve:case a.md:case a.uf:case a.Jb:case a.Sb:var c=na;c.set(d);c[3]=1;ia.transformMat4(c,b.pe,c);d=-c[1]/c[3];f[0]=(c[0]/c[3]+1)/2*b.width;f[1]=(d+1)/2*b.height;L.IJ(f[0],f[1],f,b);2<f.length&&(f[2]=(c[2]/Math.abs(c[3])+1)/2);return f;default:return N.error("Non-compatible camera"),f}};a.iF=function(a){return a.e.J[0]};a.hm=function(b,d){switch(b.type){case a.Xb:case a.ve:case a.Jb:case a.Sb:var f=Math.tan(Q.Ym(b.Rc)/
2);switch(d){case "LEFT":return-f*b.Ga;case "RIGHT":return f*b.Ga;case "TOP":return f;case "BOTTOM":return-f}break;case a.md:case a.uf:switch(d){case "LEFT":return-b.top*b.Ga;case "RIGHT":return b.top*b.Ga;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.wg:switch(d){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;default:Q.ma("Unknown camera type")}};a.cG=function(b){switch(b.type){case a.md:case a.uf:case a.wg:return!0;
default:return!1}};a.jF=function(b,d){switch(b.type){case a.Xb:case a.ve:case a.Jb:case a.Sb:var f=Q.Ym(b.Rc);return d?f*b.Ga:f;default:return 0}}};b4w.module.__constraints=function(a,y){function e(a){var b={};b.type=a;return b}function c(a,d){a.kb&&a.kb.U&&h(a.kb.U,a);d.U&&b(d.U,a);a.kb=d}function b(a,b){if(-1==a.nd.indexOf(b))a.nd.push(b);else throw"Descendant object override is forbidden";}function h(a,b){var d=a.nd.indexOf(b);if(-1!=d)a.nd.splice(d,1);else throw"No descendant object";}function m(a,b,c){switch(b.type){case 1:var e=a.e.quat,n=b.U.e.Z;c=b.U.e.quat;b.Ec?(F.copy(b.Ec,e),F.multiply(c,e,e)):F.copy(c,e);C.transformMat4(b.offset,
n,a.e.h);a.e.scale=b.dn*b.U.e.scale;break;case 9:var r=a.e.h,e=a.e.quat,n=b.U.e.Z;c=b.U.e.quat;F.multiply(F.invert(b.uh,b.uh),e,e);F.multiply(c,e,e);C.transformMat4(b.offset,n,r);F.copy(c,b.uh);break;case 10:r=a.e.h;e=a.e.quat;n=b.U.e.Z;c=b.U.e.quat;F.multiply(F.invert(b.uh,b.uh),e,e);F.multiply(c,e,e);C.transformMat4(b.offset,n,r);F.copy(c,b.uh);r=a.e.quat;e=F.multiply(b.U.e.quat,b.Ec,d);e=z.Dv(e,D);r=z.Dv(r,H);z.ad(a,l.zf(r[0],e[0]+b.YC,e[0]+b.XC),l.zf(r[1],e[1]+b.WC,e[1]+b.ZC));break;case 12:var r=
a.e.h,e=a.e.quat,n=b.U.e.Z,h=b.U.e.h,m=b.kI,A=x,I=d;C.transformMat4(b.offset,n,A);l.Ui(A,r,c,m,r);n=x;C.sub(h,r,n);C.normalize(n,n);var y=e,r=E,h=r.subarray(0,3),A=r.subarray(3,6),ha=r.subarray(6,9);C.copy(n,A);C.negate(A,A);C.normalize(A,A);Boolean(.999999<Math.abs(C.dot(n,l.jb)))?(n=G.fromQuat(F.normalize(y,I),M),C.copy(n.subarray(0,3),h)):C.cross(l.jb,A,h);C.normalize(h,h);C.cross(h,A,ha);C.normalize(ha,ha);F.fromMat3(r,I);F.normalize(I,I);l.$y(I,e,c,.16*m,e);break;case 2:e=a.e.quat;r=k;c=d;w(b.U,
b.vC,!0,r,c);b.Ec?(F.copy(b.Ec,e),F.multiply(c,e,e)):F.copy(c,e);a.e.scale=b.dn*r[3];l.Fh(b.offset,r[3],c,r,a.e.h);break;case 3:r=a.e.h;e=a.e.quat;c=b.U.e.h;q(r,e,c);break;case 4:r=a.e.h;e=a.e.quat;c=b.target;q(r,e,c);break;case 5:r=a.e.h;e=a.e.quat;c=b.U.e.h;q(r,e,c);e=C.dist(r,c);if(e=e>b.dist_max?e-b.dist_max:e<b.Qj?e-b.Qj:0)C.sub(c,r,x),C.normalize(x,x),C.scale(x,e,x),C.add(r,x,r);break;case 6:r=a.e.h;e=a.e.quat;c=b.target;q(r,e,c);e=C.dist(r,c);if(e=e>b.dist_max?e-b.dist_max:e<b.Qj?e-b.Qj:0)C.sub(c,
r,x),C.normalize(x,x),C.scale(x,e,x),C.add(r,x,r);break;case 7:n=b.U.e.Z;C.transformMat4(b.offset,n,a.e.h);break;case 8:h=b.U.e.h;r=a.e.h;C.add(h,b.offset,r);break;case 13:e=a.e.quat;n=b.U.e.Z;c=b.U.e.quat;b.Ec?(F.copy(b.Ec,e),F.multiply(c,e,e)):F.copy(c,e);C.transformMat4(b.offset,n,a.e.h);break;case 11:r=b.U.e;c=g.Cf(r.h,r.scale,r.quat,B);g.multiply(c,b.wz,c);r=a.e.h;r[0]=c[0];r[1]=c[1];r[2]=c[2];a.e.scale=c[3];e=a.e.quat;e[0]=c[4];e[1]=c[5];e[2]=c[6];e[3]=c[7];break;case 14:c=b.U,e=z.iF(c),r=a.e.h,
m=z.hm(e,"TOP"),I=z.hm(e,"BOTTOM"),n=m-I,b.ax?(h=z.hm(e,"LEFT"),r[0]=h+n*b.wq):(h=z.hm(e,"RIGHT"),r[0]=h-n*b.wq),r[2]=b.tz?-(m-n*b.Xr):-(I+n*b.Xr),z.cG(e)?r[1]=-b.distance:(r[1]=-1,C.normalize(r,r),C.scale(r,b.distance/Math.abs(r[1]),r)),g.Eh(r,c.e.Pb,r),C.add(c.e.h,r,r),e=a.e.quat,b.Ec?(F.copy(b.Ec,e),F.multiply(c.e.quat,e,e)):F.copy(c.e.quat,e)}"CAMERA"==a.e.type&&(r=l.jb,10==b.type&&(c=b.U.e.quat,r=C.transformQuat(r,c,K)),z.js(a),u(a,r))}function q(a,b,d){var c=x;l.va(b,l.Wb,c);C.normalize(c,c);
var e=A;C.subtract(d,a,e);C.normalize(e,e);a=l.xH(c,e,k);F.multiply(a,b,b);F.normalize(b,b)}function u(a,b){var c=a.e,e=c.quat,g=l.va(c.quat,l.jb,x);C.normalize(g,g);if(.999999<Math.abs(C.dot(b,g)))g=F.identity(d);else{var k=C.cross(b,g,A);C.normalize(k,k);if(c.Da==z.za)c.Tr&&C.negate(k,k);else{var n=l.va(c.quat,l.te,r);0<C.dot(n,b)&&C.negate(k,k)}c=l.va(c.quat,l.tf,r);C.normalize(c,c);var n=l.qa(C.dot(c,k),-1,1),h=Math.acos(n),g=-.999999>=n?F.setAxisAngle(g,h,d):F.rotationTo(c,k,d);F.normalize(g,
g)}F.multiply(g,e,e);z.js(a)}function w(a,b,c,e,r){var h=a.e,l=h.Pg,m=h.pd[b];b=m.Mj;a=a.pose.bones[m.Xq];var m=a.mt,x=k,E=h.jd,q=h.hd,u=h.Zc,K=h.Yc,w=E[4*b+1],z=E[4*b+2],A=E[4*b+3],M=q[4*b+1],C=q[4*b+2],H=q[4*b+3];x[0]=(1-l)*E[4*b]+l*q[4*b];x[1]=(1-l)*w+l*M;x[2]=(1-l)*z+l*C;x[3]=(1-l)*A+l*H;E=d;q=n;E[0]=u[4*b];E[1]=u[4*b+1];E[2]=u[4*b+2];E[3]=u[4*b+3];q[0]=K[4*b];q[1]=K[4*b+1];q[2]=K[4*b+2];q[3]=K[4*b+3];F.slerp(E,q,l,E);l=B;g.wr(x,l);g.Ok(E,l);c?(c=I,g.translate(m,a.FB,c),g.multiply(l,c,l)):g.multiply(l,
m,l);g.multiply(h.Pb,l,l);e[0]=l[0];e[1]=l[1];e[2]=l[2];e[3]=l[3];r&&(r[0]=l[4],r[1]=l[5],r[2]=l[6],r[3]=l[7])}var g=y("__tsr"),l=y("__util"),z=y("__camera"),C=y("vec3");y("vec4");var F=y("quat"),G=y("mat3");y("mat4");a.$J=1;a.ZJ=2;a.dK=3;a.eK=4;a.UJ=5;a.VJ=6;a.aK=7;a.TJ=8;a.YJ=9;a.XJ=10;a.ue=11;a.WJ=12;a.bK=13;a.cK=14;var D=new Float32Array(2),H=new Float32Array(2),x=new Float32Array(3),A=new Float32Array(3),r=new Float32Array(3),k=new Float32Array(4),d=new Float32Array(4),n=new Float32Array(4),
B=new Float32Array(16),I=new Float32Array(16),E=new Float32Array(9),M=new Float32Array(9),B=new Float32Array(8),K=new Float32Array(3);a.ko=function(a,b,d,t,g){var k=e(1);k.U=b;k.offset=new Float32Array(d);k.Ec=t?new Float32Array(t):null;k.dn=g;c(a,k);m(a,k,0)};a.tt=function(a,b,d,t,g,k){var n=e(2);n.U=b;n.vC=d;n.offset=new Float32Array(t);n.Ec=g?new Float32Array(g):null;n.dn=k;c(a,n);m(a,n,0)};a.QB=function(a,b,d,t){var g=e(9),k=a.e.quat,n=b.e.quat;g.U=b;g.offset=new Float32Array(d);g.uh=new Float32Array(n);
t&&(F.copy(t,k),F.multiply(n,k,k));c(a,g);m(a,g,0)};a.PB=function(a,b,d,t,g,k,n,r){var h=e(10),x=a.e.quat,E=b.e.quat;h.U=b;h.offset=new Float32Array(d);h.uh=new Float32Array(E);h.XC=l.Qd(g);h.YC=l.Qd(k);h.ZC=l.ye(n,-Math.PI,Math.PI);h.WC=l.ye(r,-Math.PI,Math.PI);t?(h.Ec=new Float32Array(t),F.copy(t,x),F.multiply(E,x,x)):h.Ec=F.create();c(a,h);m(a,h,0)};a.OB=function(a,b,d,t){var g=e(12);g.U=b;g.offset=new Float32Array(d);g.kI=t;c(a,g);m(a,g,0)};a.TB=function(a,b,d,t){var g=e(13);g.U=b;g.offset=new Float32Array(d);
g.dn=1;g.Ec=t?new Float32Array(t):null;c(a,g);m(a,g,0)};a.OL=b;a.pP=h;a.VB=function(a,b){var d=e(3);d.U=b;c(a,d);m(a,d,0)};a.WB=function(a,b){var d=e(4);d.target=new Float32Array(b);c(a,d);m(a,d,0)};a.LB=function(a,b,d,t){var g=e(5);g.U=b;g.Qj=d;g.dist_max=t;c(a,g);m(a,g,0)};a.MB=function(a,b,d,t){var g=e(6);g.target=new Float32Array(b);g.Qj=d;g.dist_max=t;c(a,g);m(a,g,0)};a.SB=function(a,b){var d=e(7);d.U=b;d.offset=new Float32Array([0,.5,0]);c(a,d);m(a,d,0)};a.KB=function(a,b,d){var t=e(8);t.U=
b;t.offset=new Float32Array(d);c(a,t);m(a,t,0)};a.JB=function(a,b,d){var t=e(11);t.U=b;t.wz=new Float32Array(d);c(a,t);m(a,t,0)};a.ut=function(a,b,d){var t=e(14);t.U=b;if("left"in d)t.ax=!0,t.wq=d.left;else if("right"in d)t.ax=!1,t.wq=d.right;else{m_print.error("append_stiff_viewport: Wrong positioning params");return}if("top"in d)t.tz=!0,t.Xr=d.top;else if("bottom"in d)t.tz=!1,t.Xr=d.bottom;else{m_print.error("append_stiff_viewport: Wrong positioning params");return}"distance"in d?(t.distance=d.distance,
t.Ec="rotation"in d?new Float32Array(d.rotation):null,c(a,t),m(a,t,0)):m_print.error("append_stiff_viewport: Wrong positioning params")};a.cJ=function(a,b){a.kb&&m(a,a.kb,b)};a.wH=q;a.Pl=u;a.LC=function(a){return a.kb?!0:!1};a.remove=function(a){a.kb.U&&h(a.kb.U,a);a.kb=null};a.Qe=function(a){return a.kb?a.kb.type:null};a.Yv=function(a){return a.kb&&a.kb.U?a.kb.U:null};a.Pe=function(a){return a.kb&&11==a.kb.type?a.kb.wz:null};a.$E=w};b4w.module.__container=function(a,y){var e,c,b,h,m;function q(a,b){e=a;c=b}function u(){var a=l.getBoundingClientRect();q(a.left,a.top)}var w=y("__print"),g=y("__util"),l=null,z=null,C=!1;h=b=0;m=1;e=c=0;a.Mp=function(){return l};a.Yd=function(){return z};a.$b=function(a){a&&a.parentNode?(l=a,z=a.parentNode):g.ma("canvas container is not available")};a.tm=function(a,b){b=b||"LAST";switch(b){case "FIRST":z.insertBefore(a,z.firstElementChild);break;case "JUST_BEFORE_CANVAS":z.insertBefore(a,l);break;
case "JUST_AFTER_CANVAS":l.nextElementSibling?z.insertBefore(a,l.nextElementSibling):z.appendChild(a,l);break;case "LAST":z.appendChild(a,l);break;default:w.error(b+" invalid stack order")}};a.BF=function(){return b};a.AF=function(){return h};a.ry=q;a.zz=u;a.cI=function(a,c,e){b=a;h=c;m=e;u()};a.Cp=function(){C=!0};a.Ml=function(a,b,g){g||(g=new Float32Array(2));var h=g;C&&(u(),C=!1);h[0]=a-e;a=g;C&&(u(),C=!1);a[1]=b-c;return g};a.Ho=function(a,c,e,g){e||(e=new Float32Array(2));e[0]=a*m;e[1]=c*m;
g&&(a=g.width/b,e[0]*=a,e[1]*=a);return e};a.IJ=function(a,c,e,g){e||(e=new Float32Array(2));e[0]=a/m;e[1]=c/m;g&&(a=g.width/b,e[0]/=a,e[1]/=a)};a.Mw=function(b){return b&&b.parentNode?b.parentNode==z?!0:a.Mw(b.parentNode):!1}};b4w.module.__graph=function(a,y){function e(a,b,d){d||(d=null);if(c(a,b))throw"Graph already has node with given ID";a.S.push(b,d)}function c(a,b){for(var d=a.S,c=0;c<d.length;c+=2)if(d[c]==b)return!0;return!1}function b(a,b,d,e){e||(e=null);if(c(a,b)&&c(a,d))a.Y.push(b,d,e);else throw"Wrong node IDs";}function h(a,b){if(!c(a,b))throw"Node not found";for(var d=a.S,e=0;e<d.length;e+=2)d[e]==b&&(d.splice(e,2),e-=2)}function m(a,b,d,c){if(!B(a,b,d))throw"Edge not found";a=a.Y;for(var e=0,g=0;g<a.length;g+=
3)if(a[g]==b&&a[g+1]==d){if(-1==c)a.splice(g,3);else{if(c==e){a.splice(g,3);break}e++}g-=3}}function q(a){a=a.S;for(var b=-1,d=0;d<a.length;d+=2)b=Math.max(b,a[d]);return++b}function u(a,b){for(var d=a.S,c=0;c<d.length;c+=2)if(d[c+1]==b)return d[c];return-1}function w(a){var b=[],d={};g(a,d);for(var c=a.S,e=0;e<c.length;e+=2)0==k(a,c[e])&&l(a,c[e],d,b);return{S:b,Y:a.Y.slice(0)}}function g(a,b){for(var d=a.S,c=0;c<d.length;c+=2)b[d[c]]=!1}function l(a,b,c,e){if(!c[b]){c[b]=!0;for(var g=0;g<r(a,b);g++)l(a,
d(a,b,g),c,e);e.unshift(b,A(a,b))}}function z(a,b,c,e){if(!c[b]){c[b]=!0;if(10==e||30==e)for(var g=0;g<r(a,b);g++){var h=d(a,b,g);z(a,h,c,e)}if(20==e||30==e)for(g=0;g<k(a,b);g++)h=n(a,b,g),z(a,h,c,e)}}function C(a){for(var b=[],d=a.S,c=0;c<d.length;c+=2){var e=d[c];r(a,e)||b.push(e)}return b}function F(a){var b=a.S;a=a.Y;for(var d=[],c=[],e=[],g=0;g<b.length;g++)e[b[2*g]]=g,d.push(g,b[2*g+1]);for(g=0;g<a.length;g+=3)c.push(e[a[g]],e[a[g+1]],a[g+2]);return{S:d,Y:c}}function G(a,b,c){if(c.Ud==c.Uf){for(var e=
0,g=0;e<c.Uf;e++)-1!=c.Ge[e]&&(a[g]=e,b[g]=c.Ge[e],g++);return!0}if(c.Uf>c.Ii||c.ig>c.jg||c.ej>c.gj||c.dj>c.fj)return!1;for(var g=e=-1,h=!1;!h&&D(c,J,e,g);)if(e=J[0],g=J[1],H(c,e,g)){var l;l=c;h={};h.ak=l.ak;h.bk=l.bk;h.Mq=l.Mq;h.Zl=l.Zl;h.Uf=l.Uf;h.Ii=l.Ii;h.Vf=l.Vf;h.Ud=h.Im=l.Ud;h.dj=l.dj;h.ej=l.ej;h.ig=l.ig;h.fj=l.fj;h.gj=l.gj;h.jg=l.jg;h.wj=-1;h.Ge=l.Ge;h.Jg=l.Jg;h.Yg=l.Yg;h.Zg=l.Zg;h.qh=l.qh;h.rh=l.rh;h.pn=l.pn;l.pn[0]+=1;var h=l=h,m=e,E=g,q=h.ak,u=h.bk,K=h.Uf,B=h.Ii,w=h.Ge,z=h.Jg,A=h.Yg,M=
h.Zg,I=h.qh,C=h.rh;x(m<K);x(E<B);x(h.Ud<K);x(h.Ud<B);K=++h.Ud;h.wj=m;A[m]||(A[m]=K,h.dj++,I[m]&&h.ig++);I[m]||(I[m]=K,h.ej++,A[m]&&h.ig++);M[E]||(M[E]=K,h.fj++,C[E]&&h.jg++);C[E]||(C[E]=K,h.gj++,M[E]&&h.jg++);w[m]=E;z[E]=m;for(w=0;w<k(q,m);w++)z=n(q,m,w),A[z]||(A[z]=K,h.dj++,I[z]&&h.ig++);for(w=0;w<r(q,m);w++)z=d(q,m,w),I[z]||(I[z]=K,h.ej++,A[z]&&h.ig++);for(w=0;w<k(u,E);w++)z=n(u,E,w),M[z]||(M[z]=K,h.fj++,C[z]&&h.jg++);for(w=0;w<r(u,E);w++)z=d(u,E,w),C[z]||(C[z]=K,h.gj++,M[z]&&h.jg++);h=G(a,b,l);
x(1>=l.Ud-l.Im);x(-1!=l.wj);z=l.ak;m=l.bk;E=l.Ud;q=l.wj;u=l.Ge;A=l.Jg;K=l.Yg;M=l.Zg;B=l.qh;I=l.rh;if(l.Im<E){K[q]==E&&(K[q]=0);for(C=0;C<k(z,q);C++)w=n(z,q,C),K[w]==E&&(K[w]=0);B[q]==E&&(B[q]=0);for(C=0;C<r(z,q);C++)w=d(z,q,C),B[w]==E&&(B[w]=0);z=u[q];M[z]==E&&(M[z]=0);for(C=0;C<k(m,z);C++)w=n(m,z,C),M[w]==E&&(M[w]=0);I[z]==E&&(I[z]=0);for(C=0;C<r(m,z);C++)w=d(m,z,C),I[w]==E&&(I[w]=0);u[q]=-1;A[z]=-1;l.Ud=l.Im;l.wj=-1}}return h}function D(a,b,d,c){-1==d&&(d=0);-1==c?c=0:c++;var e=a.ig,g=a.jg,k=a.ej,
n=a.gj,r=a.dj,h=a.fj,l=a.Ud,m=a.Uf,E=a.Ii,x=a.Ge,q=a.Jg,u=a.Yg,K=a.Zg,B=a.qh,w=a.rh;if(e>l&&g>l)for(;d<m&&(-1!=x[d]||0==B[d]||0==u[d]);)d++,c=0;else if(k>l&&n>l)for(;d<m&&(-1!=x[d]||0==B[d]);)d++,c=0;else if(r>l&&h>l)for(;d<m&&(-1!=x[d]||0==u[d]);)d++,c=0;else if(0==d&&0!=a.Vf){for(u=0;u<m&&-1!=x[d=a.Vf[u]];)u++;u==m&&(d=m)}else for(;d<m&&-1!=x[d];)d++,c=0;if(e>l&&g>l)for(;c<E&&(-1!=q[c]||0==w[c]||0==K[c]);)c++;else if(k>l&&n>l)for(;c<E&&(-1!=q[c]||0==w[c]);)c++;else if(r>l&&h>l)for(;c<E&&(-1!=q[c]||
0==K[c]);)c++;else for(;c<E&&-1!=q[c];)c++;return d<m&&c<E?(b[0]=d,b[1]=c,!0):!1}function H(a,b,c){var e=a.ak,g=a.bk,h=a.Ii,l=a.Ge,m=a.Jg,E=a.Yg,q=a.Zg,u=a.qh,K=a.rh;x(b<a.Uf);x(c<h);x(-1==l[b]);x(-1==m[c]);if(!(0,a.Mq)(A(e,b),A(g,c)))return!1;for(var w=h=0,z=0,J=0,M=0,C=0,H=0;H<r(e,b);H++){var y=d(e,b,H);if(-1!=l[y]){var D=l[y];if(!B(g,c,D)||!I(a.Zl,e,b,y,g,c,D))return!1}else E[y]&&z++,u[y]&&h++,E[y]||u[y]||M++}for(H=0;H<k(e,b);H++)if(y=n(e,b,H),-1!=l[y]){if(D=l[y],!B(g,D,c)||!I(a.Zl,e,y,b,g,D,c))return!1}else E[y]&&
z++,u[y]&&h++,E[y]||u[y]||M++;for(H=0;H<r(g,c);H++)if(D=d(g,c,H),-1!=m[D]){if(y=m[D],!B(e,b,y))return!1}else q[D]&&J++,K[D]&&w++,q[D]||K[D]||C++;for(H=0;H<k(g,c);H++)if(D=n(g,c,H),-1!=m[D]){if(y=m[D],!B(e,y,b))return!1}else q[D]&&J++,K[D]&&w++,q[D]||K[D]||C++;return z<=J&&h<=w&&M<=C}function x(a){if(!a)throw"Assertion failed";}function A(a,b){for(var d=a.S,c=0;c<d.length;c+=2)if(d[c]==b)return d[c+1];return null}function r(a,b){for(var d=a.Y,c=0,e=0;e<d.length;e+=3)d[e]==b&&c++;return c}function k(a,
b){for(var d=a.Y,c=0,e=0;e<d.length;e+=3)d[e+1]==b&&c++;return c}function d(a,b,d){a=a.Y;for(var c=0,e=0;e<a.length;e+=3)if(a[e]==b){if(c==d)return a[e+1];c++}return-1}function n(a,b,d){a=a.Y;for(var c=0,e=0;e<a.length;e+=3)if(a[e+1]==b){if(c==d)return a[e];c++}return-1}function B(a,b,d){a=a.Y;for(var c=0;c<a.length;c+=3)if(a[c]==b&&a[c+1]==d)return!0;return!1}function I(a,b,d,c,e,g,k){for(var n=E(b,d,c),r=E(e,g,k),h=0;h<n;h++){for(var l=!1,m=0;m<r;m++)if(a(M(b,d,c,h),M(e,g,k,m))){l=!0;break}if(!l)return!1}return!0}
function E(a,b,d){var c=0;a=a.Y;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==d&&c++;return c}function M(a,b,d,c){a=a.Y;for(var e=0,g=0;g<a.length;g+=3)if(a[g]==b&&a[g+1]==d){if(e==c)return a[g+2];e++}return null}var K=y("__util"),J=[-1,-1];a.Rs=-1;a.gK=10;a.Qn=20;a.lL=30;a.create=function(){for(var a=arguments,b=[],d=[],c=0;c<a.length;c++){var e=a[c];switch(e.length){case 2:b.push(e[0],e[1]);break;case 3:d.push(e[0],e[1],e[2]);break;default:throw"Wrong graph constructor params";}}return{S:b,Y:d}};
a.clone=function(a,b,d){if(b)for(var c=Array(a.S.length),e=0;e<a.S.length;e+=2)c[e]=a.S[e],c[e+1]=b(a.S[e+1]);else c=K.sa(a.S);if(d)for(b=Array(a.Y.length),e=0;e<a.Y.length;e+=3)b[e]=a.Y[e],b[e+1]=a.Y[e+1],b[e+2]=d(a.Y[e+2]);else b=K.sa(a.Y);return a={S:c,Y:b}};a.yM=function(a,b){for(var d=[],c=[],e=0;e<a.length;e++)d.push(a[e][0],a[e][1]);for(e=0;e<b.length;e++)c.push(b[e][0],b[e][1],b[e][2]);return{S:d,Y:c}};a.zl=e;a.nO=c;a.wd=b;a.Ni=h;a.xh=m;a.gy=function(a,b,d,c){if(!B(a,b,d))throw"Edge not found";
a=a.Y;for(var e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==d&&a[e+2][0]==c[0]&&a[e+2][1]==c[1]){a.splice(e,3);break}};a.u=function(a,b){if(-1==u(a,b)){var d=q(a);e(a,d,b);return d}throw"Non-unique attribute";};a.pH=function(a,b,d,c,e){a=a.Y;for(var g=0;g<a.length;g+=3)a[g]==b&&a[g+1]==d&&a[g+2]==c&&(a[g+2]=e)};a.rv=q;a.lh=u;a.m=function(a,d,c,e){d=u(a,d);c=u(a,c);if(-1!=d&&-1!=c)b(a,d,c,e);else throw"Attributes not found";};a.V=function(a,b){for(var d=a.S,c=0;c<d.length&&!b(d[c],d[c+1]);c+=2);};a.ne=function(a,
b){for(var d=a.Y,c=0;c<d.length&&!b(d[c],d[c+1],d[c+2]);c+=3);};a.of=function(a,b,d){for(var c=a.Y,e=0;e<c.length;e+=3)if(c[e+1]==b){var g=c[e];if(d(g,A(a,g),c[e+2]))break}};a.lg=function(a,b,d){for(var c=a.Y,e=0;e<c.length;e+=3)if(c[e]==b){var g=c[e+1];if(d(g,A(a,g),c[e+2]))break}};a.Yr=w;a.OI=function(a){a=w(a).S;for(var b=[],d=0;d<a.length;d+=2)b.push(a[d+1]);return b};a.zO=function(){};a.Pr=function(a,b,d){if(!c(a,b))throw"No such node";var e={};g(a,e);z(a,b,e,d);b=[];for(var k in e)e[k]&&(k=
Number(k),b.push(k,A(a,k)));a={S:b,Y:a.Y.slice(0)};e=a.Y;for(k=0;k<e.length;k+=3)b=e[k+1],c(a,e[k])&&c(a,b)||(e.splice(k,3),k-=3);return a};a.wF=function(a){for(var b=[],d=a.S,c=0;c<d.length;c+=2){var e=d[c];k(a,e)||b.push(e)}return b};a.ew=C;a.match=function(a,b,d,c){var e={};e.ak=F(a);e.bk=F(b);e.Mq=d||function(a,b){return a==b};e.Zl=c||function(a,b){return a==b};c=a.S.length/2;var g=b.S.length/2;e.Uf=c;e.Ii=g;e.Vf=0;e.Ud=e.Im=0;e.ig=e.dj=e.ej=0;e.jg=e.fj=e.gj=0;e.wj=-1;e.Ge=Array(c);e.Jg=Array(g);
e.Yg=Array(c);e.Zg=Array(g);e.qh=Array(c);e.rh=Array(g);e.pn=[1];for(d=0;d<c;d++)e.Ge[d]=-1,e.Yg[d]=0,e.qh[d]=0;for(d=0;d<g;d++)e.Jg[d]=-1,e.Zg[d]=0,e.rh[d]=0;g=Array(c);c=Array(c);if(G(g,c,e)){for(d=0;d<g.length;d++)g[d]=a.S[2*g[d]],c[d]=b.S[2*c[d]];return[g,c]}return null};a.ab=A;a.sh=r;a.Ew=k;a.Ug=d;a.im=n;a.wN=E;a.Tg=M;a.replace=function(a,b,d){for(var c=a.Y,g=q(a),k=0;k<b.length;k++){var n=b[k];h(a,n);for(var r=0;r<c.length;r+=3)c[r]==n&&(c[r]=g),c[r+1]==n&&(c[r+1]=g),c[r]==c[r+1]&&(c.splice(r,
3),r-=3)}e(a,g,d)};a.fH=function(a,b,d,c,e){if(!B(a,b,d))throw"Edge not found";a=a.Y;for(var g=0;g<a.length;g+=3)a[g]==b&&a[g+1]==d&&(a[g]=c,a[g+1]=e)};a.mE=function(a,b){function d(a,b){if(-1!=n.indexOf(a)){var c=n.slice(n.indexOf(a));if(-1!=e[c[c.length-1]].indexOf(c[0])){r.push([a,c[c.length-1]]);return}}n.push(a);for(c=0;c<b.length;c++)b[c]in e&&d(b[c],e[b[c]])}b||(b=C(a)[0]);var c=a.Y;if(c.length){for(var e={},g=0,k=0;k<c.length;k+=3)c[k+1]in e?e[c[k+1]].push(c[k]):e[c[k+1]]=[c[k]],g++;var n=
[],r=[];d(b,e[b]);for(k=0;k<r.length;k++)for(var h=g=0;h<c.length;h+=3)r[k][1]==c[h+1]&&r[k][0]==c[h]&&m(a,c[h],c[h+1],g),g++}};a.AM=function(a,b){var d=a.S,c=a.Y,e;e="digraph debug {\n    node [shape=box];\n";for(var g=0;g<d.length;g+=2){var k=d[g],n=d[g+1],n=b?b(k,n):String(k);e+="    ";e+=String(k)+' [label="'+n.replace(/\"/g,'\\"')+'"];\n'}for(g=0;g<c.length;g+=3)d=c[g],k=c[g+1],e+="    ",e+=String(d)+" -> "+String(k)+";\n";return e+="}"}};b4w.module.__nodemat=function(a,y){function e(a,f,p,k,t){var n;a:switch(t){case "GLOW":n=f+"11";break a;case "COLOR_ID":case "DEPTH":n=f+"00";break a;default:n=f+"10"}if(n in S)return S[n];if("DEPTH"!=t&&"COLOR_ID"!=t){var l=O.create(),m=a.nodes,v=a.links;f=a.animation_data;for(var E=0;E<m.length;E++)if(!d(l,m[E],0,f,k,t))return S[n]=null;if(p&&-1==r(a,l,"GROUP_OUTPUT","group"))return null;E=ha(l);if(!R(l,v,E))return null;if(p)return l;for(E=0;E<v.length;E++){p=v[E];for(var m=w(p.from_node,l),x=w(p.to_node,
l),K=0;K<m.length;K++)for(var B=0;B<x.length;B++){var J=m[K],M=x[B],I=O.ab(l,J),N=O.ab(l,M);if(!ia(l,J,M,I,N,p))return S[n]=null}}u(l);a="GLOW"==t?r(a,l,"B4W_GLOW_OUTPUT","material",!0):r(a,l,"OUTPUT","material",!1,!0);-1==a&&(l=b(),a=0);g(l);a=O.Pr(l,a,O.Qn);h(a);z(a);A(a);q(a,f,k,t)}else k=e(a,f,p,k,"MAIN"),k=O.clone(k,function(a){var b=na.Ej(a);b.H=na.sa(a.H);b.Ea=na.sa(a.Ea);return b}),a=r(a,k,"OUTPUT","material",!1,!0),c(k,a),a=O.Pr(k,a,O.Qn),h(a);return S[n]=a}function c(a,b){O.ne(a,function(d,
c,f){var e=O.ab(a,c);c==b&&"Color"==e.H[f[1]].identifier&&O.gy(a,d,c,f)})}function b(){var a=O.create(),b={data:null,Ke:[],eb:[],H:[{Ca:new Float32Array([0,0,0]),identifier:"Color",Bb:!1,name:"Color"},{Ca:1,identifier:"Alpha",Bb:!1,name:"Alpha"}],Ea:[],type:"OUTPUT",qj:[]};O.zl(a,0,b);return a}function h(a){O.V(a,function(b,d){for(var c=d.H,f=d.Ea,e=0;e<c.length;e++)m(a,c[e],b,e,1);for(e=0;e<f.length;e++)m(a,f[e],b,e,0)})}function m(a,b,d,c,f){if(b.Bb){var e=!0;O.ne(a,function(a,b,g){if(!f&&a==d&&
g[0]==c||f&&b==d&&g[1]==c)e=!1});e&&(b.Bb=!1)}}function q(a,b,c,f){var e=[];O.ne(a,function(g,p,t){var n=O.ab(a,g),r=O.ab(a,p),n=na.We(n.Ea[t[0]].Ca),r=na.We(r.H[t[1]].Ca);if(n!=r){var h,l={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},m={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};n&&!r?h=k("vector_to_scalar","B4W_VECTOSCAL",[l],[m]):!n&&r&&(h=k("scalar_to_vector","B4W_SCALTOVEC",[m],[l]));d(a,h,0,b,c,f);e.push([g,p,a.S[a.S.length-2],t])}});for(var g=0;g<
e.length;++g)O.gy(a,e[g][0],e[g][1],e[g][3]),O.wd(a,e[g][0],e[g][2],[e[g][3][0],0]),O.wd(a,e[g][2],e[g][1],[0,e[g][3][1]])}function u(a){var b=[];O.V(a,function(d,c){switch(c.type){case "B4W_TRANSLUCENCY":O.ne(a,function(a,f,e){a==d&&"Translucency"==c.Ea[e[0]].name&&b.push(a,f,[e[0]+1,e[1]+1])})}});for(var d=0;d<b.length;d+=3)O.wd(a,b[d],b[d+1],b[d+2])}function w(a,b){var d=[];O.V(b,function(b,c){c.name==a.name&&d.push(b)});if(d.length)return d;throw"Node not found";}function g(a){var b=[];O.V(a,
function(a,d){"B4W_PARALLAX"!=d.type&&"REROUTE"!=d.type||b.push(a,d)});for(var d=0;d<b.length;d+=2){var c=b[d],f=b[d+1];if("B4W_PARALLAX"==f.type){var e=l(a,c);if(-1!=e){var g=O.im(a,e,0);O.xh(a,e,c,-1);-1!=g&&O.xh(a,g,e,-1);c=O.ab(a,e);f.data=c.data;f.eb[0]=c.eb[0];O.Ni(a,e)}f.H.splice(1,1)}else if("REROUTE"==f.type){for(var f=O.im(a,c,0),p=O.sh(a,c),e=[],g=[],k=[],t=0;t<p;t++){var n=O.Ug(a,c,t),r=g.indexOf(n);-1!=r?k[r]+=1:(g.push(n),k.push(1),e.push(c,n))}if(-1!=f)for(p=O.Tg(a,f,c,0)[0],t=0;t<
g.length;t++)for(n=0;n<k[t];n++)r=O.Tg(a,c,g[t],n)[1],O.wd(a,f,g[t],[p,r]);for(t=0;t<e.length;t+=2)O.xh(a,e[t],e[t+1],-1)}}}function l(a,b){for(var d=a.Y,c=0;c<d.length;c+=3)if(d[c+1]==b&&1==d[c+2][1])return d[c];return-1}function z(a){F(a);D(a);C(a)}function C(a){var b=[],c="",f="",e={};O.V(a,function(a,d){if("GEOMETRY_UV"==d.type||"UVMAP"==d.type||"TEX_COORD_UV"==d.type){b.push(a,d);var g=d.data.value;c?c==g||f||(f=g,e[f]=0):(c=g,e[c]=0);e[g]++}});for(var g in e)if(2>e[g]){for(var p=0;p<b.length;p+=
2)b[p+1].data.value==g&&b.splice(p,2);delete e[g];c==g&&(c=f,f="");f==g&&(f="")}if(!(3>b.length)){var p={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},t={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};g=k("merged_uv","UV_MERGED",[],[p,t]);g.uv_layer=c;d(a,g,0,null,"",void 0);var n=a.S[a.S.length-2];g=a.S[a.S.length-1];if(f){t=k("merged_uv","UV_MERGED",[],[p,t]);t.uv_layer=f;d(a,t,0,null,"",void 0);var r=a.S[a.S.length-2],t=a.S[a.S.length-1]}else t=
null;for(var h=-1,l=null,p=0;p<b.length;p+=2){var m=b[p],v=b[p+1];x(v,b[1])?(h=n,l=g):t&&(h=r,l=t);for(var E=[],q=O.sh(a,m),u={},K=0;K<q;K++){var B=O.Ug(a,m,K);B in u||(u[B]=0);var w=O.Tg(a,m,B,u[B]++);E.push(m,B,w);w=w.splice(0,w.length);switch(v.type){case "GEOMETRY_UV":w[0]=0;l.Ea[0].Bb=!0;break;case "UVMAP":case "TEX_COORD_UV":w[0]=1,l.Ea[1].Bb=!0}O.wd(a,h,B,w)}for(var K=0;K<E.length;K+=3)O.xh(a,E[K],E[K+1],0);O.Ni(a,m)}}}function F(a){var b=[];O.V(a,function(a,d){"GEOMETRY_VC"!=d.type&&"GEOMETRY_NO"!=
d.type&&"GEOMETRY_FB"!=d.type&&"GEOMETRY_VW"!=d.type&&"GEOMETRY_GL"!=d.type&&"GEOMETRY_LO"!=d.type&&"GEOMETRY_OR"!=d.type||b.push(a,d)});for(var d=[],c=0;c<b.length;c+=2){for(var f=b[c],e=b[c+1],g=!0,p=0;p<d.length;p++){var k=d[p];if(H(e,k.Kc)){g=[];p=O.sh(a,f);for(r=0;r<p;r++){var t=O.Ug(a,f,r),n=O.Tg(a,f,t,0);g.push(f,t,n);O.wd(a,k.id,t,n)}for(var r=0;r<g.length;r+=3)O.xh(a,g[r],g[r+1],0);O.Ni(a,f);g=!1;break}}g&&(k={id:f,Kc:e},d.push(k))}}function G(a){for(var b={},d=0;d<a.S.length;d+=2)b[a.S[d]]=
[];for(d=0;d<a.Y.length;d+=3){var c=a.Y[d],f=a.Y[d+1];b[f].push(c);b[f].push.apply(b[f],b[c])}return b}function D(a){var b=[];O.V(a,function(a,d){"TEXTURE_COLOR"!=d.type&&"TEXTURE_NORMAL"!=d.type||b.push(a,d)});if(b.length){for(var d=G(a),c=[],f=0;f<b.length;f+=2){for(var e=b[f],g=b[f+1],p=!0,k=0;k<c.length;k++){var t=c[k];if(!(3<=t.Fi.length||!H(g,t.Kc)||-1<d[e].indexOf(t.id)||-1<d[t.id].indexOf(e))){for(var n=!1,r=0;r<t.Fi.length;r++){var h=t.Fi[r].id;if(-1<d[e].indexOf(h)||-1<d[h].indexOf(e)){n=
!0;break}}if(!n){for(var k=[],h=O.Ew(a,e),l={},r=0;r<h;r++)n=O.im(a,e,r),n in l||(l[n]=0),p=O.Tg(a,n,e,l[n]++),k.push(n,e,p);for(var h=[],l=O.sh(a,e),m={},r=0;r<l;r++)n=O.Ug(a,e,r),n in m||(m[n]=0),p=O.Tg(a,e,n,m[n]++),h.push(e,n,p);p=k.concat(h);for(r=0;r<p.length;r+=3)O.xh(a,p[r],p[r+1],0);O.Ni(a,e);r={id:e,Kc:g,hE:k,iE:h};t.Fi.push(r);p=!1;break}}}p&&(t={id:e,Kc:g,Fi:[]},c.push(t))}for(f=0;f<c.length;f++){t=c[f];d=t.Fi.length;for(k=0;k<d;k++){g=t.Fi[k];r=g.Kc;e=g.hE;g=g.iE;t.Kc.H[k+1].Bb=r.H[0].Bb;
t.Kc.H[k+1].Ca=r.H[0].Ca;t.Kc.Ea[2*(k+1)].Bb=r.Ea[0].Bb;t.Kc.Ea[2*(k+1)].Ca=r.Ea[0].Ca;t.Kc.Ea[2*(k+1)+1].Bb=r.Ea[1].Bb;t.Kc.Ea[2*(k+1)+1].Ca=r.Ea[1].Ca;for(r=0;r<e.length;r+=3)n=e[r],p=e[r+2],p[1]+=k+1,O.wd(a,n,t.id,p);for(r=0;r<g.length;r+=3)n=g[r+1],p=g[r+2],p[0]+=2*(k+1),O.wd(a,t.id,n,p);t.Kc.Ke.push(["USE_uv"+(k+2),1])}O.Ni(a,t.id);O.zl(a,t.id,t.Kc)}}}function H(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value==b.data.value;default:return!1}}function x(a,b){var d=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=d.indexOf(a.type)&&-1!=d.indexOf(b.type)?a.data.value==b.data.value:!1}function A(a){var b=[];O.V(a,function(a,d){"GEOMETRY_VC"==d.type&&b.push(a,d)});for(var d=0;d<b.length;d+=2){for(var c=b[d],f=b[d+1],e=!1,g=[],p=[],k=[[],[],[]],t=O.sh(a,c),n=0;n<t;n++){var r=O.Ug(a,c,n);if("SEPRGB"!=O.ab(a,r).type){e=!1;break}g.push(c,r);for(var h=
{},l=O.sh(a,r),e=0;e<l;e++){var m=O.Ug(a,r,e);m in h||(h[m]=0);var v=O.Tg(a,r,m,h[m]++);g.push(r,m);k[v[0]].push(c,m,v)}p.push(r);e=!0}if(e){for(n=c=t=0;n<k.length;n++)k[n].length&&(t++,c|=1<<2-n);if(t){f.type+=t;f.Ea=[];for(n=0;n<k.length;n++)if(k[n].length)for(f.Ea.push({Ca:0,identifier:"RGB"[n],Bb:!0,name:"RGB"[n]}),e=0;e<k[n].length;e+=3)k[n][e+2][0]=na.Mk(c,n);for(n=0;n<g.length;n+=2)O.xh(a,g[n],g[n+1],0);for(n=0;n<p.length;n++)O.Ni(a,p[n]);for(n=0;n<k.length;n++)for(e=0;e<k[n].length;e+=3)O.wd(a,
k[n][e],k[n][e+1],k[n][e+2])}}}}function r(a,b,d,c,f,e){a=a.nodes;for(var g=null,p=0;p<a.length;p++){var k=a[p];f?"GROUP"==k.type&&k.node_tree_name==d&&(g=k):k.type==d&&(g=k)}return g?w(g,b)[0]:(e||Y.error('No "'+d+'" node in node '+c),-1)}function k(a,b,d,c){return{name:a,type:b,inputs:d,outputs:c}}function d(a,b,c,e,g,k){var r=b.name,h=b.type,l=[],m=[],v=[],x=[],q=null,u=[];switch(h){case "BSDF_ANISOTROPIC":case "BSDF_DIFFUSE":case "BSDF_GLOSSY":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "EMISSION":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BUMP":case "NORMAL_MAP":case "VECT_TRANSFORM":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_IMAGE":case "TEX_ENVIRONMENT":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "LAYER_WEIGHT":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "PARTICLE_INFO":case "HAIR_INFO":case "OBJECT_INFO":case "SCRIPT":case "NEW_GEOMETRY":m=
T(b);v=Q(b);Y.warn(h+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":case "MIX_SHADER":m=T(b);v=Q(b);break;case "UVMAP":var q=E("param_"+h+"_a"),w=E("param_"+h+"_v");l.push(X(q));l.push(X(w));v=Q(b);x.push(X(w));q={name:q,value:b.uv_layer};break;case "UV_MERGED":q=E("param_UV_MERGED_a");w=E("param_UV_MERGED_v");l.push(X(q));l.push(X(w));v.push(t(b,"UV_geom"));v.push(t(b,"UV_cycles"));x.push(X(w));q={name:q,value:b.uv_layer};break;case "CAMERA":m=[];v=Q(b);break;case "COMBRGB":case "COMBHSV":m=
T(b);v=Q(b);break;case "CURVE_RGB":m=T(b);v=Q(b);Y.warn("CURVE_RGB node is not fully supported.");break;case "CURVE_VEC":m=T(b);v=Q(b);Y.warn("CURVE_VEC node is not fully supported.");break;case "GEOMETRY":if(!M(b))return!0;h=K(b,c);if(!h)return Y.error("Geometry output is not supported"),!1;switch(h){case "GEOMETRY_UV":if(!b.uv_layer)return Y.error('Missing uv layer in node "',b.name,'"'),!1;q=E("param_GEOMETRY_UV_a");w=E("param_GEOMETRY_UV_v");l.push(X(q));l.push(X(w));v.push(t(b,"UV"));x.push(X(w));
q={name:q,value:b.uv_layer};break;case "GEOMETRY_VC":if(!b.color_layer)return Y.error("Missing vertex color layer in node ",b.name),!1;q=E("param_GEOMETRY_VC_a");w=E("param_GEOMETRY_VC_v");l.push(X(q));l.push(X(w));v.push(t(b,"Vertex Color"));x.push(X(w));q={name:q,value:b.color_layer};break;case "GEOMETRY_NO":v.push(t(b,"Normal"));break;case "GEOMETRY_FB":v.push(t(b,"Front/Back"));break;case "GEOMETRY_VW":v.push(t(b,"View"));break;case "GEOMETRY_GL":v.push(t(b,"Global"));break;case "GEOMETRY_LO":v.push(t(b,
"Local"));break;case "GEOMETRY_OR":w=E("param_GEOMETRY_OR_v"),l.push(X(w)),v.push(t(b,"Orco")),x.push(X(w))}break;case "TEX_COORD":if(!M(b))return!0;h=J(b,c);if(!h)return Y.error("Texture coordinate output is not supported"),!1;switch(h){case "TEX_COORD_UV":q=E("param_TEX_COORD_UV_a");w=E("param_TEX_COORD_UV_v");l.push(X(q));l.push(X(w));v.push(t(b,"UV"));x.push(X(w));q={name:q,value:b.uv_layer};break;case "TEX_COORD_NO":v.push(t(b,"Normal"));break;case "TEX_COORD_GE":w=E("param_TEX_COORD_GE_v");
l.push(X(w));v.push(t(b,"Generated"));x.push(X(w));break;case "TEX_COORD_OB":v.push(t(b,"Object"));Y.warn('Output "Object" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_CA":v.push(t(b,"Camera"));break;case "TEX_COORD_WI":v.push(t(b,"Window"));Y.warn('Output "Window" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_RE":v.push(t(b,"Reflection")),Y.warn('Output "Reflection" of node "Texture Coordinate" doesn\'t supported fully.')}break;case "GROUP":w=
b.node_tree_name;switch(w){case "B4W_LINEAR_TO_SRGB":if(!n(b,[1],[1])){q=B(b,g,k);break}h="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!n(b,[1],[1])){q=B(b,g,k);break}h="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!n(b,[1],[1])){q=B(b,g,k);break}h="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!n(b,[1,1],[1])){q=B(b,g,k);break}h="B4W_REFLECT";break;case "B4W_REFRACTION":if(!n(b,[1,0],[1])){q=B(b,g,k);break}h="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!n(b,
[1,1,0,0,0],[1])){q=B(b,g,k);break}var h="B4W_PARALLAX",z=E("temp_texture");x.push(X(z));break;case "B4W_CLAMP":if(!n(b,[1],[1])){q=B(b,g,k);break}h="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!n(b,[0,0,0,0,0],[0])){q=B(b,g,k);break}h="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!n(b,[],[0])){q=B(b,g,k);break}h="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!n(b,[0,0,0],[0])){q=B(b,g,k);break}h="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":h="B4W_GLOW_OUTPUT";break;default:q=B(b,g,k)}m=T(b);v=Q(b);"B4W_TRANSLUCENCY"==
w&&(w=N("TranslucencyParams","TranslucencyParams",[0,0,0,0]),w.Bb=v[0].Bb,v.push(w));break;case "LAMP":q=b.lamp;if(!q)return Y.error("There is no lamp in node: "+b.name),!1;v.push(t(b,"Color"));v.push(t(b,"Light Vector"));v.push(t(b,"Distance"));v.push(t(b,"Visibility Factor"));q.uuid in fa?u.push(["LAMP_INDEX",String(fa[q.uuid])]):(fa[q.uuid]=va,u.push(["LAMP_INDEX",String(va++)]));q=fa;break;case "NORMAL":m=T(b);v=Q(b);w=t(b,"Normal");x.push(X(E("param_NORMAL_Normal"),w.Ca,3));break;case "MAPPING":w=
b.vector_type;h="MAPPING";m.push(p(b,"Vector"));v.push(t(b,"Vector"));var z=b.rotation,A=b.scale,I=b.translation,L=Z.create(),C=na.nE(z);"TEXTURE"==w&&(A[0]=A[0]||1,A[1]=A[1]||1,A[2]=A[2]||1);var y=new Float32Array([A[0],0,0,0,A[1],0,0,0,A[2]]);Z.multiply(C,y,L);L=na.tG(L,wa.create());switch(w){case "POINT":L[12]=I[0];L[13]=I[1];L[14]=I[2];break;case "TEXTURE":L[12]=I[0];L[13]=I[1];L[14]=I[2];L=wa.invert(L,L);break;case "NORMAL":wa.invert(L,L),wa.transpose(L,L)}switch(w){case "NORMAL":u.push(["MAPPING_IS_NORMAL",
1]);case "TEXTURE":u.push(["MAPPING_TRS_MATRIX",pa.O(L,16)]);break;case "POINT":0!==ca.length(z)?u.push(["MAPPING_TRS_MATRIX",pa.O(L,16)]):(0!==ca.length(A)&&u.push(["MAPPING_SCALE",pa.O(A,3)]),0!==ca.length(I)&&u.push(["MAPPING_TRANSLATION",pa.O(I,3)]));break;case "VECTOR":0!==ca.length(z)?u.push(["MAPPING_TRS_MATRIX",pa.O(L,16)]):0!==ca.length(A)&&u.push(["MAPPING_SCALE",pa.O(A,3)])}b.use_min&&u.push(["MAPPING_MIN_CLIP",pa.O(b.min,3)]);b.use_max&&u.push(["MAPPING_MAX_CLIP",pa.O(b.max,3)]);break;
case "MATERIAL":case "MATERIAL_EXT":q=p(b,"Color");q.Ca.splice(3);m.push(q);q=p(b,"Spec");q.Ca.splice(3);m.push(q);m.push(N("DiffuseIntensity","DiffuseIntensity",b.diffuse_intensity));w=p(b,"Normal");w.Ca.splice(3);m.push(w);v.push(t(b,"Color"));v.push(t(b,"Alpha"));v.push(t(b,"Normal"));"MATERIAL_EXT"==h?((q=p(b,"Emit"))?m.push(q):m.push(N("Emit","Emit",0)),q=p(b,"Translucency"),q.Ca=0,q.name="Translucency",q.identifier="Translucency",q?m.push(q):m.push(N(q.name,q.identifier,q.Ca)),q=p(b,"Translucency"),
q.Ca=[0,0,0,0],q.name="TranslucencyParams",q.identifier="TranslucencyParams",q?m.push(q):m.push(N(q.name,q.identifier,q.Ca)),q=p(b,"Reflectivity"),z=p(b,"Ray Mirror"),q?z="Reflectivity":z?(q=z,z="Ray Mirror"):z="Reflectivity",q?m.push(q):m.push(N(z,z,0)),(q=p(b,"SpecTra"))?m.push(q):m.push(N("SpecTra","SpecTra",0)),(q=p(b,"Alpha"))?m.push(q):m.push(N("Alpha","Alpha",b.alpha)),v.push(t(b,"Diffuse")),v.push(t(b,"Spec"))):(x.push(X(E("param_MATERIAL_alpha"),b.alpha)),x.push(X(E("param_MATERIAL_spec_alpha"),
b.specular_alpha)));z=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":q=b.specular_hardness;break;case "WARDISO":q=b.specular_slope;break;case "TOON":q=b.specular_toon_size;z=b.specular_toon_smooth;break;case "BLINN":q=b.specular_ior;z=b.specular_hardness;break;default:Y.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+'")'),q=b.specular_hardness}switch(b.diffuse_shader){case "LAMBERT":I=A=0;break;case "OREN_NAYAR":A=b.roughness;I=0;break;case "FRESNEL":A=
b.diffuse_fresnel;I=b.diffuse_fresnel_factor;break;case "MINNAERT":A=b.darkness;I=0;break;case "TOON":A=b.diffuse_toon_size;I=b.diffuse_toon_smooth;break;default:Y.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),I=A=0}x.push(X(E("param_MATERIAL_diffuse"),[A,I],2));x.push(X(E("param_MATERIAL_spec"),[b.specular_intensity,q,z],3));q={name:b.name,value:{sI:b.specular_shader,bE:b.diffuse_shader,Kd:b.use_shadeless}};w.Bb&&u.push(["USE_MATERIAL_NORMAL",1]);b.use_diffuse&&
u.push(["USE_MATERIAL_DIFFUSE",1]);b.use_specular&&u.push(["USE_MATERIAL_SPECULAR",1]);break;case "MATH":switch(b.operation){case "ADD":h="MATH_ADD";break;case "SUBTRACT":h="MATH_SUBTRACT";break;case "MULTIPLY":h="MATH_MULTIPLY";break;case "DIVIDE":h="MATH_DIVIDE";break;case "SINE":h="MATH_SINE";break;case "COSINE":h="MATH_COSINE";break;case "TANGENT":h="MATH_TANGENT";break;case "ARCSINE":h="MATH_ARCSINE";break;case "ARCCOSINE":h="MATH_ARCCOSINE";break;case "ARCTANGENT":h="MATH_ARCTANGENT";break;
case "POWER":h="MATH_POWER";break;case "LOGARITHM":h="MATH_LOGARITHM";break;case "MINIMUM":h="MATH_MINIMUM";break;case "MAXIMUM":h="MATH_MAXIMUM";break;case "ROUND":h="MATH_ROUND";break;case "LESS_THAN":h="MATH_LESS_THAN";break;case "GREATER_THAN":h="MATH_GREATER_THAN";break;case "MODULO":h="MATH_MODULO";break;case "ABSOLUTE":h="MATH_ABSOLUTE";break;default:return Y.error("Unsupported MATH operation: "+b.operation),!1}u.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);m=T(b);v=Q(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":h=
"MIX_RGB_MIX";break;case "ADD":h="MIX_RGB_ADD";break;case "MULTIPLY":h="MIX_RGB_MULTIPLY";break;case "SUBTRACT":h="MIX_RGB_SUBTRACT";break;case "SCREEN":h="MIX_RGB_SCREEN";break;case "DIVIDE":h="MIX_RGB_DIVIDE";break;case "DIFFERENCE":h="MIX_RGB_DIFFERENCE";break;case "DARKEN":h="MIX_RGB_DARKEN";break;case "LIGHTEN":h="MIX_RGB_LIGHTEN";break;case "OVERLAY":h="MIX_RGB_OVERLAY";break;case "DODGE":h="MIX_RGB_DODGE";break;case "BURN":h="MIX_RGB_BURN";break;case "HUE":h="MIX_RGB_HUE";break;case "SATURATION":h=
"MIX_RGB_SATURATION";break;case "VALUE":h="MIX_RGB_VALUE";break;case "COLOR":h="MIX_RGB_COLOR";break;case "SOFT_LIGHT":h="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":h="MIX_RGB_LINEAR_LIGHT";break;default:return Y.error("Unsupported MIX_RGB blend type: "+b.blend_type),!1}u.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);m=T(b);v=Q(b);break;case "OUTPUT":m=T(b);v=[];break;case "RGB":w=g+"%join%"+b.name;w={name:"-1",value:w};x.push(w);v.push(t(b,"Color"));break;case "SEPRGB":case "SEPHSV":m=T(b);
v=Q(b);break;case "TEXTURE":h=f(b);if("TEXTURE_EMPTY"==h)v.push(t(b,"Color")),v.push(t(b,"Normal")),v.push(t(b,"Value"));else if("TEXTURE_ENVIRONMENT"==h)m.push(p(b,"Vector")),v.push(t(b,"Color")),v.push(t(b,"Value"));else{if("TEXTURE_NORMAL"==h&&"ENVIRONMENT_MAP"==b.texture.type)return Y.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),!1;for(A=0;4>A;++A)A?(q=N("Vector"+A,"Vector"+A,[0,0,0]),"TEXTURE_COLOR"==h&&(w=N("Color"+A,"Color"+A,[0,0,0]),z=N("Value"+A,"Value"+A,0)),"TEXTURE_NORMAL"==
h&&(w=N("Normal"+A,"Normal"+A,[0,0,0]),z=N("Value"+A,"Value"+A,0))):(q=p(b,"Vector"),"TEXTURE_COLOR"==h&&(w=t(b,"Color"),z=t(b,"Value")),"TEXTURE_NORMAL"==h&&(w=t(b,"Normal"),z=t(b,"Value"))),m.push(q),v.push(w),v.push(z)}z=E("param_TEXTURE_texture");x.push(X(z));q={name:z,value:b.texture};break;case "VALTORGB":m=T(b);v=Q(b);Y.warn("VALTORGB node is not fully supported.");break;case "VALUE":h="VALUE";w=g+"%join%"+b.name;w={name:"-1",value:w};x.push(w);v.push(t(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":h=
"VECT_MATH_ADD";break;case "SUBTRACT":h="VECT_MATH_SUBTRACT";break;case "AVERAGE":h="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":h="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":h="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":h="VECT_MATH_NORMALIZE";break;default:return Y.error("Unsupported VECT_MATH operation: "+b.operation),!1}m=T(b);v=Q(b);break;default:m=T(b),v=Q(b)}r={name:r,type:h,qj:l,H:m,Ea:v,eb:x,data:q,Ke:u};O.zl(a,O.rv(a),r);if(!(r="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type)){a:{r=
b.outputs;for(l=h=0;l<r.length;l++)if(r[l].is_linked&&h++>c){r=!0;break a}r=!1}r=!r}return r||d(a,b,++c,e,g,k)?!0:!1}function n(a,b,d){for(var c=a.inputs,f=a.outputs,e=a.node_tree_name,g=0;g<b.length;g++){var p=c[g],k=b[g];if(!p||p.default_value instanceof Array!=k)return Y.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',e,'".Processing as general node group.'),!1}for(g=0;g<d.length;g++)if(b=f[g],c=d[g],!b||b.default_value instanceof Array!=c)return Y.warn('Wrong outputs for custom node group "'+
a.name+'" of type: "',e,'".Processing as general node group.'),!1;return!0}function B(a,b,d){var c=a.node_group.node_tree,f={},g;for(g in c)if("links"==g||"nodes"==g){f[g]=[];for(var p=0;p<c[g].length;p++){f[g][p]={};for(var t in c[g][p])if("links"==g){f[g][p][t]={};for(var n in c[g][p][t])f[g][p][t][n]=I(c[g][p][t][n])}else f[g][p][t]=I(c[g][p][t])}}else f[g]=I(c[g]);c=a.node_tree_name;if("B4W_REPLACE"==c||"B4W_LEVELS_OF_QUALITY"==c)g=k("Group input","GROUP_INPUT",[],a.inputs),p=k("Group output",
"GROUP_OUTPUT",a.outputs,[]),t=null,t="B4W_REPLACE"==c||"B4W_LEVELS_OF_QUALITY"==c&&(P.quality==ka.vg||P.Bp)?{from_node:g,from_socket:g.outputs[1],to_node:p,to_socket:p.inputs[0]}:{from_node:g,from_socket:g.outputs[0],to_node:p,to_socket:p.inputs[0]},f.nodes=[g,p],f.links=[t];c=a.name;g=f.nodes;p=f.links;for(t=0;t<g.length;t++)g[t].name=U(g[t].type,c,g[t].name);for(t=0;t<p.length;t++)p[t].from_node.name=U(p[t].from_node.type,c,p[t].from_node.name),p[t].to_node.name=U(p[t].to_node.type,c,p[t].to_node.name);
return{FG:e(f,a.node_group.uuid,!0,b,d),GG:f.links}}function I(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?na.Ej(a):a}function E(a){v[a]||(v[a]=0);var b=a+v[a],b=b.replace(/ /g,"_").replace(/\//g,"_");v[a]++;return b}function M(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function K(a,b){for(var d=a.outputs,c=0,f=0;f<d.length;f++){var e=d[f];if(e.is_linked&&!(c++<b))switch(e.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";
case "Normal":return"GEOMETRY_NO";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";default:return null}}}function J(a,b){for(var d=a.outputs,c=0,f=0;f<d.length;f++){var e=d[f];if(e.is_linked&&!(c++<b))switch(e.identifier){case "Camera":return"TEX_COORD_CA";case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";
case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function f(a){if(!a.texture)return"TEXTURE_EMPTY";for(var b=a.outputs,d=!1,c=!1,f=!1,e=0;e<b.length;e++){var g=b[e];if(g.is_linked)switch(g.identifier){case "Color":d=!0;break;case "Normal":c=!0;break;case "Value":f=!0;break;default:throw"Unknown texture output";}}if(d)return c&&Y.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":
"TEXTURE_COLOR";if(c)return"TEXTURE_NORMAL";if(f)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function p(a,b){for(var d=a.inputs,c=0;c<d.length;c++){var f=d[c];if(f.identifier==b)return L(f)}return null}function t(a,b){for(var d=a.outputs,c=0;c<d.length;c++){var f=d[c];if(f.identifier==b)return L(f)}return null}function L(a){var b=a.name,d=a.identifier,c=a.is_linked;a=a.default_value;a=na.We(a)?a.slice(0):a;return{name:b,identifier:d,Bb:c,Ca:a}}function N(a,b,d){return{name:a,
identifier:b,Bb:!1,Ca:d}}function T(a){for(var b=[],d=0;d<a.inputs.length;d++){var c=L(a.inputs[d]);c.Ca.length&&c.Ca.splice(3);b.push(c)}return b}function Q(a){for(var b=[],d=0;d<a.outputs.length;d++){var c=L(a.outputs[d]);b.push(c)}return b}function X(a,b,d){b=null===b||void 0===b?null:pa.O(b,d);return{name:a,value:b}}function ia(a,b,d,c,f,e){var g=[],p=e.from_socket.identifier;e=e.to_socket.identifier;var k=c.Ea;for(c=0;c<k.length;c++)if(k[c].identifier==p){g.push(c);break}f=f.H;for(c=0;c<f.length;c++)if(f[c].identifier==
e){g.push(c);break}2==g.length&&O.wd(a,b,d,g);return!0}function U(a,b,d){return"GROUP_INPUT"==a?b+"*GI*"+d:"GROUP_OUTPUT"==a?b+"*GO*"+d:b+"%join%"+d}function ha(a){var b=[];O.V(a,function(a,d){"GROUP"==d.type&&b.push(d)});return b}function R(a,b,d){for(var c=0;c<d.length;c++){var f=d[c].data.FG,e=d[c].data.GG;if(!f)return!1;O.V(f,function(b,d){O.zl(a,O.rv(a),d)});for(f=0;f<e.length;f++)b.push(e[f]);aa(d[c],b,a)}return!0}function oa(a,b,d,c,f,e){switch(a.type){case "GROUP":a.name==b&&c.push(d);break;
case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||f.push(d);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||e.push(d)}}function ea(a,b,d){for(var c=[],f=0;f<d.length;f++){for(var e=d[f],g=null,p=0;p<b.length;p++)if(e.from_socket.identifier==b[p].to_socket.identifier){g=b[p];break}g?(e.from_node=g.from_node,e.from_socket=g.from_socket):c.push(e)}for(f=0;f<b.length;f++)a.splice(a.indexOf(b[f]),1);return c}function ba(a,b){if(b.length)for(var d=b[0].from_node.name,c=0;c<a.length;c++)a[c].from_node.name==
d&&b.push(a[c])}function V(a,b,d,c){for(var f=0;f<c.length;f++){for(var e=c[f],g,p=0;p<d.H.length;p++)if(e.from_socket.identifier==d.H[p].identifier){g=d.H[p].Ca;break}for(var p=e,k=b,t=g,n=w(p.to_node,k),r=0;r<n.length;r++)for(var h=O.ab(k,n[r]),l=0;l<h.H.length;l++)if(h.H[l].identifier==p.to_socket.identifier){h.H[l].Ca=t;break}e=a.indexOf(e);-1!=e&&a.splice(e,1)}}function aa(a,b,d){for(var c=a.name,f=[],e=[],g=[],p=[],k=0;k<b.length;k++){var t=b[k];oa(t.from_node,c,t,f,g,p);oa(t.to_node,c,t,e,
g,p)}e=ea(b,e,g);f=ea(b,p,f);ba(b,e);V(b,d,a,e);if(f.length){var n;O.V(d,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(c+"*GO*")||(n=b)});V(b,d,n,f)}}var Y=y("__print"),O=y("__graph"),pa=y("__shaders"),na=y("__util"),ka=y("__config"),ca=y("vec3");y("vec4");var Z=y("mat3"),wa=y("mat4"),v={},S={},fa={},va=0;new Float32Array(4);var P=ka.r;a.bD=e;a.cD=function(a){var b=[],d={};v={};var c=O.Yr(a);O.V(c,function(a,c){var f;f=[];for(var e=[],g=[],p=[],k=[],t=[],n=0;n<c.H.length;n++){var r=c.H[n];
if(r.Bb)f.push(null),e.push(null);else{f.push(E("in_"+c.type+"_"+r.identifier));var h=pa.O(r.Ca,0);P.Ry&&(0<=c.type.indexOf("MIX_RGB_")&&("Color1"==r.identifier||"Color2"==r.identifier||"Fac"==r.identifier)||0<=c.type.indexOf("MATH_")&&("Value"==r.identifier||"Value_001"==r.identifier)||0<=c.type.indexOf("VECT_MATH_")&&"Vector_001"==r.identifier)&&(r=h,r=r.replace(/(,)/g,"$1 "),r=r.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1ZERO_VALUE_NODES$3"),r=r.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,
"$1UNITY_VALUE_NODES$3"),h=r=r.replace(/\s+/g,""));e.push(h)}}for(n=0;n<c.Ea.length;n++)r=c.Ea[n],r.Bb?g.push(null):g.push(E("out_"+c.type+"_"+r.identifier));for(n=0;n<c.eb.length;n++)r=c.eb[n],p.push(r.name),k.push(r.value);for(n=0;n<c.qj.length;n++)t.push(c.qj[n].name);f={id:c.type,H:f,jq:e,Ea:g,eb:p,Qm:k,qj:t,Ke:JSON.parse(JSON.stringify(c.Ke))};b.push(f);d[a]=f});O.ne(c,function(a,b,f){var e=O.ab(c,a);O.ab(c,b);var g=e.Ea[f[0]];a=d[a].Ea;b=d[b].H;e=a[f[0]]||E("out_"+e.type+"_"+g.identifier);a[f[0]]=
e;b[f[1]]=e});return b};a.eu=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var d=a.node_tree.nodes[b];if("GROUP"==d.type&&"B4W_GLOW_OUTPUT"==d.node_tree_name)return!0}return!1};a.aa=function(){for(var a in S)delete S[a];for(var b in fa)delete fa[b];va=0}};b4w.module.__shaders=function(a,y){function e(a,b,d){var e=a.Df;"string"==typeof d&&(a=c(a,d))&&(d=a[1]);for(a=0;a<e.length;a++)if(e[a][0]==b){e[a][1]=d;return}e.push([b,d])}function c(a,b){for(var d=a.Df,c=0;c<d.length;c++)if(d[c][0]==b)return d[c];return!1}function b(a,b){var d=a+b;if(x[d])return x[d];if(A){var c=A[b];if(!c)return null;c=y("__gpp_parser").hP.parse(c)}else if(c=y("shader_texts")[b],!c)return null;return x[d]=c}function h(a,d,c){function e(d){d=d.a;for(var c=0;c<d.length;c++){var r=
d[c];switch(r.type){case "condition":a:for(var r=r.a,E=0;E<r.length;E++){var u=r[E];switch(u.type){case "if":case "elif":if(g(u.c)){e(u.group);break a}break;case "else":e(u.group);break a;case "ifdef":u.name in n&&e(u.group);break;case "ifndef":u.name in n||e(u.group)}}break;case "include":r=b(D.shaders_dir,D.eI+r.file);e(r);break;case "var":case "export":case "import":break;case "define":E=r.name;n[E]=r.b;r.eb&&(h[E]=r.eb);break;case "error":throw"Shader error: #error "+r.b.join(" ");case "line":break;
case "pragma":t.push("#pragma "+r.name+" "+r.b.join(" "));break;case "undef":r=r.name;delete n[r];delete h[r];break;case "warning":z.warn("Shader warning: #warning "+r.b.join(" "));break;case "extension":r=m(r.b,n,h,!1);t.push("#extension "+r.join(" "));break;case "#":break;case "node":l[r.name]=r;break;case "nodes_global":r=f;for(E=0;E<r.length;E++){var u=r[E],I=l[u.id];if(I)for(var N=0,H=0;H<I.i.length;H++){var G=I.i[H];"node_param"==G.type&&(G=G.qualifier.join(" ")+" ","vert"==a?G+=u.qj[N]:"frag"==
a&&(G+=u.eb[N],null!==u.Qm[N]&&(G+=" = "+u.Qm[N])),G+=";",t.push(G),N++)}}break;case "nodes_main":r=f;for(E=0;E<r.length;E++)if(u=r[E],I=l[u.id]){N={};H={};for(G=0;G<u.Ke.length;G++)H[u.Ke[G][0]]=[u.Ke[G][1]];y=C=A=0;for(var G=u,F=I.i,U=N,wa=H,v=0;v<F.length;v++){var S=F[v];switch(S.type){case "node_in":var fa=G.H[A];if(null!==G.jq[A]){if(("MATERIAL"==G.id&&3===A||"MATERIAL_EXT"==G.id&&3===A||"TEXTURE_COLOR"==G.id||"TEXTURE_NORMAL"==G.id)&&S.f){U[S.name]=G.jq[A];A++;continue}var va=S.qualifier.join(" ")+
" ",va=va+fa,va=va+(" = "+G.jq[A]),va=va+";";t.push(va)}U[S.name]=fa;A++;break;case "node_out":fa=G.Ea[C];if(!S.f||-1<x.indexOf(fa))va=S.qualifier.join(" ")+" ",va+=fa,va+=";",t.push(va),U[S.name]=fa;-1<x.indexOf(fa)&&(wa["USE_OUT_"+S.name]=[1]);C++;break;case "node_param":"vert"==a?fa=G.qj[y]:"frag"==a&&(fa=G.eb[y]),U[S.name]=fa,y++}}t.push("{");k(u,I.g,N,H);t.push("}")}break;case "lamp":q[r.name]=r;break;case "lamps_main":r=p;for(E=0;E<r.length;E++)if(u=r[E],u.bG){t.push("{");I=q[u.type].g;for(N=
0;N<I.length;N++){H=I[N];G=[];for(F=0;F<H.b.length;F++){U=H.b[F];switch(U){case "LAMP_IND":U=u.index;break;case "LAMP_LIGHT_FACT_IND":U=u.jG;break;case "LAMP_FAC_CHANNELS":U=u.iG;break;case "LAMP_SPOT_SIZE":U=w(u.ie);break;case "LAMP_SPOT_BLEND":U=w(u.Wi||.01);break;case "LAMP_LIGHT_DIST":U=w(u.distance);break;case "LAMP_SHADOW_MAP_IND":U=u.GE?1:0}G.push(U)}t.push(G.join(" "))}t.push("}")}break;case "textline":r=m(r.b,n,h,!1);t.push(r.join(" "));break;default:throw"Unknown element type: "+r.type;
}}}function g(a,b){var d;d=m(a,n,h,!0,b);for(var c=[],f=0;f<d.length;f++)if(d[f]instanceof Object)switch(d[f].type){case "conditional_expr":var e=c.pop(),p=c.pop();c.pop()?c.push(p):c.push(e);break;case "logical_or_expr":e=c.pop();for(p=0;p<d[f].d-1;p++)k=c.pop(),e=e||k;c.push(e);break;case "logical_and_expr":e=c.pop();for(p=0;p<d[f].d-1;p++)k=c.pop(),e=e&&k;c.push(e);break;case "logical_bitor_expr":e=c.pop();for(p=0;p<d[f].d-1;p++)e|=c.pop();c.push(e);break;case "logical_bitxor_expr":e=c.pop();for(p=
0;p<d[f].d-1;p++)e^=c.pop();c.push(e);break;case "logical_bitand_expr":e=c.pop();for(p=0;p<d[f].d-1;p++)e&=c.pop();c.push(e);break;case "equal_expr":e=c.pop();p=c.pop();c.push(p==e);break;case "non_equal_expr":e=c.pop();p=c.pop();c.push(p!=e);break;case "le_expr":e=c.pop();p=c.pop();c.push(p<=e);break;case "ge_expr":e=c.pop();p=c.pop();c.push(p>=e);break;case "l_expr":e=c.pop();p=c.pop();c.push(p<e);break;case "g_expr":e=c.pop();p=c.pop();c.push(p>e);break;case "left_shift_expr":p=c.pop();e=c.pop();
c.push(p<<e);break;case "right_shift_expr":p=c.pop();e=c.pop();c.push(p>>e);break;case "add_expr":p=c.pop();e=c.pop();c.push(p+e);break;case "sub_expr":p=c.pop();e=c.pop();c.push(p-e);break;case "mul_expr":p=c.pop();e=c.pop();c.push(p*e);break;case "div_expr":p=c.pop();e=c.pop();c.push(p/e);break;case "mod_expr":p=c.pop();e=c.pop();c.push(p%e);break;case "pre_inc_expr":case "post_inc_expr":k=c.pop();c.push(++k);break;case "pre_dec_expr":case "post_dec_expr":k=c.pop();c.push(--k);break;case "positive_expr":k=
c.pop();c.push(+k);break;case "negative_expr":k=c.pop();c.push(-k);break;case "one_compl_expr":k=c.pop();c.push(~k);break;case "logic_negative_expr":k=c.pop();c.push(!k);break;default:G.ma("Unknown operation type: "+d[f].type)}else{var k=d[f];/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(k)?c.push(0):c.push(parseFloat(d[f]))}1==c.length?d=c[0]:(G.ma("Incorrect expression: "+d.join(" ")),d=void 0);return d}function k(a,b,d,c){for(var f=0;f<b.length;f++){var e=b[f];switch(e.type){case "node_condition":a:for(var p=
a,e=e.a,r=d,l=c,q=0;q<e.length;q++){var u=e[q];switch(u.type){case "node_if":case "node_elif":if(g(u.c,l)){k(p,u.g,r,l);break a}break;case "node_else":k(p,u.g,r,l);break a;case "node_ifdef":(u.name in n||u.name in l)&&k(p,u.g,r,l);break;case "node_ifndef":u.name in n||u.name in l||k(p,u.g,r,l)}}break;case "textline":p=[];for(r=0;r<e.b.length;r++)l=e.b[r],l in d?p.push(d[l]):p.push(l);p=m(p,n,h,!0,c);t.push(p.join(" "))}}}var f=c.Nq,p=c.xq;c=c.Df||[];for(var t=[],n={},r=0;r<c.length;r++)n[c[r][0]]=
[c[r][1]];for(r=0;r<f.length;r++)n["USE_NODE_"+f[r].id]=[1];var h={},l={},q={},x=[];for(r in f)for(var u in f[r].H)x.push(f[r].H[u]);e(d);var A=0,C=0,y=0;return t.join("\n")}function m(a,b,d,c,e){var g=[];q(a,b,d,c,g,e);return g}function q(a,b,d,c,e,g){for(var f=0;f<a.length;f++){var p=a[f];p in b||g&&p in g?(p=g&&g[p]||b[p],0==p.length&&c?e.push(0):q(p,b,d,c,e,g)):e.push(p)}}function u(a,b,d,c){c=a.createShader(c);a.shaderSource(c,d);a.compileShader(c);C.PC(c,b,d);return c}function w(a,b){!b&&a.length?
b=a.length:b||(b=1);switch(b){case 1:return g(a);case 2:return"vec2("+g(a[0])+","+g(a[1])+")";case 3:return"vec3("+g(a[0])+","+g(a[1])+","+g(a[2])+")";case 4:return"vec4("+g(a[0])+","+g(a[1])+","+g(a[2])+","+g(a[3])+")";case 9:return"mat3("+g(a[0])+","+g(a[1])+","+g(a[2])+","+g(a[3])+","+g(a[4])+","+g(a[5])+","+g(a[6])+","+g(a[7])+","+g(a[8])+")";case 16:return"mat4("+g(a[0])+","+g(a[1])+","+g(a[2])+","+g(a[3])+","+g(a[4])+","+g(a[5])+","+g(a[6])+","+g(a[7])+","+g(a[8])+","+g(a[9])+","+g(a[10])+","+
g(a[11])+","+g(a[12])+","+g(a[13])+","+g(a[14])+","+g(a[15])+")";default:throw"Wrong glsl value dimension";}}function g(a){return a%1?String(a):String(a)+".0"}var l=y("__config"),z=y("__print"),C=y("__debug"),F=y("__assets"),G=y("__util"),D=l.mc,H={},x={},A=null,r="anchors.glslf anchors.glslv color_id.glslf color_id.glslv depth.glslf depth.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv main.glslf main.glslv particles_color.glslf particles_color.glslv particles_texture.glslf particles_texture.glslv procedural_skydome.glslf procedural_skydome.glslv special_lens_flares.glslf special_lens_flares.glslv special_skydome.glslf special_skydome.glslv special_water.glslf special_water.glslv wireframe.glslf wireframe.glslv postprocessing/anaglyph.glslf postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf include/blending.glslf include/caustics.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/gamma.glslf include/lighting.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/std_enums.glsl include/to_world.glslv include/wind_bending.glslv".split(" "),
k=[],d=null,n=!1;a.Id=function(a){d=a};a.F=e;a.gF=c;a.AO=function(a,b){for(var d=a.Df,c=0;c<d.length;c++)if(d[c][0]==b&&1==d[c][1])return!0;return!1};a.JH=function(a){a.Df=[];for(var b="ALPHA ALPHA_CLIP BEND_CENTER_ONLY BILLBOARD_PRES_GLOB_ORIENTATION CAUSTICS CSM_BLEND_BETWEEEN_CASCADES CSM_FADE_LAST_CASCADE CSM_SECTION0 CSM_SECTION1 CSM_SECTION2 CSM_SECTION3 DEBUG_SPHERE DEBUG_SPHERE_DYNAMIC DEPTH_RGBA DISABLE_FOG DOUBLE_SIDED_LIGHTING DYNAMIC DYNAMIC_GRASS DYNAMIC_GRASS_COLOR DYNAMIC_GRASS_SIZE FOAM FRAMES_BLENDING BILLBOARD_JITTERED BILLBOARD_SPHERICAL HAIR_BILLBOARD SHADOW_TEX_RES MAIN_BEND_COL MAX_BONES NODES_GLOW NUM_NORMALMAPS PARALLAX PARALLAX_STEPS PERSPECTIVE_SHADOW_CAST PROCEDURAL_FOG PROCEDURAL_SKYDOME REFLECTION REFLECTION_PASS REFLECTION_TYPE REFRACTIVE USE_REFRACTION USE_REFRACTION_CORRECTION SHORE_SMOOTHING SKINNED SKY_COLOR SKY_TEXTURE SSAO_HEMISPHERE SSAO_BLUR_DEPTH SSAO_ONLY SSAO_WHITE STATIC_BATCH TEXTURE_COLOR TEXTURE_NORM TEXTURE_SPEC TEXTURE_STENCIL_ALPHA_MASK VERTEX_ANIM VERTEX_ANIM_MIX_NORMALS_FACTOR VERTEX_COLOR WATER_EFFECTS WIND_BEND DETAIL_BEND SHORE_PARAMS ALPHA_AS_SPEC DEPTH_RGBA MTEX_NEGATIVE MTEX_RGBTOINT NUM_LIGHTS NUM_LFACTORS NUM_LAMP_LIGHTS MAX_STEPS BILLBOARD_ALIGN SHADOW_USAGE POST_EFFECT SSAO_QUALITY TEXTURE_BLEND_TYPE TEXTURE_COORDS AA_METHOD AU_QUALIFIER BILLBOARD BILLBOARD_RANDOM PRECISION EPSILON USE_ENVIRONMENT_LIGHT WO_SKYBLEND WO_SKYPAPER WO_SKYREAL WO_SKYTEX WOMAP_BLEND WOMAP_HORIZ WOMAP_ZENUP WOMAP_ZENDOWN WIREFRAME_QUALITY SIZE_RAMP_LENGTH COLOR_RAMP_LENGTH PARTICLES_SHADELESS".split(" "),
d=0;d<b.length;d++){var c=b[d],g;switch(c){case "ALPHA":case "ALPHA_CLIP":case "BILLBOARD_PRES_GLOB_ORIENTATION":case "CAUSTICS":case "CSM_SECTION0":case "CSM_SECTION1":case "CSM_SECTION2":case "CSM_SECTION3":case "DEBUG_SPHERE":case "DEBUG_SPHERE_DYNAMIC":case "DEPTH_RGBA":case "DISABLE_FOG":case "DOUBLE_SIDED_LIGHTING":case "DYNAMIC":case "DYNAMIC_GRASS":case "DYNAMIC_GRASS_COLOR":case "DYNAMIC_GRASS_SIZE":case "FOAM":case "FRAMES_BLENDING":case "BILLBOARD_JITTERED":case "MAIN_BEND_COL":case "MAX_BONES":case "MTEX_NEGATIVE":case "MTEX_RGBTOINT":case "NODES_GLOW":case "NUM_LIGHTS":case "NUM_LFACTORS":case "NUM_NORMALMAPS":case "PARALLAX":case "PARALLAX_STEPS":case "PERSPECTIVE_SHADOW_CAST":case "PROCEDURAL_FOG":case "PROCEDURAL_SKYDOME":case "REFLECTION":case "REFLECTION_PASS":case "REFLECTION_TYPE":case "REFRACTIVE":case "USE_REFRACTION":case "USE_REFRACTION_CORRECTION":case "SHORE_SMOOTHING":case "SKINNED":case "SKY_COLOR":case "SKY_TEXTURE":case "SSAO_HEMISPHERE":case "SSAO_BLUR_DEPTH":case "SSAO_ONLY":case "SSAO_WHITE":case "STATIC_BATCH":case "TEXTURE_COLOR":case "TEXTURE_NORM":case "TEXTURE_SPEC":case "TEXTURE_STENCIL_ALPHA_MASK":case "VERTEX_ANIM":case "VERTEX_COLOR":case "WATER_EFFECTS":case "WIND_BEND":case "DETAIL_BEND":case "SHORE_PARAMS":case "BILLBOARD":case "BILLBOARD_RANDOM":case "HAIR_BILLBOARD":case "USE_ENVIRONMENT_LIGHT":case "WO_SKYBLEND":case "WO_SKYPAPER":case "WO_SKYREAL":case "WO_SKYTEX":case "WOMAP_BLEND":case "WOMAP_HORIZ":case "WOMAP_ZENUP":case "WOMAP_ZENDOWN":case "WIREFRAME_QUALITY":case "SIZE_RAMP_LENGTH":case "COLOR_RAMP_LENGTH":case "PARTICLES_SHADELESS":case "SMAA_JITTER":g=
0;break;case "ALPHA_AS_SPEC":case "BEND_CENTER_ONLY":case "CSM_BLEND_BETWEEEN_CASCADES":case "CSM_FADE_LAST_CASCADE":case "DEPTH_RGBA":case "BILLBOARD_SPHERICAL":case "NUM_LAMP_LIGHTS":case "MAX_STEPS":g=1;break;case "SHADOW_TEX_RES":g=w(2048);break;case "AA_METHOD":g="AA_METHOD_FXAA_QUALITY";break;case "AU_QUALIFIER":g="NOT_ASSIGNED";break;case "BILLBOARD_ALIGN":g="BILLBOARD_ALIGN_VIEW";break;case "POST_EFFECT":g="POST_EFFECT_NONE";break;case "SHADOW_USAGE":g="NO_SHADOWS";break;case "SSAO_QUALITY":g=
"SSAO_QUALITY_32";break;case "TEXTURE_BLEND_TYPE":g="TEXTURE_BLEND_TYPE_MIX";break;case "TEXTURE_COORDS":g="TEXTURE_COORDS_UV_ORCO";break;case "PRECISION":g=l.r.precision;break;case "EPSILON":g="highp"==l.r.precision?1E-6:1E-4;break;case "VERTEX_ANIM_MIX_NORMALS_FACTOR":g="u_va_frame_factor";break;default:z.error("Unknown directive ("+a.$k+", "+a.Yj+"): "+c)}e(a,c,g)}};a.gO=function(a){return a.$k};a.Pv=function(a){return a.Yj};a.tO=function(a,b){for(var d=b.Df,g=0;g<d.length;g++){var k=d[g][0],r=
d[g][1];c(a,k)&&e(a,k,r)}};a.bF=function(a){var c=JSON.stringify(a),e=H[c];if(e)return e;var g=a.Yj,e=b(D.shaders_dir,a.$k),g=b(D.shaders_dir,g);if(!e||!g)return null;var k=h("vert",e,a),r=h("frag",g,a),e=d,f=u(e,c,k,e.VERTEX_SHADER),p=u(e,c,r,e.FRAGMENT_SHADER),g=e.createProgram();e.attachShader(g,f);e.attachShader(g,p);e.linkProgram(g);e.validateProgram(g);e.getProgramParameter(g,e.VALIDATE_STATUS)==e.fK&&z.error("shader program is not valid",c);C.QC(g,c,f,p,k,r);a={ss:f,pv:p,Fk:g,attributes:{},
Uk:{},zk:[],Uq:{},vz:[],Ob:a};r=e.getProgramParameter(g,e.ACTIVE_ATTRIBUTES);for(k=0;k<r;k++)f=e.getActiveAttrib(g,k).name,a.attributes[f]=e.getAttribLocation(g,f);r=e.getProgramParameter(g,e.ACTIVE_UNIFORMS);for(k=0;k<r;k++)f=e.getActiveUniform(g,k).name.split("[0]").join(""),a.Uk[f]=e.getUniformLocation(g,f);return H[c]=e=a};a.lG=function(){n=!1;if(b4w.module_check("shader_texts"))n=!0;else{for(var a=[],b=F.Es,d=0;d<r.length;d++){var c=G.Hm(D.shaders_dir+r[d]);a.push([r[d],b,c])}b=function(a,b){A||
(A={});A[b]=a};a.length?F.tc(a,b,function(){n=!0}):z.error("Shaders have not been found.")}};a.RC=function(){return n};a.BM=function(){return k};a.Ev=function(){return H};a.aa=function(){for(var a in H){var b=H[a];d.deleteProgram(b.Fk);d.deleteShader(b.ss);d.deleteShader(b.pv);delete H[a]}for(var c in x)delete x[c];for(var e in k)delete k[e]};a.CM=function(a){var b=a.Df;z.log("Shader: "+a.$k+" "+a.Yj+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)z.log("  "+b[a][0],b[a][1])};a.O=w;
a.hu=function(a,b){return b in a.Uk?!0:!1};a.zF=function(a){return(d.getShaderSource(a).match(/(?:^|\s)varying(?=\s)/g)||[]).length}};b4w.module.__debug=function(a,y){function e(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function c(a,b){typeof a!=typeof b&&q.ma("Structure assertion failed: incompatible types");for(var c in a)c in b||q.ma("Structure assertion failed: missing key in the first object: "+c);for(c in b)c in a||q.ma("Structure assertion failed: missing key in the second object: "+c),typeof a[c]!=typeof b[c]&&q.ma("Structure assertion failed: incompatible types for key "+c)}var b=
y("__extensions"),h=y("__print"),m=y("__textures"),q=y("__util"),u=null,w={},g=!1,l={},z=[],C=-1,F=null,G=!1;a.it={WM_OPAQUE_WIREFRAME:0,WM_TRANSPARENT_WIREFRAME:1,WM_FRONT_BACK_VIEW:2,WM_DEBUG_SPHERES:3};a.Id=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;for(c in b){var e=b[c];e in a&&(w[a[e]]=e)}u=a};a.OC=function(a){if(g){var b=u.getError();b!=u.NO_ERROR&&(b in w?q.ma("GL Error: "+b+", gl."+w[b]+" ("+
a+")"):q.ma("Unknown GL error: "+b+" ("+a+")"))}};a.JC=function(){if(g)switch(u.checkFramebufferStatus(u.FRAMEBUFFER)){case u.FRAMEBUFFER_COMPLETE:break;case u.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:h.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case u.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:h.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case u.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:h.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");
break;case u.FRAMEBUFFER_UNSUPPORTED:h.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;default:h.error("FRAMEBUFFER CHECK FAILED")}};a.cu=function(){if(-1!=C)return C;u.bindFramebuffer(u.FRAMEBUFFER,u.createFramebuffer());var a=m.Sl("DEBUG",m.sj);m.resize(a,1,1);u.framebufferTexture2D(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,a.gc,a.ib,0);u.checkFramebufferStatus(u.FRAMEBUFFER)!=u.FRAMEBUFFER_COMPLETE?(C=!0,h.warn("depth-only issue was found")):C=!1;u.bindFramebuffer(u.FRAMEBUFFER,null);return C};
a.PC=function(a,b,c){if(g&&!u.getShaderParameter(a,u.COMPILE_STATUS))throw c=e(c),h.error("shader compilation failed:\n"+c+"\n"+u.getShaderInfoLog(a)+" ("+b+")"),"Engine failed: see above for error messages";};a.QC=function(a,c,l,r,k,d){if(g&&!u.getProgramParameter(a,u.LINK_STATUS)){var n=b.Gv();n&&(k=n.getTranslatedShaderSource(l),d=n.getTranslatedShaderSource(r));k=e(k);d=e(d);h.error("shader linking failed:\n"+k+"\n\n\n"+d+"\n"+u.getProgramInfoLog(a)+" ("+c+")");throw"Engine failed: see above for error messages";
}};a.tr=function(a){g=a};a.QM=function(a){l[a]=a in l?l[a]+1:1};a.update=function(){for(var a in l)h.log(a,l[a]),l[a]=0};a.am=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(q.We(c))for(var e=0;e<c.length;e++)a.push(c[e]);else a.push(arguments[b])}z.push(a)};a.kx=function(){for(var a=1,b=0;b<z.length;b++){var c=z[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],q.We(a))for(var e=0;e<a.length;e++)c.push(a[e]);else c.push(arguments[b]);
z.push(c)};var D=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.Sx=function(a){a||(a=1);for(var b=0,c={},e=Math.max(0,performance.now()-1E3*a),g=0;g<z.length;g++){var d=z[g];a=d[0];if(!(a<e)){var n=String(d[1]);c[n]||(c[n]=D[b++%D.length]);a=["%c"+(a/1E3).toFixed(6),c[n],n];for(n=2;n<d.length;n++)a.push(d[n]);h.log.apply(this,a)}}z.splice(0)};a.Wq=function(a){a||(a=1);for(var b={},c=Math.max(0,performance.now()-1E3*a),e=0;e<z.length;e++){var g=z[e];a=g[0];
if(!(a<c))for(var d=2;d<g.length;d++){var n=String(g[1]);3<g.length&&(n+="_"+String(d-2));b[n]||(b[n]=n+"\n");b[n]+=String(a)+" "+g[d]+"\n"}}a="";for(n in b)a+=b[n]+"\n\n";h.log(a);z.splice(0)};a.bM=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&b("trident")&&b("msie");case "opera":return b("opera")&&
b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.du=function(a){if(q.We(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.IL=function(a,b){a.constructor!=b&&q.ma("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.KL=c;a.LL=function(a){G?c(a,F):G=!0;F=a}};b4w.module.__textures=function(a,y){function e(){return{name:"",type:0,source:"",Hr:"",width:0,height:0,Ro:1,wl:!0,Ch:1024,Zu:!1,De:null,Va:null,Qi:null,py:1,ef:0,Ri:!1,Jn:!1,ah:!1,M:0,ta:0,mi:0,sJ:!1,Gh:!1,Kq:0,uc:0,gc:0,ib:null,og:null}}function c(d,c,g,r){var h=d.type,f=new Uint8Array([204,204,204,255]),p=e();switch(h){case "DATA_TEX2D":case "IMAGE":var t=n.createTexture(),l=n.TEXTURE_2D;n.bindTexture(l,t);n.texImage2D(l,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,f);d.image&&"MOVIE"==d.image.source&&
(p.ah=!0,p.M=d.frame_start,p.ta=d.frame_offset,p.mi=d.frame_duration,p.sJ=d.use_auto_refresh,p.Gh=d.use_cyclic,p.Kq=d.movie_length,0!=p.ta&&F.warn('Frame offset for texture "'+d.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));break;case "NONE":t=n.createTexture();l=n.TEXTURE_2D;n.bindTexture(l,t);if("NONE"==d.b4w_source_type)return null;if("SCENE"==d.b4w_source_type)if(d.b4w_source_id&&(g=H.vb("name",d.b4w_source_id,g)))p.Ch=d.b4w_source_size,g.Pd=g.Pd||[],g.Pd.push(d),
n.texImage2D(l,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,f);else return null;break;case "ENVIRONMENT_MAP":t=n.createTexture();l=n.TEXTURE_CUBE_MAP;n.bindTexture(l,t);g="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var m=0;6>m;m++)x.kq?n.texImage2D(n["TEXTURE_CUBE_MAP_"+g[m]],0,n.RGB,1,1,0,n.RGB,n.UNSIGNED_BYTE,f):n.texImage2D(n["TEXTURE_CUBE_MAP_"+g[m]],0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,f);break;case "BLEND":return null;default:return F.error('texture "'+d.name+
'" has unsupported type "'+h+'"'),null}"NONE"==h&&(!d.b4w_enable_canvas_mipmapping||"CANVAS"!=d.b4w_source_type)||"DATA_TEX2D"==h||"IMAGE"==h&&"MOVIE"==d.image.source?n.texParameteri(l,n.TEXTURE_MIN_FILTER,n.LINEAR):x.kq&&"ENVIRONMENT_MAP"==h?n.texParameteri(l,n.TEXTURE_MIN_FILTER,n.LINEAR):n.texParameteri(l,n.TEXTURE_MIN_FILTER,B[x.yn]);n.texParameteri(l,n.TEXTURE_MAG_FILTER,n.LINEAR);f=l;g=d.b4w_anisotropic_filtering;"DEFAULT"===g&&(g=c);"OFF"!==g&&x.xl&&(c=D.XE())&&(g=parseFloat(g.split("x")[0]),
n.texParameterf(f,c.TEXTURE_MAX_ANISOTROPY_EXT,g));"REPEAT"!=d.extension||d.b4w_shore_dist_map?(n.texParameteri(l,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(l,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)):(n.texParameteri(l,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(l,n.TEXTURE_WRAP_T,n.REPEAT));p.type=a.Ph;p.width=1;p.height=1;p.ib=t;p.gc=l;"CANVAS"==d.b4w_source_type&&"NONE"==h?(h=d.b4w_source_id,t=d.b4w_source_size,p.Zu=d.b4w_enable_canvas_mipmapping,p.Hr=h,p.source="CANVAS",l=document.createElement("canvas"),
l.width=t,l.height=t,p.De=l.getContext("2d"),r in k||(k[r]={}),k[r][h]=p,b(p)):"SCENE"==d.b4w_source_type&&"NONE"==h?(p.Hr=d.b4w_source_id,p.source="SCENE"):(p.source=h,n.generateMipmap(l),n.bindTexture(l,null));p.name=d.name;return d.e=p}function b(a){if("CANVAS"!=a.source)throw"Wrong texture";var b=a.gc;n.bindTexture(b,a.ib);var d=u(a),c=w(a),e=a.De.canvas;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0);n.texImage2D(b,0,d,d,c,e);n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);a.Zu&&n.generateMipmap(b);n.bindTexture(b,
null);a.width=e.width;a.height=e.height}function h(a){var b=a.gc;n.bindTexture(b,a.ib);n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0);n.texImage2D(b,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,a.Qi[a.ef]);n.bindTexture(b,null)}function m(a){n.texParameteri(a,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE);n.texParameteri(a,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);n.texParameteri(a,n.TEXTURE_MAG_FILTER,n.LINEAR);n.texParameteri(a,n.TEXTURE_MIN_FILTER,n.LINEAR)}function q(a,b){var d=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384];
return-1==d.indexOf(a)||-1==d.indexOf(b)}function u(b){switch(b.type){case a.Ph:b=n.RGBA;break;case a.Yn:b=n.RGB;break;case a.ql:b=n.RGBA;break;case a.rl:b=n.RGB;break;case a.sj:b=n.DEPTH_COMPONENT;break;default:throw"Wrong texture type";}return b}function w(b){switch(b.type){case a.Ph:b=n.UNSIGNED_BYTE;break;case a.Yn:b=n.UNSIGNED_BYTE;break;case a.ql:b=n.FLOAT;break;case a.rl:b=n.FLOAT;break;case a.sj:b=n.UNSIGNED_INT;break;default:throw"Wrong texture type";}return b}function g(a,b){return b in
d&&a in d[b]?(x.ud?d[b][a].Ri=!0:d[b][a].Va.play(),!0):null}function l(a,b){if(b in d&&a in d[b]){var c=d[b][a];x.ud?(c.ef=c.ta,h(c),c.ef++):c.Va.currentTime=c.ta/c.uc;return!0}return null}function z(a,b){return b in d&&a in d[b]?(x.ud?d[b][a].Ri=!1:d[b][a].Va.pause(),!0):null}var C=y("__config"),F=y("__print"),G=y("__dds"),D=y("__extensions"),H=y("__util"),x=C.r,A=C.ze,r=C.Jd;a.Hc=0;a.t=0;a.vB=0;a.tB=0;a.uB=0;a.sB=0;a.Ph=10;a.Yn=20;a.ql=30;a.rl=40;a.sj=50;a.Oh=60;var k={},d={},n=null,B;a.Id=function(b){B=
[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.Hc=b.NEAREST;a.t=b.LINEAR;a.vB=b.NEAREST_MIPMAP_NEAREST;a.tB=b.LINEAR_MIPMAP_NEAREST;a.uB=b.NEAREST_MIPMAP_LINEAR;a.sB=b.LINEAR_MIPMAP_LINEAR;n=b};a.rN=function(a,b){return b in k&&a in k[b]?k[b][a].De:null};a.LQ=function(a,d){return d in k&&a in k[d]?(b(k[d][a]),!0):!1};a.Sl=function(b,d){var c=e();c.name=b;c.type=d;c.source="NONE";if(d==a.Oh)c.og=n.createRenderbuffer();else{var g=n.TEXTURE_2D,k=n.createTexture();
n.bindTexture(g,k);n.texParameteri(g,n.TEXTURE_MAG_FILTER,n.LINEAR);n.texParameteri(g,n.TEXTURE_MIN_FILTER,n.LINEAR);n.texParameteri(g,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE);n.texParameteri(g,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);n.bindTexture(g,null);c.gc=g;c.ib=k}return c};a.pD=function(b){var d=n.createTexture(),c=n.TEXTURE_CUBE_MAP;n.bindTexture(c,d);n.texParameteri(c,n.TEXTURE_MAG_FILTER,n.LINEAR);n.texParameteri(c,n.TEXTURE_MIN_FILTER,n.LINEAR);n.texParameteri(c,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE);n.texParameteri(c,
n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);for(var g="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),k=0;6>k;k++)n.texImage2D(n[g[k]],0,n.RGBA,b,b,0,n.RGBA,n.UNSIGNED_BYTE,null);n.bindTexture(c,null);c=e();c.name="CUBEMAP";c.type=a.Ph;c.source="NONE";c.width=3*b;c.height=2*b;c.Ro=1;c.ib=d;c.gc=n.TEXTURE_CUBE_MAP;return c};a.Nk=function(b,d,c){if(b.type!=a.Oh){var e=b.gc;n.bindTexture(e,
b.ib);d&&n.texParameteri(e,n.TEXTURE_MIN_FILTER,d);c&&n.texParameteri(e,n.TEXTURE_MAG_FILTER,c);n.bindTexture(e,null)}};a.zN=function(b){if(b.type==a.Oh)return{min:a.Hc,oG:a.Hc};var d=b.gc;n.bindTexture(d,b.ib);b=n.getTexParameter(d,n.TEXTURE_MIN_FILTER);var c=n.getTexParameter(d,n.TEXTURE_MAG_FILTER);n.bindTexture(d,null);return{min:b,oG:c}};a.resize=function(b,d,c){d=Math.max(d,1);c=Math.max(c,1);if(b.width!=d||b.height!=c){if(b.type==a.Oh)n.bindRenderbuffer(n.RENDERBUFFER,b.og),n.renderbufferStorage(n.RENDERBUFFER,
n.DEPTH_COMPONENT16,d,c),n.bindRenderbuffer(n.RENDERBUFFER,null);else{var e=b.gc;n.bindTexture(e,b.ib);var g=u(b),f=w(b);n.texImage2D(e,0,g,d,c,0,g,f,null);n.bindTexture(e,null)}d>x.bc||c>x.bc?F.error('Slink texture "'+b.name+'" has unsupported size: '+d+"x"+c+". Max available: "+x.bc+"x"+x.bc+"."):(b.width=d,b.height=c)}};a.JD=c;a.pJ=function(a){var b=a.gc;n.bindTexture(b,a.ib);n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Va.length?n.texImage2D(b,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,a.Va):n.texImage2D(b,
0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,a.Va);n.bindTexture(b,null)};a.mJ=h;a.Wk=function(a,b,c,e,g){var f=a.source,p=a.gc;n.bindTexture(p,a.ib);if(4==b.length){var k=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==f)if(k)n.texImage2D(p,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(c){c=G.ow(b);if(c.width>x.bc||c.height>x.bc){F.error('Texture "'+e+'" has unsupported size: '+c.width+"x"+c.height+". Max available: "+x.bc+"x"+x.bc+".");return}G.rJ(n,D.bw(),
b,!0);q(c.width,c.height)&&(a.Lt||F.warn("using NPOT texture",e),m(p));a.width=c.width;a.height=c.height;a.Ro=G.cF(b)}else{n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0);if(b.width>x.bc||b.height>x.bc){F.error('Texture "'+e+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+x.bc+"x"+x.bc+".");return}a.ah?x.ud?b&&(g in d||(d[g]={}),d[g][a.name]=a,a.Qi=b,a.uc=a.Kq/b.length,a.mi=Math.round(a.mi/a.uc),a.ta=Math.round(a.ta/a.uc),a.M=Math.round(a.M/a.uc),a.ef=a.ta,n.texImage2D(p,0,n.RGBA,n.RGBA,
n.UNSIGNED_BYTE,a.Qi[0])):(a.Va=b,a.Va.loop=a.Gh,b&&(g in d||(d[g]={}),d[g][a.name]=a),a.uc=A.Pa,b.duration&&(a.uc=a.Kq/b.duration),r.Wu||(b.playbackRate=A.Pa/a.uc,r.iu&&2<b.playbackRate&&(b.playbackRate=2)),n.texImage2D(p,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,a.Va)):n.texImage2D(p,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,b);a.ah?x.ud?(a.width=b[0].width,a.height=b[0].height):(a.width=b.videoWidth,a.height=b.videoHeight):(a.width=b.width,a.height=b.height);q(a.width,a.height)?(a.Lt||(a.ah?F.warn("using NPOT video texture",
e):F.warn("using NPOT texture",e)),m(p)):a.ah||n.generateMipmap(p)}else if("ENVIRONMENT_MAP"==f)if(c=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],k){for(k=0;6>k;k++)g=c[k],n.texImage2D(n["TEXTURE_CUBE_MAP_"+g[0]],0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);f=b.width/3;if(f>x.kh||f>x.kh){F.warn('Cubemap texture "'+e+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+
3*x.kh+"x"+2*x.kh+". Reduced image size will be used.");var h=b.width/3*(x.kh/f)}else h=f;for(k=0;6>k;k++){g=c[k];var l=document.createElement("canvas");l.width=h;l.height=h;var u=l.getContext("2d");"POSITIVE_Y"==g[0]||"NEGATIVE_Y"==g[0]?(u.translate(0,h),u.scale(1,-1)):(u.translate(h,0),u.scale(-1,1));u.drawImage(b,g[1]*f,g[2]*f,f,f,0,0,h,h);n.texImage2D(n["TEXTURE_CUBE_MAP_"+g[0]],0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,l)}a.width=3*h;a.height=2*h;q(b.width/3,b.height/2)?(F.warn("using NPOT cube map texture",
e),m(p)):n.generateMipmap(p)}else"DATA_TEX2D"==f&&(n.texImage2D(p,0,n.RGBA,b.width,b.height,0,n.RGBA,n.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);n.bindTexture(p,null)};a.ZD=function(a){n.deleteTexture(a)};a.nk=function(a){return a&&a.name&&(a.ib||a.og)?!0:!1};a.Qw=function(a){return a&&a.name&&a.og?!0:!1};a.BO=function(b){return b.type==a.ql||b.type==a.rl?!0:!1};a.yF=function(b){var d=0;switch(b.type){case a.Ph:case a.Yn:d=4;break;case a.ql:case a.rl:d=16;break;case a.sj:d=3;break;
case a.Oh:d=2}return d};a.TE=function(a){var b=null,b={name:"special_ssao_texture",type:"DATA_TEX2D",extension:"REPEAT",b4w_anisotropic_filtering:"OFF"};c(b,null,a,0);b.image={filepath:null};return b};a.aa=function(){if(!x.ud)for(var a in d)for(var b in d[a])d[a][b].Va.pause(),d[a][b].Va.src="",d[a][b].Va.load();k={};d={}};a.VG=g;a.sH=l;a.OG=z;a.pause=function(){for(var a in d)for(var b in d[a])x.ud&&!d[a][b].Ri||!x.ud&&d[a][b].Va.paused||(z(b,a),d[a][b].Jn=!0)};a.reset=function(){for(var a in d)for(var b in d[a])l(b,
a),d[a][b].Jn=!1};a.play=function(a){for(var b in d)for(var c in d[b])if(!a||d[b][c].Jn)g(c,b),d[b][c].Jn=!1}};b4w.module.__dds=function(a,y){function e(a,b,c,e){var g=new Uint16Array(4),h=new Uint16Array(c*e),m=0,q=0,u=0,r=q=m=0,k=0,d=0,n=0,w=c/4;e/=4;for(var y=0;y<e;y++)for(var E=0;E<w;E++)u=b+4*(y*w+E),g[0]=a[u],g[1]=a[u+1],m=g[0]&31,q=g[0]&2016,r=g[0]&63488,k=g[1]&31,d=g[1]&2016,n=g[1]&63488,g[2]=5*m+3*k>>3|5*q+3*d>>3&2016|5*r+3*n>>3&63488,g[3]=5*k+3*m>>3|5*d+3*q>>3&2016|5*n+3*r>>3&63488,m=a[u+2],q=4*y*c+4*E,h[q]=g[m&3],h[q+1]=g[m>>2&3],h[q+2]=g[m>>4&3],h[q+3]=g[m>>6&3],q+=c,h[q]=g[m>>8&3],h[q+1]=g[m>>
10&3],h[q+2]=g[m>>12&3],h[q+3]=g[m>>14],m=a[u+3],q+=c,h[q]=g[m&3],h[q+1]=g[m>>2&3],h[q+2]=g[m>>4&3],h[q+3]=g[m>>6&3],q+=c,h[q]=g[m>>8&3],h[q+1]=g[m>>10&3],h[q+2]=g[m>>12&3],h[q+3]=g[m>>14];return h}function c(a,b,c,h){var y=new Int32Array(c,0,31),D,H,x,A,r,k;if(542327876!=y[0])return q.error("Invalid magic number in DDS header"),0;if(!y[20]&4)return q.error("Unsupported format, must contain a FourCC code"),0;D=y[21];switch(D){case u:H=8;x=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case w:H=16;x=
b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case g:H=16;x=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return q.error("Unsupported FourCC code:",m(D)),null}k=1;y[2]&131072&&!1!==h&&(k=Math.max(1,y[7]));A=y[4];r=y[3];y=y[1]+4;if(b)for(D=0;D<k;++D)h=Math.max(4,A)/4*Math.max(4,r)/4*H,b=new Uint8Array(c,y,h),a.compressedTexImage2D(a.TEXTURE_2D,D,x,A,r,0,b),y+=h,A=Math.max(.5*A,1),r=Math.max(.5*r,1);else if(D==u)Math.max(4,A),Math.max(4,r),b=new Uint16Array(c),c=e(b,y/2,A,r),a.texImage2D(a.TEXTURE_2D,
0,a.RGB,A,r,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,c),h&&a.generateMipmap(a.TEXTURE_2D);else return q.error("No manual decoder for",m(D),"and no native support"),0;return k}function b(a,b,e,g,h,m){var q=new XMLHttpRequest;q.open("GET",e,!0);q.responseType="arraybuffer";q.onload=function(){if(200==q.status){a.bindTexture(a.TEXTURE_2D,g);var e=c(a,b,q.response,h);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<e?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}m&&
m(g)};q.send(null);return g}function h(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function m(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var q=y("__print"),u=h("DXT1"),w=h("DXT3"),g=h("DXT5");a.MM=e;a.rJ=c;a.ow=function(a){a=new Int32Array(a,0,31);return{width:a[4],height:a[3]}};a.cF=function(a){var b=1;a=(new Int32Array(a,0,31))[21];switch(a){case u:b=6;break;case w:case g:b=4;break;default:q.error("Unsupported FourCC code:",m(a))}return b};
a.QO=b;a.PO=function(a,c,e,g){var h=a.createTexture();b(a,c,e,h,!0,g);return h}};b4w.module.__assets=function(a,y){function e(){return G.UF()?y(G.mc.Il).data:null}function c(){var a={tl:null,DB:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var d=b.length,c=new Int8Array(d),f=0;f<d;f++)c[f]=b.charCodeAt(f);return c.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,d){a.tl=d;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=e();b&&a.tl in b&&(a.status=200,b[a.tl]&&(a.response=a.DB(b[a.tl])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var d=0,c=0;c<b.length;c++){var e=b[c];20===e.state&&d++;if(d>=k.wG)break;if(10===e.state)switch(e.state=20,d++,e.type){case a.el:h(e,"arraybuffer");break;case a.Ds:h(e,"json");break;case a.Es:h(e,"text");break;case a.Bs:m(e);break;case a.fl:q(e);break;case a.Cs:u(e);break;case a.hl:w(e);break;
case a.gl:g(e);break;default:x.ma("Wrong asset type: "+e.type)}}}function h(a,b){var d=e(),g=d&&a.s in d?new c:new XMLHttpRequest;g.open("GET",a.s,!0);"text"==b?(g.overrideMimeType("text/plain"),g.responseType="text"):"json"==b?(g.overrideMimeType("application/json"),g.responseType="text"):g.responseType=b;g.onreadystatechange=function(){if(40!=a.state&&4==g.readyState){if(200==g.status||0==g.status){var d=g.response;if(d){if("json"==b&&"string"==typeof d)try{d=JSON.parse(d)}catch(c){a.wb(null,a.uri,
a.type,a.s,a.Db);D.error(c+" (parsing JSON "+a.s+")");return}a.wb(d,a.uri,a.type,a.s,a.Db)}else a.wb(null,a.uri,a.type,a.s,a.Db),D.error("empty responce when trying to get "+a.s)}else a.wb(null,a.uri,a.type,a.s,a.Db),D.error(g.status+" when trying to get "+a.s);a.state=30}};g.addEventListener("progress",function(b){b.lengthComputable&&a.Ux(b.loaded/b.total)},!1);g.send(null)}function m(a){var b=e(),d=b&&a.s in b?new c:new XMLHttpRequest;d.open("GET",a.s,!0);d.responseType="arraybuffer";d.onreadystatechange=
function(){if(40!=a.state&&4==d.readyState)if(200==d.status||0==d.status){var b=d.response;b?H.TD(b,function(b){a.wb(b,a.uri,a.type,a.s,a.Db);a.state=30},function(){a.wb(null,a.uri,a.type,a.s,a.Db);D.error("failed to decode "+a.s);a.state=30}):(a.wb(null,a.uri,a.type,a.s,a.Db),D.error("empty responce when trying to get "+a.s),a.state=30)}else a.wb(null,a.uri,a.type,a.s,a.Db),D.error(d.status+" when trying to get "+a.s),a.state=30};d.send(null)}function q(a){var b=document.createElement("img");d.allow_cors&&
(b.crossOrigin="Anonymous");b.onload=function(){40!=a.state&&(a.wb(b,a.uri,a.type,a.s,a.Db),a.state=30)};b.addEventListener("error",function(){40!=a.state&&(a.wb(null,a.uri,a.type,a.s,a.Db),D.error("could not load image: "+a.s),a.state=30)},!1);var c=e();if(c&&a.s in c)if(c[a.s]){var g=z(a.s);b.src="data:"+g+";base64,"+c[a.s]}else r.pq()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.s}function u(a){var b=document.createElement("audio");
if(d.allow_cors||d.wu)b.crossOrigin="Anonymous";b.addEventListener("loadeddata",function(){40!=a.state&&(a.wb(b,a.uri,a.type,a.s,a.Db),a.state=30)},!1);b.addEventListener("error",function(){40!=a.state&&(a.wb(null,a.uri,a.type,a.s,a.Db),D.error("could not load sound: "+a.s),a.state=30)},!1);var c=e();if(c&&a.s in c)if(c[a.s]){var g=C(a.s);b.src="data:"+g+";base64,"+c[a.s];40!=a.state&&(a.wb(b,a.uri,a.type,a.s,a.Db),a.state=30)}else r.pq()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",
!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.s,d.$g&&b.load();d.Jq&&(b.autoplay=!0,b.pause());setTimeout(function(){b.lI=1},5E3)}function w(a){function b(){40!=a.state&&(a.wb(null,a.uri,a.type,a.s),D.error("could not load video: "+a.s,a.Db),a.state=30)}var c=document.createElement("video");c.muted=!0;if(d.allow_cors||d.$g)c.crossOrigin="Anonymous";c.addEventListener("loadeddata",function(){c.removeEventListener("error",b,!1);40!=a.state&&(a.wb(c,a.uri,a.type,a.s,a.Db),a.state=
30)},!1);c.addEventListener("error",b,!1);var g=e();if(g&&a.s in g)if(g[a.s]){var f=F(a.s);c.src="data:"+f+";base64,"+g[a.s];40!=a.state&&c.addEventListener("loadeddata",function(){a.wb(c,a.uri,a.type,a.s,a.Db);a.state=30},!1)}else r.pq()?(g=document.createEvent("CustomEvent"),g.initCustomEvent("error",!1,!1,null)):g=new CustomEvent("error"),c.dispatchEvent(g);else c.src=a.s,d.$g&&c.load();d.Jq&&(c.autoplay=!0,c.pause());setTimeout(function(){c.lI=1},1E4)}function g(a){function b(d){a.wb(d,a.uri,
a.type,a.s,a.Db)}var d=e(),g=d&&a.s in d?new c:new XMLHttpRequest;g.open("GET",a.s,!0);g.responseType="arraybuffer";g.onreadystatechange=function(){if(40!=a.state&&4==g.readyState){if(200==g.status||0==g.status){var d=g.response;d?l(d,b):(a.wb(null,a.uri,a.type,a.s,a.Db),D.error("empty responce when trying to get "+a.s))}else a.wb(null,a.uri,a.type,a.s,a.Db),D.error(g.status+" when trying to get "+a.s);a.state=30}};g.addEventListener("progress",function(b){b.lengthComputable&&a.Ux(b.loaded/b.total)},
!1);g.send(null)}function l(a,b){for(var d=new Int32Array(a),c=new Int8Array(a),f=d[3],e={images:[],Pt:[],uc:d[4]},g=20,k=0;k<f;k++){var n=d[g/4],r=new Blob([c.subarray(g+4,g+4+n)],{type:"image/jpg"}),h=document.createElement("img");h.src=window.URL.createObjectURL(r);e.images.push(h);e.Pt.push(r);g+=n+8-n%4}h.onload=function(){for(var a=0;a<e.images.length;a++)window.URL.revokeObjectURL(e.images[a].src);delete e.Pt;b(e)}}function z(a){var b="image";switch(x.Op(a).toLowerCase()){case "jpeg":case "jpg":b+=
"/jpeg";break;case "png":b+="/png"}return b}function C(a){var b="audio";switch(x.Op(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function F(a){var b="video";switch(x.Op(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var G=y("__config"),D=y("__print"),H=y("__sfx"),x=y("__util"),A=y("__version"),r=y("__compat"),k=G.Ae,d=G.r;a.el=10;a.Ds=
20;a.Es=30;a.Bs=40;a.fl=50;a.Cs=60;a.hl=70;a.gl=80;var n=[],B=0,I={};a.Sk=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.ZN=function(a){if(I[a])return I[a];var b=k.Rx?a+A.timestamp():a,d=new XMLHttpRequest;d.overrideMimeType("text/plain");d.open("GET",b,!1);d.send(null);if(200==d.status||0==d.status){b=d.responseText;if(b.length)return I[a]=b;x.ma("Error XHR: responce is empty, GET "+a)}else x.ma("Error XHR: "+d.status+", GET "+a)};a.aa=
function(){for(var a=0;a<n.length;a++)n[a].state=40;n=[];B=0;I={}};a.tc=function(a,d,c,g){for(var f=0;f<a.length;f++){var p=a[f],p={uri:p[0],type:p[1],s:p[2],Db:p[3],state:10,wb:d||function(){},Lx:c||function(){},Ux:g||function(){},Mx:B};if(k.Rx){var r=e();r&&p.s in r||(p.s+=A.timestamp())}n.push(p)}b(n);B++};a.update=function(){b(n);for(var a=n,d=0,c=!0,e=0;e<a.length;e++){var f=a[e];f.Mx===a[d].Mx?30!==f.state&&(c=!1):(c&&(a[e-1].Lx(),c=e-d,a.splice(d,c),e-=c),d=e,c=30===a[e].state?!0:!1);e===a.length-
1&&c&&(a[e].Lx(),a.splice(d))}}};b4w.module.__sfx=function(a,y){function e(){var a=window.AudioContext||window.webkitAudioContext;if(a){a=new a;if(a.createGain)return a;D.warn("deprecated WebAudio implementation");return null}D.warn("WebAudio is not supported");return null}function c(a,d,c){var f=a.k;if("NONE"!=f.behavior){c||(c=0);var e=f.loop,g=f.pitch;if(f.src&&(e||0<=c)){f.qo=Math.floor(5E4*Math.random());var k=E.currentTime+d;f.dd=k;f.state=20;b(a);"POSITIONAL"==f.behavior||"BACKGROUND_SOUND"==f.behavior?(d=E.createBufferSource(),
d.buffer=f.src,d.playbackRate.value=g,e?(f.Fb&&f.Fb.disconnect(),d.loop=!0,d.start(k),f.duration=0):(e=d.buffer?d.buffer.duration:0,c>e?(e=k+c+f.Ne,d.loop=!0,d.start(k),d.stop(e),f.duration=c):(d.loop=!1,d.start(k),f.duration=e)),d.connect(f.Bc),f.Fb=d,m(f),q(f)):"BACKGROUND_MUSIC"==f.behavior&&(H.ai(f.uo),H.ai(f.vo),c=function(){var b=a.k,d=b.src;d&&(d.volume=1,d.loop=b.loop,b.Fb=b.Fb||E.createMediaElementSource(d),b.Fb.connect(b.Bc),20==b.state&&(d.currentTime&&(d.currentTime=0),d.play()))},0==
d?c():f.uo=H.kn(c,1E3*d),f.duration=e?0:F(a));u(f,k)}}}function b(a){var b=a.k;if(!b.Bc){var d=a.e.h;a=a.e.quat;if(r.Em){var c=E.createBiquadFilter();c.type="peaking"}else c=null;var f=E.createGain();switch(b.behavior){case "POSITIONAL":var e=E.createPanner();"string"!=typeof e.panningModel?(e.panningModel=e.EQUALPOWER,e.distanceModel=e.INVERSE_DISTANCE):(e.panningModel="equalpower",e.distanceModel="inverse");e.setPosition(d[0],d[1],d[2]);A.copy(d,b.vq);d=k;x.va(a,x.Wb,d);e.setOrientation(d[0],d[1],
d[2]);A.copy(d,b.direction);e.refDistance=b.dist_ref;e.maxDistance=b.dist_max;e.rolloffFactor=b.attenuation;e.coneInnerAngle=b.eD;e.coneOuterAngle=b.fD;e.coneOuterGain=b.gD;var g=E.createGain();g.gain.value=C(b);c?(e.connect(c),c.connect(g)):e.connect(g);g.connect(f);b.Bc=e;if(b.pj){var n=E.createGain();f.connect(n);n.connect(E?M.k.Bc:null)}else n=null,f.connect(E?M.k.Bc:null);break;case "BACKGROUND_SOUND":e=null;g=E.createGain();g.gain.value=C(b);c?(b.Bc=c,c.connect(g)):b.Bc=g;g.connect(f);b.pj?
(n=E.createGain(),f.connect(n),n.connect(E?M.k.Bc:null)):(n=null,f.connect(E?M.k.Bc:null));break;case "BACKGROUND_MUSIC":n=e=null,g=E.createGain(),g.gain.value=C(b),c?(b.Bc=c,c.connect(g)):b.Bc=g,g.connect(f),f.connect(E?M.k.Bc:null)}b.xk=e;b.Xd=c;b.ni=g;b.Ng=f;b.Zx=n}}function h(a){var b=a.k,d=b.duration,b=b.XD+b.YD*Math.random();c(a,b,d)}function m(a){a.pj&&a.Zx.gain.cancelScheduledValues(a.dd);a.Ak&&a.Fb.playbackRate.cancelScheduledValues(a.dd);a.al=a.dd}function q(a){if(a.pj||a.Ak){var b=a.Zx,
d=a.Fb,c=d.buffer?d.buffer.duration:0;if(c){var f=a.dd;J[0]=a.qo;for(var e=0;5>e;){var g=a.pitch+a.Ak*x.td(J);if(f>=a.al){if(a.pj){var k=1-x.qa(a.pj,0,1)*Math.random();b.gain.setValueAtTime(k,f)}a.Ak&&d.playbackRate.setValueAtTime(g,f);e++}f+=c/g}a.al=f-.001}}}function u(a,b){if(a.wp||a.Ne){var d=a.Ng;d.gain.cancelScheduledValues(b);a.wp?(d.gain.setValueAtTime(0,b),d.gain.linearRampToValueAtTime(1,b+a.wp)):d.gain.setValueAtTime(1,b);a.Ne&&!a.loop&&(d.gain.setValueAtTime(1,b+a.duration),d.gain.linearRampToValueAtTime(0,
b+a.duration+a.Ne))}}function w(a){if("SPEAKER"!=a.type)throw"Wrong object type";var b=a.k;if(20==b.state||40==b.state){var d=b.Ng,c=E.currentTime;b.Ne&&(d.gain.setValueAtTime(d.gain.value,c),d.gain.linearRampToValueAtTime(0,c+b.Ne));"BACKGROUND_MUSIC"==b.behavior?b.src&&(H.ai(b.uo),H.ai(b.vo),b.vo=H.kn(function(){var b=a.k.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.Ne)):(d=b.Fb,b.duration<d.buffer.duration?b.Ne&&20==b.state?d.stop(c+b.Ne):20==b.state&&(d.stop(0),d.disconnect()):d.disconnect(),
b.dd=0,b.Tq=0,b.Co=0);b.state=30}}function g(a){a=a.k;if(20==a.state){var b=E.currentTime;a.Tq=b;if("BACKGROUND_MUSIC"==a.behavior){var d=a.src;d&&d.pause()}else{if(b>a.dd){J[0]=a.qo;for(var c=a.Fb.buffer.duration,f=a.dd;f<b;)d=a.pitch+a.Ak*x.td(J),f+=c/d;d*=c/d-(f-b)}else d=0;a.Co=d;a.Fb.stop(0);a.Fb.disconnect();m(a)}a.state=40}}function l(a){var b=a.k;if(40==b.state){var d=E.currentTime;b.dd+=d-b.Tq;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();else{a=a.k;var c=E.createBufferSource();c.loop=a.Fb.loop;
c.buffer=a.Fb.buffer;c.playbackRate.value=a.Fb.playbackRate.value;a.xk?c.connect(a.xk):c.connect(a.ni);a.Fb=c;b.al=d;b.Fb.start(b.dd,b.Co);q(b)}u(b,b.dd);b.state=20}}function z(a){return!a.k||20!=a.k.state&&40!=a.k.state&&30!=a.k.state?!1:!0}function C(a){return a.muted?0:a.volume}function F(a){a=a.k;return(a=a.src)?a.duration:0}var G=y("__config"),D=y("__print"),H=y("__time"),x=y("__util"),A=y("__vec3"),r=G.Jd;a.As=10;a.On=20;a.zs=30;var k=new Float32Array(3),d=new Float32Array(3),n=new Float32Array(3),
B=[],I=[],E=null,M=null,K=[],J=[1],f=null;a.$b=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(B.push("ogg"),B.push("ogv")),""!=a.canPlayType("audio/mpeg")&&B.push("mp3"),""!=a.canPlayType("audio/mp4")&&(B.push("mp4"),B.push("m4v")),""!=a.canPlayType("audio/webm")&&B.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&I.push("ogv"),""!=b.canPlayType("video/mp4")&&I.push("m4v"),""!=b.canPlayType("video/webm")&&
I.push("webm"));(E=r.ws?e():null)&&D.log("%cINIT WEBAUDIO: "+E.sampleRate+"Hz","color: #00a")};a.Ft=function(a){var b={fh:new Float32Array(3),bx:new Float32Array(3),Bi:new Float32Array(3)};a.k=b;if(E){var d=E.createGain(),c=E.createGain();b.ni=d;b.Ng=c;d.connect(c);c.connect(E.destination);if(a.b4w_enable_dynamic_compressor){var c=E.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;c.threshold.value=f.threshold;c.knee.value=f.knee;c.ratio.value=f.ratio;c.attack.value=f.attack;c.release.value=
f.release;c.connect(d);b.Hj=c;b.Bc=c}else b.Hj=null,b.Bc=d;d=E.listener;b.hi=G.r.Jo;b.hi||(d.dopplerFactor=a.audio_doppler_factor,d.speedOfSound=a.audio_doppler_speed);b.muted=!1;b.volume=1;b.Mg=0}};a.HH=function(a){M=a};a.jp=function(a){a||(a="ogg");return-1<B.indexOf(a)?a:"ogg"==a&&-1<B.indexOf("mp4")?"mp4":"mp3"==a&&-1<B.indexOf("ogg")?"ogg":"mp4"==a&&-1<B.indexOf("ogg")?"ogg":"ogv"==a&&-1<B.indexOf("m4v")?"m4v":"webm"==a&&-1<B.indexOf("m4v")?"m4v":"m4v"==a&&-1<B.indexOf("webm")?"webm":""};a.kp=
function(a){a||(a="webm");return-1<I.indexOf(a)?a:"ogv"==a&&-1<I.indexOf("m4v")?"m4v":"webm"==a&&-1<I.indexOf("m4v")?"m4v":"m4v"==a&&-1<I.indexOf("webm")?"webm":""};a.yf=function(a){if("SPEAKER"!=a.type)throw"Wrong speaker object";var b=a.data;a.k={};switch(b.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":a.k.behavior=E?b.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var d=a.k,c;E?(window.MediaElementAudioSourceNode?c=!0:(D.warn("MediaElementAudioSourceNode not found"),c=!1),c=c?"BACKGROUND_MUSIC":
"BACKGROUND_SOUND"):c="NONE";d.behavior=c;break;default:throw"Wrong speaker behavior";}b.sound||(a.k.behavior="NONE");a.k.hi=b.b4w_disable_doppler&&G.r.Jo;a.k.muted=b.muted;a.k.volume=b.volume;a.k.pitch=b.pitch;a.k.attenuation=b.attenuation;a.k.dist_ref=b.distance_reference;a.k.dist_max=b.distance_max||1E4;a.k.eD=b.cone_angle_inner;a.k.fD=b.cone_angle_outer;a.k.gD=b.cone_volume_outer;a.k.sc=b.b4w_cyclic_play;a.k.loop=b.b4w_loop;a.k.XD=b.b4w_delay;a.k.YD=b.b4w_delay_random;a.k.pj=b.b4w_volume_random;
a.k.Ak=b.b4w_pitch_random;a.k.wp=b.b4w_fade_in;a.k.Ne=b.b4w_fade_out;a.k.dd=0;a.k.Tq=0;a.k.Co=0;a.k.duration=0;a.k.al=0;a.k.qo=1;a.k.src=null;a.k.state=10;a.k.vq=new Float32Array(3);a.k.direction=new Float32Array(3);a.k.Jr=new Float32Array(3);a.k.uo=-1;a.k.vo=-1;a.k.Mg=0;K.push(a)};a.bz=function(b){if("SPEAKER"!=b.type)throw"Wrong object type";switch(b.k.behavior){case "POSITIONAL":return a.On;case "BACKGROUND_SOUND":return a.On;case "BACKGROUND_MUSIC":return a.zs;case "NONE":return a.As;default:throw"Wrong speaker behavior";
}};a.nJ=function(a,b){var d=a.k;switch(d.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":d.src=b;break;case "NONE":break;default:throw"Wrong speaker behavior";}};a.UG=function(){var a=E.createBufferSource();a.buffer=E.createBuffer(1,22050,22050);a.connect(E.destination);a.start(0)};a.TD=function(a,b,d){E?E.decodeAudioData(a,b,d):d()};a.pI=function(a){w(a);delete a.k;K.splice(K.indexOf(a),1)};a.aa=function(){for(var a=0;a<K.length;a++){var b=K[a].k;"BACKGROUND_MUSIC"==b.behavior?
(b=b.src)&&b.pause():b.Fb&&b.Fb.disconnect()}M&&M.k&&(a=M.k,a.fh[0]=0,a.fh[1]=0,a.fh[2]=0,a.Bi[0]=0,a.Bi[1]=0,a.Bi[2]=0);M=null;K.splice(0);f=null};a.update=function(a){if(E&&0!=K.length){for(var b=0;b<K.length;b++){var d=K[b],c=d.k,e=E.currentTime;E&&!c.loop&&c.sc&&20==c.state&&c.duration&&c.dd+c.duration<e&&h(d);20==c.state&&3>c.al-e&&q(c)}f&&f.kf.length&&(-1==f.Xa||a>f.qt+f.Yu[f.Xa])&&(b=f,-1<b.Xa&&w(b.kf[b.Xa]),-1==b.Xa&&b.random?d=Math.round(Math.random()*(b.kf.length-1)):b.random?(d=1+Math.round(Math.random()*
(b.kf.length-2)),d=(b.Xa+d)%b.kf.length):d=(b.Xa+1)%b.kf.length,h(b.kf[d]),b.Xa=d,b.qt=a)}};a.play=c;a.Vq=h;a.stop=w;a.yi=function(a){return 20==a.k.state};a.oI=g;a.qI=l;a.Dk=function(a,b){var d=a.k;d.pitch=b;!z(a)||"POSITIONAL"!=d.behavior&&"BACKGROUND_SOUND"!=d.behavior||(d.Fb.playbackRate.value=b,m(d),q(d))};a.Zv=function(a){return a.k.pitch};a.sc=function(a,b){a.k.sc=Boolean(b)};a.xi=function(a){return a.k.sc};a.kG=function(a,b,c,f){if(E&&a.k){var e=k;e[0]=0;e[1]=-1;e[2]=0;A.transformQuat(e,c,
e);d[0]=0;d[1]=0;d[2]=-1;A.transformQuat(d,c,d);c=E.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(e[0],e[1],e[2],d[0],d[1],d[2]);A.copy(e,a.k.bx);!a.k.hi&&f&&(n[0]=(b[0]-a.k.fh[0])/f,n[1]=(b[1]-a.k.fh[1])/f,n[2]=(b[2]-a.k.fh[2])/f,x.Ui(n,a.k.Bi,f,.3,n),c.setVelocity(n[0],n[1],n[2]),A.copy(n,a.k.Bi));A.copy(b,a.k.fh)}};a.cx=function(a,b){if(E&&M.k&&!M.k.hi){var d=k;b?A.copy(b,d):A.copy(M.k.bx,d);A.scale(d,a,d);E.listener.setVelocity(d[0],d[1],d[2]);A.copy(d,M.k.Bi)}};a.rI=function(a,b){var c=
a.k;if(z(a)&&"POSITIONAL"==c.behavior){var f=a.e.h,e=c.xk;e.setPosition(f[0],f[1],f[2]);var g=k;x.va(a.e.quat,x.Wb,g);e.setOrientation(g[0],g[1],g[2]);g=c.vq;!c.hi&&b&&(d[0]=(f[0]-g[0])/b,d[1]=(f[1]-g[1])/b,d[2]=(f[2]-g[2])/b,x.Ui(d,c.Jr,b,.3,d),e.setVelocity(d[0],d[1],d[2]),A.copy(d,c.Jr));A.copy(f,g)}};a.cz=function(a,b,d){var c=a.k;if(z(a)&&"POSITIONAL"==c.behavior&&!c.hi){var f=k;d?A.copy(d,f):A.copy(c.direction,f);A.scale(f,b,f);c.xk.setVelocity(f[0],f[1],f[2]);A.copy(f,c.Jr);A.copy(a.e.h,c.vq)}};
a.Ve=function(a){return a.k?!0:!1};a.Up=function(a){return a.k.behavior};a.bu=function(){for(var a=0;a<K.length;a++)if(z(K[a]))return!0;return!1};a.OH=function(a){var b=M.k;b&&(b.volume=a,E&&(b.ni.gain.value=C(b)))};a.qF=function(){var a=M.k;return a?a.volume:0};a.yr=function(a,b){var d=a.k;d.volume=b;z(a)&&(d.ni.gain.value=C(d))};a.lw=function(a){return a.k.volume};a.rk=function(a,b){a.k.muted=Boolean(b);z(a)&&(a.k.ni.gain.value=C(a.k))};a.Nw=function(a){return a.k.muted};a.DG=function(a){var b=
M.k;b&&(b.muted=Boolean(a),E&&(b.ni.gain.value=C(b)))};a.aG=function(){var a=M.k;return a?a.muted:!1};a.fk=function(){return K};a.pause=function(){for(var a=0;a<K.length;a++)g(K[a])};a.Fd=function(){for(var a=0;a<K.length;a++)l(K[a])};a.xy=function(a,b){if(a.k&&a.k.Hj){var d=a.k.Hj;d.threshold.value=b.threshold;d.knee.value=b.knee;d.ratio.value=b.ratio;d.attack.value=b.attack;d.release.value=b.release}};a.Fv=function(a){if(!a.k||!a.k.Hj)return null;a=a.k.Hj;return{threshold:a.threshold.value,knee:a.knee.value,
ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.Xu=function(a,b,d){if(z(a)){a=a.k;var c=a.Ng,f=E.currentTime;c.gain.setValueAtTime(c.gain.value,f);c.gain.linearRampToValueAtTime(b,f+d);a.Mg=d}};a.yz=function(a){if(z(a)){a=a.k;var b=a.Ng,d=E.currentTime;b.gain.setValueAtTime(b.gain.value,d);b.gain.linearRampToValueAtTime(1,d+a.Mg);a.Mg=0}};a.eE=function(a,b){if(E){var d=M.k,c=d.Ng,f=E.currentTime;c.gain.setValueAtTime(c.gain.value,f);c.gain.linearRampToValueAtTime(a,f+b);d.Mg=
b}};a.VI=function(){if(E){var a=M.k,b=a.Ng,d=E.currentTime;b.gain.setValueAtTime(b.gain.value,d);b.gain.linearRampToValueAtTime(1,d+a.Mg);a.Mg=0}};a.xt=function(a,b,d){f={Xa:-1,qt:0,random:d,kf:[],Yu:[]};for(d=0;d<a.length;d++){var c=a[d],e=F(c);0==e?D.warn("Ignoring speaker with zero duration: "+c.name):(w(c),c.k.sc=!1,f.kf.push(c),f.Yu.push(e+b))}};a.Iv=F;a.nu=function(){if(f)for(var a=f.kf,b=0;b<a.length;b++)w(a[b]);f=null};a.$v=function(a){return(a=a.k)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,
dist_max:a.dist_max,attenuation:a.attenuation}:null};a.Gy=function(a,b){var d=a.k;if(d&&"POSITIONAL"==d.behavior){d.dist_ref=b.dist_ref;d.dist_max=b.dist_max;d.attenuation=b.attenuation;var c=d.xk;c&&(c.refDistance=d.dist_ref,c.maxDistance=d.dist_max,c.rolloffFactor=d.attenuation)}};a.By=function(a,b){var d=a.k;d&&d.Xd&&(d.Xd.frequency.value=b.freq,d.Xd.Q.value=b.Q,d.Xd.gain.value=b.gain)};a.Nv=function(a){return(a=a.k)&&a.Xd?{freq:a.Xd.frequency.value,Q:a.Xd.Q.value,gain:a.Xd.gain.value}:null};a.Mv=
function(a,b,d,c){a=a.k;if(!a||!a.Xd)return null;a.Xd.getFrequencyResponse(b,d,c)}};b4w.module.__time=function(a,y){y("__util");var e=0,c=0,b=[],h=0,m=0,q=[];a.My=function(a){e=a;c=performance.now();for(a=0;a<b.length;a++){var h=b[a];e>h.sp&&(b.splice(a,1),a--,h.callback())}for(a=0;a<q.length;a++){var h=q[a],g=1-(h.sp-e)/h.duration,g=Math.min(g,1);h.callback(h.T+g*(h.wa-h.T));1==g&&(q.splice(a,1),a--)}};a.Jf=function(){return e};a.kn=function(a,m){var g;h++;g=h;b.push({id:g,callback:a,sp:e+(performance.now()-c+m)/1E3});return g};a.ai=function(a){for(var c=0;c<b.length;c++)if(b[c].id==
a){b.splice(c,1);break}};a.ku=function(a){for(var b=q.length;b--;)if(q[b].id==a){q.splice(b,1);break}};a.Sh=function(a,b,c,h){c/=1E3;var z;m++;z=m;q.push({id:z,callback:h,T:a,wa:b,sp:e+c,duration:c});h(a);return z};a.reset=function(){c=e=0;b.length=0;m=h=q.length=0}};"object"==typeof module&&module.tp&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function y(){var a=e,c=a.getDate(),c=10>c?"0"+String(c):String(c),m=a.getMonth()+1,m=10>m?"0"+String(m):String(m),q=String(a.getFullYear()),u=a.getHours(),u=10>u?"0"+String(u):String(u),w=a.getMinutes(),w=10>w?"0"+String(w):String(w),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return c+"."+m+"."+q+" "+u+":"+w+":"+a}var e=new Date(2015,6,29,10,16,53),c=[15,7];a.version=function(){return c};a.Zk=function(){for(var a="",e=0;e<c.length;e++)a=1==e?a+(10>c[e]?"0"+c[e]:
c[e]):a+c[e],e!=c.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.Ou=function(){return e};a.fp=y;a.timestamp=function(){var a=y(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.tp&&b4w.module.__version(exports);b4w.module.__compat=function(a,y){function e(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function c(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var h=y("__config"),m=y("__extensions"),q=y("__print");
y("__util");a.aE=function(a){a.getError()==a.INVALID_ENUM&&q.warn("Possible Tegra invalid enum issue detected, ignoring")};a.NH=function(a){var w=h.ze,g=h.r,l=h.context,z=h.Pi,C=h.Jd;g.hx=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS);g.bc=a.getParameter(a.MAX_TEXTURE_SIZE);g.kh=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE);var y=Boolean(m.fF());e("Firefox/28.0")&&(e("Linux")||e("Macintosh"))&&(q.warn("Firefox 28 detected, applying depth hack"),y=!1);e("iPad")||e("iPhone")?(q.warn("iOS detected, applying alpha hack, applying vertex animation mix normals hack, applying ios depth hack and disable smaa. Disable ssao for performance. Disable video textures. Initialize WebAudio context with empty sound."),
l.alpha||(g.background_color[3]=1),g.Mz=!0,g.smaa=!1,g.lf=!1,g.precision="highp",g.Gw=!0,g.Jw=!0):e("Mac OS X")&&e("Safari")&&!e("Chrome")&&(q.warn("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures."),C.Ht=!0,C.iu=!0);e("Windows")&&(e("Chrome/40")||e("Firefox/33")||e("Firefox/34")||e("Firefox/35")||e("Firefox/36"))&&(q.warn("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),g.Lo=!0);c()&&(q.warn("Mobile detected, applying various hacks for video textures."),
g.$g=!0,e("iPad")||e("iPhone")||(q.warn("Mobile (not iOS) detected, disable playback rate for video textures."),C.Wu=!0));(e("Firefox/35.0")||e("Firefox/36.0"))&&e("Windows")&&(q.warn("Windows/Firefox 35/36 detected, applying shadows slink hack"),g.hv=!0);if(e("iPhone")||b())q.warn("iPhone or IE11 detected. Enable sequential video fallback for video textures."),g.ud=!0;10>a.getParameter(a.MAX_VARYING_VECTORS)&&(q.warn("Not enough varyings, disable shadows on blend objects"),g.Vu=!0);if(l=m.aw())e("Macintosh")&&
-1<a.getParameter(l.UNMASKED_RENDERER_WEBGL).indexOf("Intel HD Graphics 3000")&&(q.warn("OS X / Intel HD 3000 detected, applying depth hack"),y=!1),e("Windows")&&e("Chrome")&&-1<a.getParameter(l.UNMASKED_RENDERER_WEBGL).indexOf("Intel")&&(q.warn("Chrome / Windows / Intel GPU detected, applying cubemap mipmap/rgb hack"),g.kq=!0),-1<a.getParameter(l.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(l.UNMASKED_RENDERER_WEBGL).indexOf("Mali-400")&&(q.warn("ARM Mali-400 detected, applying depth and frames blending hacks"),
y=!1,w.nv=!0),-1<a.getParameter(l.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(l.UNMASKED_RENDERER_WEBGL).indexOf("Mali-T604")&&(q.warn('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),g.precision="highp",g.Qk=!1),-1<a.getParameter(l.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(l.UNMASKED_RENDERER_WEBGL).indexOf("Mali-T760")&&(q.warn('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),g.precision="highp",g.lf=!1),-1<a.getParameter(l.UNMASKED_VENDOR_WEBGL).indexOf("Qualcomm")&&
-1<a.getParameter(l.UNMASKED_RENDERER_WEBGL).indexOf("Adreno")&&(q.warn("Qualcomm Adreno detected, applying shader constants hack."),g.Ry=!0,-1<a.getParameter(l.UNMASKED_RENDERER_WEBGL).indexOf("305")&&(q.warn('Qualcomm Adreno305 detected, set "highp" precision.'),g.precision="highp"),-1<a.getParameter(l.UNMASKED_RENDERER_WEBGL).indexOf("330")&&(q.warn('Qualcomm Adreno330 detected, set "highp" precision.'),g.precision="highp")),-1<a.getParameter(l.UNMASKED_VENDOR_WEBGL).indexOf("NVIDIA")&&-1<a.getParameter(l.UNMASKED_RENDERER_WEBGL).indexOf("Tegra 3")&&
(q.warn("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),g.Bp=!0),e("Windows")&&e("Chrome")&&a.getParameter(l.UNMASKED_RENDERER_WEBGL).match(/NVIDIA GeForce 8..0/)&&(q.warn("Chrome / Windows / NVIDIA GeForce 8000 series detected, setting max cubemap size to 256."),g.kh=256);0==a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS)&&(q.warn("Vertex textures are not allowed. Disabling vertex textures"),g.eo=!1);g.allow_hidpi&&1<window.devicePixelRatio&&(q.log("%cENABLE HIDPI MODE",
"color: #00a"),g.render_resolution_factor=1,g.smaa=!1);y||(g.Xj=!1,g.yk=!1,g.Lb=!1,g.water_dynamic=!1,g.dg=!1,g.qn=!1,g.smaa=!1);g.Fz=Boolean(m.bw());g.Nj=y;0===a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision&&(g.precision="mediump");b()&&(q.warn("IE11 detected. Set sky cubemap texture size to 512 (power of two)."),z.Vl=512);b()&&e("Touch")&&(q.warn("IE11 and touchscreen detected. Behaviour of the mouse move sensor will be changed."),g.hq=!0);128>=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS)&&
(q.warn("Not enough fragment uniforms, force low quality for B4W_LEVELS_OF_QUALITY nodes."),g.Bp=!0);e("Chrome")&&(q.log("Chrome detected. Some of deprecated functions related to the Doppler effect won't be called."),g.Jo=!0,g.wu=!0);if(b()||e("iPad"))q.warn("iPad or Internet Explorer detected. Applying alpha clip hack."),g.io=!0;c()&&e("Firefox")&&(q.log("Mobile firefox detected. Applying autoplay media hack."),g.Jq=!0)};a.Uu=c;a.ZB=function(){e("Firefox/35.0")&&e("Windows")&&(q.warn("Windows/Firefox 35 detected, forcing context's alpha"),
h.context.alpha=!0)};a.pq=b};b4w.module.shader_texts=function(a){a["anchors.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"void main ( ) { gl_FragColor = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={type:"group",a:[{type:"var",name:"ANCHOR_NUM",b:["0"]},{type:"textline",b:"attribute float a_index ; uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; void main ( ) { vec4 a ; a = u_view_matrix * vec4 ( u_position [ int ( a_index ) ] , 1.0 ) ; gl_Position = u_proj_matrix * a ; gl_PointSize = 4.0 ; }".split(" ")}]};
a["color_id.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",
name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"pack.glslf"},{type:"include",file:"fog.glslf"},{type:"include",file:"lighting.glslf"},
{type:"include",file:"procedural.glslf"},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform",
"mat4","u_view_matrix_frag",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform",
"vec4","u_diffuse_color",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_sampler",";"]}]}}]}]}}]},{type:"textline",b:["uniform","vec3","u_color_id",";"]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",
";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",
a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_VALUE"],group:{type:"group",
a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["USE_OUTLINE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_outline_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"varying vec3 eU ; varying vec4 eV ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eW",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eX",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",
d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","eZ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_perspective_cast_far_bound ; varying vec4 e_ ; varying vec4 fa ; varying vec4 fb ; varying vec4 fc ; uniform float u_perspective_cast_far_bound ; uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform sampler2D u_shadow_map0 ; uniform sampler2D u_shadow_map1 ; uniform sampler2D u_shadow_map2 ; uniform sampler2D u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fd",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"},{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["USE_REFRACTION"],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",b:"void main ( ) { float te , tf ; vec3 tg , th , ti , tj ;".split(" ")},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:"tg = u_camera_eye_frag - eU ; tg = normalize ( tg ) ; td ( tg , th , ti , tj , te , tf ) ; tf = tf ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"tf = ( texture2D ( u_sampler , fd ) ) . a ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"tf = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( tf < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_OUTLINE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["color_id.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},
{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",
";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",
b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 eU ; varying vec4 eV ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL",
"USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eW",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eX",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","eZ",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fd",";"]}]}}]}]}}]},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},
{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec4 vN ; float vO , vP , vQ ; mat4 vR ; vec3 vS , vT , vU , vV , vW , vX ; vS = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",
d:3},{type:"logical_or_expr",d:6},{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["vT","=","a_normal",";"]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"vU = vec3 ( a_tangent ) ; vV = a_tangent [ 3 ] * cross ( vT , vU ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vU = vec3 ( 0.0 ) ; vV = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vT = vec3 ( 0.0 ) ; vU = vec3 ( 0.0 ) ; vV = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"vS = mix ( vS , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:"vT = mix ( vT , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"vW = vec3 ( a_tangent ) ; vX = a_tangent_next [ 3 ] * cross ( a_normal_next , vW ) ; vU = mix ( vU , vW , u_va_frame_factor ) ; vV = mix ( vV , vX , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uT ( vS , vU , vV , vT ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["vV","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vV = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"vU = ( u_model_matrix * vec4 ( vV , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"vR = tM ( u_camera_eye , vU , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vR = tG ( u_camera_eye , vU , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vX = ( u_model_matrix * vec4 ( vV , 1.0 ) ) . xyz ; vR = vR * ty ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vX ) ;".split(" ")}]}}]},
{type:"textline",b:"el vY = tT ( vS - vV , vV , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vR ) ; vY . b = vU ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"el vY = tT ( vS , vV , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vH ( vY . a , vY . b , vT ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["vT","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vT = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:"vH ( vY . a , vY . b , vT ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logic_negative_expr",d:1}],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"fd = tW ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"eU = vY . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",
d:3},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:"eW = vY . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"vO = ( dot ( cross ( vY . e , vY . c ) , vY . d ) < 0.0 ) ? - 1.0 : 1.0 ; eX = vec4 ( vY . c , vO ) ;".split(" ")}]}}]},{type:"textline",b:"eV = u_view_matrix * vec4 ( vY . a , 1.0 ) ; vN = u_proj_matrix * eV ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",
b:"vN . xy += u_subpixel_jitter * vN . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vO = vN . x ; vP = vN . y ; vQ = vN . w ; eY . x = ( vO + vQ ) / 2.0 ; eY . y = ( vP + vQ ) / 2.0 ; eY . z = vQ ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"eZ = - eV . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:["vM","(",")",";"]}]}}]},{type:"textline",b:"gl_Position = u_proj_matrix * u_view_matrix * vec4 ( vY . a , 1.0 ) ; }".split(" ")}]};a["depth.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",
b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},
{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1},"NODES","ALPHA",{type:"logical_and_expr",d:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"include",file:"procedural.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"pack.glslf"},{type:"include",file:"fog.glslf"},{type:"include",file:"lighting.glslf"},
{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",
c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform",
"samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},
{type:"elif",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_VALUE"],group:{type:"group",a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_colormap0",";"]}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_diffuse_color",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eU",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eW",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eX",";"]}]}}]}]}},{type:"else",
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fd",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eV",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","e_",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fa",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fb",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fc",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE",
"REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","eZ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADELESS",
{type:"logic_negative_expr",d:1},"NODES","ALPHA",{type:"logical_and_expr",d:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",b:"void main ( ) { float vN , vO ; vec3 vP , vQ , vR , vS ;".split(" ")},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:"vP = u_camera_eye_frag - eU ; vP = normalize ( vP ) ; td ( vP , vQ , vR , vS , vN , vO ) ; vO = vO ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"vO = ( texture2D ( u_colormap0 , fd ) ) . a ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vO = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( vO < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","NO_SHADOWS",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",
d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}},{type:"elif",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( gT ( eV . z ) , 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",
a:[{type:"textline",b:"gl_FragColor . a += 0.00001 * eX . r ;".split(" ")}]}}]}]}}]},{type:"textline",b:["}"]}]};a["depth.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},
{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["NODES","ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},
{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS",
"CALC_TBN_SPACE",{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logic_negative_expr",d:1},"TEXTURE_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute",
"vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_shadow_cast_billboard_view_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",
b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",
c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logic_negative_expr",d:1},"TEXTURE_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",
a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eU",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS",
"CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eW",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eX",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fd",";"]}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eV",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","e_",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying",
"vec4","fa",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fb",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fc",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eY",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","eZ",";"]}]}}]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",
{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec2 wC ; vec4 wD , wE ; float wF ; mat4 wG , wH ; vec3 wI , wJ , wK , wL , wM , wN ; wI = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",
d:3},{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:["wJ","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wJ = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"wK = vec3 ( a_tangent ) ; wL = a_tangent [ 3 ] * cross ( wJ , wK ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wK = vec3 ( 0.0 ) ; wL = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"wI = mix ( wI , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:"wJ = mix ( wJ , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"wM = vec3 ( a_tangent ) ; wN = a_tangent_next [ 3 ] * cross ( a_normal_next , wM ) ; wK = mix ( wK , wM , u_va_frame_factor ) ; wL = mix ( wL , wN , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uT ( wI , wK , wL , wJ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",
{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["wL","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wL = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"el wO = wr ( wI , vec3 ( 0.0 ) , vec3 ( 0.0 ) , wJ , wL , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"wK = ( u_model_matrix * vec4 ( wL , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["HAIR_BILLBOARD",{type:"logic_negative_expr",d:1},"SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["wG","=","u_shadow_cast_billboard_view_matrix",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:["wG","=","u_view_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wH = tM ( u_camera_eye , wK , wG , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wH = tG ( u_camera_eye , wK , wG ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"wN = ( u_model_matrix * vec4 ( wL , 1.0 ) ) . xyz ; wH = wH * ty ( u_wind , u_time , u_jitter_amp , u_jitter_freq , wN ) ;".split(" ")}]}}]},{type:"textline",b:"el wO = tT ( wI - wL , wL , vec3 ( 0.0 ) , vec3 ( 0.0 ) , wJ , wH ) ; wO . b = wK ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"el wO = tT ( wI , wL , vec3 ( 0.0 ) , vec3 ( 0.0 ) , wJ , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["wJ","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wJ = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:"vH ( wO . a , wO . b , wJ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"eU = wO . a ;".split(" ")},
{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:"eW = wO . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"wF = ( dot ( cross ( wO . e , wO . c ) , wO . d ) < 0.0 ) ? - 1.0 : 1.0 ; eX = vec4 ( wO . c , wF ) ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"wD = u_view_matrix * vec4 ( wO . a , 1.0 ) ; wE = u_proj_matrix * wD ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"wE . xy += u_subpixel_jitter * wE . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:"eY = eT ( wE ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"eZ = - eV . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:["vM","(",")",";"]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"fd = tW ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wB ( wO . a , wO . e ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["eV","=","wD",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"wC = ( u_proj_matrix * u_view_matrix [ 3 ] ) . xy ; wF = SHADOW_TEX_RES / 2.0 ; wC = floor ( wC * wF + 0.5 ) / wF - wC ; wE . xy += wC ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","wE",";","}"]}]};a["grass_map.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",
a:[{type:"textline",b:["varying","vec4","wC",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["varying","float","wC",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","wC",";"]}]}}]}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],
group:{type:"group",a:[{type:"textline",b:["gl_FragColor","=","wC",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( wC , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , wC ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",
b:["}"]}]};a["grass_map.glslv"]={type:"group",a:[{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_grass_size",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_grass_color",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",
{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","wC",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["varying","float","wC",";"]}]}}]}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","wC",";"]}]}}]}]}}]},{type:"textline",b:"void main ( ) { vec4 wD ; mat4 wE ; vec3 wF ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"wF = ( u_model_matrix * vec4 ( vec3 ( 0.0 ) , 1.0 ) ) . xyz ; wE = tG ( u_camera_eye , wF , u_view_matrix ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WIND_BEND",
"BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wE = wE * ty ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",b:"el wG = tT ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , wE ) ; wG . b = wF ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"el wG = tT ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]},
{type:"textline",b:"wD = u_proj_matrix * u_view_matrix * vec4 ( wG . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:"wC = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["wC","=","a_grass_size",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],
group:{type:"group",a:[{type:"textline",b:["wC","=","a_grass_color",";"]}]}}]}]}}]},{type:"textline",b:["gl_Position","=","wD",";","}"]}]};a["halo.glslf"]={type:"group",a:[{type:"var",name:"NUM_LINES",b:["0"]},{type:"var",name:"NUM_RINGS",b:["0"]},{type:"var",name:"NUM_STARS",b:["0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ; varying vec4 wD ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 fd ; varying float wE ;".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_RINGS","NUM_LINES",{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"const int wF = NUM_RINGS ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const int wF = NUM_LINES ;".split(" ")}]}}]},{type:"textline",b:"float wH ( float wG ) { return wG - floor ( wG * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"void wQ ( inout float wI , in float wJ [ wF ] , in float wK ) { float wL , wM , wN , wO ; for ( int wP = 0 ; wP < NUM_RINGS ; wP ++ ) { wL = 40.0 * wJ [ wP ] ; wM = 300.0 * ( wH ( wL ) - 0.005 ) ; wN = wL ; wO = abs ( wN * ( u_halo_size * wM - wK ) ) ; wI += 1.0 - min ( wO , 1.0 ) ; } }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"void wZ ( inout float wR , in float wS [ wF ] , in float wT ) { float wU , wV , wW , wX ; for ( int wY = 0 ; wY < NUM_LINES ; wY ++ ) { wU = wS [ wY ] ; wV = wU ; wW = 1000.0 * ( wH ( wU ) - 0.005 ) ; wX = 20.0 * abs ( wV * fd . x + wW * fd . y ) ; wR += 1.0 - min ( wX , 1.0 ) ; } wR *= wT ; }".split(" ")}]}}]},{type:"textline",b:"void xf ( inout float w_ , in vec2 xa ) { float xb , xc , xd , xe ; xc = atan ( xa . y , xa . x ) ; xc *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; xd = cos ( xc ) ; xe = sin ( xc ) ; xc = ( xd * xa . x + xe * xa . y ) * ( xd * xa . y - xe * xa . x ) ; xb = abs ( xc ) ; if ( xb < 1.0 ) { xb = ( 0.01 * u_halo_size ) / ( xb ) ; w_ *= sqrt ( min ( xb , 1.0 ) ) ; } } void main ( ) { vec3 xg ; float xh , xi , xj , xk ; xh = ( fd . x * fd . x + fd . y * fd . y ) ; xi = sqrt ( xh ) ; xh = max ( 1.0 - xh , 0.0 ) ; xh = pow ( xh , u_halo_hardness ) ; xj = u_diffuse_color . a ;".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_RINGS","NUM_LINES",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float xl [ wF ] ; for ( int xm = 0 ; xm < wF ; xm ++ ) { xl [ xm ] = fract ( wE / ( float ( xm ) + 0.01 ) ) - 1.0 ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"xk = 0.0 ; wQ ( xk , xl , xi ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"xi = 0.0 ; wZ ( xi , xl , xh ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NUM_STARS"],group:{type:"group",a:[{type:"textline",b:"xf ( xh , fd ) ;".split(" ")}]}}]},{type:"textline",b:"xh *= xj ; xg = u_diffuse_color . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"xk *= xh ; xg += u_halo_rings_color * xk ; xh += xk ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"xi *= xj ; xg += u_halo_lines_color * xi ; xh += xi ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"xh *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xi = u_halo_stars_blend * ( wD . y - u_halo_stars_height ) ; xh *= clamp ( xi , 0.0 , 1.0 ) ; xh *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"ef ( xg ) ; ei ( xg , xh ) ; gl_FragColor = vec4 ( xg , xh ) ; }".split(" ")}]};a["halo.glslv"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:"attribute vec3 a_position ; attribute vec2 a_halo_bb_vertex ; uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ; uniform PRECISION float u_halo_size ; varying vec2 fd ; varying float wE ;".split(" ")},{type:"condition",a:[{type:"if",
c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","wD",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 wF , wG ; mat4 wH , wI ; vec3 wJ ; wJ = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; fd = a_halo_bb_vertex * 2.0 ; wE = fract ( wJ . x + wJ . y + wJ . z ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"wH = tk ( wJ , u_view_matrix ) ; wI = u_view_matrix ; wI [ 3 ] [ 0 ] = 0.0 ; wI [ 3 ] [ 1 ] = 0.0 ; wI [ 3 ] [ 2 ] = 0.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wH = tk ( wJ , u_view_matrix ) ;".split(" ")}]}}]},{type:"textline",b:"wF = vec4 ( a_halo_bb_vertex * 2.0 * u_halo_size , 0.0 , 1.0 ) ; wF = wH * wF ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",
a:[{type:"textline",b:"wG = u_proj_matrix * wI * wF ; wG . z = 0.99999 * wG . w ;".split(" ")},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["wD","=","wF",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wG = u_proj_matrix * u_view_matrix * wF ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","wG",";","}"]}]};a["line.glslf"]={type:"group",a:[{type:"include",
file:"precision_statement.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; void main ( ) { gl_FragColor = u_diffuse_color ; }".split(" ")}]};a["line.glslv"]={type:"group",a:[{type:"var",name:"NUM_POINTS",b:["0"]},{type:"textline",b:"attribute float a_point ; uniform vec3 u_line_points [ NUM_POINTS ] ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; void main ( ) { vec3 wF ; wF = u_line_points [ int ( a_point ) ] ; gl_Position = u_proj_matrix * u_view_matrix * vec4 ( wF , 1.0 ) ; }".split(" ")}]};
a["main.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"PARALLAX_STEPS",b:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},
{type:"include",file:"pack.glslf"},{type:"include",file:"fog.glslf"},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"lighting.glslf"},{type:"include",file:"procedural.glslf"},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"},{type:"textline",b:["uniform","float","u_time",";"]},{type:"condition",
a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform",
"vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_VECTOR_VIEW",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_direction",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"PROCEDURAL_FOG",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",b:["uniform",
"sampler2D","u_colormap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC","ALPHA_AS_SPEC",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",a:[{type:"textline",
b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["uniform",
"float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_B4W_REFRACTION","USE_REFRACTION","NODES",{type:"logical_and_expr",
d:3},{type:"logical_or_expr",d:2},"REFRACTIVE","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2},
{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_reflect_factor",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_VALUE"],group:{type:"group",a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_normal_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],
group:{type:"group",a:[{type:"textline",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{type:"textline",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:["uniform","float","u_parallax_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_refr_bump",";"]}]}}]}]}}]},{type:"textline",b:["varying","vec3","eU",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"USE_NODE_TEX_COORD_NO",
{type:"logical_or_expr",d:8}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eW",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eV",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eX",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","wF",";"]},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fd",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying",
"vec3","wG",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","e_",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fa",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fb",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],
group:{type:"group",a:[{type:"textline",b:["varying","vec4","fc",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","NODES",{type:"logic_negative_expr",d:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",
d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","eZ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"}]}}]},{type:"include",file:"mirror.glslf"},{type:"condition",a:[{type:"if",c:["REFRACTIVE","NODES",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2},"USE_NODE_B4W_REFRACTION","USE_REFRACTION","NODES",{type:"logical_and_expr",d:3},{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",b:"void main ( ) { vec4 wH , wI , wJ , wK ; mat3 wL ; vec2 wM , wN , wO , wP ; vec3 wQ , wR , wS , wT , wU , wV , wW , wX , wY ; float wZ , w_ , xa , xb , xc , xd , xe ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","DISABLE_FOG",{type:"logic_negative_expr",
d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"wZ = length ( eV ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"w_ = eU . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},"CAUSTICS","WATER_EFFECTS",{type:"logical_and_expr",
d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["wQ","=","u_sun_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:"wR = normalize ( u_camera_eye_frag - eU ) ; td ( wR , wS , wT , wU , xa , xb ) ; wS = wS ; xb = xb ; wU = wU ; xa = xa ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["wM","=","fd",";"]}]}}]},{type:"textline",
b:["wT","=","eW",";"]},{type:"condition",a:[{type:"if",c:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",a:[{type:"textline",b:"if ( gl_FrontFacing ) wT = wT ; else wT = - wT ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"wV = cross ( wT , eX . xyz ) * eX . w ; wL = mat3 ( eX . xyz , wV , wT ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"wN = normalize ( u_view_matrix_frag * vec4 ( eW , 0.0 ) ) . st ; wN = wN * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( wZ < PARALLAX_LOD_DIST ) { xc = clamp ( 0.5 * ( PARALLAX_LOD_DIST - wZ ) , 0.0 , 1.0 ) ; xc = u_parallax_scale * xc ; wV = normalize ( wF * wL ) ; xd = 1.0 / PARALLAX_STEPS ; wO = wV . xy * xc / ( PARALLAX_STEPS * wV . z ) ; xc = 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["wP","=","wN",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["wP","=","wM",";"]}]}}]},{type:"textline",b:"xe = texture2D ( u_normalmap0 , wP ) . a ; for ( float xf = 1.0 ; xf <= PARALLAX_STEPS ; xf ++ ) { if ( xe < xc ) { xc -= xd ; wP -= wO ; xe = texture2D ( u_normalmap0 , wP ) . a ; } } wO = wP + wO ; xd = texture2D ( u_normalmap0 , wO ) . a - ( xc + xd ) ; xc = xe - xc ; xd = xc / ( xc - xd ) ; wP = xd * wO + ( 1.0 - xd ) * wP ;".split(" ")},{type:"condition",
a:[{type:"if",c:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"wM += wP - wN ;".split(" ")}]}}]},{type:"textline",b:["wN","=","wP",";"]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"wN += wP - wM ;".split(" ")}]}}]},{type:"textline",b:["wM","=","wP",";"]}]}}]},{type:"textline",
b:["}"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wH = texture2D ( u_normalmap0 , wN ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wH = texture2D ( u_normalmap0 , wM ) ;".split(" ")}]}}]},{type:"textline",b:"wV = wH . rgb - 0.5 ; wV = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , wV , u_normal_factor ) ; wU = wL * wV ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["wU","=","wT",";"]}]}}]},{type:"textline",b:"wU = normalize ( wU ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"wN = normalize ( u_view_matrix_frag * vec4 ( wU , 0.0 ) ) . st ; wN = wN * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:"wR = normalize ( wF ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"wT = wG ; ed ( wT ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wH = vec4 ( wT , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["wH","=","u_diffuse_color",";"]}]}}]},{type:"textline",b:["xd","=","1.0",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"wI = texture2D ( u_colormap0 , wN ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wI = texture2D ( u_colormap0 , wM ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",b:"ed ( wI . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",
a:[{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wJ = texture2D ( u_colormap1 , wN ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wJ = texture2D ( u_colormap1 , wM ) ;".split(" ")}]}}]},{type:"textline",b:"ed ( wJ . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"wK = texture2D ( u_stencil0 , wN ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wK = texture2D ( u_stencil0 , wM ) ;".split(" ")}]}}]},{type:"textline",b:"wI = mix ( wI , wJ , wK . r ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wH . rgb = mix ( wH . rgb , wI . rgb , u_diffuse_color_factor ) ; xc = u_alpha_factor * wI . a ; xc += ( 1.0 - step ( 0.0 , xc ) ) ; wH . a = mix ( xc , 1.0 , u_diffuse_color . a ) ; xd = wI . a ;".split(" ")}]}},
{type:"elif",c:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wH . rgb *= mix ( vec3 ( 1.0 ) , wI . rgb , u_diffuse_color_factor ) ; wH . a = wI . a ; xd = wI . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"wT = u_diffuse_intensity * wH . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHADELESS"],group:{type:"group",a:[{type:"textline",b:["wS","=","wT",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wV = u_environment_energy * hu ( wU ) ; wV = u_ambient * wV ; xa = gY ( wT ) ; wW = u_emit * wH . rgb ; wX = u_specular_color ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["ALPHA_AS_SPEC"],group:{type:"group",a:[{type:"textline",b:"wY = vec3 ( xd ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wY = texture2D ( u_specmap0 , wN ) . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wY = texture2D ( u_specmap0 , wM ) . rgb ;".split(" ")}]}}]},
{type:"textline",b:"ed ( wY . rgb ) ; wX = mix ( wX , wY , u_specular_color_factor ) ;".split(" ")}]}}]},{type:"textline",b:"xd = u_specular_params [ 0 ] ; wM = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; wX = xd * wX ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"af xg = cS ( wW , wV , wT ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"af xg = cN ( wW , wV , wT , wX , eU , wU , wR , wM , u_diffuse_params , xa , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , 0.0 , vec4 ( 0.0 ) ) ;".split(" ")}]}}]},
{type:"textline",b:"wS = xg . a . rgb ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"hr ( wS , wR , wU , u_reflect_factor ) ;".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"hr ( wS , wR , wU , 0.0 ) ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"wS += xg . b ;".split(" ")}]}}]},{type:"textline",b:"xb = wH . a ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WETTABLE"],group:{type:"group",a:[{type:"textline",b:"wS = max ( wS - sqrt ( 0.01 * - min ( w_ , 0.0 ) ) , 0.5 * wS ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"textline",b:"eb ( wS , w_ , u_time , xa , wU , u_sun_direction , wQ , u_sun_quaternion , eU , wZ ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["ALPHA_CLIP"],group:{type:"group",a:[{type:"textline",b:"if ( xb <= 0.5 ) discard ; xb = 1.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SHADELESS",
{type:"logic_negative_expr",d:1},"NODES",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xa = max ( max ( xg . b . r , xg . b . g ) , xg . b . b ) * u_specular_alpha ; xb = wH . a * ( 1.0 - xa ) + xa ;".split(" ")}]}}]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NODES_GLOW",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["xb","=","1.0",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"wS = mix ( hI ( eY , wU . xz * u_refr_bump ) , wS , xb ) ; xb = 1.0 ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"PROCEDURAL_FOG",{type:"logic_negative_expr",d:1},"WATER_EFFECTS",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"xa = clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"wU = D ( u_cube_fog , wR ) ; wH = vec4 ( wU , u_fog_color_density . a ) ; ed ( wH . rgb ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wH = u_fog_color_density ; wH . rgb *= xa ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"U ( wS , wZ , wR , u_cam_water_depth , u_underwater_fog_color_density , wH , w_ , xa ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"x ( wS , wZ , wH ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},{type:"logical_and_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"wM = texture2DProj ( u_shadow_mask , eY ) . rg ; wZ = wM . g ; wS = vec3 ( wZ ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"SHADELESS",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"wS = vec3 ( fe . a ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["ef","(","wS",")",
";"]},{type:"condition",a:[{type:"if",c:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2},"NODES_GLOW",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"ei ( wS , xb ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( wS , xb ) ; }".split(" ")}]};a["main.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",
b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"USE_NODE_TEX_COORD_NO",
{type:"logical_or_expr",d:8}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",
{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",
a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_color",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},
{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",
a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",
a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","USE_NODE_B4W_REFRACTION",
{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"textline",b:["varying","vec3","eU",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:8}],group:{type:"group",a:[{type:"textline",
b:["varying","vec3","eW",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eV",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying",
"vec4","eX",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","wF",";"]},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fd",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","wG",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","e_",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fa",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fb",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4",
"fc",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","NODES",{type:"logic_negative_expr",d:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["varying","float","eZ",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec4 wH , wI ; float wJ ; mat4 wK ; vec3 wL , wM , wN , wO , wP , wQ , wR ; wL = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE",
"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"NODES",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:["wM","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wM = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE","NODES",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",
{type:"equal_expr",d:2},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wN = vec3 ( a_tangent ) ; wO = a_tangent [ 3 ] * cross ( wM , wN ) ;".split(" ")}]}},{type:"elif",c:["NODES",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wP = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; wQ = normalize ( ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ) ; wP = wP - u_camera_eye ; wO = cross ( wP , wQ ) ; wN = cross ( wQ , wO ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"wN = vec3 ( 0.0 ) ; wO = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"wL = mix ( wL , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",
b:"wM = mix ( wM , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"wQ = vec3 ( a_tangent ) ; wP = a_tangent_next [ 3 ] * cross ( a_normal_next , wQ ) ; wN = mix ( wN , wQ , u_va_frame_factor ) ; wO = mix ( wO , wP , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uT ( wL , wN , wO , wM ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["wP","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wP = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"el wS = wr ( wL , wN , wO , wM , wP , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"wQ = ( u_model_matrix * vec4 ( wP , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wK = tM ( u_camera_eye , wQ , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"wK = tG ( u_camera_eye , wQ , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wR = ( u_model_matrix * vec4 ( wP , 1.0 ) ) . xyz ; wK = wK * ty ( u_wind , u_time , u_jitter_amp , u_jitter_freq , wR ) ;".split(" ")}]}}]},{type:"textline",b:"el wS = tT ( wL - wP , wP , wN , wO , wM , wK ) ; wS . b = wQ ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"el wS = tT ( wL , wP , wN , wO , wM , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wJ = ( dot ( cross ( wS . e , wS . c ) , wS . d ) < 0.0 ) ? - 1.0 : 1.0 ; eX = vec4 ( wS . c , wJ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"vH ( wS . a , wS . b , wM ) ;".split(" ")}]}}]},{type:"textline",
b:"eU = wS . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:"eW = wS . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"wF = u_camera_eye - wS . a ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"fd = tW ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"wG = wS . f ;".split(" ")}]}},{type:"elif",c:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["wG","=","a_color",";"]}]}}]}]}}]},{type:"textline",b:"wH = u_view_matrix * vec4 ( wS . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",
"DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["eV","=","wH",";"]}]}}]},{type:"textline",b:"wI = u_proj_matrix * wH ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"wI . xy += u_subpixel_jitter * wI . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"eY = eT ( wI ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wB ( wS . a , wS . e ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","NODES",
{type:"logic_negative_expr",d:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"eZ = - wH . z / u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:["vM","(",")",";"]}]}}]},{type:"textline",b:["gl_Position","=","wI",";","}"]}]};a["particles_color.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"fog.glslf"},
{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"SOFT_STRENGTH",b:["1.0"]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform float u_p_alpha_start ; uniform float u_p_alpha_end ; uniform vec2 u_texel_size ; uniform vec4 u_fog_color_density ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},
{type:"textline",b:"varying float wH ; varying vec3 wG ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"SOFT_PARTICLES",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eV",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eY",";"]}]}}]},{type:"textline",b:"varying float wI ; void main ( ) { vec4 wJ ; vec3 wK ; float wL , wM , wN ; vec2 wO , wP ; wO = gl_PointCoord - 0.5 ; wL = 2.0 * length ( wO ) ; wL = smoothstep ( u_p_alpha_start , u_p_alpha_end , wL ) ; wL = u_diffuse_color . a * wH * ( 1.0 - wL ) ; wK = wG * u_diffuse_color . rgb ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"x ( wK , length ( eV ) , u_fog_color_density ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"wP = eY . xy / eY . z ; wO = vec2 ( wO . x , - wO . y ) * wI * u_texel_size ; wO = vec2 ( wP + wO ) ; wJ = texture2D ( u_scene_depth , wO ) ; wM = k ( wJ ) ; wN = - eV . z / u_view_max_depth ; wN = wM - wN ; wN = u_view_max_depth / SOFT_STRENGTH * wN ; wL = wL * min ( wN , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["ef","(","wK",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"ei ( wK , wL ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( wK , wL ) ; }".split(" ")}]};a["particles_color.glslv"]={type:"group",a:[{type:"var",name:"COLOR_RAMP_LENGTH",b:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",b:["0"]},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_p_delay ; attribute float a_p_lifetime ; attribute vec4 a_p_vels ;".split(" ")},
{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec2 u_p_size_ramp [ SIZE_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform vec3 u_p_wind ; uniform float u_p_max_lifetime ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_p_size ;".split(" ")},
{type:"condition",a:[{type:"if",c:["WORLD_SPACE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"varying float wH ; varying vec3 wG ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"SOFT_PARTICLES",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eV",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",
a:[{type:"textline",b:["varying","vec3","eY",";"]}]}}]},{type:"textline",b:["varying","float","wI",";"]},{type:"include",file:"particles.glslv"},{type:"textline",b:"void main ( ) { float xv , xw , xx , xy ; vec4 xz , xA ; wJ xB ; xB = xu ( ) ; xz = u_view_matrix * vec4 ( xB . b , 1.0 ) ; xA = u_proj_matrix * xz ; gl_Position = xA ; wH = xB . c ; wG = xB . d ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"SOFT_PARTICLES",{type:"logical_or_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:["eV","=","xz",";"]}]}}]},{type:"textline",b:"xv = u_height * u_proj_matrix [ 1 ] [ 1 ] * u_p_size / gl_Position . z ; xv = xB . a * xv ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"xw = xA . x ; xx = xA . y ; xy = xA . w ; eY . x = ( xw + xy ) / 2.0 ; eY . y = ( xx + xy ) / 2.0 ; eY . z = xy ; wI = xv ;".split(" ")}]}}]},{type:"textline",b:["gl_PointSize","=","xv",";","}"]}]};a["particles_texture.glslf"]=
{type:"group",a:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"lighting.glslf"},{type:"include",file:"fog.glslf"},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"PARTICLES_SHADELESS",b:["0"]},{type:"var",name:"SOFT_STRENGTH",b:["1.0"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",
b:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; varying float wH ; varying vec3 wG ; varying vec2 fd ; varying vec3 wF ; varying vec3 eU ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"SOFT_PARTICLES",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eV",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eY",";"]}]}}]},{type:"include",file:"environment.glslf"},{type:"textline",b:"void main ( ) { vec2 xv ; float xw , xx , xy ; vec3 xz , xA , xB , xC , xD , xE ; vec4 xF , xG ; xF = u_diffuse_color ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"xG = texture2D ( u_sampler , fd ) ; ed ( xG . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xF . rgb = mix ( xF . rgb , xG . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"xF . rgb *= mix ( vec3 ( 1.0 ) , xG . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},{type:"textline",b:"xF . a = xG . a ;".split(" ")}]}}]},{type:"textline",b:"xF . rgb *= wG ; xz = u_diffuse_intensity * xF . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["PARTICLES_SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"xA = u_emit * xF . rgb ; xB = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT",
"SKY_TEXTURE",{type:"logic_negative_expr",d:1},"SKY_COLOR",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"xC = u_environment_energy * hu ( vec3 ( 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xC = u_environment_energy * hu ( xB ) ;".split(" ")}]}}]},{type:"textline",b:"xC = u_ambient * xC ; xw = u_specular_params [ 0 ] ; xv = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; xD = xw * u_specular_color ; xE = normalize ( wF ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"af xH = cN ( xA , xC , xz , xD , eU , xB , xE , xv , u_diffuse_params , 1.0 , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , 0.0 , vec4 ( 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"af xH = cS ( xA , xC , xz ) ;".split(" ")}]}}]},{type:"textline",b:"xC = xH . a . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:["xC","=","xz",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"x ( xC , length ( eV ) , u_fog_color_density ) ;".split(" ")}]}}]},{type:"textline",b:"xw = xF . a * wH ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"xx = - eV . z / u_view_max_depth ; xF = texture2DProj ( u_scene_depth , eY ) ; xy = k ( xF ) ; xx = xy - xx ; xx = u_view_max_depth / SOFT_STRENGTH * xx ; xw = xw * min ( xx , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["ef","(","xC",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"ei ( xC , xw ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( xC , xw ) ; }".split(" ")}]};a["particles_texture.glslv"]={type:"group",a:[{type:"var",name:"BILLBOARD_ALIGN",b:["0"]},{type:"var",name:"COLOR_RAMP_LENGTH",b:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",b:["0"]},{type:"include",
file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"define",name:"BILLBOARD_ALIGN_VIEW",b:["1"]},{type:"define",name:"BILLBOARD_ALIGN_XY",b:["2"]},{type:"define",name:"BILLBOARD_ALIGN_YZ",b:["3"]},{type:"define",name:"BILLBOARD_ALIGN_ZX",b:["4"]},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_p_delay ; attribute float a_p_lifetime ; attribute vec4 a_p_vels ; attribute vec2 a_p_bb_vertex ;".split(" ")},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",
0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec2 u_p_size_ramp [ SIZE_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform vec3 u_p_wind ; uniform float u_p_max_lifetime ; uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ; uniform vec3 u_camera_eye ; uniform float u_p_size ;".split(" ")},
{type:"condition",a:[{type:"if",c:["WORLD_SPACE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"varying float wH ; varying vec3 wG ; varying vec2 fd ; varying vec3 wF ; varying vec3 eU ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"SOFT_PARTICLES",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","eV",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eY",";"]}]}}]},{type:"include",file:"particles.glslv"},{type:"textline",b:"float xx ( vec2 xv , vec2 xw ) { return ( atan ( xw . y , xw . x ) - atan ( xv . y , xv . x ) ) ; } void main ( ) { vec4 xy , xz , xA ; mat4 xB ; float xC , xD , xE ; wJ xF ; xF = xu ( ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { xC = xF . e ; xB = tk ( xF . b , u_view_matrix ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { xC = xF . e ; xB = eF ( ) ; xB [ 3 ] = vec4 ( xF . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { xC = xF . e ; xB = eJ ( radians ( 90.0 ) ) ; xB [ 3 ] = vec4 ( xF . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { xC = xx ( vec2 ( EPSILON , 1.0 ) , vec2 ( a_normal . x , a_normal . z ) ) + xF . e ; xB = eH ( radians ( - 90.0 ) ) ; xB [ 3 ] = vec4 ( xF . b , 1.0 ) ; } xy = vec4 ( a_p_bb_vertex * 2.0 * xF . a * u_p_size , 0.0 , 1.0 ) ; xy = xB * eL ( xC ) * xy ; xz = u_view_matrix * xy ; xA = u_proj_matrix * xz ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"xC = xA . x ; xD = xA . y ; xE = xA . w ; eY . x = ( xC + xE ) / 2.0 ; eY . y = ( xD + xE ) / 2.0 ; eY . z = xE ;".split(" ")}]}}]},{type:"textline",b:"gl_Position = xA ; wH = xF . c ; wG = xF . d ; fd = a_p_bb_vertex + 0.5 ; eU = xy . xyz ; wF = u_camera_eye - xy . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"SOFT_PARTICLES",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["eV","=","xz",";"]}]}}]},{type:"textline",b:["}"]}]};a["procedural_skydome.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; varying vec3 xv ; const float xw = 0.99 ; const float xx = 1.8 ; const int xy = 8 ; float xE ( vec3 xz , vec3 xA ) { float xB , xC , xD ; xB = dot ( xA , xA ) ; xC = 2.0 * dot ( xA , xz ) ; xD = dot ( xz , xz ) - 1.0 ; xB = xC * xC - 4.0 * xB * xD ; xB = sqrt ( xB ) ; xB = ( - xC - xB ) / 2.0 ; xB = xD / xB ; return xB ; } float xL ( float xF , float xG ) { float xH , xI , xJ , xK ; xH = 3.0 * ( 1.0 - xG * xG ) ; xI = 2.0 * ( 2.0 + xG * xG ) ; xJ = 1.0 + xF * xF ; xK = pow ( 1.0 + xG * xG - 2.0 * xG * xF , 1.5 ) ; xK = max ( xK , 0.00001 ) ; return ( xH / xI ) * ( xJ / xK ) ; } float xR ( vec3 xM , vec3 xN , float xO ) { vec3 xP ; float xQ ; xQ = dot ( xN , - xM ) ; if ( xQ < 0.0 ) { return 1.0 ; } xP = xM + xQ * xN ; if ( length ( xP ) < xO ) { return 0.0 ; } else if ( length ( xP ) >= xO ) { xP = normalize ( xP ) * xO - xM ; xQ = acos ( dot ( normalize ( xP ) , xN ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( xQ * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 xV ( float xS , vec3 xT , float xU ) { return xT - xT * pow ( u_sky_color , vec3 ( xU / xS ) ) ; } void main ( ) { float xW , xX , xY , xZ , x_ , ya , yb , yc , yd ; vec3 ye , yf , yg , yh , yi , yj , yk ; ye = normalize ( xv ) ; yf = u_sun_direction ; xW = dot ( ye , yf ) ; xX = xL ( xW , - 0.01 ) * u_rayleigh_brightness * yf . y ; xY = xL ( xW - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - yf . y ) ; xW = smoothstep ( 0.0 , 100.0 , xL ( xW , 0.9995 ) ) * u_spot_brightness ; yg = vec3 ( 0.0 , xw , 0.0 ) ; xZ = xE ( yg , ye ) ; x_ = xZ / float ( xy ) ; ya = xR ( yg , ye , xw - 0.3 ) ; yh = vec3 ( 0.0 , 0.0 , 0.0 ) ; yi = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int yl = 0 ; yl < xy ; yl ++ ) { yb = x_ * float ( yl ) ; yj = yg + ye * yb ; yc = xR ( yj , yf , xw - 0.2 ) ; yd = xE ( yj , yf ) ; yk = xV ( yd , vec3 ( xx ) , u_scatter_strength ) * yc ; yh += xV ( sqrt ( yb ) , u_sky_color * yk , u_rayleigh_strength ) ; yi += xV ( yb , yk , u_mie_strength ) ; } yh = yh * ya * pow ( xZ , u_rayleigh_collection_power ) / float ( xy ) ; yi = ( yi * ya * pow ( xZ , u_mie_collection_power ) ) / float ( xy ) ; yh = vec3 ( xW * yi + xY * yi + xX * yh ) ; ef ( yh ) ; gl_FragColor = vec4 ( yh , 1.0 ) ; }".split(" ")}]};
a["procedural_skydome.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec3 a_position ; uniform mat4 u_cube_view_matrix ; varying vec3 xv ; void main ( ) { vec4 xw , xx ; xw = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; xx = u_cube_view_matrix * xw ; xv = xx . xyz ; gl_Position = xw ; }".split(" ")}]};a["special_lens_flares.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform sampler2D u_sampler ; varying vec2 fd ; void main ( ) { vec4 xw ; xw = texture2D ( u_sampler , fd ) ; ef ( xw . rgb ) ; ei ( xw . rgb , xw . a ) ; gl_FragColor = xw ; }".split(" ")}]};
a["special_lens_flares.glslv"]={type:"group",a:[{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"define",name:"LIGHT_INDEX",b:["0"]},{type:"textline",b:"attribute float a_lf_dist ; attribute vec2 a_lf_bb_vertex ; attribute vec2 a_texcoord ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; varying vec2 fd ; void main ( ) { vec2 xw ; float xx ; vec4 xy ; vec3 xz ; fd = a_texcoord ; xz = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; xy = u_proj_matrix * u_view_matrix * vec4 ( xz , 0.0 ) ; xy . x /= xy . w ; xy . y /= xy . w ; xy += 99999.0 * step ( xy . z , 0.0 ) ; xy += 100.0 * ( step ( 1.0 , abs ( xy . x ) ) + step ( 1.0 , abs ( xy . y ) ) ) ; xy . x = - a_lf_dist * xy . x ; xy . y = - a_lf_dist * xy . y ; xx = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; xw = vec2 ( a_lf_bb_vertex . x / xx , a_lf_bb_vertex . y ) ; if ( a_lf_dist > - 0.999 ) { const float xA = 1.9 ; xw *= ( 1.0 + xA * length ( xy . xy ) ) ; } gl_Position = vec4 ( xy . xy + xw , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"define",name:"INV_PI",b:["0.318309886"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",c:["WO_SKYTEX","PROCEDURAL_SKYDOME",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky",";"]}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1},"WO_SKYTEX",
{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"blending.glslf"},{type:"textline",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; vec3 zC ( vec3 zx , vec3 zy , float zz , float zA ) { float zB ; zB = zz * zA ;".split(" ")},{type:"condition",a:[{type:"if",c:["BLENDTYPE","MIX",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return xM ( zy , zx , zB ) ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","ADD",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return xQ ( zx , zy , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SUBTRACT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return xU ( zx , zy , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","MULTIPLY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return xZ ( zx , zy , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SCREEN",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"return yd ( zx , zy , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","OVERLAY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yi ( zx , zy , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return ym ( zx , zy , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DIVIDE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"return yq ( zx , zy , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DARKEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yu ( zx , zy , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","LIGHTEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yy ( zx , zy , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","HUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yE ( zy , zx , zB ) ;".split(" ")}]}},{type:"elif",
c:["BLENDTYPE","SATURATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yK ( zy , zx , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","VALUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yQ ( zy , zx , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","COLOR",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yW ( zy , zx , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SOFT_LIGHT",{type:"equal_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:"return za ( zy , zx , zB ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return ze ( zy , zx , zB ) ;".split(" ")}]}}]},{type:"textline",b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float zK ( float zD , float zE , float zF , float zG ) { float zH ; vec3 zI , zJ ; zI = vec3 ( zD ) , zJ = vec3 ( zE ) ; zH = zF * zG ;".split(" ")},{type:"condition",a:[{type:"if",c:["BLENDTYPE","MIX",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return xM ( zJ , zI , zH ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","ADD",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return xQ ( zI , zJ , zH ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SUBTRACT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return xU ( zI , zJ , zH ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","MULTIPLY",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"return zk ( zD , zE , zH , zG ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SCREEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return zq ( zD , zE , zH , zG ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","OVERLAY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return zw ( zD , zE , zH , zG ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return ym ( zI , zJ , zH ) . x ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","DIVIDE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yq ( zI , zJ , zH ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DARKEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yu ( zI , zJ , zH ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","LIGHTEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yy ( zI , zJ , zH ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SOFT_LIGHT",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return za ( zJ , zI , zH ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return ze ( zJ , zI , zH ) . x ;".split(" ")}]}}]},{type:"textline",b:["return","0.0",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_camera_eye_frag ; uniform vec3 u_sun_intensity ; uniform float u_environment_energy ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{type:"textline",b:["varying","vec3","xv",";"]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",
d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fd",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 zL ; float zM , zN , zO ; vec3 zP , zQ , zR , zS , zT ; zQ = normalize ( xv ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME"],group:{type:"group",a:[{type:"textline",b:"zP = textureCube ( u_sky , zQ ) . rgb ;".split(" ")}]}},{type:"elif",c:["WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",d:2},{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"textline",b:"zP = u_horizon_color ; ef ( zP ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",c:["WO_SKYPAPER"],group:{type:"group",a:[{type:"textline",b:"zR = vec3 ( fd , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zR = vec3 ( xv . xy , 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:["zM","=","0.0",";"]},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["WO_SKYPAPER"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"zM = abs ( fd . y ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zM = ( fd . y + 1.0 ) * 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zN = acos ( zQ . y ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"zM = abs ( zN * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zM = 1.0 - zN * INV_PI ;".split(" ")}]}}]}]}}]}]}}]},{type:"textline",b:"zS = u_horizon_color ; zT = u_zenith_color ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYTEX"],group:{type:"group",a:[{type:"textline",b:"zN = 1.0 ; zL = textureCube ( u_sky , zQ ) ; ed ( zL . rgb ) ; zN = zL . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"zN = dot ( zL . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["MTEX_NEGATIVE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"zL = vec4 ( vec3 ( 1.0 ) - zL . rgb , zL . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zN = 1.0 - zN ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"condition",
a:[{type:"if",c:["MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"zL = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zN = zL . a ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_HORIZ"],group:{type:"group",a:[{type:"textline",b:"zS = zC ( zL . rgb , zS , zN , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:["zO","=","0.0",";"]},{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"if ( dot ( zR , vec3 ( 0.0 , 1.0 , 0.0 ) ) >= 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP"],group:{type:"group",a:[{type:"textline",b:"zO = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:[";"]}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",
b:"else zO = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP"],group:{type:"group",a:[{type:"textline",b:"zO = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"elif",c:["WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",b:"zO = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( zO != 0.0 ) zT = zC ( zL . rgb , zT , zN , zO ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_BLEND"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"zN = dot ( zL . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{type:"textline",b:"zM = zK ( u_sky_tex_dvar , zM , zN , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"textline",b:"zP = mix ( zS , zT , zM ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:["zP","=","zS",";"]}]}}]},{type:"textline",b:["ef","(","zP",")",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"ef ( zS ) ; ef ( zT ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"textline",b:"zP = mix ( zS , zT , zM ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["zP","=","zS",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},"REFLECTION_PASS",
{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"ed ( zP ) ; zM = u_camera_eye_frag . y - WATER_LEVEL ; zM = min ( - zM * 0.03 , 0.8 ) ; zN = clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ; zS = vec3 ( 0.0 ) ; zL = u_underwater_fog_color_density ; zL . rgb = mix ( zL . rgb , zS , min ( - zQ . y + zM , 1.0 ) ) * zN ; zM = clamp ( sign ( zQ . y - 0.05 * zM ) , 0.0 , 1.0 ) ; zP = mix ( zL . rgb , zP , zM ) ; ef ( zP ) ;".split(" ")}]}}]},
{type:"textline",b:"gl_FragColor = vec4 ( zP , 1.0 ) ; }".split(" ")}]};a["special_skydome.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec3 a_position ; uniform mat4 u_sky_vp_inverse ; varying vec3 xv ;".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fd",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 zx , zy ; zx = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; zy = u_sky_vp_inverse * zx ; xv = zy . xyz ;".split(" ")},
{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"fd = a_position . xy ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","zx",";","}"]}]};a["special_water.glslf"]={type:"group",a:[{type:"var",name:"ABSORB",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"SSS_STRENGTH",b:["6.0"]},{type:"var",name:"SSS_WIDTH",
b:["0.0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"fog.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"lighting.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"},{type:"define",name:"REFL_BUMP",b:["0.001"]},{type:"define",name:"REFR_BUMP",b:["0.0005"]},{type:"textline",b:["uniform","float","u_time",";"]},
{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",
0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE","WATER_EFFECTS",{type:"logical_or_expr",
d:3}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",
d:1},"PROCEDURAL_FOG",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",
a:[{type:"textline",b:["uniform","sampler2D","u_foam",";"]}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",1,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_normalmap1_scale",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",2,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_normalmap2_scale",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",3,{type:"g_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","float","u_reflect_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:["uniform","float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_refr_bump",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:"const float zx = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",b:"varying vec3 wF ; varying vec3 eU ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},"GENERATED_MESH",{type:"logic_negative_expr",
d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fd",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 eX ; varying vec3 zy ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eW",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zz",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zA",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",{type:"logical_or_expr",d:3}],group:{type:"group",
a:[{type:"textline",b:["varying","vec3","eY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","float","eZ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zB",";"]}]}}]},{type:"include",file:"environment.glslf"},
{type:"condition",a:[{type:"if",c:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"textline",b:"vec3 zN ( in vec2 zC , in vec3 zD , in vec3 zE , in vec3 zF , out float zG ) { float zH , zI , zJ ; vec2 zK ; vec3 zL , zM ; zG = 0.0 ; zL = reflect ( - zE , zD ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"zK = zC . xy + zD . xz * REFL_BUMP / eZ ; zG = u_reflect_factor ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"WATER_EFFECTS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zM = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zM = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"textline",b:"zH = dot ( zE , zD ) ; zG *= max ( 1.0 - 1.0 / zH , 1.0 ) ; } else { zM = texture2D ( u_plane_reflection , zK ) . rgb ; ed ( zM ) ; }".split(" ")}]}},
{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zG = u_mirror_factor ; zM = zF * textureCube ( u_mirrormap , zL ) . rgb ; ed ( zM ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zG = u_reflect_factor ; zM = zF * vec3 ( 0.3 , 0.5 , 1.0 ) ; ed ( zM ) ;".split(" ")}]}}]},{type:"textline",b:"zL = normalize ( zL + zE ) ; zH = 1.0 - dot ( zE , zL ) ; zI = u_fresnel_params [ 3 ] ; zJ = u_fresnel_params [ 2 ] ; zJ = zI + ( 1.0 - zI ) * pow ( zH , zJ ) ; zG = min ( zG * zJ , 1.0 ) ; return zM ; } void main ( ) { vec4 zO ; vec2 zP , zQ , zR ; float zS , zT , zU , zV , zW , zX ; vec3 zY , zZ , z_ , Aa , Ab , Ac , Ad ; mat3 Ae ;".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ae = mat3 ( eX , zy , eW ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"zY = normalize ( eW ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zY = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC","FOAM",{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"zS = eU . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"zP = vec2 ( zz . x , - zz . z ) + 0.5 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zP = vec2 ( eU . x , - eU . z ) + 0.5 ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["zP","=","fd",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zZ = vec3 ( 0.0 ) ; z_ = texture2D ( u_normalmap0 , zP * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; zZ += z_ ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"Aa = vec3 ( 0.0 ) ;".split(" ")},{type:"condition",
a:[{type:"if",c:["NORM_FOAM0"],group:{type:"group",a:[{type:"textline",b:["Aa","+=","z_",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",1,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"z_ = texture2D ( u_normalmap0 , zP * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; zZ += z_ ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM1"],group:{type:"group",
a:[{type:"textline",b:["Aa","+=","z_",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",2,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"z_ = texture2D ( u_normalmap0 , zP * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; zZ += z_ ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM2"],group:{type:"group",a:[{type:"textline",b:["Aa","+=","z_",
";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",3,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"z_ = texture2D ( u_normalmap0 , zP * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; zZ += z_ ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM3"],group:{type:"group",a:[{type:"textline",b:["Aa","+=","z_",";"]}]}}]}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"Aa = Ae * Aa ; if ( ! eo ( Aa , vec3 ( 0.0 ) ) ) Aa = normalize ( Aa ) ; Aa = mix ( zY , Aa , 0.2 ) ; Aa = normalize ( Aa ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"zY = mix ( zY , normalize ( Ae * zZ ) , 0.3 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"zY = mix ( zY , normalize ( Ae * zZ ) , 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:"zY = normalize ( zY ) ;".split(" ")}]}}]},{type:"textline",b:"zZ = normalize ( wF ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zQ = eY . xy / eY . z ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","DISABLE_FOG",{type:"logic_negative_expr",
d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zT = eZ * u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:"zU = u_diffuse_color . a ; zO = texture2DProj ( u_scene_depth , eY ) ; zV = k ( zO ) ; zW = max ( zV - eZ , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"zR = zQ + zY . xz * u_refr_bump / eZ ; zV = hA ( zV , zR , zQ ) ; zV = max ( zV - eZ , 0.0 ) ; zV = u_view_max_depth / ABSORB * zV ; if ( u_cam_water_depth < 0.0 ) zX = 0.0 ; else zX = min ( zU * zV , 1.0 ) ; zV = u_view_max_depth / ABSORB * zW ; zU = min ( 15.0 * zU * u_view_max_depth * zW , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zV = u_view_max_depth / ABSORB * zW ; if ( u_cam_water_depth > 0.0 ) zU = min ( zU * zV , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"zU *= min ( 5.0 * zT , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zU = u_diffuse_color . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"zX = 1.0 - zU ; zR = zQ + zY . xz * u_refr_bump / eZ ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"z_ = texture2D ( u_refractmap , zR ) . rgb ; ed ( z_ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"zV = pow ( min ( zA . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; Ab = mix ( u_shallow_water_col , u_diffuse_color . rgb , zV ) ; zV = pow ( min ( zA . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; Ab = mix ( u_shore_water_col , Ab , zV ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"Ab = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:"zW = max ( 1.0 - u_view_max_depth * zW , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zW = 1.0 - zU ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",
b:"zS = max ( zS / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"Ac = normalize ( vec3 ( zA . r , 0.0 , zA . g ) ) ; Ac = normalize ( mix ( vec3 ( 0.0 , 1.0 , 0.0 ) , Ac , 0.8 ) ) ; zV = 1.25 * max ( dot ( Aa , Ac ) - 0.2 , 0.0 ) ; zV += max ( dot ( Aa , vec3 ( 0.0 , - 1.0 , 0.0 ) ) , 0.0 ) ; zW += zV * ( 1.0 - zA . b ) ; zS *= ( 1.0 - 0.95 * pow ( zA . b , 0.1 ) ) ;".split(" ")}]}}]},{type:"textline",b:"zW += zS ; zW = min ( u_foam_factor * zW , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"zO = texture2D ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + zP * u_foam_scale ) ;".split(" ")}]}}]},{type:"textline",b:"zS = u_specular_params [ 0 ] ; zP = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; Aa = zS * u_specular_color ; Ac = u_environment_energy * hu ( zY ) ; Ac = u_ambient * Ac ; Ac = Ac + u_sun_intensity ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"Ad = zN ( zQ , zY , zZ , Ac , zS ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Ad = zN ( vec2 ( 0.0 ) , zY , zZ , Ac , zS ) ;".split(" ")}]}}]},{type:"textline",b:"Ab = u_diffuse_intensity * Ab ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"af Af = cN ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Ab , Aa , eU , zY , zZ , zP , u_diffuse_params , 1.0 , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , 0.0 , vec4 ( 0.0 ) ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"af Af = cS ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Ab ) ;".split(" ")}]}}]},{type:"textline",b:"Ab = Af . a . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"zV = max ( dot ( u_sun_direction , - eW ) + SSS_WIDTH , 0.0 ) * max ( dot ( - zZ , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; zV = clamp ( SSS_STRENGTH * zV , 0.0 , 1.0 ) ; Ab = mix ( Ab , u_shallow_water_col , zV ) ; Ab = mix ( Ab , u_shore_water_col , zV ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"Ab = mix ( z_ , Ab , zX ) ;".split(" ")}]}}]},{type:"textline",b:"Ab = mix ( Ab , Ad , zS ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"zS = mix ( zO . g , zO . r , max ( 4.0 * ( zW - 0.75 ) , 0.0 ) ) ; zS = mix ( zO . b , zS , max ( 2.0 * zW - 1.0 , 0.0 ) ) ; zS = mix ( 0.0 , zS , zW ) ; Ab = mix ( Ab , Ac , zS ) ;".split(" ")}]}}]},{type:"textline",
b:"Ab += Af . b ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"zZ = D ( u_cube_fog , zZ ) ; zO = vec4 ( zZ , u_fog_color_density . a ) ; ed ( zO . rgb ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["zO","=","u_fog_color_density",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",
a:[{type:"textline",b:"if ( u_cam_water_depth < 0.0 ) { ab ( Ab , zT , u_cam_water_depth , u_underwater_fog_color_density , clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ) ; } else { x ( Ab , zT , zO ) ; }".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"x ( Ab , zT , zO ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["ef","(","Ab",")",";"]},{type:"condition",a:[{type:"if",c:["REFRACTIVE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",
b:"zU = max ( zU , Af . b . r ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:["zU","+=","zS",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"textline",b:"ei ( Ab , zU ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"extension",b:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",b:"zZ = fwidth ( zB ) ; zZ = smoothstep ( vec3 ( 0.0 ) , zZ * zx , zB ) ; zS = min ( min ( zZ . x , zZ . y ) , zZ . z ) ; zS = clamp ( zS , 0.0 , 1.0 ) ; Ab = mix ( u_wireframe_edge_color , Ab , zS ) ; zU = mix ( 1.0 , zU , zS ) ;".split(" ")}]}}]},
{type:"textline",b:"gl_FragColor = vec4 ( Ab , zU ) ; }".split(" ")}]};a["special_water.glslv"]={type:"group",a:[{type:"var",name:"DIR_MIN_SHR_FAC",b:["0.0"]},{type:"var",name:"DIR_FREQ",b:["0.0"]},{type:"var",name:"DIR_NOISE_SCALE",b:["0.0"]},{type:"var",name:"DIR_NOISE_FREQ",b:["0.0"]},{type:"var",name:"DIR_MIN_NOISE_FAC",b:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_0",b:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_0",b:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_1",b:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_1",
b:["0.0"]},{type:"var",name:"DST_MIN_FAC",b:["0.0"]},{type:"var",name:"MAX_SHORE_DIST",b:["0.0"]},{type:"var",name:"PRECISION",b:["mediump"]},{type:"var",name:"SHORE_MAP_CENTER_X",b:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_X",b:["0.0"]},{type:"var",name:"SHORE_MAP_CENTER_Y",b:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_Y",b:["0.0"]},{type:"var",name:"WAVES_HOR_FAC",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"WAVES_LENGTH",b:["0.0"]},
{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"include",file:"procedural.glslf"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"DYNAMIC",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_normal ; attribute vec3 a_tangent ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["GENERATED_MESH",{type:"logic_negative_expr",d:1},"NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_polyindex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",
"DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{type:"textline",b:"varying vec3 wF ; varying vec3 eU ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},
"GENERATED_MESH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fd",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 eX ; varying vec3 zy ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3",
"eW",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zz",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zA",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",
{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","eY",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","float","eZ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zB",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"vec3 zG ( in vec2 zx ) { float zC ; vec4 zD ; vec2 zE ; zE = 0.5 + vec2 ( ( zx . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , - ( zx . y + SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; zD = texture2D ( u_shore_dist_map , zE ) ; const vec2 zF = vec2 ( 1.0 / 255.0 , 1.0 ) ; zC = dot ( zD . ba , zF ) ; zE = normalize ( zD . rg * 2.0 - 1.0 ) ; return vec3 ( zE , zC ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["DYNAMIC"],group:{type:"group",a:[{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"define",name:"SMALL_WAVES_FAC",b:["0.3"]},{type:"textline",b:"void zS ( inout vec3 zH , in float zI , in vec3 zJ ) { vec2 zK , zL , zM ; float zN , zO , zP , zQ , zR ; zN = dG ( DST_NOISE_SCALE_0 * ( zH . xz + DST_NOISE_FREQ_0 * zI ) ) * dG ( DST_NOISE_SCALE_1 * ( zH . zx - DST_NOISE_FREQ_1 * zI ) ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"zO = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; zP = zJ . b ; zQ = sqrt ( zP ) ; zO = max ( zP , DIR_MIN_SHR_FAC ) * sin ( zQ / zO + DIR_FREQ * zI ) ; zR = max ( dG ( DIR_NOISE_SCALE * ( zH . xz + DIR_NOISE_FREQ * zI ) ) , DIR_MIN_NOISE_FAC ) ; zO *= zR ; zQ = WAVES_HEIGHT * mix ( zO , zN , max ( zQ , DST_MIN_FAC ) ) ; zK = zJ . rg ; zO = WAVES_HOR_FAC * zO * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - zP ) , 0.0 ) ; zK = zO * zK ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zQ = WAVES_HEIGHT * zN ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"zL = 2.0 * ( zH . xz - 0.1 * zI ) ; zM = 1.3 * ( zH . zx + 0.03 * zI ) ; zN = dj ( 0.5 * zL ) . x + dj ( 0.5 * zM ) . x - 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"zH . xz += zK ; zN *= zP ;".split(" ")}]}}]},{type:"textline",b:"zQ += SMALL_WAVES_FAC * zN ;".split(" ")}]}}]},
{type:"textline",b:"zH . y += zQ ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { vec4 zT , zU ; vec2 zV ; float zW , zX , zY ; vec3 zZ , z_ , Aa , Ab ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:"if ( a_polyindex == 0.0 ) zB = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) zB = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) zB = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["zZ","=",
"a_position",";"]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"zW = abs ( zZ . y ) ; zV = u_camera_eye . xz - mod ( u_camera_eye . xz , zW ) ; zZ . y = WATER_LEVEL ; zZ . xz += zV ;".split(" ")}]}},{type:"elif",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["fd","=","a_texcoord",";"]}]}}]},{type:"textline",b:"el Ac = tT ( zZ , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"zA = zG ( Ac . a . xz ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"zX = length ( u_wind ) ; zY = u_time ; zY *= zX ;".split(" ")},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"zW = zW ; zZ = Ac . a + vec3 ( zW , 0.0 , 0.0 ) ; z_ = Ac . a + vec3 ( 0.0 , 0.0 , zW ) ; if ( a_position . y < 0.0 ) { Ac . a . y = WATER_LEVEL - 1.0 ; zZ . y = Ac . a . y ; z_ . y = Ac . a . y ; }".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zz = Ac . a ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zZ = Ac . a + vec3 ( 0.05 , 0.0 , 0.0 ) ; z_ = Ac . a + vec3 ( 0.0 , 0.0 , 0.05 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"Aa = zG ( zZ . xz ) ; Ab = zG ( z_ . xz ) ; zS ( zZ , zY , Aa ) ; zS ( z_ , zY , Ab ) ; zS ( Ac . a , zY , zA ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zS ( zZ , zY , vec3 ( 0.0 ) ) ; zS ( z_ , zY , vec3 ( 0.0 ) ) ; zS ( Ac . a , zY , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",b:"zZ = normalize ( zZ - Ac . a ) ; z_ = normalize ( z_ - Ac . a ) ; eW = normalize ( cross ( z_ , zZ ) ) ; zY = dot ( eW , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; zY = clamp ( 0.8 - zY , 0.0 , 1.0 ) ; eW = mix ( eW , vec3 ( 0.0 , 1.0 , 0.0 ) , zY ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",
0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"z_ = a_tangent ; eW = a_normal ;".split(" ")}]}}]},{type:"textline",b:"eX = z_ ; zy = cross ( eW , eX ) ;".split(" ")}]}}]},{type:"textline",b:"eU = Ac . a ; wF = u_camera_eye - Ac . a ; zT = u_view_matrix * vec4 ( Ac . a , 1.0 ) ; zU = u_proj_matrix * zT ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE",
"REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"zY = zU . x ; zW = zU . y ; zX = zU . w ; eY . x = ( zY + zX ) / 2.0 ; eY . y = ( zW + zX ) / 2.0 ; eY . z = zX ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"eZ = - zT . z / u_view_max_depth ;".split(" ")}]}}]},
{type:"textline",b:["gl_Position","=","zU",";","}"]}]};a["wireframe.glslf"]={type:"group",a:[{type:"define",name:"WM_OPAQUE_WIREFRAME",b:["0"]},{type:"define",name:"WM_TRANSPARENT_WIREFRAME",b:["1"]},{type:"define",name:"WM_FRONT_BACK_VIEW",b:["2"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"uniform int u_wireframe_mode ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},
{type:"textline",b:"varying vec3 zB ; const float zx = 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE_DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"const vec3 zC = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const vec3 zC = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const vec3 zD = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 zE = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 zF = vec3 ( 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"void main ( ) { float zG , zH ; vec3 zI , zJ ; zI = vec3 ( 0.0 ) ; zG = 0.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"zJ = sign ( zB - vec3 ( 0.02 * zx ) ) ; if ( zJ . x < 0.0 || zJ . y < 0.0 || zJ . z < 0.0 ) { zI = zC ; zG = 1.0 ; } else discard ;".split(" ")}]}},{type:"elif",c:["WIREFRAME_QUALITY",0,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zJ = sign ( zB - vec3 ( 0.02 * zx ) ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { if ( zJ . x < 0.0 || zJ . y < 0.0 || zJ . z < 0.0 ) zI = u_wireframe_edge_color ; else zI = zF ; zG = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { if ( zJ . x < 0.0 || zJ . y < 0.0 || zJ . z < 0.0 ) zG = 1.0 ; else zG = 0.0 ; zI = u_wireframe_edge_color ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( zJ . x < 0.0 || zJ . y < 0.0 || zJ . z < 0.0 ) zI = u_wireframe_edge_color ; else if ( gl_FrontFacing ) zI = zD ; else zI = zE ; zG = 1.0 ; }".split(" ")}]}},
{type:"elif",c:["WIREFRAME_QUALITY",1,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"extension",b:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",b:"zJ = fwidth ( zB ) ; zJ = smoothstep ( vec3 ( 0.0 ) , zJ * zx , zB ) ; zH = min ( min ( zJ . x , zJ . y ) , zJ . z ) ; zH = clamp ( zH , 0.0 , 1.0 ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { zI = vec3 ( mix ( u_wireframe_edge_color , zF , zH ) ) ; zG = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { zI = u_wireframe_edge_color ; zG = mix ( 1.0 , 0.0 , zH ) ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( gl_FrontFacing ) zI = mix ( u_wireframe_edge_color , zD , zH ) ; else zI = mix ( u_wireframe_edge_color , zE , zH ) ; zG = 1.0 ; }".split(" ")}]}}]},
{type:"textline",b:["ef","(","zI",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"textline",b:"ei ( zI , zG ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( zI , zG ) ; }".split(" ")}]};a["wireframe.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_polyindex ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],
group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{type:"textline",b:["varying","vec3","zB",";"]},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"include",file:"dynamic_grass.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec4 zx ; mat4 zC ; vec3 zD , zE , zF , zG , zH ; if ( a_polyindex == 0.0 ) zB = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) zB = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) zB = vec3 ( 0.0 , 0.0 , 1.0 ) ; zD = a_position ; zE = a_normal ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"el zI = tT ( zD , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"zD = mix ( zD , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"zF = vec3 ( 0.0 ) ; zG = vec3 ( 0.0 ) ; uT ( zD , zF , zG , zE ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["zG","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zG = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"el zI = wr ( zD , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , zG , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"zF = ( u_model_matrix * vec4 ( zG , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zC = tM ( u_camera_eye , zF , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"zC = tG ( u_camera_eye , zF , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zH = ( u_model_matrix * vec4 ( zG , 1.0 ) ) . xyz ; zC = zC * ty ( u_wind , u_time , u_jitter_amp , u_jitter_freq , zH ) ;".split(" ")}]}}]},{type:"textline",b:"el zI = tT ( zD - zG , zG , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , zC ) ; zI . b = zF ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"el zI = tT ( zD , zG , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"vH ( zI . a , zI . b , zE ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"zx = u_view_matrix * vec4 ( zI . a , 1.0 ) ; gl_Position = u_proj_matrix * zx ; }".split(" ")}]};a["postprocessing/anaglyph.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",
b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; varying vec2 fd ; void main ( ) { vec4 zx , zC ; zx = texture2D ( u_sampler_left , fd ) ; zC = texture2D ( u_sampler_right , fd ) ; gl_FragColor = vec4 ( zx [ 0 ] , zC [ 1 ] , zC [ 2 ] , zx [ 3 ] + zC [ 3 ] ) ; }".split(" ")}]};a["postprocessing/antialiasing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"AA_METHOD_PASS",b:["1"]},{type:"define",name:"AA_METHOD_FXAA_LIGHT",b:["2"]},
{type:"define",name:"AA_METHOD_FXAA_QUALITY",b:["3"]},{type:"define",name:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{type:"define",name:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{type:"define",name:"FXAA_SPAN_MAX",b:["8.0"]},{type:"textline",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; varying vec2 fd ; vec4 zE ( float zx , float zC ) { vec2 zD ; zD = fd + vec2 ( zx , zC ) * u_texel_size ; return texture2D ( u_color , zD ) ; } float zI ( vec4 zF ) { float zG ; vec3 zH ; zH = vec3 ( 0.299 , 0.587 , 0.114 ) ; zG = dot ( zF . rgb , zH ) ; return zG ; } vec4 zV ( ) { vec2 zJ ; float zK , zL , zM , zN , zO , zP ; vec4 zQ , zR , zS , zT , zU ; zQ = zE ( - 1.0 , - 1.0 ) ; zR = zE ( 1.0 , - 1.0 ) ; zS = zE ( - 1.0 , 1.0 ) ; zT = zE ( 1.0 , 1.0 ) ; zU = zE ( 0.0 , 0.0 ) ; zK = zI ( zQ ) ; zL = zI ( zR ) ; zM = zI ( zS ) ; zN = zI ( zT ) ; zO = zI ( zU ) ; zP = min ( zO , min ( min ( zK , zL ) , min ( zM , zN ) ) ) ; zO = max ( zO , max ( max ( zK , zL ) , max ( zM , zN ) ) ) ; zJ . x = - ( ( zK + zL ) - ( zM + zN ) ) ; zJ . y = ( ( zK + zM ) - ( zL + zN ) ) ; zN = max ( ( zK + zL + zM + zN ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; zN = 1.0 / ( min ( abs ( zJ . x ) , abs ( zJ . y ) ) + zN ) ; zJ = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , zJ * zN ) ) * u_texel_size ; zU = 0.5 * ( texture2D ( u_color , fd + zJ * ( 1.0 / 3.0 - 0.5 ) ) + texture2D ( u_color , fd + zJ * ( 2.0 / 3.0 - 0.5 ) ) ) ; zT = zU * 0.5 + 0.25 * ( texture2D ( u_color , fd + zJ * - 0.5 ) + texture2D ( u_color , fd + zJ * 0.5 ) ) ; zN = zI ( zT ) ; if ( ( zN < zP ) || ( zN > zO ) ) return zU ; else return zT ; }".split(" ")},
{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",b:["(","1.0","/","6.0",")"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["(","1.0","/","12.0",")"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",b:["(","3.0","/","4.0",")"]},{type:"textline",b:"vec4 Az ( ) { bool zW , zX , zY , zZ , z_ ; float Aa , Ab , Ac , Ad , Ae , Af , Ag , Ah , Ai , Aj , Ak , Al , Am , An , Ao ; vec4 Ap , Aq , Ar , As , At ; vec2 Au , Av , Aw , Ax , Ay ; Au . x = fd . x ; Au . y = fd . y ; Ap = texture2D ( u_color , Au ) ; Aq = zE ( 0.0 , 1.0 ) ; Ar = zE ( 1.0 , 0.0 ) ; As = zE ( 0.0 , - 1.0 ) ; At = zE ( - 1.0 , 0.0 ) ; Aa = zI ( Aq ) ; Ab = zI ( Ar ) ; Ac = zI ( As ) ; Ad = zI ( At ) ; Ae = zI ( Ap ) ; Af = max ( Aa , Ae ) ; Ag = min ( Aa , Ae ) ; Af = max ( Ab , Af ) ; Ag = min ( Ab , Ag ) ; Ah = max ( Ac , Ad ) ; Ai = min ( Ac , Ad ) ; Af = max ( Ah , Af ) ; Ag = min ( Ai , Ag ) ; Ai = Af * FXAA_QUALITY_EDGE_THRESHOLD ; Ag = Af - Ag ; Ai = max ( FXAA_QUALITY_EDGE_THRESHOLD_MIN , Ai ) ; zW = Ag < Ai ; if ( zW ) return Ap ; Ap = zE ( - 1.0 , - 1.0 ) ; At = zE ( 1.0 , 1.0 ) ; As = zE ( 1.0 , - 1.0 ) ; Ar = zE ( - 1.0 , 1.0 ) ; Ai = zI ( Ap ) ; Af = zI ( At ) ; Ah = zI ( As ) ; Aj = zI ( Ar ) ; Ak = Ac + Aa ; Al = Ad + Ab ; Ag = 1.0 / Ag ; Am = Ak + Al ; Ak = ( - 2.0 * Ae ) + Ak ; Al = ( - 2.0 * Ae ) + Al ; An = Ah + Af ; Ah = Ai + Ah ; Ao = ( - 2.0 * Ab ) + An ; Ah = ( - 2.0 * Ac ) + Ah ; Ai = Ai + Aj ; Af = Aj + Af ; Ao = ( abs ( Ak ) * 2.0 ) + abs ( Ao ) ; Ah = ( abs ( Al ) * 2.0 ) + abs ( Ah ) ; Al = ( - 2.0 * Ad ) + Ai ; Af = ( - 2.0 * Aa ) + Af ; Ao = abs ( Al ) + Ao ; Ah = abs ( Af ) + Ah ; An = Ai + An ; Ai = u_texel_size . x ; zW = Ao >= Ah ; An = Am * 2.0 + An ; if ( ! zW ) Ac = Ad ; if ( ! zW ) Aa = Ab ; if ( zW ) Ai = u_texel_size . y ; An = ( An * ( 1.0 / 12.0 ) ) - Ae ; Ab = Ac - Ae ; Ad = Aa - Ae ; Ac = Ac + Ae ; Aa = Aa + Ae ; zX = abs ( Ab ) >= abs ( Ad ) ; Ad = max ( abs ( Ab ) , abs ( Ad ) ) ; if ( zX ) Ai = - Ai ; Ag = clamp ( abs ( An ) * Ag , 0.0 , 1.0 ) ; Av . x = Au . x ; Av . y = Au . y ; Aw . x = ( ! zW ) ? 0.0 : u_texel_size . x ; Aw . y = ( zW ) ? 0.0 : u_texel_size . y ; if ( ! zW ) Av . x += Ai * 0.5 ; if ( zW ) Av . y += Ai * 0.5 ; Ax . x = Av . x - Aw . x ; Ax . y = Av . y - Aw . y ; Ay . x = Av . x + Aw . x ; Ay . y = Av . y + Aw . y ; An = ( ( - 2.0 ) * Ag ) + 3.0 ; Ab = zI ( texture2D ( u_color , Ax ) ) ; Ag = Ag * Ag ; Am = zI ( texture2D ( u_color , Ay ) ) ; if ( ! zX ) Ac = Aa ; Ad = Ad * 1.0 / 4.0 ; Ae = Ae - Ac * 0.5 ; Ag = An * Ag ; zX = Ae < 0.0 ; Ab -= Ac * 0.5 ; Am -= Ac * 0.5 ; zY = abs ( Ab ) >= Ad ; zZ = abs ( Am ) >= Ad ; if ( ! zY ) Ax . x -= Aw . x * 1.5 ; if ( ! zY ) Ax . y -= Aw . y * 1.5 ; z_ = ( ! zY ) || ( ! zZ ) ; if ( ! zZ ) Ay . x += Aw . x * 1.5 ; if ( ! zZ ) Ay . y += Aw . y * 1.5 ; if ( z_ ) { if ( ! zY ) Ab = zI ( texture2D ( u_color , Ax . xy ) ) ; if ( ! zZ ) Am = zI ( texture2D ( u_color , Ay . xy ) ) ; if ( ! zY ) Ab = Ab - Ac * 0.5 ; if ( ! zZ ) Am = Am - Ac * 0.5 ; zY = abs ( Ab ) >= Ad ; zZ = abs ( Am ) >= Ad ; if ( ! zY ) Ax . x -= Aw . x * 2.0 ; if ( ! zY ) Ax . y -= Aw . y * 2.0 ; z_ = ( ! zY ) || ( ! zZ ) ; if ( ! zZ ) Ay . x += Aw . x * 2.0 ; if ( ! zZ ) Ay . y += Aw . y * 2.0 ; if ( z_ ) { if ( ! zY ) Ab = zI ( texture2D ( u_color , Ax . xy ) ) ; if ( ! zZ ) Am = zI ( texture2D ( u_color , Ay . xy ) ) ; if ( ! zY ) Ab = Ab - Ac * 0.5 ; if ( ! zZ ) Am = Am - Ac * 0.5 ; zY = abs ( Ab ) >= Ad ; zZ = abs ( Am ) >= Ad ; if ( ! zY ) Ax . x -= Aw . x * 2.0 ; if ( ! zY ) Ax . y -= Aw . y * 2.0 ; z_ = ( ! zY ) || ( ! zZ ) ; if ( ! zZ ) Ay . x += Aw . x * 2.0 ; if ( ! zZ ) Ay . y += Aw . y * 2.0 ; if ( z_ ) { if ( ! zY ) Ab = zI ( texture2D ( u_color , Ax . xy ) ) ; if ( ! zZ ) Am = zI ( texture2D ( u_color , Ay . xy ) ) ; if ( ! zY ) Ab = Ab - Ac * 0.5 ; if ( ! zZ ) Am = Am - Ac * 0.5 ; zY = abs ( Ab ) >= Ad ; zZ = abs ( Am ) >= Ad ; if ( ! zY ) Ax . x -= Aw . x * 4.0 ; if ( ! zY ) Ax . y -= Aw . y * 4.0 ; z_ = ( ! zY ) || ( ! zZ ) ; if ( ! zZ ) Ay . x += Aw . x * 4.0 ; if ( ! zZ ) Ay . y += Aw . y * 4.0 ; if ( z_ ) { if ( ! zY ) Ab = zI ( texture2D ( u_color , Ax . xy ) ) ; if ( ! zZ ) Am = zI ( texture2D ( u_color , Ay . xy ) ) ; if ( ! zY ) Ab = Ab - Ac * 0.5 ; if ( ! zZ ) Am = Am - Ac * 0.5 ; zY = abs ( Ab ) >= Ad ; zZ = abs ( Am ) >= Ad ; if ( ! zY ) Ax . x -= Aw . x * 2.0 ; if ( ! zY ) Ax . y -= Aw . y * 2.0 ; if ( ! zZ ) Ay . x += Aw . x * 2.0 ; if ( ! zZ ) Ay . y += Aw . y * 2.0 ; } } } } Ad = Au . x - Ax . x ; Ac = Ay . x - Au . x ; if ( ! zW ) Ad = Au . y - Ax . y ; if ( ! zW ) Ac = Ay . y - Au . y ; zZ = ( Ab < 0.0 ) != zX ; Ab = ( Ac + Ad ) ; zX = ( Am < 0.0 ) != zX ; Ab = 1.0 / Ab ; zY = Ad < Ac ; Ac = min ( Ad , Ac ) ; zX = zY ? zZ : zX ; Ag = Ag * Ag ; Ab = ( Ac * ( - Ab ) ) + 0.5 ; Ag = Ag * FXAA_QUALITY_SUBPIX ; Ab = zX ? Ab : 0.0 ; Ag = max ( Ab , Ag ) ; if ( ! zW ) Au . x += Ag * Ai ; if ( zW ) Au . y += Ag * Ai ; return texture2D ( u_color , Au ) ; }".split(" ")},
{type:"define",name:"FXAA_CONSOLE_EDGE_SHARPNESS",b:["8.0"]},{type:"define",name:"FXAA_CONSOLE_EDGE_THRESHOLD",b:["0.125"]},{type:"define",name:"FXAA_CONSOLE_EDGE_THRESHOLD_MIN",b:["0.05"]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["AA_METHOD","AA_METHOD_PASS",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = texture2D ( u_color , fd ) ;".split(" ")}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{type:"equal_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:"gl_FragColor = zV ( ) ;".split(" ")}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = Az ( ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , 1.0 , 0.0 , 1.0 ) * texture2D ( u_color , fd ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},
{type:"textline",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 fd ; void main ( ) { vec4 zx ; vec2 zC , zD ; zC = vec2 ( 0.0 , 0.0 ) ; zD = u_texel_size ; zx = texture2D ( u_color , fd ) ; gl_FragColor = zx * 0.0875447373698 ; zC += zD ; gl_FragColor += texture2D ( u_color , fd + zC ) * 0.0858112354248 ; gl_FragColor += texture2D ( u_color , fd - zC ) * 0.0858112354248 ; zC += zD ; gl_FragColor += texture2D ( u_color , fd + zC ) * 0.0808139781061 ; gl_FragColor += texture2D ( u_color , fd - zC ) * 0.0808139781061 ; zC += zD ; gl_FragColor += texture2D ( u_color , fd + zC ) * 0.0731235112908 ; gl_FragColor += texture2D ( u_color , fd - zC ) * 0.0731235112908 ; zC += zD ; gl_FragColor += texture2D ( u_color , fd + zC ) * 0.0635705267419 ; gl_FragColor += texture2D ( u_color , fd - zC ) * 0.0635705267419 ; zC += zD ; gl_FragColor += texture2D ( u_color , fd + zC ) * 0.0530985673112 ; gl_FragColor += texture2D ( u_color , fd - zC ) * 0.0530985673112 ; zC += zD ; gl_FragColor += texture2D ( u_color , fd + zC ) * 0.0426125984122 ; gl_FragColor += texture2D ( u_color , fd - zC ) * 0.0426125984122 ; zC += zD ; gl_FragColor += texture2D ( u_color , fd + zC ) * 0.0328565115809 ; gl_FragColor += texture2D ( u_color , fd - zC ) * 0.0328565115809 ; zC += zD ; gl_FragColor += texture2D ( u_color , fd + zC ) * 0.0243407024472 ; gl_FragColor += texture2D ( u_color , fd - zC ) * 0.0243407024472 ; gl_FragColor = max ( 0.7 * zx , gl_FragColor ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; varying vec2 fd ; void main ( ) { vec4 zx , zC ; zx = texture2D ( u_main , fd ) ; zC = texture2D ( u_bloom , fd ) ; zx = zx ; zx += zC ; gl_FragColor = vec4 ( zx . rgb , 1.0 ) ; }".split(" ")}]};a["postprocessing/compositing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"PI_4",
b:["0.785398163"]},{type:"textline",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; varying vec2 fd ; void main ( ) { float zx ; vec3 zC , zD ; vec4 zE ; zE = texture2D ( u_color , fd ) ; zC = zE . rgb ; if ( u_brightness < 0.0 ) zC = zC * ( 1.0 + u_brightness ) ; else zC = zC + ( ( 1.0 - zC ) * u_brightness ) ; zC = ( zC - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * PI_4 ) ) + 0.5 ; zC *= u_exposure ; zD = vec3 ( 0.299 , 0.587 , 0.114 ) ; zx = dot ( zC , zD ) ; zC = mix ( vec3 ( zx ) , zC , u_saturation ) ; gl_FragColor = vec4 ( zC , zE . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; varying vec2 fd ; void main ( ) { gl_FragColor = g ( clamp ( zI ( u_depth , fd , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};a["postprocessing/dof.glslf"]=
{type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front ; uniform float u_dof_rear ; uniform vec2 u_camera_range ; varying vec2 fd ; void main ( ) { float zx , zJ ; vec4 zK , zL ; zK = texture2D ( u_sharp , fd ) ; if ( u_dof_dist > 0.0 ) { zx = zI ( u_depth , fd , u_camera_range ) ; zx *= u_view_max_depth ; if ( zx < u_dof_dist ) zJ = ( u_dof_dist - zx ) / u_dof_front ; else zJ = ( zx - u_dof_dist ) / u_dof_rear ; zJ = clamp ( zJ , 0.0 , 1.0 ) ; zL = texture2D ( u_blurred , fd ) ; gl_FragColor = mix ( zK , zL , zJ ) ; } else gl_FragColor = zK ; }".split(" ")}]};
a["postprocessing/glow.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; varying vec2 fd ; void main ( ) { float zx ; vec4 zJ , zK , zL ; zJ = texture2D ( u_src_color , fd ) ; zK = texture2D ( u_glow_mask_small , fd ) ; zL = texture2D ( u_glow_mask_large , fd ) ; gl_FragColor = zJ ; if ( zL . a != 0.0 ) { zx = u_glow_mask_large_coeff * zL . a ; zx = clamp ( zx , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , zL . rgb / zL . a , zx ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , zx ) ; } if ( zK . a != 0.0 ) { zx = u_glow_mask_small_coeff * zK . a ; zx = clamp ( zx , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , zK . rgb / zK . a , zx ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , zx ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"var",name:"STEPS_PER_PASS",b:["0.0"]},{type:"textline",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},{type:"condition",
a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_camera_range",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"varying float zJ ; varying vec2 zK ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 fd ; varying vec4 zL ; void main ( ) { vec4 zM ; float zN , zO , zP , zQ , zR ; vec2 zS , zT , zU ; zS = ( zL . xy - fd ) ; zN = length ( zS ) ; zS = u_radial_blur_step * zS / zN ; zO = zN / u_radial_blur_step ; zS *= min ( zO , STEPS_PER_PASS ) / STEPS_PER_PASS ; zO = max ( zO , STEPS_PER_PASS ) ; zT = fd ; zP = 0.0 ; for ( float zV = 0.0 ; zV < STEPS_PER_PASS ; zV += 1.0 ) { if ( zV <= zO ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"textline",b:"zQ = zI ( u_input , zT , u_camera_range ) ; zP += max ( ( 1.0 - pow ( zN , 0.3 ) ) * step ( 0.9 , zQ ) , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zM = texture2D ( u_input , zT ) ; zP += k ( zM ) ;".split(" ")}]}}]},{type:"textline",b:"} zT += zS ; }".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"zU = fd + zK ; zR = dj ( vec2 ( 2.5 * ( zU . x ) , 2.5 * ( zU . y ) + 1.0 * u_time ) ) . x + 0.75 * dj ( vec2 ( 5.0 * ( zU . x ) - 0.66 * u_time , 5.0 * ( zU . y ) + 0.66 * u_time ) ) . x + 0.5 * dG ( vec2 ( 7.5 * ( zU . x ) + 0.33 * u_time , 7.5 * ( zU . y ) - 0.33 * u_time ) ) ; zR *= clamp ( 1.2 - sqrt ( 0.2 * zN ) , 0.0 , 1.0 ) * zJ ; zP = max ( zR , zP ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = g ( zP / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]=
{type:"group",a:[{type:"include",file:"math.glslv"},{type:"textline",b:"attribute vec2 a_bb_vertex ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ; varying float zJ ; varying vec2 zK ;".split(" ")}]}}]}]}}]},{type:"textline",
b:"varying vec2 fd ; varying vec4 zL ; void main ( ) { float zx , zM ; vec3 zN ; fd = a_bb_vertex + 0.5 ; zN = normalize ( u_sun_direction ) ; zL = u_proj_matrix * u_view_matrix * vec4 ( zN , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( u_cam_water_depth < 0.0 ) { zJ = 1.0 ; zN = vec3 ( 0.0 , 1.0 , 0.0 ) ; zN = er ( u_camera_quat , zN ) ; zN = normalize ( zN ) ; zx = dot ( zN , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; zM = atan ( zN . x , zN . z ) ; zK = vec2 ( - zM , acos ( zx ) ) ; } else { zJ = 0.0 ; }".split(" ")}]}}]},
{type:"textline",b:"zL . xy = 0.5 * ( zL . xy / zL . w + 1.0 ) ; zL += 99999.0 * step ( zL . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; varying vec2 fd ; void main ( ) { float zx ; vec3 zM ; vec4 zN ; zN = texture2D ( u_main , fd ) ; zM = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; ed ( zN . rgb ) ; zx = k ( texture2D ( u_god_rays , fd ) ) ; zM = zN . rgb + u_god_rays_intensity * vec3 ( zx ) * zM ; ef ( zM ) ; gl_FragColor . rgb = zM ; gl_FragColor . a = zN . a ; }".split(" ")}]};
a["postprocessing/luminance.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_input ; varying vec2 fd ; void main ( ) { float zx ; vec4 zM ; zM = texture2D ( u_input , fd ) ; zx = dot ( zM . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; gl_FragColor = vec4 ( vec3 ( zx ) , 1.0 ) ; }".split(" ")}]};a["postprocessing/luminance_av.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_input ; void main ( ) { float zx , zM ; zM = 0.0 ; for ( float zN = 0.025 ; zN < 1.0 ; zN += 0.05 ) for ( float zO = 0.025 ; zO < 1.0 ; zO += 0.05 ) { zx = max ( texture2D ( u_input , vec2 ( zN , zO ) ) . r , 0.01 ) ; zM += log ( zx ) ; } zM = exp ( zM / 400.0 ) ; gl_FragColor = vec4 ( vec3 ( zM ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; varying vec2 fd ; varying float zM ; void main ( ) { vec4 zN ; float zO , zP ; zO = texture2D ( u_average_lum , vec2 ( 0.5 ) ) . r ; zP = texture2D ( u_luminance , fd ) . r ; zN = texture2D ( u_main , fd ) ; zO = zP / zO ; zP = u_bloom_edge_lum ; gl_FragColor = zN * max ( zO - zP , 0.0 ) * zM ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec2 a_position ; uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; varying vec2 fd ; varying float zM ; const vec3 zx = vec3 ( 0.0 , 1.0 , 0.0 ) ; void zU ( in vec4 zN , in vec3 zO , out vec3 zP ) { float zQ , zR , zS , zT ; zQ = zN . w * zO . x + zN . y * zO . z - zN . z * zO . y ; zR = zN . w * zO . y + zN . z * zO . x - zN . x * zO . z ; zS = zN . w * zO . z + zN . x * zO . y - zN . y * zO . x ; zT = - zN . x * zO . x - zN . y * zO . y - zN . z * zO . z ; zP . x = zQ * zN . w - zT * zN . x - zR * zN . z + zS * zN . y ; zP . y = zR * zN . w - zT * zN . y - zS * zN . x + zQ * zN . z ; zP . z = zS * zN . w - zT * zN . z - zQ * zN . y + zR * zN . x ; } void main ( ) { vec3 zV ; fd = 2.0 * a_position ; zU ( u_camera_quat , zx , zV ) ; zM = dot ( - zV , u_sun_direction ) * u_bloom_key ; zM *= max ( sign ( u_sun_direction . y ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; varying vec2 fd ; float zx = 0.0042 ; void main ( ) { vec4 zN , zO , zP , zQ ; zN = texture2D ( u_mb_tex_curr , fd ) ; zO = texture2D ( u_mb_tex_accum , fd ) ; if ( length ( zN - zO ) > u_motion_blur_decay_threshold ) { zP = ( 1.0 - u_motion_blur_exp ) * zN + u_motion_blur_exp * zO ; zP = zP - zO ; zQ = zN - zO ; zP = min ( max ( abs ( zP ) , vec4 ( zx ) ) , abs ( zQ ) ) * sign ( zP ) ; gl_FragColor = zO + zP ; } else { gl_FragColor = zN ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; varying vec2 fd ; void main ( ) { vec3 zx ; float zN ; vec4 zO , zP , zQ ; zO = texture2D ( u_outline_src , fd ) ; gl_FragColor = zO ; if ( u_draw_outline != 0.0 ) { zP = texture2D ( u_outline_mask , fd ) ; zQ = texture2D ( u_outline_mask_blurred , fd ) ; zN = zQ . a - zP . a ; if ( zN != 0.0 ) { zN = smoothstep ( 0.0 , 1.0 , zQ . a ) ; if ( zP . a == 0.0 ) { zx = u_outline_color ; ef ( zx ) ; zP = vec4 ( clamp ( zx , 0.0 , 1.0 ) , 1.0 ) ; gl_FragColor = mix ( zO , zP , zN ) ; } } } }".split(" ")}]};
a["postprocessing/postprocessing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"POST_EFFECT_NONE",b:["1"]},{type:"define",name:"POST_EFFECT_GRAYSCALE",b:["2"]},{type:"define",name:"POST_EFFECT_X_BLUR",b:["3"]},{type:"define",name:"POST_EFFECT_Y_BLUR",b:["4"]},{type:"define",name:"POST_EFFECT_X_EXTEND",b:["5"]},{type:"define",name:"POST_EFFECT_Y_EXTEND",b:["6"]},{type:"textline",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 fd ; void main ( ) { vec2 zx , zN ; vec4 zO ;".split(" ")},
{type:"condition",a:[{type:"if",c:["POST_EFFECT","POST_EFFECT_NONE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = texture2D ( u_color , fd ) ;".split(" ")}]}},{type:"elif",c:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zO = texture2D ( u_color , fd ) ; gl_FragColor . rgb = vec3 ( ( zO . r + zO . g + zO . b ) / 3.0 ) ; gl_FragColor . a = 1.0 ;".split(" ")}]}},{type:"elif",c:["POST_EFFECT","POST_EFFECT_X_BLUR",
{type:"equal_expr",d:2},"POST_EFFECT","POST_EFFECT_Y_BLUR",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zx = vec2 ( 0.0 , 0.0 ) ; zN = u_texel_size ; zO = texture2D ( u_color , fd ) ; gl_FragColor = zO * 0.2270270270 ; zx += zN ; zO = texture2D ( u_color , fd + zx ) ; gl_FragColor += zO * 0.1945945946 ; zO = texture2D ( u_color , fd - zx ) ; gl_FragColor += zO * 0.1945945946 ; zx += zN ; zO = texture2D ( u_color , fd + zx ) ; gl_FragColor += zO * 0.1216216216 ; zO = texture2D ( u_color , fd - zx ) ; gl_FragColor += zO * 0.1216216216 ; zx += zN ; zO = texture2D ( u_color , fd + zx ) ; gl_FragColor += zO * 0.0540540541 ; zO = texture2D ( u_color , fd - zx ) ; gl_FragColor += zO * 0.0540540541 ; zx += zN ; zO = texture2D ( u_color , fd + zx ) ; gl_FragColor += zO * 0.0162162162 ; zO = texture2D ( u_color , fd - zx ) ; gl_FragColor += zO * 0.0162162162 ;".split(" ")}]}},
{type:"elif",c:["POST_EFFECT","POST_EFFECT_X_GLOW_BLUR",{type:"equal_expr",d:2},"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zx = vec2 ( 0.0 , 0.0 ) ; zN = u_texel_size ; zO = texture2D ( u_color , fd ) ; gl_FragColor = zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.152507 ; zx += zN ; zO = texture2D ( u_color , fd + zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.141763 ; zO = texture2D ( u_color , fd - zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.141763 ; zx += zN ; zO = texture2D ( u_color , fd + zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.113861 ; zO = texture2D ( u_color , fd - zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.113861 ; zx += zN ; zO = texture2D ( u_color , fd + zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.079019 ; zO = texture2D ( u_color , fd - zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.079019 ; zx += zN ; zO = texture2D ( u_color , fd + zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.047383 ; zO = texture2D ( u_color , fd - zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.047383 ; zx += zN ; zO = texture2D ( u_color , fd + zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.024549 ; zO = texture2D ( u_color , fd - zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.024549 ; zx += zN ; zO = texture2D ( u_color , fd + zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.01099 ; zO = texture2D ( u_color , fd - zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.01099 ; zx += zN ; zO = texture2D ( u_color , fd + zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.00425 ; zO = texture2D ( u_color , fd - zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.00425 ; zx += zN ; zO = texture2D ( u_color , fd + zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.00142 ; zO = texture2D ( u_color , fd - zx ) ; gl_FragColor += zO * ( 1.0 - step ( 0.0 , - zO . a ) ) * 0.00142 ; gl_FragColor = clamp ( gl_FragColor , 0.0 , 1.0 ) ;".split(" ")}]}},
{type:"elif",c:["POST_EFFECT","POST_EFFECT_X_EXTEND",{type:"equal_expr",d:2},"POST_EFFECT","POST_EFFECT_Y_EXTEND",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zN = u_texel_size ; zO = texture2D ( u_color , fd ) ; gl_FragColor = zO ; if ( zO . a == 0.0 ) { zO = texture2D ( u_color , fd + zN ) ; if ( zO . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , zO . a ) ; else { zO = texture2D ( u_color , fd - zN ) ; if ( zO . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , zO . a ) ; } }".split(" ")}]}}]},
{type:"textline",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec2 a_position ; varying vec2 fd ; void main ( ) { fd = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"pack.glslf"},{type:"define",name:"SMAA_RESOLVE",b:["1"]},{type:"define",
name:"SMAA_EDGE_DETECTION",b:["2"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{type:"define",name:"AA_METHOD_SMAA_LOW",b:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",b:["4"]},{type:"textline",b:["uniform","sampler2D","u_color",";"]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_blend",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",d:2},"SMAA_PREDICATION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},{type:"textline",b:"uniform vec2 u_texel_size ; varying vec2 fd ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","zN",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"varying vec4 zO ; varying vec4 zP ; varying vec4 zQ ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","zR",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.15"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_HIGH",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.05"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",
b:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["16"]},{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_DEPTH_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS_DIAG",
group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_CORNER_ROUNDING",group:{type:"group",a:[{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",group:{type:"group",a:[{type:"define",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION",group:{type:"group",a:[{type:"define",
name:"SMAA_PREDICATION",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_SCALE",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_STRENGTH",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},
{type:"condition",a:[{type:"ifndef",name:"SMAA_REPROJECTION",group:{type:"group",a:[{type:"define",name:"SMAA_REPROJECTION",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_REPROJECTION_WEIGHT_SCALE",group:{type:"group",a:[{type:"define",name:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},
{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{type:"define",name:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{type:"define",name:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{type:"define",name:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{type:"define",name:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{type:"define",name:"SMAA_CORNER_ROUNDING_NORM",b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 zX ( vec2 zS , sampler2D zT ) { float zU , zV , zW ; zU = texture2D ( zT , zS ) . r ; zV = texture2D ( zT , zO . xy ) . r ; zW = texture2D ( zT , zO . zw ) . r ; return vec3 ( zU , zV , zW ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 Ab ( vec2 zY , sampler2D zZ ) { vec2 z_ ; vec3 Aa ; Aa = zX ( zY , zZ ) ; z_ = abs ( Aa . xx - Aa . yz ) ; z_ = step ( SMAA_PREDICATION_THRESHOLD , z_ ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * z_ ) ; }".split(" ")}]}}]},
{type:"textline",b:"void Af ( bvec2 Ac , inout vec2 Ad , vec2 Ae ) { if ( Ac . x ) Ad . x = Ae . x ; if ( Ac . y ) Ad . y = Ae . y ; } void Af ( bvec4 Ag , inout vec4 Ah , vec4 Ai ) { Af ( Ag . xy , Ah . xy , Ai . xy ) ; Af ( Ag . zw , Ah . zw , Ai . zw ) ; } vec2 Ak ( vec2 Aj ) { return sign ( Aj ) * floor ( abs ( Aj ) + .5 ) ; } vec4 Ak ( vec4 Al ) { return sign ( Al ) * floor ( abs ( Al ) + .5 ) ; }".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 Ay ( vec2 Am , sampler2D An".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","Ao"]}]}}]},{type:"textline",b:") { vec4 Ap ; float Aq , Ar , As , At , Au ; vec3 Av ; vec2 Aw , Ax ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",b:"Aw = Ab ( Am , Ao ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"Aw = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{type:"textline",b:"Av = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; Aq = dot ( texture2D ( An , Am ) . rgb , Av ) ; Ar = dot ( texture2D ( An , zO . xy ) . rgb , Av ) ; As = dot ( texture2D ( An , zO . zw ) . rgb , Av ) ; Ap . xy = abs ( Aq - vec2 ( Ar , As ) ) ; Aw = step ( Aw , Ap . xy ) ; if ( dot ( Aw , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; At = dot ( texture2D ( An , zP . xy ) . rgb , Av ) ; Au = dot ( texture2D ( An , zP . zw ) . rgb , Av ) ; Ap . zw = abs ( Aq - vec2 ( At , Au ) ) ; Ax = max ( Ap . xy , Ap . zw ) ; Au = dot ( texture2D ( An , zQ . xy ) . rgb , Av ) ; At = dot ( texture2D ( An , zQ . zw ) . rgb , Av ) ; Ap . zw = abs ( vec2 ( Ar , As ) - vec2 ( Au , At ) ) ; Ax = max ( Ax . xy , Ap . zw ) ; At = max ( Ax . x , Ax . y ) ; Aw . xy *= step ( At , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * Ap . xy ) ; return Aw ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"vec2 AA ( vec2 Az ) { Az . r = Az . r * abs ( 5.0 * Az . r - 5.0 * 0.75 ) ; return Ak ( Az ) ; } vec4 AA ( vec4 AB ) { AB . rb = AB . rb * abs ( 5.0 * AB . rb - 5.0 * 0.75 ) ; return Ak ( AB ) ; } vec2 AJ ( sampler2D AC , vec2 AD , vec2 AE , out vec2 AF ) { vec3 AG ; vec4 AH ; AH = vec4 ( AD , - 1.0 , 1.0 ) ; AG = vec3 ( u_texel_size , 1.0 ) ; for ( int AI = 0 ; AI < SMAA_MAX_SEARCH_STEPS_DIAG ; AI ++ ) { if ( AH . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && AH . w > 0.9 ) { AH . xyz += AG * vec3 ( AE , 1.0 ) ; AF = texture2D ( AC , AH . xy , 0.0 ) . rg ; AH . w = dot ( AF , vec2 ( 0.5 , 0.5 ) ) ; } } return AH . zw ; } vec2 AR ( sampler2D AK , vec2 AL , vec2 AM , out vec2 AN ) { vec3 AO ; vec4 AP ; AP = vec4 ( AL , - 1.0 , 1.0 ) ; AP . x += 0.25 * u_texel_size . x ; AO = vec3 ( u_texel_size , 1.0 ) ; for ( int AQ = 0 ; AQ < SMAA_MAX_SEARCH_STEPS_DIAG ; AQ ++ ) { if ( AP . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && AP . w > 0.9 ) { AP . xyz = AO * vec3 ( AM , 1.0 ) + AP . xyz ; AN = texture2D ( AK , AP . xy , 0.0 ) . rg ; AN = AA ( AN ) ; AP . w = dot ( AN , vec2 ( 0.5 , 0.5 ) ) ; } } return AP . zw ; } vec2 AX ( sampler2D AS , vec2 AT , vec2 AU , float AV ) { vec2 AW ; AW = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * AU + AT ; AW = SMAA_AREATEX_PIXEL_SIZE * AW + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; AW . x += 0.5 ; AW . y += SMAA_AREATEX_SUBTEX_SIZE * AV ; return texture2D ( AS , AW , 0.0 ) . rg ; } vec2 Bi ( sampler2D AY , sampler2D AZ , vec2 A_ , vec2 Ba , vec4 Bb ) { vec4 Bc , Bd , Be ; vec2 Bf , Bg , Bh ; Bf = vec2 ( 0.0 , 0.0 ) ; if ( Ba . r > 0.0 ) { Bc . xz = AJ ( AY , A_ , vec2 ( - 1.0 , 1.0 ) , Bg ) ; Bc . x += float ( Bg . y > 0.9 ) ; } else Bc . xz = vec2 ( 0.0 , 0.0 ) ; Bc . yw = AJ ( AY , A_ , vec2 ( 1.0 , - 1.0 ) , Bg ) ; if ( Bc . x + Bc . y > 2.0 ) { Bd = vec4 ( - Bc . x + 0.25 , Bc . x , Bc . y , - Bc . y - 0.25 ) * u_texel_size . xyxy + A_ . xyxy ; Be . xy = texture2D ( AY , Bd . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; Be . zw = texture2D ( AY , Bd . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; Be . yxwz = AA ( Be . xyzw ) ; Bh = vec2 ( 2.0 , 2.0 ) * Be . xz + Be . yw ; Af ( bvec2 ( step ( 0.9 , Bc . zw ) ) , Bh , vec2 ( 0.0 , 0.0 ) ) ; Bf += AX ( AZ , Bc . xy , Bh , Bb . z ) ; } Bc . xz = AR ( AY , A_ , vec2 ( - 1 , - 1 ) , Bg ) ; if ( texture2D ( AY , A_ + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { Bc . yw = AR ( AY , A_ , vec2 ( 1 , 1 ) , Bg ) ; Bc . y += float ( Bg . y > 0.9 ) ; } else Bc . yw = vec2 ( 0.0 , 0.0 ) ; if ( Bc . x + Bc . y > 2.0 ) { Be = vec4 ( - Bc . x , - Bc . x , Bc . y , Bc . y ) * u_texel_size . xyxy + A_ . xyxy ; Bd . x = texture2D ( AY , Be . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; Bd . y = texture2D ( AY , Be . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; Bd . zw = texture2D ( AY , Be . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; Bg = vec2 ( 2.0 , 2.0 ) * Bd . xz + Bd . yw ; Af ( bvec2 ( step ( 0.9 , Bc . zw ) ) , Bg , vec2 ( 0 , 0 ) ) ; Bf += AX ( AZ , Bc . xy , Bg , Bb . w ) . gr ; } return Bf ; }".split(" ")}]}}]},
{type:"textline",b:"float Bo ( sampler2D Bj , vec2 Bk , float Bl ) { vec2 Bm , Bn ; Bm = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; Bn = SMAA_SEARCHTEX_SIZE * vec2 ( Bl , 1.0 ) ; Bm += vec2 ( - 1.0 , 1.0 ) ; Bn += vec2 ( 0.5 , - 0.5 ) ; Bm *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; Bn *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return texture2D ( Bj , Bm * Bk + Bn , 0.0 ) . r ; } float Bw ( sampler2D Bp , sampler2D Bq , vec2 Br , float Bs ) { float Bt ; vec2 Bu ; Bu = vec2 ( 0.0 , 1.0 ) ; for ( int Bv = 0 ; Bv < SMAA_MAX_SEARCH_STEPS ; Bv ++ ) { if ( Br . x > Bs && Bu . g > 0.8281 && Bu . r == 0.0 ) { Bu = texture2D ( Bp , Br , 0.0 ) . rg ; Br = - vec2 ( 2.0 , 0.0 ) * u_texel_size + Br ; } } Bt = - ( 255.0 / 127.0 ) * Bo ( Bq , Bu , 0.0 ) + 3.25 ; return u_texel_size . x * Bt + Br . x ; } float BE ( sampler2D Bx , sampler2D By , vec2 Bz , float BA ) { float BB ; vec2 BC ; BC = vec2 ( 0.0 , 1.0 ) ; for ( int BD = 0 ; BD < SMAA_MAX_SEARCH_STEPS ; BD ++ ) { if ( Bz . x < BA && BC . g > 0.8281 && BC . r == 0.0 ) { BC = texture2D ( Bx , Bz , 0.0 ) . rg ; Bz = vec2 ( 2.0 , 0.0 ) * u_texel_size + Bz ; } } BB = - ( 255.0 / 127.0 ) * Bo ( By , BC , 0.5 ) + 3.25 ; return - u_texel_size . x * BB + Bz . x ; } float BM ( sampler2D BF , sampler2D BG , vec2 BH , float BI ) { float BJ ; vec2 BK ; BK = vec2 ( 1.0 , 0.0 ) ; for ( int BL = 0 ; BL < SMAA_MAX_SEARCH_STEPS ; BL ++ ) { if ( BH . y > BI && BK . r > 0.8281 && BK . g == 0.0 ) { BK = texture2D ( BF , BH , 0.0 ) . rg ; BH = - vec2 ( 0.0 , 2.0 ) * u_texel_size + BH ; } } BJ = - ( 255.0 / 127.0 ) * Bo ( BG , BK . gr , 0.0 ) + 3.25 ; return u_texel_size . y * BJ + BH . y ; } float BU ( sampler2D BN , sampler2D BO , vec2 BP , float BQ ) { float BR ; vec2 BS ; BS = vec2 ( 1.0 , 0.0 ) ; for ( int BT = 0 ; BT < SMAA_MAX_SEARCH_STEPS ; BT ++ ) { if ( BP . y < BQ && BS . r > 0.8281 && BS . g == 0.0 ) { BS = texture2D ( BN , BP , 0.0 ) . rg ; BP = vec2 ( 0.0 , 2.0 ) * u_texel_size + BP ; } } BR = - ( 255.0 / 127.0 ) * Bo ( BO , BS . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * BR + BP . y ; } vec2 Ca ( sampler2D BV , vec2 BW , float BX , float BY , float BZ ) { vec2 B_ ; B_ = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * Ak ( 4.0 * vec2 ( BX , BY ) ) + BW ; B_ = SMAA_AREATEX_PIXEL_SIZE * B_ + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; B_ . y = SMAA_AREATEX_SUBTEX_SIZE * BZ + B_ . y ; return texture2D ( BV , B_ , 0.0 ) . rg ; } void Ch ( sampler2D Cb , inout vec2 Cc , vec4 Cd , vec2 Ce ) { vec2 Cf , Cg ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"Cf = step ( Ce . xy , Ce . yx ) ; Cg = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * Cf ; Cg /= Cf . x + Cf . y ; Cf = vec2 ( 1.0 , 1.0 ) ; Cf . x -= Cg . x * texture2D ( Cb , Cd . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; Cf . x -= Cg . y * texture2D ( Cb , Cd . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; Cf . y -= Cg . x * texture2D ( Cb , Cd . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; Cf . y -= Cg . y * texture2D ( Cb , Cd . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; Cc *= clamp ( Cf , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"} void Co ( sampler2D Ci , inout vec2 Cj , vec4 Ck , vec2 Cl ) { vec2 Cm , Cn ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"Cm = step ( Cl . xy , Cl . yx ) ; Cn = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * Cm ; Cn /= Cm . x + Cm . y ; Cm = vec2 ( 1.0 , 1.0 ) ; Cm . x -= Cn . x * texture2D ( Ci , Ck . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; Cm . x -= Cn . y * texture2D ( Ci , Ck . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; Cm . y -= Cn . x * texture2D ( Ci , Ck . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; Cm . y -= Cn . y * texture2D ( Ci , Ck . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; Cj *= clamp ( Cm , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 CC ( vec2 Cp , vec2 Cq , sampler2D Cr , sampler2D Cs , sampler2D Ct , vec4 Cu ) { float Cv , Cw ; vec3 Cx ; vec2 Cy , Cz , CA ; vec4 CB ; CB = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; Cy = texture2D ( Cr , Cp ) . rg ; if ( Cy . g > 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"textline",b:"CB . rg = Bi ( Cr , Cs , Cp , Cy , Cu ) ; if ( CB . r == - CB . g ) {".split(" ")}]}}]},{type:"textline",b:"; Cx . x = Bw ( Cr , Ct , zO . xy , zQ . x ) ; Cx . y = zP . y ; Cz . x = Cx . x ; Cv = texture2D ( Cr , Cx . xy , 0.0 ) . r ; Cx . z = BE ( Cr , Ct , zO . zw , zQ . y ) ; Cz . y = Cx . z ; Cz = abs ( Ak ( Cz / u_texel_size . xx - Cq . xx ) ) ; CA = sqrt ( Cz ) ; Cw = texture2D ( Cr , Cx . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; CB . rg = Ca ( Cs , CA , Cv , Cw , Cu . y ) ; Cx . y = Cp . y ; Ch ( Cr , CB . rg , Cx . xyzy , Cz ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"} else Cy . r = 0.0 ;".split(" ")}]}}]},{type:"textline",b:"} if ( Cy . r > 0.0 ) { ; Cx . y = BM ( Cr , Ct , zP . xy , zQ . z ) ; Cx . x = zO . x ; Cy . x = Cx . y ; Cw = texture2D ( Cr , Cx . xy , 0.0 ) . g ; Cx . z = BU ( Cr , Ct , zP . zw , zQ . w ) ; Cy . y = Cx . z ; Cy = abs ( Ak ( Cy / u_texel_size . yy - Cq . yy ) ) ; Cz = sqrt ( Cy ) ; Cv = texture2D ( Cr , Cx . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; CB . ba = Ca ( Cs , Cz , Cw , Cv , Cu . x ) ; Cx . x = Cp . x ; Co ( Cr , CB . ba , Cx . xyxz , Cy ) ; } return CB ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 CO ( vec2 CD , sampler2D CE , sampler2D CF".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","CG"]}]}}]},{type:"textline",b:") { bool CH ; vec2 CI , CJ , CK ; vec4 CL , CM , CN ; CL . x = texture2D ( CF , zN . xy ) . a ; CL . y = texture2D ( CF , zN . zw ) . g ; CL . wz = texture2D ( CF , CD ) . xz ; if ( dot ( CL , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { CM = texture2D ( CE , CD , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"CN = texture2D ( CG , fd ) ; CI = 2.0 * s ( CN ) - 1.0 ; CM . a = sqrt ( 2.0 * length ( CI ) ) ;".split(" ")}]}}]},{type:"textline",b:"return CM ; } else { CH = max ( CL . x , CL . z ) > max ( CL . y , CL . w ) ; CM = vec4 ( 0.0 , CL . y , 0.0 , CL . w ) ; CI = CL . yw ; Af ( bvec4 ( CH , CH , CH , CH ) , CM , vec4 ( CL . x , 0.0 , CL . z , 0.0 ) ) ; Af ( bvec2 ( CH , CH ) , CI , CL . xz ) ; CI /= dot ( CI , vec2 ( 1.0 , 1.0 ) ) ; CM = CM * vec4 ( u_texel_size , - u_texel_size ) + CD . xyxy ; CL = CI . x * texture2D ( CE , CM . xy , 0.0 ) ; CL += CI . y * texture2D ( CE , CM . zw , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"CN = texture2D ( CG , CM . xy ) ; CJ = 2.0 * s ( CN ) - 1.0 ; CK = CI . x * CJ ; CN = texture2D ( CG , CM . zw ) ; CJ = 2.0 * s ( CN ) - 1.0 ; CK += CI . y * CJ ; CL . a = sqrt ( 2.0 * length ( CK ) ) ;".split(" ")}]}}]},{type:"textline",b:["return","CL",";","}","}"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 CY ( vec2 CP , sampler2D CQ , sampler2D CR".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","CS"]}]}}]},{type:"textline",b:") { float CT ; vec2 CU ; vec4 CV , CW , CX ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"CV = texture2D ( CS , fd ) ; CU = 2.0 * s ( CV ) - 1.0 ; CV = texture2D ( CQ , CP ) ; CW = texture2D ( CR , CP - CU ) ; CT = abs ( CV . a * CV . a - CW . a * CW . a ) / 2.0 ; CT = 0.5 * clamp ( 1.0 - sqrt ( CT ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; CX = mix ( CV , CW , CT ) ; CX . a = 1.0 ; return CX ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"CV = texture2D ( CQ , CP ) ; CW = texture2D ( CR , CP ) ; return mix ( CV , CW , 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:"void main ( ) { vec4 CZ ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"CZ = vec4 ( Ay ( fd , u_color".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",
a:[{type:"textline",b:[",","u_predication_tex"]}]}}]},{type:"textline",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"CZ = CC ( fd , zR , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"CZ = CO ( fd , u_color , u_blend".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","u_velocity_tex"]}]}}]},{type:"textline",b:[")",";"]}]}},{type:"elif",c:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"CZ = vec4 ( CY ( fd , u_color , u_color_prev".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","u_velocity_tex"]}]}}]},{type:"textline",b:[")",")",";"]}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:"CZ = texture2D ( u_color , fd ) ;".split(" ")}]}}]},{type:"textline",b:["gl_FragColor","=","CZ",";","}"]}]};a["postprocessing/smaa.glslv"]={type:"group",a:[{type:"define",name:"SMAA_EDGE_DETECTION",b:["1"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["2"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_LOW",b:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",
b:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",b:["4"]},{type:"textline",b:"attribute vec2 a_position ; uniform vec2 u_texel_size ; varying vec2 fd ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","zN",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"varying vec4 zO ; varying vec4 zP ; varying vec4 zQ ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","zR",";"]}]}}]},{type:"condition",a:[{type:"if",c:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{type:"elif",c:["AA_METHOD",
"AA_METHOD_SMAA_HIGH",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void zS ( vec2 zx ) { zO = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + zx . xyxy ; zP = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + zx . xyxy ; zQ = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + zx . xyxy ; }".split(" ")}]}},{type:"elif",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void zV ( vec2 zT , out vec2 zU ) { zU = zT / u_texel_size ; zO = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + zT . xyxy ; zP = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + zT . xyxy ; zQ = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( zO . xz , zP . yw ) ; }".split(" ")}]}},
{type:"elif",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void zX ( vec2 zW ) { zN = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + zW . xyxy ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { fd = 2.0 * a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["zS","(","fd",")",";"]}]}},{type:"elif",c:["SMAA_PASS",
"SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zV ( fd , zR ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["zX","(","fd",")",";"]}]}}]},{type:"textline",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",
b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"define",name:"SSAO_QUALITY_8",b:["1"]},{type:"define",name:"SSAO_QUALITY_16",b:["2"]},{type:"define",name:"SSAO_QUALITY_24",b:["3"]},{type:"define",name:"SSAO_QUALITY_32",b:["4"]},{type:"textline",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; varying vec2 fd ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; float zS ( in vec2 zx ) { return zI ( u_depth , zx , u_camera_range ) ; } void main ( ) { vec3 zT , zU , zV ; float zW , zX , zY , zZ , z_ , Aa , Ab ; zW = texture2D ( u_color , fd ) . r ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SSAO_WHITE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( zW , 1.0 , 0.0 , 1.0 ) ; return ;".split(" ")}]}}]},{type:"textline",b:"zT = normalize ( 2.0 * texture2D ( u_ssao_special_tex , fd * 0.25 / u_texel_size ) . rgb - 1.0 ) ; zX = zS ( fd ) ; zY = zX * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_QUALITY","SSAO_QUALITY_8",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"const float Ac = 8.0 ; const int Ad = 1 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","SSAO_QUALITY_16",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"const float Ac = 16.0 ; const int Ad = 2 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","SSAO_QUALITY_24",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"const float Ac = 24.0 ; const int Ad = 3 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","SSAO_QUALITY_32",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"const float Ac = 32.0 ; const int Ad = 4 ;".split(" ")}]}}]},{type:"textline",b:"zZ = u_ssao_radius_increase * 0.001 ; const float Ae = 1.0 + 2.4 / Ac ; z_ = 0.0 ; for ( int Af = 0 ; Af < Ad ; Af ++ ) for ( int Ag = - 1 ; Ag <= 1 ; Ag += 2 ) for ( int Ah = - 1 ; Ah <= 1 ; Ah += 2 ) for ( int Ai = - 1 ; Ai <= 1 ; Ai += 2 ) { zU = reflect ( normalize ( vec3 ( Ag , Ah , Ai ) ) , zT ) * ( zZ *= Ae ) ; zV = vec3 ( fd , zY ) ; zV += vec3 ( zU . xy , zU . z * zY * 2.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"zV . z -= 1.4 * ( zV . z - zY ) * step ( zY , zV . z ) ;".split(" ")}]}}]},{type:"textline",b:"Aa = zS ( zV . xy ) * ( u_camera_range . y - u_camera_range . x ) ; Ab = clamp ( ( zY - Aa ) / Aa , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"z_ += mix ( 1.0 , Ab , step ( Aa , zV . z ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"z_ += mix ( step ( zV . z , Aa ) , 0.5 , Ab ) ;".split(" ")}]}}]},{type:"textline",b:"} z_ = z_ / Ac ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"z_ = clamp ( z_ * z_ + 0.6 * z_ , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"z_ = clamp ( z_ * z_ + z_ , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"zX = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * zX ) ; z_ = mix ( 1.0 , z_ , zX ) ; gl_FragColor = vec4 ( zW , z_ , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/ssao_blur.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"include",file:"depth_fetch.glslf"}]}}]},{type:"textline",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; varying vec2 fd ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",
a:[{type:"textline",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float zS ( in vec2 zx ) { return zI ( u_depth , zx , u_camera_range ) ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { vec2 zT , zU ; float zV , zW , zX , zY , zZ , z_ , Aa ; zV = 0.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"zW = zS ( fd ) ; zX = 0.0 ; zY = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},
{type:"textline",b:"zT = vec2 ( - 2.0 ) ; for ( int Ab = 0 ; Ab < 4 ; ++ Ab ) { for ( int Ac = 0 ; Ac < 4 ; ++ Ac ) { zU = ( zT + vec2 ( float ( Ab ) , float ( Ac ) ) ) * u_texel_size ; zZ = texture2D ( u_ssao_mask , fd + zU ) . g ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"z_ = zS ( fd + zU ) ; Aa = 1.0 - clamp ( abs ( z_ - zW ) * zY , 0.0 , 1.0 ) ; zV += zZ * Aa ; zX += Aa ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:["zV","+=","zZ",";"]}]}}]},{type:"textline",b:["}","}"]},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , fd ) . r , zV / zX , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , fd ) . r , zV / 16.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/velocity.glslf"]={type:"group",a:[{type:"include",
file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; varying vec2 fd ; void main ( ) { vec2 zx ; vec4 zS , zT ; float zU ; zU = texture2D ( u_depth , fd ) . x ; zS = vec4 ( fd * 2.0 - 1.0 , 2.0 * zU - 1.0 , 1.0 ) ; zT = u_view_proj_inverse * zS ; zT = zT / zT . w ; zT = u_view_proj_prev * zT ; zT /= zT . w ; zx = ( zS . xy - zT . xy ) / 4.0 + 0.5 ; zx = clamp ( zx , 0.0 , 1.0 ) ; gl_FragColor = g ( zx ) ; }".split(" ")}]};
a["include/precision_statement.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","float",";"]}]};a["include/std_enums.glsl"]={type:"group",a:[{type:"define",name:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{type:"define",name:"TEXTURE_COORDS_NORMAL",b:["2"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MULTIPLY",b:["2"]},{type:"define",name:"SHADOW_SRC_NONE",b:["1"]},{type:"define",name:"SHADOW_SRC_DEPTH",
b:["2"]},{type:"define",name:"SHADOW_SRC_MASK",b:["3"]},{type:"define",name:"SHADOW_DST_NONE",b:["1"]},{type:"define",name:"SHADOW_DST_DEPTH",b:["2"]},{type:"define",name:"SHADOW_DST_MASK",b:["3"]},{type:"define",name:"NO_SHADOWS",b:["1"]},{type:"define",name:"SHADOW_CASTING",b:["2"]},{type:"define",name:"SHADOW_MASK_GENERATION",b:["3"]},{type:"define",name:"SHADOW_MAPPING_OPAQUE",b:["4"]},{type:"define",name:"SHADOW_MAPPING_BLEND",b:["5"]},{type:"define",name:"SPECULAR_PHONG",b:["1"]},{type:"define",
name:"SPECULAR_COOKTORR",b:["2"]},{type:"define",name:"SPECULAR_WARDISO",b:["3"]},{type:"define",name:"SPECULAR_BLINN",b:["4"]},{type:"define",name:"DIFFUSE_LAMBERT",b:["1"]},{type:"define",name:"DIFFUSE_OREN_NAYAR",b:["2"]},{type:"define",name:"DIFFUSE_FRESNEL",b:["3"]},{type:"define",name:"DIFFUSE_MINNAERT",b:["4"]},{type:"define",name:"DIFFUSE_TOON",b:["5"]},{type:"define",name:"MAPPING_TYPE_TEXTURE",b:["0.0"]},{type:"define",name:"MAPPING_TYPE_POINT",b:["1.0"]},{type:"define",name:"MAPPING_TYPE_VECTOR",
b:["2.0"]},{type:"define",name:"MAPPING_TYPE_NORMAL",b:["3.0"]},{type:"define",name:"MIX",b:["0"]},{type:"define",name:"ADD",b:["1"]},{type:"define",name:"SUBTRACT",b:["2"]},{type:"define",name:"MULTIPLY",b:["3"]},{type:"define",name:"SCREEN",b:["4"]},{type:"define",name:"OVERLAY",b:["5"]},{type:"define",name:"DIFFERENCE",b:["6"]},{type:"define",name:"DIVIDE",b:["7"]},{type:"define",name:"DARKEN",b:["8"]},{type:"define",name:"LIGHTEN",b:["9"]},{type:"define",name:"HUE",b:["10"]},{type:"define",name:"SATURATION",
b:["11"]},{type:"define",name:"VALUE",b:["12"]},{type:"define",name:"COLOR",b:["13"]},{type:"define",name:"SOFT_LIGHT",b:["14"]},{type:"define",name:"LINEAR_LIGHT",b:["15"]},{type:"define",name:"REFL_NONE",b:["0"]},{type:"define",name:"REFL_MIRRORMAP",b:["1"]},{type:"define",name:"REFL_PLANE",b:["2"]},{type:"define",name:"REFL_CUBE",b:["3"]}]};a["include/pack.glslf"]={type:"group",a:[{type:"textline",b:"float a = 255.0 ; float b = 0.0 ; float c = 1.0 ; vec4 g ( const in float d ) { vec4 e , f ; e = vec4 ( a * a * a , a * a , a , c ) ; f = vec4 ( b , c / a , c / a , c / a ) ; e = fract ( d * e ) ; e -= e . xxyz * f ; return e ; } float k ( const in vec4 h ) { vec4 i ; float j ; i = vec4 ( c / ( a * a * a ) , c / ( a * a ) , c / a , c ) ; j = dot ( h , i ) ; return j ; } vec4 g ( const in vec2 l ) { vec4 m ; vec2 n , o ; n = vec2 ( a , c ) ; o = vec2 ( b , c / a ) ; m = fract ( l . xxyy * n . xyxy ) ; m -= m . xxzz * o . xyxy ; if ( l . r == c ) m . rg = vec2 ( b , c ) ; if ( l . g == c ) m . ba = vec2 ( b , c ) ; return m ; } vec2 s ( const in vec4 p ) { vec2 q , r ; r = vec2 ( c / a , c ) ; q . r = dot ( p . rg , r ) ; q . g = dot ( p . ba , r ) ; return q ; }".split(" ")}]};
a["include/fog.glslf"]={type:"group",a:[{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"textline",b:"void x ( inout vec3 t , in float u , in vec4 v ) { float w ; w = v . w * u ; w = exp ( - w * w ) ; w = clamp ( w , 0.0 , 1.0 ) ; t = mix ( v . rgb , t , w ) ; }".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"vec3 D ( in mat4 y , in vec3 z ) { vec3 A , B , C ; A = mix ( y [ 0 ] . rgb , y [ 1 ] . rgb , max ( sign ( z . x ) , 0.0 ) ) ; B = mix ( y [ 2 ] . rgb , y [ 3 ] . rgb , max ( sign ( z . z ) , 0.0 ) ) ; C = vec3 ( y [ 0 ] . a , y [ 1 ] . a , y [ 2 ] . a ) ; B = mix ( A , B , abs ( z . z ) ) ; B = mix ( B , C , abs ( z . y ) ) ; return B ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"void F ( inout float E ) { E -= 0.5 ; E = 4.0 * ( E * E * E ) + 0.5 ; } void U ( inout vec3 G , in float H , in vec3 I , in float J , in vec4 L , in vec4 M , in float N , in float O ) { vec3 P , Q ; float R , S , T ; R = M . w * H ; R = exp ( - R * R ) ; R = clamp ( R , 0.0 , 1.0 ) ; S = max ( I . y , 0.0 ) ; H = max ( H - max ( J / S , 0.0 ) , 0.0 ) ; T = L . w * H ; T = 1.0 - T ; T = max ( T , 0.0 ) ; F ( T ) ; T += max ( N - 0.5 , 0.0 ) ; if ( T < R ) { P = vec3 ( 0.0 , 0.02 , 0.05 ) ; Q = L . rgb ; J = clamp ( - J * 0.03 , 0.0 , 0.8 ) ; P = mix ( Q , P , min ( S , 1.0 ) ) ; P = mix ( P , vec3 ( 0.0 ) , J ) * O ; G = mix ( P , G , T ) ; } if ( T >= R ) { G = mix ( M . rgb , G , R ) ; } } void ab ( inout vec3 V , in float W , in float X , in vec4 Y , in float Z ) { vec3 _ ; float aa ; aa = Y . w * W ; aa = 1.0 - aa ; aa = clamp ( aa , 0.0 , 1.0 ) ; F ( aa ) ; X = clamp ( - X * 0.03 , 0.0 , 0.8 ) ; _ = mix ( Y . rgb , vec3 ( 0.0 ) , X ) * Z ; V = mix ( _ , V , aa ) ; }".split(" ")}]}}]}]};
a["include/lighting.glslf"]={type:"group",a:[{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"textline",
b:"float ac = 0.0 ; float ad = 1.0 ; float ae = 0.5 ; struct af { vec4 a ; vec3 b ; } ;".split(" ")},{type:"condition",a:[{type:"if",c:["SPECULAR_SHADER","SPECULAR_PHONG",{type:"equal_expr",d:2},"SPECULAR_SHADER","SPECULAR_COOKTORR",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float an ( vec3 ag , vec3 ah , vec3 ai , float aj , float ak ) { float al ; vec3 am ; am = normalize ( ag + ah ) ; al = ( ad - aj ) * max ( dot ( ai , am ) , ac ) + aj ; return pow ( al , ak ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SPECULAR_SHADER","SPECULAR_WARDISO",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float ax ( vec3 ao , vec3 ap , vec3 aq , float ar ) { float as , at , au , av ; vec3 aw ; aw = normalize ( ao + ap ) ; as = max ( dot ( aq , aw ) , 0.001 ) ; at = max ( dot ( aq , ap ) , 0.01 ) ; au = max ( dot ( aq , ao ) , 0.01 ) ; as = tan ( acos ( as ) ) ; av = max ( ar , 0.001 ) ; return au * ( ad / ( 4.0 * M_PI * av * av ) ) * ( exp ( - ( as * as ) / ( av * av ) ) / ( sqrt ( at * au ) ) ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SPECULAR_SHADER","SPECULAR_TOON",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float aF ( vec3 ay , vec3 az , vec3 aA , float aB , float aC ) { float aD ; vec3 aE ; aE = normalize ( ay + az ) ; aD = acos ( dot ( aE , aA ) ) ; if ( aD < aB ) return ad ; else if ( aD >= aB + aC || aC == ac ) return ac ; else return ad - ( aD - aB ) / aC ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SPECULAR_SHADER","SPECULAR_BLINN",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"float aS ( vec3 aG , vec3 aH , vec3 aI , float aJ , float aK , float aL ) { float aM , aN , aO , aP , aQ ; vec3 aR ; if ( aJ < 1.0 || aK == ac ) return ac ; else { if ( aK < 100.0 ) aK = sqrt ( 1.0 / aK ) ; else aK = 10.0 / aK ; aR = normalize ( aH + aG ) ; aM = ( ad - aL ) * max ( dot ( aI , aR ) , ac ) + aL ; if ( aM < ac ) return ac ; else { aN = max ( dot ( aI , aH ) , 0.01 ) ; aO = dot ( aI , aG ) ; if ( aO <= 0.01 ) return ac ; else { aP = max ( dot ( aH , aR ) , 0.01 ) ; aQ = ad ; aN = ( 2.0 * aM * aN ) / aP ; aO = ( 2.0 * aM * aO ) / aP ; aO = min ( min ( aQ , aN ) , aO ) ; aN = sqrt ( pow ( aJ , 2.0 ) + pow ( aP , 2.0 ) - ad ) ; aP = pow ( aN - aP , 2.0 ) / pow ( aN + aP , 2.0 ) * ( ad + pow ( aP * ( aN + aP ) - ad , 2.0 ) / pow ( aP * ( aN - aP ) + ad , 2.0 ) ) ; aM = acos ( aM ) ; return max ( aP * aO * exp ( - pow ( aM , 2.0 ) / ( 2.0 * pow ( aK , 2.0 ) ) ) , ac ) ; } } } }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","DIFFUSE_OREN_NAYAR",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float bf ( float aT , vec3 aU , vec3 aV , vec3 aW , float aX ) { vec3 aY , aZ ; float a_ , ba , bb , bc , bd , be ; if ( aX > ac ) { a_ = max ( dot ( aU , aW ) , ac ) ; ba = aX * aX ; bb = ad - ae * ( ba / ( ba + 0.33 ) ) ; aY = aV - aT * aU ; aZ = aW - a_ * aU ; if ( length ( aY ) == ac || length ( aZ ) == ac || abs ( aT ) > ad || abs ( a_ ) > ad ) return aT * bb ; else { bc = acos ( aT ) ; a_ = acos ( a_ ) ; aY = normalize ( aY ) ; aZ = normalize ( aZ ) ; bd = max ( bc , a_ ) ; be = min ( bc , a_ ) ; be *= 0.95 ; a_ = max ( dot ( aY , aZ ) , ac ) ; ba = 0.45 * ( ba / ( ba + 0.09 ) ) ; return aT * ( bb + ( ba * a_ * sin ( bd ) * tan ( be ) ) ) ; } } else return aT ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","DIFFUSE_MINNAERT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float bl ( float bg , vec3 bh , vec3 bi , float bj ) { float bk ; bk = max ( dot ( bh , bi ) , ac ) ; if ( bj <= ad ) return bg * pow ( max ( bk * bg , 0.1 ) , bj - ad ) ; else return bg * pow ( 1.0001 - bk , bj - ad ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","DIFFUSE_TOON",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"float bq ( float bm , float bn , float bo ) { float bp ; bp = acos ( bm ) ; if ( bp < bn ) return ad ; else if ( bp > ( bn + bo ) || bo == ac ) return ac ; else return ad - ( ( bp - bn ) / bo ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","DIFFUSE_FRESNEL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float bv ( float br , float bs , float bt ) { float bu ; if ( bs == ac ) { return ad ; } else { bu = ad + abs ( br ) ; bu = bt + ( ad - bt ) * pow ( bu , bs ) ; return clamp ( bu , ac , ad ) ; } }".split(" ")}]}}]},
{type:"textline",b:"void bD ( vec3 bw , vec3 bx , vec3 by , vec2 bz , const float bA , out float bB ) { float bC ; bC = ( ad - bA ) * dot ( bw , bx ) + bA ; bB = bC ; if ( bA == ae ) return ;".split(" ")},{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","DIFFUSE_FRESNEL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bB = bv ( bC , bz [ 0 ] , bz [ 1 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","DIFFUSE_OREN_NAYAR",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bB = bf ( bC , bw , bx , by , bz [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","DIFFUSE_MINNAERT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bB = bl ( bC , bw , by , bz [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","DIFFUSE_TOON",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bB = bq ( bC , bz [ 0 ] , bz [ 1 ] ) ;".split(" ")}]}}]},
{type:"textline",b:"bB = max ( bB , ac ) ;".split(" ")}]}}]},{type:"textline",b:"} void bK ( vec3 bE , vec3 bF , vec3 bG , float bH , vec2 bI , out float bJ ) {".split(" ")},{type:"condition",a:[{type:"if",c:["SPECULAR_SHADER","SPECULAR_PHONG",{type:"equal_expr",d:2},"SPECULAR_SHADER","SPECULAR_COOKTORR",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bJ = an ( bE , bF , bG , bH , bI [ 0 ] ) ;".split(" ")}]}},{type:"elif",c:["SPECULAR_SHADER","SPECULAR_WARDISO",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bJ = ax ( bE , bF , bG , bI [ 0 ] ) ;".split(" ")}]}},{type:"elif",c:["SPECULAR_SHADER","SPECULAR_TOON",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bJ = aF ( bE , bF , bG , bI [ 0 ] , bI [ 1 ] ) ;".split(" ")}]}},{type:"elif",c:["SPECULAR_SHADER","SPECULAR_BLINN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bJ = aS ( bE , bF , bG , bI [ 0 ] , bI [ 1 ] , bH ) ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:["bJ","=","ac",";"]}]}}]},{type:"textline",b:"} void cf ( vec3 bL , vec3 bM , vec3 bN , vec2 bO , vec4 bP , vec3 bQ , vec3 bR , vec3 bS , inout af bT , float bU , vec2 bV , vec2 bW , float bX ) { float bY , bZ , b_ , ca , cb , cc , cd , ce ; bY = ac ; if ( bO . r != ac ) bD ( bN , bM , bL , bV , bX , bY ) ; bZ = ac ; if ( bO . g != ac ) bK ( bM , bL , bN , bX , bW , bZ ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_TRANSLUCENCY"],group:{type:"group",
a:[{type:"textline",b:"if ( dot ( bM , bN ) * dot ( bL , bN ) < ac ) { b_ = bP . x ; ca = bP . y ; cb = bP . z ; cc = bP . w ; cd = clamp ( abs ( dot ( bM , bN ) ) , ac , ad ) ; ce = clamp ( dot ( bL , - bM ) , ac , ad ) ; ca = pow ( ce , ca ) ; bT . a += bU * vec4 ( bS * cd * pow ( bQ , vec3 ( b_ ) ) , ad ) ; bT . a += cb * mix ( vec4 ( bQ , ad ) , vec4 ( ad ) , cc ) * bU * vec4 ( bS * cd * vec3 ( ca ) , ad ) ; } else { bT . b += bS * bR * bZ ; bT . a += vec4 ( bS * bQ * bY , bZ ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"bT . b += bS * bR * bZ ; bT . a += vec4 ( bS * bQ * bY , bZ ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"lamp",name:"POINT",g:[{type:"textline",b:"cI = ct [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; cA = cq [ LAMP_IND ] ; cB = cs [ LAMP_IND ] ; cw = ac ;".split(" ")},{type:"textline",b:"cB = cB ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) cB *= cp ; cA = cA - ck ;".split(" ")},{type:"textline",b:"cx = length ( cA ) ; cB *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + cx * cx ) ; cA = normalize ( cA ) ; cf ( cm , cA , cl , cI , cv , ci , cj , cB , cM , cu , co , cn , cw ) ;".split(" ")}]},
{type:"lamp",name:"SPOT",g:[{type:"textline",b:"cJ = ct [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; cC = cq [ LAMP_IND ] ; cD = cs [ LAMP_IND ] ; cE = cr [ LAMP_IND ] ; cx = ac ;".split(" ")},{type:"textline",b:"cD = cD ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) cD *= cp ; cC = cC - ck ;".split(" ")},{type:"textline",b:"cy = length ( cC ) ; cD *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + cy * cy ) ; cC = normalize ( cC ) ;".split(" ")},{type:"textline",b:"cy = dot ( cC , cE ) ; cy *= smoothstep ( ac , ad , ( cy - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; cD *= cy ; cf ( cm , cC , cl , cJ , cv , ci , cj , cD , cM , cu , co , cn , cx ) ;".split(" ")}]},
{type:"lamp",name:"SUN",g:[{type:"textline",b:"cK = ct [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; cE = cs [ LAMP_IND ] ; cF = cr [ LAMP_IND ] ; cy = ac ;".split(" ")},{type:"textline",b:"cE = cE ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) cE *= cp ; cf ( cm , cF , cl , cK , cv , ci , cj , cE , cM , cu , co , cn , cy ) ;".split(" ")}]},{type:"lamp",name:"HEMI",g:[{type:"textline",b:"cL = ct [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; cG = cs [ LAMP_IND ] ; cH = cr [ LAMP_IND ] ; cz = ae ;".split(" ")},
{type:"textline",b:"cG = cG ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) cG *= cp ; cf ( cm , cH , cl , cL , cv , ci , cj , cG , cM , cu , co , cn , cz ) ;".split(" ")}]},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"af cN ( vec3 cg , vec3 ch , vec3 ci , vec3 cj , vec3 ck , vec3 cl , vec3 cm , vec2 cn , vec2 co , float cp , vec3 cq [ NUM_LIGHTS ] , vec3 cr [ NUM_LIGHTS ] , vec3 cs [ NUM_LIGHTS ] , vec4 ct [ NUM_LFACTORS ] , float cu , vec4 cv ) { float cw , cx , cy , cz ; vec3 cA , cB , cC , cD , cE , cF , cG , cH ; vec2 cI , cJ , cK , cL ; af cM ; cM . a = vec4 ( cg + ci * ch , ac ) ; cM . b = vec3 ( ac ) ;".split(" ")},
{type:"lamps_main"},{type:"textline",b:["return","cM",";","}"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"af cS ( vec3 cO , vec3 cP , vec3 cQ ) { af cR ; cR . a = vec4 ( cO + cQ * cP , ac ) ; cR . b = vec3 ( ac ) ; return cR ; }".split(" ")}]}}]}]};a["include/procedural.glslf"]={type:"group",a:[{type:"textline",b:"float cT = 0.0 ; float cU = 1.0 ; vec4 cW ( vec4 cV ) { return cV - floor ( cV * ( cU / 289.0 ) ) * 289.0 ; } vec3 cW ( vec3 cX ) { return cX - floor ( cX * ( cU / 289.0 ) ) * 289.0 ; } vec2 cW ( vec2 cY ) { return cY - floor ( cY * ( cU / 289.0 ) ) * 289.0 ; } vec4 c_ ( vec4 cZ ) { return cZ - floor ( cZ * ( cU / 7.0 ) ) * 7.0 ; } vec4 db ( vec4 da ) { return cW ( ( 34.0 * da + 5.0 ) * da ) ; }".split(" ")},
{type:"define",name:"K",b:["0.142857142857"]},{type:"define",name:"K2",b:["0.0714285714285"]},{type:"define",name:"JITTER",b:["0.7"]},{type:"textline",b:"vec2 dj ( vec2 dc ) { vec4 dd , de , df , dg ; vec2 dh , di ; dh = cW ( floor ( dc ) ) ; di = fract ( dc ) ; dd = di . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; de = di . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; df = db ( dh . x + vec4 ( cT , cU , cT , cU ) ) ; df = db ( df + dh . y + vec4 ( cT , cT , cU , cU ) ) ; dg = c_ ( df ) * K + K2 ; df = c_ ( floor ( df * K ) ) * K + K2 ; dg = dd + JITTER * dg ; df = de + JITTER * df ; df = dg * dg + df * df ;".split(" ")},
{type:"condition",a:[{type:"if",c:[1],group:{type:"group",a:[{type:"textline",b:"df . xy = min ( df . xy , df . zw ) ; df . x = min ( df . x , df . y ) ; return df . xx ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"df . xy = ( df . x < df . y ) ? df . xy : df . yx ; df . xz = ( df . x < df . z ) ? df . xz : df . zx ; df . xw = ( df . x < df . w ) ? df . xw : df . wx ; df . y = min ( df . y , df . z ) ; df . y = min ( df . y , df . w ) ; return sqrt ( df . xy ) ;".split(" ")}]}}]},
{type:"textline",b:"} vec3 dt ( vec2 dk , float dl ) { vec4 dm , dn , dp , dq ; vec2 dr , ds ; dr = cW ( floor ( dk ) ) ; ds = fract ( dk ) ; dm = ds . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; dn = ds . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; dp = db ( dr . x + vec4 ( cT , cU , cT , cU ) ) ; dp = db ( dp + dr . y + vec4 ( cT , cT , cU , cU ) ) ; dq = c_ ( dp ) * K + K2 ; dp = c_ ( floor ( dp * K ) ) * K + K2 ; dq = dm + JITTER * dq ; dp = dn + JITTER * dp ; dn = dq * dq + dp * dp ; dq += dl ; dp += dl ; dm = dq * dq + dp * dp ; dq += dl ; dp += dl ; dp = dq * dq + dp * dp ; dn . xy = min ( dn . xy , dn . zw ) ; dn . x = min ( dn . x , dn . y ) ; dm . xy = min ( dm . xy , dm . zw ) ; dm . x = min ( dm . x , dm . y ) ; dp . xy = min ( dp . xy , dp . zw ) ; dp . x = min ( dp . x , dp . y ) ; return vec3 ( dn . x , dm . x , dp . x ) ; } vec3 dv ( vec3 du ) { return cW ( ( ( du * 34.0 ) + cU ) * du ) ; } float dG ( vec2 dw ) { vec3 dx , dy , dz , dA ; vec4 dB ; vec2 dC , dD , dE ; const vec4 dF = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; dC = floor ( dw + dot ( dw , dF . yy ) ) ; dD = dw - dC + dot ( dC , dF . xx ) ; dE = ( dD . x > dD . y ) ? vec2 ( cU , cT ) : vec2 ( cT , cU ) ; dB = dD . xyxy + dF . xxzz ; dB . xy -= dE ; dC = cW ( dC ) ; dx = dv ( dv ( dC . y + vec3 ( cT , dE . y , cU ) ) + dC . x + vec3 ( cT , dE . x , cU ) ) ; dy = max ( 0.5 - vec3 ( dot ( dD , dD ) , dot ( dB . xy , dB . xy ) , dot ( dB . zw , dB . zw ) ) , cT ) ; dy = dy * dy ; dy = dy * dy ; dx = 2.0 * fract ( dx * dF . www ) - cU ; dz = abs ( dx ) - 0.5 ; dA = floor ( dx + 0.5 ) ; dA = dx - dA ; dy *= 1.79284291400159 - 0.85373472095314 * ( dA * dA + dz * dz ) ; dx . x = dA . x * dD . x + dz . x * dD . y ; dx . yz = dA . yz * dB . xz + dz . yz * dB . yw ; return 130.0 * dot ( dy , dx ) ; } vec2 dK ( vec2 dH ) { float dI , dJ ; dI = dot ( dH , vec2 ( 12.9898 , 78.233 ) ) ; dJ = dot ( dH , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; dI = fract ( sin ( dI ) * 43758.5453 ) * 2.0 - cU ; dJ = fract ( sin ( dJ ) * 43758.5453 ) * 2.0 - cU ; return vec2 ( dI , dJ ) ; }".split(" ")}]};
a["include/caustics.glslf"]={type:"group",a:[{type:"var",name:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{type:"var",name:"CAUST_SCALE",b:["0.0"]},{type:"var",name:"CAUST_BRIGHT",b:["0.0"]},{type:"define",name:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{type:"textline",b:"void eb ( inout vec3 dL , float dM , float dN , float dO , vec3 dP , vec3 dQ , vec3 dR , vec4 dS , vec3 dT , float dU ) { float dV , dW , dX ; vec2 dY , dZ ; vec3 d_ ; vec4 ea ; if ( dU > CAUSTICS_VIEW_DISTANCE ) return ; ea = dS ; d_ = dT + dP ; d_ . xz = 10.0 * sin ( 0.1 * d_ . xz ) ; d_ = d_ + 2.0 * cross ( - ea . xyz , cross ( - ea . xyz , d_ ) + ea . w * d_ ) ; dY = d_ . xz ; d_ = dQ ; dV = max ( dot ( dP , d_ ) , 0.0 ) ; dW = 0.025 ; dZ = CAUST_SPEED * dN ; dY . s += 0.25 * sin ( dot ( dT + dN , vec3 ( 1.0 ) ) ) ; dY . t += 0.35 * ( - sin ( dot ( dT - dN , vec3 ( - 0.7 ) ) ) ) ; dY . st += 0.15 * cos ( 4.0 * dM - dZ . x ) + 1.5 * sin ( dM - 0.3 * dZ . y ) ; dX = CAUST_SCALE * ( 1.0 + max ( 0.1 * dM , 0.0 ) ) ; d_ = dt ( ( dY / dX ) , dW ) ; d_ *= CAUST_BRIGHT ; d_ *= d_ ; dW = min ( 0.25 * dM , - dM ) + 1.0 ; dW = max ( dW , 0.0 ) ; dV = dO * dV ; dX = max ( sign ( dM ) , 0.0 ) ; dV = dV + max ( 0.5 * sign ( - dP . y ) * dX , 0.0 ) ; dV = min ( dV , 1.0 ) ; dL += dR * d_ * dW * dV ; }".split(" ")}]};
a["include/gamma.glslf"]={type:"group",a:[{type:"define",name:"GAMMA",b:["1"]},{type:"define",name:"PREMULTIPLY_ALPHA",b:["1"]},{type:"textline",b:"void ed ( inout vec3 ec ) {".split(" ")},{type:"condition",a:[{type:"if",c:["GAMMA"],group:{type:"group",a:[{type:"textline",b:"ec = max ( vec3 ( 0.0 ) , ec ) ; ec = pow ( ec , vec3 ( 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} void ef ( inout vec3 ee ) {".split(" ")},{type:"condition",a:[{type:"if",c:["GAMMA"],group:{type:"group",a:[{type:"textline",
b:"ee = max ( vec3 ( 0.0 ) , ee ) ; ee = pow ( ee , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} void ei ( inout vec3 eg , in float eh ) {".split(" ")},{type:"condition",a:[{type:"if",c:["PREMULTIPLY_ALPHA"],group:{type:"group",a:[{type:"textline",b:"eg = eg * eh ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["include/math.glslv"]={type:"group",a:[{type:"var",name:"EPSILON",b:["0.0001"]},{type:"textline",b:"float ej = 0.0 ; float ek = 1.0 ; struct el { vec3 a ; vec3 b ; vec3 c ; vec3 d ; vec3 e ; vec3 f ; } ; bool eo ( vec3 em , vec3 en ) { return any ( lessThan ( abs ( em - en ) , vec3 ( EPSILON ) ) ) ; } vec3 er ( in vec4 ep , in vec3 eq ) { return eq + 2.0 * cross ( ep . xyz , cross ( ep . xyz , eq ) + ep . w * eq ) ; } vec4 et ( in vec4 es ) { return vec4 ( - es . xyz , es . w ) / dot ( es , es ) ; } vec3 ey ( vec4 eu , vec4 ev , vec4 ew ) { vec3 ex ; ex = ew . xyz * eu . w ; ex = er ( ev , ex ) ; ex += eu . xyz * ew . w ; return ex ; } vec3 eE ( vec4 ez , vec4 eA , vec4 eB ) { vec4 eC ; vec3 eD ; eD = eB . xyz - ez . xyz * eB . w ; eC = et ( eA ) ; eD = er ( eC , eD ) ; eD /= ez . w ; return eD ; } mat4 eF ( ) { return mat4 ( ek , ej , ej , ej , ej , ek , ej , ej , ej , ej , ek , ej , ej , ej , ej , ek ) ; } mat4 eH ( float eG ) { return mat4 ( ek , ej , ej , ej , ej , cos ( eG ) , sin ( eG ) , ej , ej , - sin ( eG ) , cos ( eG ) , ej , ej , ej , ej , ek ) ; } mat4 eJ ( float eI ) { return mat4 ( cos ( eI ) , ej , - sin ( eI ) , ej , ej , ek , ej , ej , sin ( eI ) , ej , cos ( eI ) , ej , ej , ej , ej , ek ) ; } mat4 eL ( float eK ) { return mat4 ( cos ( eK ) , sin ( eK ) , ej , ej , - sin ( eK ) , cos ( eK ) , ej , ej , ej , ej , ek , ej , ej , ej , ej , ek ) ; } el eN ( in el eM ) { return el ( eM . a , eM . b , normalize ( eM . c ) , normalize ( eM . d ) , normalize ( eM . e ) , eM . f ) ; }".split(" ")},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"vec3 eT ( vec4 eO ) { vec3 eP ; float eQ , eR , eS ; eQ = eO . x ; eR = eO . y ; eS = eO . w ; eP . x = ( eQ + eS ) / 2.0 ; eP . y = ( eR + eS ) / 2.0 ; eP . z = eS ; return eP ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={type:"group",
a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"CSM_BLEND_BETWEEN_CASCADES",b:["1.0"]},{type:"var",name:"CSM_FADE_LAST_CASCADE",b:["1.0"]},{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["vec4","fe",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",
d:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"const float ff = 0.1 ; const float fg = 0.1 ; const float fh = - 0.01 ; const float fi = 0.05 ; vec4 fj = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 fk = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 fl = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 fm = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 fn = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 fo = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 fp = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 fq = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ; bool ft ( vec2 fr , float fs ) { return all ( lessThanEqual ( fr , vec2 ( 1.0 + fs ) ) ) && all ( greaterThanEqual ( fr , vec2 ( 0.0 - fs ) ) ) ; } float fC ( float fu , float fv , mat2 fw , vec3 fx , float fy , PRECISION sampler2D fz ) { vec2 fA , fB ; fB . x = fu ; fB . y = fv ; fB = fw * fB ; fA = fx . xy + fB * fy / SHADOW_TEX_RES ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"if ( ! ft ( fA , fh ) ) return 1.0 ; else".split(" ")}]}}]},{type:"textline",b:"return step ( fx . z , texture2D ( fz , fA ) . r ) ; } void fQ ( inout float fD , inout float fE , float fF , float fG , mat2 fH , vec3 fI , vec3 fJ , float fK , float fL , PRECISION sampler2D fM , PRECISION sampler2D fN ) { vec2 fO , fP ; fP . x = fF ; fP . y = fG ; fP = fH * fP ; fO = fI . xy + fP * fK / SHADOW_TEX_RES ; fD += step ( fI . z , texture2D ( fM , fO ) . r ) ; fO = fJ . xy + fP * fL / SHADOW_TEX_RES ; fE += step ( fJ . z , texture2D ( fN , fO ) . r ) ; } float fZ ( vec3 fR , PRECISION sampler2D fS , float fT ) { mat2 fU ; float fV , fW , fX ;".split(" ")},
{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:"if ( fR . z > u_perspective_cast_far_bound ) return 1.0 ; else {".split(" ")}]}}]},{type:"textline",b:"fR . z = clamp ( fR . z , 0.0 , 1.0 ) ; fV = 0.0 ; fW = dK ( fR . xy ) . x * M_PI ; fX = cos ( fW ) ; fW = sin ( fW ) ; fU = mat2 ( fX , fW , - fW , fX ) ; for ( int fY = 0 ; fY < 4 ; fY ++ ) { fV += fC ( fj [ fY ] , fn [ fY ] , fU , fR , fT , fS ) ; fV += fC ( fk [ fY ] , fo [ fY ] , fU , fR , fT , fS ) ; fV += fC ( fl [ fY ] , fp [ fY ] , fU , fR , fT , fS ) ; fV += fC ( fm [ fY ] , fq [ fY ] , fU , fR , fT , fS ) ; } fV /= 16.0 ; return clamp ( fV , 0.0 , 1.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["}"]}]}}]},{type:"textline",b:"return 1.0 ; } float gm ( vec3 f_ , PRECISION sampler2D ga , vec3 gb , PRECISION sampler2D gc , float gd , float ge , float gf ) { mat2 gg ; float gh , gi , gj , gk ; f_ . z = clamp ( f_ . z , 0.0 , 1.0 ) ; gb . z = clamp ( gb . z , 0.0 , 1.0 ) ; gh = 0.0 ; gi = 0.0 ; gj = dK ( f_ . xy ) . x * M_PI ; gk = cos ( gj ) ; gj = sin ( gj ) ; gg = mat2 ( gk , gj , - gj , gk ) ; for ( int gl = 0 ; gl < 4 ; gl ++ ) { fQ ( gh , gi , fj [ gl ] , fn [ gl ] , gg , f_ , gb , gd , ge , ga , gc ) ; fQ ( gh , gi , fk [ gl ] , fo [ gl ] , gg , f_ , gb , gd , ge , ga , gc ) ; fQ ( gh , gi , fl [ gl ] , fp [ gl ] , gg , f_ , gb , gd , ge , ga , gc ) ; fQ ( gh , gi , fm [ gl ] , fq [ gl ] , gg , f_ , gb , gd , ge , ga , gc ) ; } gh = mix ( gh , gi , gf ) ; gh /= 16.0 ; return clamp ( gh , 0.0 , 1.0 ) ; } float gq ( vec2 gn ) { float go , gp ; go = min ( gn . x , gn . y ) ; gp = min ( 1.0 - gn . x , 1.0 - gn . y ) ; return min ( go , gp ) ; } float gt ( float gr , float gs ) { if ( gs >= 0.0 && gs <= fg ) gr = ( gr - 1.0 ) / fg * gs + 1.0 ; return gr ; } float gE ( vec3 gu , vec3 gv , PRECISION sampler2D gw , PRECISION sampler2D gx , float gy , float gz , float gA , float gB ) { float gC , gD ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_BLEND_BETWEEN_CASCADES"],group:{type:"group",a:[{type:"textline",b:"gD = gq ( gu . xy ) ; if ( - gB > gA && gD >= 0.0 && gD <= ff && ft ( gv . xy , 0.0 ) ) { gD = 1.0 - gD / ff ; gC = gm ( gu , gw , gv , gx , gy , gz , gD ) ; } else".split(" ")}]}}]},{type:"textline",b:"gC = fZ ( gu , gw , gy ) ; return gC ; } float gM ( vec3 gF , PRECISION sampler2D gG , float gH , float gI , float gJ ) { float gK , gL ; gK = fZ ( gF , gG , gH ) ;".split(" ")},{type:"condition",
a:[{type:"if",c:["CSM_FADE_LAST_CASCADE"],group:{type:"group",a:[{type:"textline",b:"if ( - gJ > gI ) { gL = gq ( gF . xy ) ; gK = gt ( gK , gL ) ; }".split(" ")}]}}]},{type:"textline",b:"return gK ; } float gT ( float gN ) { vec3 gO , gP , gQ , gR ; float gS ; gS = 1.0 ; gO = e_ . xyz / e_ . w ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"gP = fa . xyz / fa . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",
a:[{type:"textline",b:"gQ = fb . xyz / fb . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"gR = fc . xyz / fc . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"if ( ft ( gO . xy , 0.0 ) ) { gS = gE ( gO , gP , u_shadow_map0 , u_shadow_map1 , u_pcf_blur_radii [ 0 ] , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 0 ] , gN ) ; }".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"if ( ft ( gO . xy , fi ) ) { gS = gM ( gO , u_shadow_map0 , u_pcf_blur_radii [ 0 ] , u_csm_center_dists [ 0 ] , gN ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"else { if ( ft ( gP . xy , 0.0 ) ) {".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"gS = gE ( gP , gQ , u_shadow_map1 , u_shadow_map2 , u_pcf_blur_radii [ 1 ] , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 1 ] , gN ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gS = gM ( gP , u_shadow_map1 , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 1 ] , gN ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"else { if ( ft ( gQ . xy , 0.0 ) ) {".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"gS = gE ( gQ , gR , u_shadow_map2 , u_shadow_map3 , u_pcf_blur_radii [ 2 ] , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 2 ] , gN ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gS = gM ( gQ , u_shadow_map2 , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 2 ] , gN ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"else { if ( ft ( gR . xy , 0.0 ) ) gS = gM ( gR , u_shadow_map3 , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 3 ] , gN ) ; }".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",
b:["return","gS",";","}"]}]}}]},{type:"textline",b:"float gY ( inout vec3 gU ) { float gV ; vec3 gW ; vec2 gX ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gX = texture2DProj ( u_shadow_mask , eY ) . rg ; gW = vec3 ( gX . r ) ; gV = gX . g ; fe = vec4 ( gW , gV ) ; gU *= fe . a ; return fe . r ;".split(" ")}]}},{type:"elif",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},
"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return gT ( eV . z ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["return","1.0",";"]}]}}]},{type:"textline",b:["}"]}]};a["include/mirror.glslf"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_MIRRORMAP",
{type:"equal_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"define",name:"REFL_BUMP",b:["0.1"]},{type:"textline",b:"float he ( in vec3 gZ , vec3 g_ , float ha , float hb ) { float hc ; vec3 hd ; hd = normalize ( g_ + gZ ) ; hc = 1.0 - dot ( gZ , hd ) ; hc = hb + ( 1.0 - hb ) * pow ( hc , ha ) ; return hc ; } void hr ( inout vec3 hf , vec3 hg , vec3 hh , float hi ) { vec2 hj , hk ; float hl , hm , hn ; vec3 ho , hp , hq ; ho = reflect ( - hg , hh ) ; hl = u_fresnel_params [ 2 ] ; hm = u_fresnel_params [ 3 ] ; hn = 1.0 ; if ( hl != 0.0 ) hn = he ( hg , ho , hl , hm ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"hp = textureCube ( u_cube_reflection , ho ) . xyz ;".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"hq = u_refl_plane . xyz * dot ( hh , u_refl_plane . xyz ) ; hq = hh - hq ; hj = ( u_view_matrix_frag * vec4 ( hq , 0.0 ) ) . xy ; hk = eY . xy / eY . z ; hk += hj * REFL_BUMP ; hp = texture2D ( u_plane_reflection , hk ) . rgb ;".split(" ")}]}},
{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"hp = textureCube ( u_mirrormap , ho ) . xyz ; hi = u_mirror_factor ;".split(" ")}]}}]},{type:"textline",b:"ed ( hp . rgb ) ; hf = mix ( hf , hp , hi * hn ) ; }".split(" ")}]}}]}]};a["include/environment.glslf"]={type:"group",a:[{type:"textline",b:"vec3 hu ( vec3 hs ) { float ht ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT"],group:{type:"group",a:[{type:"condition",
a:[{type:"if",c:["SKY_TEXTURE"],group:{type:"group",a:[{type:"textline",b:"return textureCube ( u_sky_texture , hs ) . rgb ;".split(" ")}]}},{type:"elif",c:["SKY_COLOR"],group:{type:"group",a:[{type:"textline",b:"ht = 0.5 * hs . y + 0.5 ; return mix ( u_horizon_color , u_zenith_color , ht ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["}"]}]};a["include/refraction.glslf"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"textline",b:"float hA ( in float hv , inout vec2 hw , in vec2 hx ) { float hy ; vec4 hz ; hz = texture2D ( u_scene_depth , hw ) ; hy = k ( hz ) ; if ( hy < eZ ) { hw = hx ; return hv ; } else { return hy ; } return hv ; }".split(" ")}]}}]},{type:"textline",b:"vec3 hI ( in vec3 hB , in vec2 hC ) { vec3 hD ; float hE ; vec4 hF ; vec2 hG , hH ; hG = hB . xy / hB . z ; hH = hG + hC ;".split(" ")},
{type:"condition",a:[{type:"if",c:["USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"textline",b:"hF = texture2DProj ( u_scene_depth , hB ) ; hE = k ( hF ) ; hA ( hE , hH , hG ) ;".split(" ")}]}}]},{type:"textline",b:"hD = texture2D ( u_refractmap , hH ) . rgb ; ed ( hD ) ; return hD ; }".split(" ")}]}}]}]};a["include/nodes.glslf"]={type:"group",a:[{type:"var",name:"MAPPING_TRS_MATRIX",b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",
b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","hJ",";"]}]}}]},{type:"textline",
b:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; vec3 hK = vec3 ( ZERO_VALUE_NODES ) ; vec3 hL = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:"vec3 hP ( in vec3 hM , in float hN ) { vec3 hO ; hO = hK ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:"hO = hI ( eY , hM . xz * hN ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"hO = texture2D ( u_refractmap , eY . xy / eY . z ) . rgb ; ed ( hO ) ;".split(" ")}]}}]},{type:"textline",b:["return","hO",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:"vec3 hU ( vec3 hQ ) { float hR , hS ; vec4 hT ; hT = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; hT = mix ( vec4 ( hQ . bg , hT . wz ) , vec4 ( hQ . gb , hT . xy ) , step ( hQ . b , hQ . g ) ) ; hT = mix ( vec4 ( hT . xyw , hQ . r ) , vec4 ( hQ . r , hT . yzx ) , step ( hT . x , hQ . r ) ) ; hR = hT . x - min ( hT . w , hT . y ) ; hS = 1.0e-10 ; return vec3 ( abs ( hT . z + ( hT . w - hT . y ) / ( 6.0 * hR + hS ) ) , hR / ( hT . x + hS ) , hT . x ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:"vec3 hY ( vec3 hV ) { vec3 hW ; vec4 hX ; hX = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; hW = abs ( fract ( vec3 ( hV . r , hV . r , hV . r ) + hX . xyz ) * 6.0 - hX . www ) ; return hV . b * mix ( hX . xxx , clamp ( hW - hX . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , hV . g ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"vec3 h_ ( vec2 hZ ) { return vec3 ( hZ * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"vec2 ib ( vec3 ia ) { return vec2 ( ia . xy * 0.5 + vec2 ( 0.5 , 0.5 ) ) ; }".split(" ")}]}}]},
{type:"node",name:"CAMERA",i:[{type:"node_out",name:"je",qualifier:["vec3"],f:!0},{type:"node_out",name:"jf",qualifier:["float"],f:!0},{type:"node_out",name:"jg",qualifier:["float"],f:!0}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_je"],g:[{type:"textline",b:"je = normalize ( iL . xyz ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_jf"],g:[{type:"textline",b:"jf = abs ( iL . z ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_jg"],
g:[{type:"textline",b:"jg = length ( iL . xyz ) ;".split(" ")}]}]}]},{type:"node",name:"COMBRGB",i:[{type:"node_in",name:"jh",qualifier:["float"],f:!1},{type:"node_in",name:"ji",qualifier:["float"],f:!1},{type:"node_in",name:"jj",qualifier:["float"],f:!1},{type:"node_out",name:"jk",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"jk = vec3 ( jh , ji , jj ) ;".split(" ")}]},{type:"node",name:"COMBHSV",i:[{type:"node_in",name:"jl",qualifier:["float"],f:!1},{type:"node_in",name:"jm",qualifier:["float"],
f:!1},{type:"node_in",name:"jn",qualifier:["float"],f:!1},{type:"node_out",name:"jo",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"jo = hY ( vec3 ( jl , jm , jn ) ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_UV",i:[{type:"node_out",name:"jp",qualifier:["vec3"],f:!1},{type:"node_param",name:"ic",qualifier:["varying","vec2"]}],g:[{type:"textline",b:"jp = h_ ( ic ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_OR",i:[{type:"node_out",name:"jq",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"jq = 2.0 * clamp ( hJ , 0.0 , 1.0 ) - hL ;".split(" ")}]},
{type:"node",name:"GEOMETRY_VC",i:[{type:"node_out",name:"jr",qualifier:["vec3"],f:!1},{type:"node_param",name:"id",qualifier:["varying","vec3"]}],g:[{type:"textline",b:["jr","=","id",";"]}]},{type:"node",name:"GEOMETRY_VC1",i:[{type:"node_out",name:"js",qualifier:["float"],f:!1},{type:"node_param",name:"ie",qualifier:["varying","float"]}],g:[{type:"textline",b:["js","=","ie",";"]}]},{type:"node",name:"GEOMETRY_VC2",i:[{type:"node_out",name:"jt",qualifier:["float"],f:!1},{type:"node_out",name:"ju",
qualifier:["float"],f:!1},{type:"node_param",name:"ig",qualifier:["varying","vec2"]}],g:[{type:"textline",b:"jt = ig [ 0 ] ; ju = ig [ 1 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC3",i:[{type:"node_out",name:"jv",qualifier:["float"],f:!1},{type:"node_out",name:"jw",qualifier:["float"],f:!1},{type:"node_out",name:"jx",qualifier:["float"],f:!1},{type:"node_param",name:"ih",qualifier:["varying","vec3"]}],g:[{type:"textline",b:"jv = ih [ 0 ] ; jw = ih [ 1 ] ; jx = ih [ 2 ] ;".split(" ")}]},{type:"node",
name:"GEOMETRY_NO",i:[{type:"node_out",name:"jy",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["jy","=","iP",";"]}]},{type:"node",name:"GEOMETRY_FB",i:[{type:"node_out",name:"jz",qualifier:["float"],f:!1}],g:[{type:"textline",b:"jz = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"GEOMETRY_VW",i:[{type:"node_out",name:"jA",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["jA","=","it",";"]}]},{type:"node",name:"GEOMETRY_LO",i:[{type:"node_out",name:"jB",
qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"jB [ 0 ] = iL [ 0 ] ; jB [ 1 ] = iL [ 1 ] ; jB [ 2 ] = iL [ 2 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_GL",i:[{type:"node_out",name:"jC",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"jC = vec3 ( iO . r , - iO . b , iO . g ) ;".split(" ")}]},{type:"node",name:"NEW_GEOMETRY",i:[{type:"node_out",name:"jD",qualifier:["vec3"],f:!1},{type:"node_out",name:"jE",qualifier:["vec3"],f:!1},{type:"node_out",name:"jF",qualifier:["vec3"],f:!1},{type:"node_out",
name:"jG",qualifier:["vec3"],f:!1},{type:"node_out",name:"jH",qualifier:["vec3"],f:!1},{type:"node_out",name:"jI",qualifier:["vec3"],f:!1},{type:"node_out",name:"jJ",qualifier:["float"],f:!1},{type:"node_out",name:"jK",qualifier:["float"],f:!1}],g:[{type:"textline",b:"jD = hK ; jE = hK ; jF = hK ; jG = hK ; jH = hK ; jI = hK ; jJ = ZERO_VALUE_NODES ; jK = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"HUE_SAT",i:[{type:"node_in",name:"jL",qualifier:["float"],f:!1},{type:"node_in",name:"jM",
qualifier:["float"],f:!1},{type:"node_in",name:"jN",qualifier:["float"],f:!1},{type:"node_in",name:"jO",qualifier:["float"],f:!1},{type:"node_in",name:"jP",qualifier:["vec3"],f:!1},{type:"node_out",name:"jQ",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iQ = hU ( jP ) ; iQ [ 0 ] += ( jL - 0.5 ) ; if ( iQ [ 0 ] > UNITY_VALUE_NODES ) iQ [ 0 ] -= UNITY_VALUE_NODES ; else if ( iQ [ 0 ] < ZERO_VALUE_NODES ) iQ [ 0 ] += UNITY_VALUE_NODES ; iQ *= vec3 ( UNITY_VALUE_NODES , jM , jN ) ; iQ = mix ( hL , mix ( hK , iQ , step ( hK , iQ ) ) , step ( iQ , hL ) ) ; jQ = mix ( jP , hY ( iQ ) , jO ) ;".split(" ")}]},
{type:"node",name:"INVERT",i:[{type:"node_in",name:"jR",qualifier:["float"],f:!1},{type:"node_in",name:"jS",qualifier:["vec3"],f:!1},{type:"node_out",name:"jT",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"jT = mix ( jS , hL - jS , jR ) ;".split(" ")}]},{type:"node",name:"LAMP",i:[{type:"node_out",name:"jU",qualifier:["vec3"],f:!0},{type:"node_out",name:"jV",qualifier:["vec3"],f:!1},{type:"node_out",name:"jW",qualifier:["float"],f:!1},{type:"node_out",name:"jX",qualifier:["float"],f:!0}],g:[{type:"node_condition",
a:[{type:"node_if",c:["USE_OUT_jU"],g:[{type:"textline",b:"jU = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{type:"textline",b:"iM = u_lamp_light_factors [ LAMP_INDEX ] ; iR = u_lamp_light_directions [ LAMP_INDEX ] ; iS = u_lamp_light_positions [ LAMP_INDEX ] ; iD = iM . z ; if ( iD != - UNITY_VALUE_NODES ) {".split(" ")},{type:"textline",b:"jV = iS - eU ; jW = length ( jV ) ; jV = normalize ( jV ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_jX"],g:[{type:"textline",
b:"jX = iD / ( iD + jW * jW ) ; iD = iM . x ; iE = iM . y ; if ( iD > - UNITY_VALUE_NODES ) { iF = dot ( jV , iR ) ; iF *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( iF - iD ) / iE ) ; jX *= iF ; }".split(" ")}]}]},{type:"textline",b:["}","else","{"]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_jV"],g:[{type:"textline",b:["jV","=","iR",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_jW"],g:[{type:"textline",b:"jW = length ( iS - eU ) ;".split(" ")}]}]},{type:"node_condition",
a:[{type:"node_if",c:["USE_OUT_jX"],g:[{type:"textline",b:["jX","=","UNITY_VALUE_NODES",";"]}]}]},{type:"textline",b:["}"]}]},{type:"node",name:"NORMAL",i:[{type:"node_in",name:"jY",qualifier:["vec3"],f:!1},{type:"node_out",name:"jZ",qualifier:["vec3"],f:!0},{type:"node_out",name:"j_",qualifier:["float"],f:!0},{type:"node_param",name:"ii",qualifier:["vec3"]}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_jZ"],g:[{type:"textline",b:["jZ","=","ii",";"]}]}]},{type:"node_condition",a:[{type:"node_if",
c:["USE_OUT_j_"],g:[{type:"textline",b:"j_ = - dot ( jY , ii ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_VECTOR_VIEW",i:[{type:"node_in",name:"ka",qualifier:["vec3"],f:!1},{type:"node_out",name:"kb",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"kb = - ( u_view_matrix_frag * vec4 ( ka , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{type:"node",name:"BSDF_ANISOTROPIC",i:[{type:"node_in",name:"kc",qualifier:["vec3"],f:!1},{type:"node_in",name:"kd",qualifier:["float"],f:!1},{type:"node_in",name:"ke",
qualifier:["float"],f:!1},{type:"node_in",name:"kf",qualifier:["float"],f:!1},{type:"node_in",name:"kg",qualifier:["vec3"],f:!1},{type:"node_in",name:"kh",qualifier:["vec3"],f:!1},{type:"node_out",name:"ki",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["ki","=","kc",";"]},{type:"textline",b:"kd ; ke ; kf ; kg ; kh ;".split(" ")}]},{type:"node",name:"BSDF_DIFFUSE",i:[{type:"node_in",name:"kj",qualifier:["vec3"],f:!1},{type:"node_in",name:"kk",qualifier:["float"],f:!1},{type:"node_in",name:"kl",
qualifier:["vec3"],f:!1},{type:"node_out",name:"km",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["km","=","kj",";"]},{type:"textline",b:["kk",";","kl",";"]}]},{type:"node",name:"BSDF_GLASS",i:[{type:"node_in",name:"kn",qualifier:["vec3"],f:!1},{type:"node_in",name:"ko",qualifier:["float"],f:!1},{type:"node_in",name:"kp",qualifier:["float"],f:!1},{type:"node_in",name:"kq",qualifier:["vec3"],f:!1},{type:"node_out",name:"kr",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["kr","=","kn",";"]},{type:"textline",
b:"ko ; kp ; kq ;".split(" ")}]},{type:"node",name:"BSDF_GLOSSY",i:[{type:"node_in",name:"ks",qualifier:["vec3"],f:!1},{type:"node_in",name:"kt",qualifier:["float"],f:!1},{type:"node_in",name:"ku",qualifier:["vec3"],f:!1},{type:"node_out",name:"kv",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["kv","=","ks",";"]},{type:"textline",b:["kt",";","ku",";"]}]},{type:"node",name:"BSDF_HAIR",i:[{type:"node_in",name:"kw",qualifier:["vec3"],f:!1},{type:"node_in",name:"kx",qualifier:["float"],f:!1},{type:"node_in",
name:"ky",qualifier:["float"],f:!1},{type:"node_in",name:"kz",qualifier:["float"],f:!1},{type:"node_out",name:"kA",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["kA","=","kw",";"]},{type:"textline",b:"kx ; ky ; kz ;".split(" ")}]},{type:"node",name:"BSDF_TRANSPARENT",i:[{type:"node_in",name:"kB",qualifier:["vec3"],f:!1},{type:"node_out",name:"kC",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["kC","=","kB",";"]}]},{type:"node",name:"BSDF_TRANSLUCENT",i:[{type:"node_in",name:"kD",qualifier:["vec3"],
f:!1},{type:"node_in",name:"kE",qualifier:["vec3"],f:!1},{type:"node_out",name:"kF",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["kF","=","kD",";"]},{type:"textline",b:["kE",";"]}]},{type:"node",name:"BSDF_REFRACTION",i:[{type:"node_in",name:"kG",qualifier:["vec3"],f:!1},{type:"node_in",name:"kH",qualifier:["float"],f:!1},{type:"node_in",name:"kI",qualifier:["float"],f:!1},{type:"node_in",name:"kJ",qualifier:["vec3"],f:!1},{type:"node_out",name:"kK",qualifier:["vec3"],f:!1}],g:[{type:"textline",
b:"kK [ 0 ] = kK [ 1 ] = kK [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"kG ; kH ; kI ; kJ ;".split(" ")}]},{type:"node",name:"BSDF_TOON",i:[{type:"node_in",name:"kL",qualifier:["vec3"],f:!1},{type:"node_in",name:"kM",qualifier:["float"],f:!1},{type:"node_in",name:"kN",qualifier:["float"],f:!1},{type:"node_in",name:"kO",qualifier:["vec3"],f:!1},{type:"node_out",name:"kP",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["kP","=","kL",";"]},{type:"textline",b:"kM ; kN ; kO ;".split(" ")}]},
{type:"node",name:"BSDF_VELVET",i:[{type:"node_in",name:"kQ",qualifier:["vec3"],f:!1},{type:"node_in",name:"kR",qualifier:["float"],f:!1},{type:"node_in",name:"kS",qualifier:["vec3"],f:!1},{type:"node_out",name:"kT",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["kT","=","kQ",";"]},{type:"textline",b:["kR",";","kS",";"]}]},{type:"node",name:"SUBSURFACE_SCATTERING",i:[{type:"node_in",name:"kU",qualifier:["vec3"],f:!1},{type:"node_in",name:"kV",qualifier:["float"],f:!1},{type:"node_in",name:"kW",
qualifier:["vec3"],f:!1},{type:"node_in",name:"kX",qualifier:["float"],f:!1},{type:"node_in",name:"kY",qualifier:["float"],f:!1},{type:"node_in",name:"kZ",qualifier:["vec3"],f:!1},{type:"node_out",name:"k_",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"k_ [ 0 ] = k_ [ 1 ] = k_ [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"kU ; kW ; kX ; kY ; kZ ; kV ;".split(" ")}]},{type:"node",name:"EMISSION",i:[{type:"node_in",name:"la",qualifier:["vec3"],f:!1},{type:"node_in",name:"lb",qualifier:["float"],
f:!1},{type:"node_out",name:"lc",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["lc","=","la",";"]},{type:"textline",b:["lb",";"]}]},{type:"node",name:"AMBIENT_OCCLUSION",i:[{type:"node_in",name:"ld",qualifier:["vec3"],f:!1},{type:"node_out",name:"le",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"le [ 0 ] = le [ 1 ] = le [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["ld",";"]}]},{type:"node",name:"HOLDOUT",i:[{type:"node_out",name:"lf",qualifier:["vec3"],f:!1}],g:[{type:"textline",
b:"lf [ 0 ] = lf [ 1 ] = lf [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"VOLUME_ABSORPTION",i:[{type:"node_in",name:"lg",qualifier:["vec3"],f:!1},{type:"node_in",name:"lh",qualifier:["float"],f:!1},{type:"node_out",name:"li",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"li [ 0 ] = li [ 1 ] = li [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["lg",";","lh",";"]}]},{type:"node",name:"VOLUME_SCATTER",i:[{type:"node_in",name:"lj",qualifier:["vec3"],f:!1},{type:"node_in",
name:"lk",qualifier:["float"],f:!1},{type:"node_in",name:"ll",qualifier:["float"],f:!1},{type:"node_out",name:"lm",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"lm [ 0 ] = lm [ 1 ] = lm [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"lj ; lk ; ll ;".split(" ")}]},{type:"node",name:"BUMP",i:[{type:"node_in",name:"ln",qualifier:["float"],f:!1},{type:"node_in",name:"lo",qualifier:["float"],f:!1},{type:"node_in",name:"lp",qualifier:["float"],f:!1},{type:"node_in",name:"lq",qualifier:["vec3"],
f:!1},{type:"node_out",name:"lr",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["lr","=","lq",";"]},{type:"textline",b:"ln ; lo ; lp ;".split(" ")}]},{type:"node",name:"NORMAL_MAP",i:[{type:"node_in",name:"ls",qualifier:["float"],f:!1},{type:"node_in",name:"lt",qualifier:["vec3"],f:!1},{type:"node_out",name:"lu",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["lu","=","lt",";"]},{type:"textline",b:["ls",";"]}]},{type:"node",name:"VECT_TRANSFORM",i:[{type:"node_in",name:"lv",qualifier:["vec3"],
f:!1},{type:"node_out",name:"lw",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"lw [ 0 ] = lw [ 1 ] = lw [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["lv",";"]}]},{type:"node",name:"BLACKBODY",i:[{type:"node_in",name:"lx",qualifier:["float"],f:!1},{type:"node_out",name:"ly",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"ly [ 0 ] = ly [ 1 ] = ly [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["lx",";"]}]},{type:"node",name:"WAVELENGTH",i:[{type:"node_in",name:"lz",qualifier:["float"],
f:!1},{type:"node_out",name:"lA",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"lA [ 0 ] = lA [ 1 ] = lA [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["lz",";"]}]},{type:"node",name:"SEPXYZ",i:[{type:"node_in",name:"lB",qualifier:["vec3"],f:!1},{type:"node_out",name:"lC",qualifier:["float"],f:!1},{type:"node_out",name:"lD",qualifier:["float"],f:!1},{type:"node_out",name:"lE",qualifier:["float"],f:!1}],g:[{type:"textline",b:"lC = lB [ 0 ] ; lD = lB [ 1 ] ; lE = lB [ 2 ] ;".split(" ")}]},
{type:"node",name:"COMBXYZ",i:[{type:"node_in",name:"lF",qualifier:["float"],f:!1},{type:"node_in",name:"lG",qualifier:["float"],f:!1},{type:"node_in",name:"lH",qualifier:["float"],f:!1},{type:"node_out",name:"lI",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"lI [ 0 ] = lF ; lI [ 1 ] = lG ; lI [ 2 ] = lH ;".split(" ")}]},{type:"node",name:"BRIGHTCONTRAST",i:[{type:"node_in",name:"lJ",qualifier:["vec3"],f:!1},{type:"node_in",name:"lK",qualifier:["float"],f:!1},{type:"node_in",name:"lL",qualifier:["float"],
f:!1},{type:"node_out",name:"lM",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iF = lK - lL * 0.5 ; lM = max ( ( UNITY_VALUE_NODES + lL ) * lJ + iF , hK ) ;".split(" ")}]},{type:"node",name:"LIGHT_FALLOFF",i:[{type:"node_in",name:"lN",qualifier:["float"],f:!1},{type:"node_in",name:"lO",qualifier:["float"],f:!1},{type:"node_out",name:"lP",qualifier:["float"],f:!1},{type:"node_out",name:"lQ",qualifier:["float"],f:!1},{type:"node_out",name:"lR",qualifier:["float"],f:!1}],g:[{type:"textline",b:"lP = lQ = lR = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["lN",";","lO",";"]}]},{type:"node",name:"TEX_IMAGE",i:[{type:"node_in",name:"lS",qualifier:["vec3"],f:!1},{type:"node_out",name:"lT",qualifier:["vec3"],f:!1},{type:"node_out",name:"lU",qualifier:["float"],f:!1}],g:[{type:"textline",b:"lT [ 0 ] = lT [ 1 ] = lT [ 2 ] = ZERO_VALUE_NODES ; lU = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["lS",";"]}]},{type:"node",name:"TEX_ENVIRONMENT",i:[{type:"node_in",name:"lV",qualifier:["vec3"],f:!1},{type:"node_out",name:"lW",qualifier:["vec3"],
f:!1}],g:[{type:"textline",b:"lW [ 0 ] = lW [ 1 ] = lW [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["lV",";"]}]},{type:"node",name:"TEX_SKY",i:[{type:"node_in",name:"lX",qualifier:["vec3"],f:!1},{type:"node_out",name:"lY",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"lY [ 0 ] = lY [ 1 ] = lY [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["lX",";"]}]},{type:"node",name:"TEX_NOISE",i:[{type:"node_in",name:"lZ",qualifier:["vec3"],f:!1},{type:"node_in",name:"l_",qualifier:["float"],
f:!1},{type:"node_in",name:"ma",qualifier:["float"],f:!1},{type:"node_in",name:"mb",qualifier:["float"],f:!1},{type:"node_out",name:"mc",qualifier:["vec3"],f:!1},{type:"node_out",name:"md",qualifier:["float"],f:!1}],g:[{type:"textline",b:"mc [ 0 ] = mc [ 1 ] = mc [ 2 ] = ZERO_VALUE_NODES ; md = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"lZ ; l_ ; ma ; mb ;".split(" ")}]},{type:"node",name:"TEX_WAVE",i:[{type:"node_in",name:"me",qualifier:["vec3"],f:!1},{type:"node_in",name:"mf",qualifier:["float"],
f:!1},{type:"node_in",name:"mg",qualifier:["float"],f:!1},{type:"node_in",name:"mh",qualifier:["float"],f:!1},{type:"node_in",name:"mi",qualifier:["float"],f:!1},{type:"node_out",name:"mj",qualifier:["vec3"],f:!1},{type:"node_out",name:"mk",qualifier:["float"],f:!1}],g:[{type:"textline",b:"mj [ 0 ] = mj [ 1 ] = mj [ 2 ] = ZERO_VALUE_NODES ; mk = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"me ; mf ; mg ; mh ; mi ;".split(" ")}]},{type:"node",name:"TEX_VORONOI",i:[{type:"node_in",name:"ml",
qualifier:["vec3"],f:!1},{type:"node_in",name:"mm",qualifier:["float"],f:!1},{type:"node_out",name:"mn",qualifier:["vec3"],f:!1},{type:"node_out",name:"mo",qualifier:["float"],f:!1}],g:[{type:"textline",b:"mn [ 0 ] = mn [ 1 ] = mn [ 2 ] = ZERO_VALUE_NODES ; mo = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["ml",";","mm",";"]}]},{type:"node",name:"TEX_MUSGRAVE",i:[{type:"node_in",name:"mp",qualifier:["vec3"],f:!1},{type:"node_in",name:"mq",qualifier:["float"],f:!1},{type:"node_in",name:"mr",
qualifier:["float"],f:!1},{type:"node_in",name:"ms",qualifier:["float"],f:!1},{type:"node_in",name:"mt",qualifier:["float"],f:!1},{type:"node_in",name:"mu",qualifier:["float"],f:!1},{type:"node_in",name:"mv",qualifier:["float"],f:!1},{type:"node_out",name:"mw",qualifier:["vec3"],f:!1},{type:"node_out",name:"mx",qualifier:["float"],f:!1}],g:[{type:"textline",b:"mw [ 0 ] = mw [ 1 ] = mw [ 2 ] = ZERO_VALUE_NODES ; mx = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"mp ; mq ; mr ; ms ; mt ; mu ; mv ;".split(" ")}]},
{type:"node",name:"TEX_GRADIENT",i:[{type:"node_in",name:"my",qualifier:["vec3"],f:!1},{type:"node_out",name:"mz",qualifier:["vec3"],f:!1},{type:"node_out",name:"mA",qualifier:["float"],f:!1}],g:[{type:"textline",b:"mz [ 0 ] = mz [ 1 ] = mz [ 2 ] = ZERO_VALUE_NODES ; mA = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["my",";"]}]},{type:"node",name:"TEX_MAGIC",i:[{type:"node_in",name:"mB",qualifier:["vec3"],f:!1},{type:"node_in",name:"mC",qualifier:["float"],f:!1},{type:"node_in",name:"mD",
qualifier:["float"],f:!1},{type:"node_out",name:"mE",qualifier:["vec3"],f:!1},{type:"node_out",name:"mF",qualifier:["float"],f:!1}],g:[{type:"textline",b:"mE [ 0 ] = mE [ 1 ] = mE [ 2 ] = ZERO_VALUE_NODES ; mF = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"mB ; mC ; mD ;".split(" ")}]},{type:"node",name:"TEX_CHECKER",i:[{type:"node_in",name:"mG",qualifier:["vec3"],f:!1},{type:"node_in",name:"mH",qualifier:["vec3"],f:!1},{type:"node_in",name:"mI",qualifier:["vec3"],f:!1},{type:"node_in",name:"mJ",
qualifier:["float"],f:!1},{type:"node_out",name:"mK",qualifier:["vec3"],f:!1},{type:"node_out",name:"mL",qualifier:["float"],f:!1}],g:[{type:"textline",b:"mK [ 0 ] = mK [ 1 ] = mK [ 2 ] = ZERO_VALUE_NODES ; mL = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"mG ; mH ; mI ; mJ ;".split(" ")}]},{type:"node",name:"TEX_BRICK",i:[{type:"node_in",name:"mM",qualifier:["vec3"],f:!1},{type:"node_in",name:"mN",qualifier:["vec3"],f:!1},{type:"node_in",name:"mO",qualifier:["vec3"],f:!1},{type:"node_in",
name:"mP",qualifier:["vec3"],f:!1},{type:"node_in",name:"mQ",qualifier:["float"],f:!1},{type:"node_in",name:"mR",qualifier:["float"],f:!1},{type:"node_in",name:"mS",qualifier:["float"],f:!1},{type:"node_in",name:"mT",qualifier:["float"],f:!1},{type:"node_in",name:"mU",qualifier:["float"],f:!1},{type:"node_out",name:"mV",qualifier:["vec3"],f:!1},{type:"node_out",name:"mW",qualifier:["float"],f:!1}],g:[{type:"textline",b:"mV [ 0 ] = mV [ 1 ] = mV [ 2 ] = ZERO_VALUE_NODES ; mW = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:"mM ; mN ; mO ; mP ; mQ ; mR ; mS ; mT ; mU ;".split(" ")}]},{type:"node",name:"ADD_SHADER",i:[{type:"node_in",name:"mX",qualifier:["vec3"],f:!1},{type:"node_in",name:"mY",qualifier:["vec3"],f:!1},{type:"node_out",name:"mZ",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"mZ = clamp ( mX + mY , hK , hL ) ;".split(" ")}]},{type:"node",name:"MIX_SHADER",i:[{type:"node_in",name:"m_",qualifier:["float"],f:!1},{type:"node_in",name:"na",qualifier:["vec3"],f:!1},{type:"node_in",name:"nb",
qualifier:["vec3"],f:!1},{type:"node_out",name:"nc",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( m_ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; nc = iE * na + ( UNITY_VALUE_NODES - iE ) * nb ;".split(" ")}]},{type:"node",name:"UV_MERGED",i:[{type:"node_out",name:"nd",qualifier:["vec3"],f:!1},{type:"node_out",name:"ne",qualifier:["vec3"],f:!1},{type:"node_param",name:"ij",qualifier:["varying","vec2"]}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_nd"],g:[{type:"textline",
b:"nd = h_ ( ij ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ne"],g:[{type:"textline",b:"ne = vec3 ( ij , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"TEX_COORD_UV",i:[{type:"node_out",name:"nf",qualifier:["vec3"],f:!1},{type:"node_param",name:"ik",qualifier:["varying","vec2"]}],g:[{type:"textline",b:"nf = vec3 ( ik , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_NO",i:[{type:"node_out",name:"ng",qualifier:["vec3"],f:!1}],g:[{type:"textline",
b:["ng","=","iP",";"]}]},{type:"node",name:"TEX_COORD_GE",i:[{type:"node_out",name:"nh",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"nh = abs ( hJ ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_OB",i:[{type:"node_out",name:"ni",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"ni [ 0 ] = ni [ 1 ] = ni [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_CA",i:[{type:"node_out",name:"nj",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"nj [ 0 ] = iL [ 0 ] ; nj [ 1 ] = iL [ 1 ] ; nj [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"TEX_COORD_WI",i:[{type:"node_out",name:"nk",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"nk [ 0 ] = nk [ 1 ] = nk [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_RE",i:[{type:"node_out",name:"nl",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"nl [ 0 ] = nl [ 1 ] = nl [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"UVMAP",i:[{type:"node_out",name:"nm",qualifier:["vec3"],f:!1},{type:"node_param",name:"il",qualifier:["varying","vec2"]}],
g:[{type:"textline",b:"nm = vec3 ( il , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",i:[{type:"node_out",name:"nn",qualifier:["float"],f:!1},{type:"node_out",name:"no",qualifier:["float"],f:!1},{type:"node_out",name:"np",qualifier:["float"],f:!1},{type:"node_out",name:"nq",qualifier:["vec3"],f:!1},{type:"node_out",name:"nr",qualifier:["float"],f:!1},{type:"node_out",name:"ns",qualifier:["vec3"],f:!1},{type:"node_out",name:"nt",qualifier:["vec3"],f:!1}],g:[{type:"textline",
b:"nn = ZERO_VALUE_NODES ; no = ZERO_VALUE_NODES ; np = ZERO_VALUE_NODES ; nq = vec3 ( ZERO_VALUE_NODES ) ; nr = ZERO_VALUE_NODES ; ns = nq ; nt = nq ;".split(" ")}]},{type:"node",name:"HAIR_INFO",i:[{type:"node_out",name:"nu",qualifier:["float"],f:!1},{type:"node_out",name:"nv",qualifier:["float"],f:!1},{type:"node_out",name:"nw",qualifier:["float"],f:!1},{type:"node_out",name:"nx",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"nu = ZERO_VALUE_NODES ; nv = ZERO_VALUE_NODES ; nw = ZERO_VALUE_NODES ; nx = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"OBJECT_INFO",i:[{type:"node_out",name:"ny",qualifier:["vec3"],f:!1},{type:"node_out",name:"nz",qualifier:["float"],f:!1},{type:"node_out",name:"nA",qualifier:["float"],f:!1},{type:"node_out",name:"nB",qualifier:["float"],f:!1}],g:[{type:"textline",b:"nz = ZERO_VALUE_NODES ; nA = ZERO_VALUE_NODES ; nB = ZERO_VALUE_NODES ; ny = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"WIREFRAME",i:[{type:"node_in",name:"nC",qualifier:["float"],f:!1},{type:"node_out",name:"nD",
qualifier:["float"],f:!1}],g:[{type:"textline",b:["nD","=","nC",";"]}]},{type:"node",name:"TANGENT",i:[{type:"node_out",name:"nE",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"nE = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LAYER_WEIGHT",i:[{type:"node_in",name:"nF",qualifier:["float"],f:!1},{type:"node_in",name:"nG",qualifier:["vec3"],f:!1},{type:"node_out",name:"nH",qualifier:["float"],f:!1},{type:"node_out",name:"nI",qualifier:["float"],f:!1}],g:[{type:"textline",b:"nH = nI = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["nG",";","nF",";"]}]},{type:"node",name:"LIGHT_PATH",i:[{type:"node_out",name:"nJ",qualifier:["float"],f:!1},{type:"node_out",name:"nK",qualifier:["float"],f:!1},{type:"node_out",name:"nL",qualifier:["float"],f:!1},{type:"node_out",name:"nM",qualifier:["float"],f:!1},{type:"node_out",name:"nN",qualifier:["float"],f:!1},{type:"node_out",name:"nO",qualifier:["float"],f:!1},{type:"node_out",name:"nP",qualifier:["float"],f:!1},{type:"node_out",name:"nQ",qualifier:["float"],f:!1},{type:"node_out",
name:"nR",qualifier:["float"],f:!1},{type:"node_out",name:"nS",qualifier:["float"],f:!1}],g:[{type:"textline",b:"nJ = nK = nL = ZERO_VALUE_NODES ; nM = nN = nO = ZERO_VALUE_NODES ; nP = nP = nR = nS = ZERO_VALUE_NODES ; nQ = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"ATTRIBUTE",i:[{type:"node_out",name:"nT",qualifier:["vec3"],f:!1},{type:"node_out",name:"nU",qualifier:["vec3"],f:!1},{type:"node_out",name:"nV",qualifier:["float"],f:!1}],g:[{type:"textline",b:"nT = nU = vec3 ( ZERO_VALUE_NODES ) ; nV = ZERO_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"SCRIPT",i:[],g:[]},{type:"node",name:"CURVE_VEC",i:[{type:"node_in",name:"nW",qualifier:["float"],f:!1},{type:"node_in",name:"nX",qualifier:["vec3"],f:!1},{type:"node_out",name:"nY",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:["nY","=","nX",";"]},{type:"textline",b:["nW",";"]}]},{type:"node",name:"CURVE_RGB",i:[{type:"node_in",name:"nZ",qualifier:["float"],f:!1},{type:"node_in",name:"n_",qualifier:["vec3"],f:!1},{type:"node_out",name:"oa",qualifier:["vec3"],f:!1}],g:[{type:"textline",
b:["oa","=","n_",";"]},{type:"textline",b:["nZ",";"]}]},{type:"node",name:"VALTORGB",i:[{type:"node_in",name:"ob",qualifier:["float"],f:!1},{type:"node_out",name:"oc",qualifier:["vec3"],f:!1},{type:"node_out",name:"od",qualifier:["float"],f:!1}],g:[{type:"textline",b:"oc [ 0 ] = oc [ 1 ] = oc [ 2 ] = clamp ( ob , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; od = oc [ 0 ] ;".split(" ")}]},{type:"node",name:"MAPPING",i:[{type:"node_in",name:"oe",qualifier:["vec3"],f:!1},{type:"node_out",name:"of",qualifier:["vec3"],
f:!1}],g:[{type:"textline",b:["of","=","oe",";"]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_TRS_MATRIX",g:[{type:"textline",b:"of = ( MAPPING_TRS_MATRIX * vec4 ( of , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_SCALE",g:[{type:"textline",b:"of = of * MAPPING_SCALE ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_TRANSLATION",g:[{type:"textline",b:"of = of + MAPPING_TRANSLATION ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_MIN_CLIP",g:[{type:"textline",b:"of = max ( of , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_MAX_CLIP",g:[{type:"textline",b:"of = min ( of , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["MAPPING_IS_NORMAL"],g:[{type:"textline",b:"of = normalize ( of ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ADD",i:[{type:"node_in",name:"og",qualifier:["float"],
f:!1},{type:"node_in",name:"oh",qualifier:["float"],f:!1},{type:"node_out",name:"oi",qualifier:["float"],f:!1}],g:[{type:"textline",b:"oi = og + oh ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"oi = clamp ( oi , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SUBTRACT",i:[{type:"node_in",name:"oj",qualifier:["float"],f:!1},{type:"node_in",name:"ok",qualifier:["float"],f:!1},{type:"node_out",name:"ol",qualifier:["float"],
f:!1}],g:[{type:"textline",b:"ol = oj - ok ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"ol = clamp ( ol , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MULTIPLY",i:[{type:"node_in",name:"om",qualifier:["float"],f:!1},{type:"node_in",name:"on",qualifier:["float"],f:!1},{type:"node_out",name:"oo",qualifier:["float"],f:!1}],g:[{type:"textline",b:"oo = om * on ;".split(" ")},{type:"node_condition",a:[{type:"node_if",
c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"oo = clamp ( oo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_DIVIDE",i:[{type:"node_in",name:"op",qualifier:["float"],f:!1},{type:"node_in",name:"oq",qualifier:["float"],f:!1},{type:"node_out",name:"or",qualifier:["float"],f:!1}],g:[{type:"textline",b:"or = ( oq != ZERO_VALUE_NODES ) ? op / oq : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"or = clamp ( or , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_SINE",i:[{type:"node_in",name:"os",qualifier:["float"],f:!1},{type:"node_in",name:"ot",qualifier:["float"],f:!1},{type:"node_out",name:"ou",qualifier:["float"],f:!1}],g:[{type:"textline",b:"ou = sin ( os ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"ou = clamp ( ou , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["ot",";"]}]},{type:"node",name:"MATH_COSINE",i:[{type:"node_in",name:"ov",
qualifier:["float"],f:!1},{type:"node_in",name:"ow",qualifier:["float"],f:!1},{type:"node_out",name:"ox",qualifier:["float"],f:!1}],g:[{type:"textline",b:"ox = cos ( ov ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"ox = clamp ( ox , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["ow",";"]}]},{type:"node",name:"MATH_TANGENT",i:[{type:"node_in",name:"oy",qualifier:["float"],f:!1},{type:"node_in",name:"oz",qualifier:["float"],
f:!1},{type:"node_out",name:"oA",qualifier:["float"],f:!1}],g:[{type:"textline",b:"oA = tan ( oy ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"oA = clamp ( oA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["oz",";"]}]},{type:"node",name:"MATH_ARCSINE",i:[{type:"node_in",name:"oB",qualifier:["float"],f:!1},{type:"node_in",name:"oC",qualifier:["float"],f:!1},{type:"node_out",name:"oD",qualifier:["float"],f:!1}],
g:[{type:"textline",b:"oD = ( oB <= UNITY_VALUE_NODES && oB >= - UNITY_VALUE_NODES ) ? asin ( oB ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"oD = clamp ( oD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["oC",";"]}]},{type:"node",name:"MATH_ARCCOSINE",i:[{type:"node_in",name:"oE",qualifier:["float"],f:!1},{type:"node_in",name:"oF",qualifier:["float"],f:!1},{type:"node_out",name:"oG",qualifier:["float"],
f:!1}],g:[{type:"textline",b:"oG = ( oE <= UNITY_VALUE_NODES && oE >= - UNITY_VALUE_NODES ) ? acos ( oE ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"oG = clamp ( oG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["oF",";"]}]},{type:"node",name:"MATH_ARCTANGENT",i:[{type:"node_in",name:"oH",qualifier:["float"],f:!1},{type:"node_in",name:"oI",qualifier:["float"],f:!1},{type:"node_out",name:"oJ",
qualifier:["float"],f:!1}],g:[{type:"textline",b:"oJ = atan ( oH ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"oJ = clamp ( oJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["oI",";"]}]},{type:"node",name:"MATH_POWER",i:[{type:"node_in",name:"oK",qualifier:["float"],f:!1},{type:"node_in",name:"oL",qualifier:["float"],f:!1},{type:"node_out",name:"oM",qualifier:["float"],f:!1}],g:[{type:"textline",b:"if ( oK < ZERO_VALUE_NODES || oK == ZERO_VALUE_NODES && oL == ZERO_VALUE_NODES ) oM = ZERO_VALUE_NODES ; else oM = pow ( oK , oL ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"oM = clamp ( oM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_LOGARITHM",i:[{type:"node_in",name:"oN",qualifier:["float"],f:!1},{type:"node_in",name:"oO",qualifier:["float"],f:!1},{type:"node_out",name:"oP",qualifier:["float"],f:!1}],g:[{type:"textline",b:"oP = ( oN > ZERO_VALUE_NODES && oO > ZERO_VALUE_NODES ) ? log2 ( oN ) / log2 ( oO ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"oP = clamp ( oP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MINIMUM",i:[{type:"node_in",name:"oQ",qualifier:["float"],f:!1},{type:"node_in",name:"oR",qualifier:["float"],f:!1},{type:"node_out",name:"oS",qualifier:["float"],f:!1}],g:[{type:"textline",b:"oS = min ( oQ , oR ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"oS = clamp ( oS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_MAXIMUM",i:[{type:"node_in",name:"oT",qualifier:["float"],f:!1},{type:"node_in",name:"oU",qualifier:["float"],f:!1},{type:"node_out",name:"oV",qualifier:["float"],f:!1}],g:[{type:"textline",b:"oV = max ( oT , oU ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"oV = clamp ( oV , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ROUND",i:[{type:"node_in",name:"oW",qualifier:["float"],f:!1},
{type:"node_in",name:"oX",qualifier:["float"],f:!1},{type:"node_out",name:"oY",qualifier:["float"],f:!1}],g:[{type:"textline",b:"oY = floor ( oW + 0.5 ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"oY = clamp ( oY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["oX",";"]}]},{type:"node",name:"MATH_LESS_THAN",i:[{type:"node_in",name:"oZ",qualifier:["float"],f:!1},{type:"node_in",name:"o_",qualifier:["float"],f:!1},
{type:"node_out",name:"pa",qualifier:["float"],f:!1}],g:[{type:"textline",b:"pa = ( oZ < o_ ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"pa = clamp ( pa , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_GREATER_THAN",i:[{type:"node_in",name:"pb",qualifier:["float"],f:!1},{type:"node_in",name:"pc",qualifier:["float"],f:!1},{type:"node_out",name:"pd",qualifier:["float"],
f:!1}],g:[{type:"textline",b:"pd = ( pb > pc ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"pd = clamp ( pd , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MODULO",i:[{type:"node_in",name:"pe",qualifier:["float"],f:!1},{type:"node_in",name:"pf",qualifier:["float"],f:!1},{type:"node_out",name:"pg",qualifier:["float"],f:!1}],g:[{type:"textline",b:"pg = abs ( pf ) > 0.000001 ? mod ( pe , pf ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"pg = clamp ( pg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ABSOLUTE",i:[{type:"node_in",name:"ph",qualifier:["float"],f:!1},{type:"node_in",name:"pi",qualifier:["float"],f:!1},{type:"node_out",name:"pj",qualifier:["float"],f:!1}],g:[{type:"textline",b:"pj = abs ( ph ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"pj = clamp ( pj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",b:["pi",";"]}]},{type:"node",name:"MIX_RGB_MIX",i:[{type:"node_in",name:"pk",qualifier:["float"],f:!1},{type:"node_in",name:"pl",qualifier:["vec3"],f:!1},{type:"node_in",name:"pm",qualifier:["vec3"],f:!1},{type:"node_out",name:"pn",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( pk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pn = mix ( pl , pm , iE ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"pn = clamp ( pn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_ADD",i:[{type:"node_in",name:"po",qualifier:["float"],f:!1},{type:"node_in",name:"pp",qualifier:["vec3"],f:!1},{type:"node_in",name:"pq",qualifier:["vec3"],f:!1},{type:"node_out",name:"pr",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( po , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pr = mix ( pp , pp + pq , iE ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"pr = clamp ( pr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_MULTIPLY",i:[{type:"node_in",name:"ps",qualifier:["float"],f:!1},{type:"node_in",name:"pt",qualifier:["vec3"],f:!1},{type:"node_in",name:"pu",qualifier:["vec3"],f:!1},{type:"node_out",name:"pv",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( ps , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pv = mix ( pt , pt * pu , iE ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"pv = clamp ( pv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SUBTRACT",i:[{type:"node_in",name:"pw",qualifier:["float"],f:!1},{type:"node_in",name:"px",qualifier:["vec3"],f:!1},{type:"node_in",name:"py",qualifier:["vec3"],f:!1},{type:"node_out",name:"pz",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( pw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pz = mix ( px , px - py , iE ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"pz = clamp ( pz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SCREEN",i:[{type:"node_in",name:"pA",qualifier:["float"],f:!1},{type:"node_in",name:"pB",qualifier:["vec3"],f:!1},{type:"node_in",name:"pC",qualifier:["vec3"],f:!1},{type:"node_out",name:"pD",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( pA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iD = UNITY_VALUE_NODES - iE ; pD = hL - ( vec3 ( iD ) + iE * ( hL - pC ) ) * ( hL - pB ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",
b:"pD = clamp ( pD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIVIDE",i:[{type:"node_in",name:"pE",qualifier:["float"],f:!1},{type:"node_in",name:"pF",qualifier:["vec3"],f:!1},{type:"node_in",name:"pG",qualifier:["vec3"],f:!1},{type:"node_out",name:"pH",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( pE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iD = UNITY_VALUE_NODES - iE ; pG += step ( pG , hK ) ; pH = iD * pF + iE * pF / pG ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"pH = clamp ( pH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIFFERENCE",i:[{type:"node_in",name:"pI",qualifier:["float"],f:!1},{type:"node_in",name:"pJ",qualifier:["vec3"],f:!1},{type:"node_in",name:"pK",qualifier:["vec3"],f:!1},{type:"node_out",name:"pL",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( pI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pL = mix ( pJ , abs ( pJ - pK ) , iE ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"pL = clamp ( pL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DARKEN",i:[{type:"node_in",name:"pM",qualifier:["float"],f:!1},{type:"node_in",name:"pN",qualifier:["vec3"],f:!1},{type:"node_in",name:"pO",qualifier:["vec3"],f:!1},{type:"node_out",name:"pP",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( pM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pP = min ( pN . rgb , pO . rgb * iE ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"pP = clamp ( pP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LIGHTEN",i:[{type:"node_in",name:"pQ",qualifier:["float"],f:!1},{type:"node_in",name:"pR",qualifier:["vec3"],f:!1},{type:"node_in",name:"pS",qualifier:["vec3"],f:!1},{type:"node_out",name:"pT",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( pQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pT = max ( pR . rgb , pS . rgb * iE ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"pT = clamp ( pT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_OVERLAY",i:[{type:"node_in",name:"pU",qualifier:["float"],f:!1},{type:"node_in",name:"pV",qualifier:["vec3"],f:!1},{type:"node_in",name:"pW",qualifier:["vec3"],f:!1},{type:"node_out",name:"pX",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( pU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iS = vec3 ( UNITY_VALUE_NODES - iE ) ; pX = mix ( pV * ( iS + 2.0 * iE * pW ) , hL - ( iS + 2.0 * iE * ( hL - pW ) ) * ( hL - pV ) , step ( 0.5 , pV ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"pX = clamp ( pX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DODGE",i:[{type:"node_in",name:"pY",qualifier:["float"],f:!1},{type:"node_in",name:"pZ",qualifier:["vec3"],f:!1},{type:"node_in",name:"p_",qualifier:["vec3"],f:!1},{type:"node_out",name:"qa",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( pY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iS = hL - iE * p_ ; iR = clamp ( pZ / iS , 0.0 , 1.0 ) ; qa = mix ( mix ( iR , hL , step ( iS , hK ) ) , pZ , step ( pZ , hK ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"qa = clamp ( qa , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_BURN",i:[{type:"node_in",name:"qb",qualifier:["float"],f:!1},{type:"node_in",name:"qc",qualifier:["vec3"],f:!1},{type:"node_in",name:"qd",qualifier:["vec3"],f:!1},{type:"node_out",name:"qe",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( qb , 0.0 , 1.0 ) ; iS = vec3 ( 1.0 - iE ) ; iS = iS + iE * qd ; iR = clamp ( hL - ( hL - qc ) / iS , 0.0 , 1.0 ) ; qe = mix ( iR , hK , step ( iS , hK ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"qe = clamp ( qe , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_HUE",i:[{type:"node_in",name:"qf",qualifier:["float"],f:!1},{type:"node_in",name:"qg",qualifier:["vec3"],f:!1},{type:"node_in",name:"qh",qualifier:["vec3"],f:!1},{type:"node_out",name:"qi",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( qf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; qi = qg ; iR = hU ( qh ) ; if ( iR . y != ZERO_VALUE_NODES ) { iS = hU ( qi ) ; iS . x = iR . x ; iT = hY ( iS ) ; qi = mix ( qi , iT , iE ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"qi = clamp ( qi , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SATURATION",i:[{type:"node_in",name:"qj",qualifier:["float"],f:!1},{type:"node_in",name:"qk",qualifier:["vec3"],f:!1},{type:"node_in",name:"ql",qualifier:["vec3"],f:!1},{type:"node_out",name:"qm",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( qj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iD = UNITY_VALUE_NODES - iE ; qm = qk ; iT = hU ( qm ) ; if ( iT . y != ZERO_VALUE_NODES ) { iR = hU ( ql ) ; iT . y = iD * iT . y + iE * iR . y ; qm = hY ( iT ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"qm = clamp ( qm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_VALUE",i:[{type:"node_in",name:"qn",qualifier:["float"],f:!1},{type:"node_in",name:"qo",qualifier:["vec3"],f:!1},{type:"node_in",name:"qp",qualifier:["vec3"],f:!1},{type:"node_out",name:"qq",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( qn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iD = UNITY_VALUE_NODES - iE ; iR = hU ( qo ) ; iU = hU ( qp ) ; iR . z = iD * iR . z + iE * iU . z ; qq = hY ( iR ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"qq = clamp ( qq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_COLOR",i:[{type:"node_in",name:"qr",qualifier:["float"],f:!1},{type:"node_in",name:"qs",qualifier:["vec3"],f:!1},{type:"node_in",name:"qt",qualifier:["vec3"],f:!1},{type:"node_out",name:"qu",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( qr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; qu = qs ; iV = hU ( qt ) ; if ( iV . y != ZERO_VALUE_NODES ) { iU = hU ( qu ) ; iU . x = iV . x ; iU . y = iV . y ; iW = hY ( iU ) ; qu = mix ( qu , iW , iE ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"qu = clamp ( qu , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SOFT_LIGHT",i:[{type:"node_in",name:"qv",qualifier:["float"],f:!1},{type:"node_in",name:"qw",qualifier:["vec3"],f:!1},{type:"node_in",name:"qx",qualifier:["vec3"],f:!1},{type:"node_out",name:"qy",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( qv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iD = UNITY_VALUE_NODES - iE ; iW = qx + qw - qx * qw ; qy = qw * ( vec3 ( iD ) + vec3 ( iE ) * ( ( hL - qw ) * qx + iW ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"qy = clamp ( qy , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LINEAR_LIGHT",i:[{type:"node_in",name:"qz",qualifier:["float"],f:!1},{type:"node_in",name:"qA",qualifier:["vec3"],f:!1},{type:"node_in",name:"qB",qualifier:["vec3"],f:!1},{type:"node_out",name:"qC",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"iE = clamp ( qz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; qC = qA + iE * ( 2.0 * qB - hL ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"qC = clamp ( qC , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"OUTPUT",i:[{type:"node_in",name:"qD",qualifier:["vec3"],f:!1},{type:"node_in",name:"qE",qualifier:["float"],f:!1}],g:[{type:"textline",b:"iu = qD ; iy = qE ;".split(" ")}]},{type:"node",name:"MATERIAL",i:[{type:"node_in",name:"qF",qualifier:["vec3"],f:!1},{type:"node_in",name:"qG",qualifier:["vec3"],f:!1},{type:"node_in",
name:"qH",qualifier:["float"],f:!1},{type:"node_in",name:"qI",qualifier:["vec3"],f:!0},{type:"node_out",name:"qJ",qualifier:["vec3"],f:!0},{type:"node_out",name:"qK",qualifier:["float"],f:!0},{type:"node_out",name:"qL",qualifier:["vec3"],f:!0},{type:"node_param",name:"im",qualifier:["float"]},{type:"node_param",name:"io",qualifier:["float"]},{type:"node_param",name:"ip",qualifier:["const","vec2"]},{type:"node_param",name:"iq",qualifier:["const","vec3"]}],g:[{type:"textline",b:"iW = clamp ( qF , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},
{type:"textline",b:"iV = iq [ 0 ] * clamp ( qG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_NORMAL"],g:[{type:"textline",b:"iX = normalize ( qI ) ;".split(" ")}]},{type:"node_else",g:[{type:"textline",b:["iX","=","iP",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["SHADELESS_MAT",{type:"logic_negative_expr",d:1},"NODES_GLOW",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],g:[{type:"textline",b:"iY = iB * iW ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_DIFFUSE"],g:[{type:"textline",b:["iW","*=","qH",";"]}]}]},{type:"textline",b:"iZ = iC * u_environment_energy * hu ( iX ) ; iE = gY ( iW ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],g:[{type:"textline",b:"iz = vec2 ( ip [ 0 ] , ip [ 1 ] ) ;".split(" ")},{type:"textline",b:"iA = vec2 ( iq [ 1 ] , iq [ 2 ] ) ; jd = cN ( iY , iZ , iW , iV , iO , iX , it , iA , iz , iE , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , ZERO_VALUE_NODES , vec4 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]},
{type:"node_else",g:[{type:"textline",b:"jd = cS ( iY , iZ , iW ) ;".split(" ")}]}]},{type:"textline",b:["ix","=","iE",";"]}]},{type:"node_else",g:[{type:"textline",b:"jd . a = vec4 ( iW , ZERO_VALUE_NODES ) ; jd . b = hK ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_qJ"],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_DIFFUSE"],g:[{type:"textline",b:"qJ = jd . a . rgb ;".split(" ")}]},{type:"node_else",g:[{type:"textline",b:["qJ","=","hK",";"]}]}]},{type:"node_condition",
a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:"qJ += jd . b ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_qK"],g:[{type:"textline",b:"qK = clamp ( im , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:"iD = max ( max ( jd . b . r , jd . b . g ) , jd . b . b ) * io ; qK = im * ( UNITY_VALUE_NODES - iD ) + iD ;".split(" ")}]}]}]}]},{type:"node_condition",
a:[{type:"node_if",c:["USE_OUT_qL"],g:[{type:"textline",b:["qL","=","iX",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:"iv = jd . b ;".split(" ")}]},{type:"node_else",g:[{type:"textline",b:["iv","=","hK",";"]}]}]},{type:"textline",b:["iw","=","iX",";"]}]},{type:"node",name:"MATERIAL_EXT",i:[{type:"node_in",name:"qM",qualifier:["vec3"],f:!1},{type:"node_in",name:"qN",qualifier:["vec3"],f:!1},{type:"node_in",name:"qO",qualifier:["float"],f:!1},
{type:"node_in",name:"qP",qualifier:["vec3"],f:!0},{type:"node_in",name:"qQ",qualifier:["float"],f:!1},{type:"node_in",name:"qR",qualifier:["float"],f:!1},{type:"node_in",name:"qS",qualifier:["vec4"],f:!1},{type:"node_in",name:"qT",qualifier:["float"],f:!1},{type:"node_in",name:"qU",qualifier:["float"],f:!1},{type:"node_in",name:"qV",qualifier:["float"],f:!1},{type:"node_out",name:"qW",qualifier:["vec3"],f:!0},{type:"node_out",name:"qX",qualifier:["float"],f:!0},{type:"node_out",name:"qY",qualifier:["vec3"],
f:!0},{type:"node_out",name:"qZ",qualifier:["vec3"],f:!0},{type:"node_out",name:"q_",qualifier:["vec3"],f:!0},{type:"node_param",name:"ir",qualifier:["const","vec2"]},{type:"node_param",name:"is",qualifier:["const","vec3"]}],g:[{type:"textline",b:"iV = clamp ( qM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",b:"i_ = is [ 0 ] * clamp ( qN , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_NORMAL"],g:[{type:"textline",
b:"ja = normalize ( qP ) ;".split(" ")}]},{type:"node_else",g:[{type:"textline",b:["ja","=","iP",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["SHADELESS_MAT",{type:"logic_negative_expr",d:1},"NODES_GLOW",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],g:[{type:"textline",b:"jb = qQ * iV ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_DIFFUSE"],g:[{type:"textline",b:["iV","*=","qO",";"]}]}]},{type:"textline",b:"iD = gY ( iV ) ;".split(" ")},{type:"textline",
b:"jc = iC * u_environment_energy * hu ( ja ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],g:[{type:"textline",b:"iz = vec2 ( ir [ 0 ] , ir [ 1 ] ) ; iA = vec2 ( is [ 1 ] , is [ 2 ] ) ; jd = cN ( jb , jc , iV , i_ , iO , ja , it , iA , iz , iD , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , qR , qS ) ;".split(" ")}]},{type:"node_else",g:[{type:"textline",b:"jd = cS ( jb , jc , iV ) ;".split(" ")}]}]},{type:"textline",
b:["ix","=","iD",";"]}]},{type:"node_else",g:[{type:"textline",b:"jd . a = vec4 ( iV , ZERO_VALUE_NODES ) ; jd . b = hK ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_qW"],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_DIFFUSE"],g:[{type:"textline",b:"qW = jd . a . rgb ;".split(" ")}]},{type:"node_else",g:[{type:"textline",b:["qW","=","hK",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["REFLECTION_TYPE","REFL_NONE",{type:"non_equal_expr",d:2}],g:[{type:"textline",
b:"hr ( qW , it , ja , qT ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:"qW += jd . b ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_qX"],g:[{type:"textline",b:"qX = clamp ( qV , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:"iG = max ( max ( jd . b . r , jd . b . g ) , jd . b . b ) * qU ; qX = clamp ( qV * ( UNITY_VALUE_NODES - iG ) + iG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_qY"],g:[{type:"textline",b:["qY","=","ja",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_qZ"],g:[{type:"textline",b:"qZ = jd . a . rgb ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_q_"],g:[{type:"textline",b:"q_ = jd . b ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:"iv = jd . b ;".split(" ")}]},{type:"node_else",g:[{type:"textline",b:["iv",
"=","hK",";"]}]}]},{type:"textline",b:["iw","=","ja",";"]}]},{type:"node",name:"RGB",i:[{type:"node_out",name:"ra",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"ra = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{type:"node",name:"RGBTOBW",i:[{type:"node_in",name:"rb",qualifier:["vec3"],f:!1},{type:"node_out",name:"rc",qualifier:["float"],f:!1}],g:[{type:"textline",b:"rc = dot ( rb , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{type:"node",name:"SEPRGB",i:[{type:"node_in",name:"rd",qualifier:["vec3"],
f:!1},{type:"node_out",name:"re",qualifier:["float"],f:!0},{type:"node_out",name:"rf",qualifier:["float"],f:!0},{type:"node_out",name:"rg",qualifier:["float"],f:!0}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_re"],g:[{type:"textline",b:"re = rd . r ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rf"],g:[{type:"textline",b:"rf = rd . g ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rg"],g:[{type:"textline",b:"rg = rd . b ;".split(" ")}]}]}]},
{type:"node",name:"SEPHSV",i:[{type:"node_in",name:"rh",qualifier:["vec3"],f:!1},{type:"node_out",name:"ri",qualifier:["float"],f:!0},{type:"node_out",name:"rj",qualifier:["float"],f:!0},{type:"node_out",name:"rk",qualifier:["float"],f:!0}],g:[{type:"textline",b:"i_ = hU ( rh ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ri"],g:[{type:"textline",b:"ri = i_ . r ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rj"],g:[{type:"textline",b:"rj = i_ . g ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rk"],g:[{type:"textline",b:"rk = i_ . b ;".split(" ")}]}]}]},{type:"node",name:"SQUEEZE",i:[{type:"node_in",name:"rl",qualifier:["float"],f:!1},{type:"node_in",name:"rm",qualifier:["float"],f:!1},{type:"node_in",name:"rn",qualifier:["float"],f:!1},{type:"node_out",name:"ro",qualifier:["float"],f:!1}],g:[{type:"textline",b:"ro = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( ( rl - rn ) * rm ) ) ) ;".split(" ")}]},{type:"node",
name:"GAMMA",i:[{type:"node_in",name:"rp",qualifier:["vec3"],f:!1},{type:"node_in",name:"rq",qualifier:["float"],f:!1},{type:"node_out",name:"rr",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"rr = max ( hK , rp ) ; rr = pow ( rr , vec3 ( rq ) ) ;".split(" ")}]},{type:"node",name:"B4W_SRGB_TO_LINEAR",i:[{type:"node_in",name:"rs",qualifier:["vec3"],f:!1},{type:"node_out",name:"rt",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"rt = max ( hK , rs ) ; rt = pow ( rt , vec3 ( 2.2 ) ) ;".split(" ")}]},
{type:"node",name:"B4W_LINEAR_TO_SRGB",i:[{type:"node_in",name:"ru",qualifier:["vec3"],f:!1},{type:"node_out",name:"rv",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"rv = max ( hK , ru ) ; rv = pow ( rv , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{type:"node",name:"TEXTURE_EMPTY",i:[{type:"node_out",name:"rw",qualifier:["vec3"],f:!1},{type:"node_out",name:"rx",qualifier:["vec3"],f:!1},{type:"node_out",name:"ry",qualifier:["float"],f:!1}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ry"],
g:[{type:"textline",b:"rw [ 2 ] = rw [ 1 ] = rw [ 0 ] = 0.0 ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ry"],g:[{type:"textline",b:"rx [ 2 ] = rx [ 1 ] = rx [ 0 ] = 0.0 ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ry"],g:[{type:"textline",b:["ry","=","0.0",";"]}]}]}]},{type:"node",name:"TEXTURE_ENVIRONMENT",i:[{type:"node_in",name:"rz",qualifier:["vec3"],f:!1},{type:"node_out",name:"rA",qualifier:["vec3"],f:!0},{type:"node_out",name:"rB",qualifier:["float"],
f:!0},{type:"node_param",name:"node_TEXTURE_ENVIRONMENT_var_texture",qualifier:["uniform","samplerCube"]}],g:[{type:"textline",b:"iM = textureCube ( node_TEXTURE_ENVIRONMENT_var_texture , rz ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rA"],g:[{type:"textline",b:"rA = iM . xyz ; ed ( rA ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rB"],g:[{type:"textline",b:"rB = iM . w ;".split(" ")}]}]}]},{type:"node",name:"TEXTURE_COLOR",i:[{type:"node_in",
name:"rC",qualifier:["vec3"],f:!0},{type:"node_in",name:"rD",qualifier:["vec3"],f:!0},{type:"node_in",name:"rE",qualifier:["vec3"],f:!0},{type:"node_in",name:"rF",qualifier:["vec3"],f:!0},{type:"node_out",name:"rG",qualifier:["vec3"],f:!0},{type:"node_out",name:"rH",qualifier:["float"],f:!0},{type:"node_out",name:"rI",qualifier:["vec3"],f:!0},{type:"node_out",name:"rJ",qualifier:["float"],f:!0},{type:"node_out",name:"rK",qualifier:["vec3"],f:!0},{type:"node_out",name:"rL",qualifier:["float"],f:!0},
{type:"node_out",name:"rM",qualifier:["vec3"],f:!0},{type:"node_out",name:"rN",qualifier:["float"],f:!0},{type:"node_param",name:"node_TEXTURE_COLOR_var_texture",qualifier:["uniform","sampler2D"]}],g:[{type:"textline",b:"iM = texture2D ( node_TEXTURE_COLOR_var_texture , ib ( rC ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rG"],g:[{type:"textline",b:"rG = iM . xyz ; ed ( rG ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rH"],g:[{type:"textline",
b:"rH = iM . w ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv2"],g:[{type:"textline",b:"iM = texture2D ( node_TEXTURE_COLOR_var_texture , ib ( rD ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rI"],g:[{type:"textline",b:"rI = iM . xyz ; ed ( rI ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rJ"],g:[{type:"textline",b:"rJ = iM . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv3"],g:[{type:"textline",
b:"iM = texture2D ( node_TEXTURE_COLOR_var_texture , ib ( rE ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rK"],g:[{type:"textline",b:"rK = iM . xyz ; ed ( rK ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rL"],g:[{type:"textline",b:"rL = iM . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv4"],g:[{type:"textline",b:"iM = texture2D ( node_TEXTURE_COLOR_var_texture , ib ( rF ) ) ;".split(" ")},{type:"node_condition",
a:[{type:"node_if",c:["USE_OUT_rM"],g:[{type:"textline",b:"rM = iM . xyz ; ed ( rM ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rN"],g:[{type:"textline",b:"rN = iM . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"TEXTURE_NORMAL",i:[{type:"node_in",name:"rO",qualifier:["vec3"],f:!0},{type:"node_in",name:"rP",qualifier:["vec3"],f:!0},{type:"node_in",name:"rQ",qualifier:["vec3"],f:!0},{type:"node_in",name:"rR",qualifier:["vec3"],f:!0},{type:"node_out",name:"rS",qualifier:["vec3"],
f:!0},{type:"node_out",name:"rT",qualifier:["float"],f:!0},{type:"node_out",name:"rU",qualifier:["vec3"],f:!0},{type:"node_out",name:"rV",qualifier:["float"],f:!0},{type:"node_out",name:"rW",qualifier:["vec3"],f:!0},{type:"node_out",name:"rX",qualifier:["float"],f:!0},{type:"node_out",name:"rY",qualifier:["vec3"],f:!0},{type:"node_out",name:"rZ",qualifier:["float"],f:!0},{type:"node_param",name:"node_TEXTURE_NORMAL_var_texture",qualifier:["uniform","sampler2D"]}],g:[{type:"textline",b:"iM = texture2D ( node_TEXTURE_NORMAL_var_texture , ib ( rO ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rS"],g:[{type:"textline",b:"rS = normalize ( iN * ( iM . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rT"],g:[{type:"textline",b:"rT = iM . w ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv2"],g:[{type:"textline",b:"iM = texture2D ( node_TEXTURE_NORMAL_var_texture , ib ( rP ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rU"],g:[{type:"textline",b:"rU = normalize ( iN * ( iM . xyz - 0.5 ) ) ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rV"],g:[{type:"textline",b:"rV = iM . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv3"],g:[{type:"textline",b:"iM = texture2D ( node_TEXTURE_NORMAL_var_texture , ib ( rQ ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rW"],g:[{type:"textline",b:"rW = normalize ( iN * ( iM . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rX"],g:[{type:"textline",b:"rX = iM . w ;".split(" ")}]}]}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_uv4"],g:[{type:"textline",b:"iM = texture2D ( node_TEXTURE_NORMAL_var_texture , ib ( rR ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rY"],g:[{type:"textline",b:"rY = normalize ( iN * ( iM . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rZ"],g:[{type:"textline",b:"rZ = iM . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"VALUE",i:[{type:"node_out",name:"r_",qualifier:["float"],f:!1}],
g:[{type:"textline",b:"r_ = u_node_values [ VALUE_IND ] ;".split(" ")}]},{type:"node",name:"VECT_MATH_ADD",i:[{type:"node_in",name:"sa",qualifier:["vec3"],f:!1},{type:"node_in",name:"sb",qualifier:["vec3"],f:!1},{type:"node_out",name:"sc",qualifier:["vec3"],f:!1},{type:"node_out",name:"sd",qualifier:["float"],f:!0}],g:[{type:"textline",b:"sc = sa + sb ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sd"],g:[{type:"textline",b:"sd = ( abs ( sc [ 0 ] ) + abs ( sc [ 1 ] ) + abs ( sc [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_SUBTRACT",i:[{type:"node_in",name:"se",qualifier:["vec3"],f:!1},{type:"node_in",name:"sf",qualifier:["vec3"],f:!1},{type:"node_out",name:"sg",qualifier:["vec3"],f:!1},{type:"node_out",name:"sh",qualifier:["float"],f:!0}],g:[{type:"textline",b:"sg = se - sf ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sh"],g:[{type:"textline",b:"sh = ( abs ( sg [ 0 ] ) + abs ( sg [ 1 ] ) + abs ( sg [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_AVERAGE",
i:[{type:"node_in",name:"si",qualifier:["vec3"],f:!1},{type:"node_in",name:"sj",qualifier:["vec3"],f:!1},{type:"node_out",name:"sk",qualifier:["vec3"],f:!1},{type:"node_out",name:"sl",qualifier:["float"],f:!0}],g:[{type:"textline",b:"sk = si + sj ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sl"],g:[{type:"textline",b:"sl = length ( sk ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sk"],g:[{type:"textline",b:"sk = normalize ( sk ) ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_DOT_PRODUCT",i:[{type:"node_in",name:"sm",qualifier:["vec3"],f:!1},{type:"node_in",name:"sn",qualifier:["vec3"],f:!1},{type:"node_out",name:"so",qualifier:["vec3"],f:!1},{type:"node_out",name:"sp",qualifier:["float"],f:!0}],g:[{type:"textline",b:["so","=","hK",";"]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sp"],g:[{type:"textline",b:"sp = dot ( sm , sn ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_CROSS_PRODUCT",i:[{type:"node_in",name:"sq",qualifier:["vec3"],
f:!1},{type:"node_in",name:"sr",qualifier:["vec3"],f:!1},{type:"node_out",name:"ss",qualifier:["vec3"],f:!1},{type:"node_out",name:"st",qualifier:["float"],f:!0}],g:[{type:"textline",b:"ss = cross ( sq , sr ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_st"],g:[{type:"textline",b:"st = length ( ss ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_NORMALIZE",i:[{type:"node_in",name:"su",qualifier:["vec3"],f:!1},{type:"node_in",name:"sv",qualifier:["vec3"],f:!1},{type:"node_out",
name:"sw",qualifier:["vec3"],f:!1},{type:"node_out",name:"sx",qualifier:["float"],f:!0}],g:[{type:"textline",b:"sw = normalize ( su ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sx"],g:[{type:"textline",b:"sx = length ( su ) ;".split(" ")}]}]},{type:"textline",b:["sv",";"]}]},{type:"node",name:"B4W_REFLECT",i:[{type:"node_in",name:"sy",qualifier:["vec3"],f:!1},{type:"node_in",name:"sz",qualifier:["vec3"],f:!1},{type:"node_out",name:"sA",qualifier:["vec3"],f:!1}],g:[{type:"textline",
b:"sA = reflect ( - sy , sz ) ;".split(" ")}]},{type:"node",name:"B4W_PARALLAX",i:[{type:"node_in",name:"sB",qualifier:["vec3"],f:!1},{type:"node_in",name:"sC",qualifier:["float"],f:!1},{type:"node_in",name:"sD",qualifier:["const","float"],f:!1},{type:"node_in",name:"sE",qualifier:["const","float"],f:!1},{type:"node_out",name:"sF",qualifier:["vec3"],f:!1},{type:"node_param",name:"node_B4W_PARALLAX_var_texture",qualifier:["uniform","sampler2D"]}],g:[{type:"textline",b:"iG = length ( iL ) ; if ( iG < sE ) { iz = ib ( sB ) ; iH = clamp ( 0.5 * ( sE - iG ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iH = sC * iH ;".split(" ")},
{type:"textline",b:"i_ = normalize ( it * iN ) ;".split(" ")},{type:"textline",b:"iI = UNITY_VALUE_NODES / sD ;".split(" ")},{type:"textline",b:"iA = i_ . xy * iH / ( sD * i_ . z ) ; iJ = UNITY_VALUE_NODES ; iK = texture2D ( node_B4W_PARALLAX_var_texture , iz ) . a ;".split(" ")},{type:"textline",b:"for ( float sG = 1.0 ; sG <= sD ; sG ++ ) { if ( iK < iJ ) { iJ -= iI ; iz -= iA ; iK = texture2D ( node_B4W_PARALLAX_var_texture , iz ) . a ; } }".split(" ")},{type:"textline",b:"iA = iz + iA ; iI = texture2D ( node_B4W_PARALLAX_var_texture , iA ) . a - ( iJ + iI ) ; iJ = iK - iJ ; iI = iJ / ( iJ - iI ) ;".split(" ")},
{type:"textline",b:"iz = iI * iA + ( UNITY_VALUE_NODES - iI ) * iz ; sF = h_ ( iz ) ; } else sF = sB ;".split(" ")}]},{type:"node",name:"B4W_CLAMP",i:[{type:"node_in",name:"sH",qualifier:["vec3"],f:!1},{type:"node_out",name:"sI",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"sI = clamp ( sH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"B4W_REFRACTION",i:[{type:"node_in",name:"sJ",qualifier:["vec3"],f:!1},{type:"node_in",name:"sK",qualifier:["float"],f:!1},{type:"node_out",
name:"sL",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"sL = hP ( sJ , sK ) ;".split(" ")}]},{type:"node",name:"B4W_TRANSLUCENCY",i:[{type:"node_in",name:"sM",qualifier:["float"],f:!1},{type:"node_in",name:"sN",qualifier:["float"],f:!1},{type:"node_in",name:"sO",qualifier:["float"],f:!1},{type:"node_in",name:"sP",qualifier:["float"],f:!1},{type:"node_in",name:"sQ",qualifier:["float"],f:!1},{type:"node_out",name:"sR",qualifier:["float"],f:!0},{type:"node_out",name:"sS",qualifier:["vec4"],f:!0}],
g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sR"],g:[{type:"textline",b:["sR","=","sM",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_sS"],g:[{type:"textline",b:"sS = vec4 ( sN , sO , sP , sQ ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_TIME",i:[{type:"node_out",name:"sT",qualifier:["float"],f:!1}],g:[{type:"textline",b:["sT","=","u_time",";"]}]},{type:"node",name:"B4W_SMOOTHSTEP",i:[{type:"node_in",name:"sU",qualifier:["float"],f:!1},{type:"node_in",name:"sV",qualifier:["float"],
f:!1},{type:"node_in",name:"sW",qualifier:["float"],f:!1},{type:"node_out",name:"sX",qualifier:["float"],f:!1}],g:[{type:"textline",b:"sX = smoothstep ( sV , sW , sU ) ;".split(" ")}]},{type:"node",name:"B4W_GLOW_OUTPUT",i:[{type:"node_in",name:"sY",qualifier:["vec3"],f:!1},{type:"node_in",name:"sZ",qualifier:["float"],f:!1}],g:[{type:"textline",b:"iu = sY ; iy = sZ ;".split(" ")}]},{type:"node",name:"B4W_VECTOSCAL",i:[{type:"node_in",name:"s_",qualifier:["vec3"],f:!1},{type:"node_out",name:"ta",
qualifier:["float"],f:!1}],g:[{type:"textline",b:"ta = ( s_ . r + s_ . g + s_ . b ) / 3.0 ;".split(" ")}]},{type:"node",name:"B4W_SCALTOVEC",i:[{type:"node_in",name:"tb",qualifier:["float"],f:!1},{type:"node_out",name:"tc",qualifier:["vec3"],f:!1}],g:[{type:"textline",b:"tc [ 0 ] = tb ; tc [ 1 ] = tb ; tc [ 2 ] = tb ;".split(" ")}]},{type:"nodes_global"},{type:"textline",b:"void td ( in vec3 it , out vec3 iu , out vec3 iv , out vec3 iw , out float ix , out float iy ) { vec2 iz , iA ; float iB , iC , iD , iE , iF , iG , iH , iI , iJ , iK ; vec4 iL , iM ; mat3 iN ; vec3 iO , iP , iQ , iR , iS , iT , iU , iV , iW , iX , iY , iZ , i_ , ja , jb , jc ; iu = hK ; iv = hK ; iw = hK ; ix = ZERO_VALUE_NODES ; iy = ZERO_VALUE_NODES ;".split(" ")},
{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["iO","=","eW",";"]},{type:"condition",a:[{type:"if",c:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",a:[{type:"textline",b:"if ( gl_FrontFacing ) iO = iO ; else iO = - iO ;".split(" ")}]}}]},{type:"textline",b:"iP = normalize ( iO ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"iQ = cross ( iO , eX . xyz ) * eX . w ; iN = mat3 ( eX . xyz , iQ , iO ) ; iN = iN ;".split(" ")}]}}]},{type:"textline",b:"iO = eU ; iL = eV ; iB = u_emit ; iC = u_ambient ; af jd ;".split(" ")},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/to_world.glslv"]={type:"group",a:[{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"define",name:"MAX_BILLBOARD_ANGLE",b:["(","M_PI","/","4.0",")"]},{type:"textline",b:"const vec3 te = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",d:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"mat4 tk ( vec3 tf , mat4 tg ) { vec3 th , ti , tj ; th = vec3 ( tg [ 0 ] [ 0 ] , tg [ 1 ] [ 0 ] , tg [ 2 ] [ 0 ] ) ; ti = vec3 ( tg [ 0 ] [ 1 ] , tg [ 1 ] [ 1 ] , tg [ 2 ] [ 1 ] ) ; tj = vec3 ( tg [ 0 ] [ 2 ] , tg [ 1 ] [ 2 ] , tg [ 2 ] [ 2 ] ) ; ti = cross ( tj , th ) ; th = normalize ( th ) ; ti = normalize ( ti ) ; tj = normalize ( tj ) ; return mat4 ( vec4 ( th , 0.0 ) , vec4 ( ti , 0.0 ) , vec4 ( tj , 0.0 ) , vec4 ( tf , 1.0 ) ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 tq ( vec3 tl , vec3 tm ) { vec3 tn , to , tp ; tn = tl - tm ; tn . y = 0.0 ; to = cross ( te , tn ) ; tp = cross ( tn , to ) ; to = normalize ( to ) ; tp = normalize ( tp ) ; tn = normalize ( tn ) ; return mat4 ( vec4 ( to , 0.0 ) , vec4 ( tp , 0.0 ) , vec4 ( tn , 0.0 ) , vec4 ( tm , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"mat4 ty ( in vec3 tr , float ts , float tt , float tu , vec3 tv ) { float tw , tx ; tw = fract ( length ( tv ) / 0.17 ) ; tx = tu + tw / 10.0 ; tw = tw ; if ( tu != 0.0 ) tw /= tu ; tr *= 1.0 + 0.5 * sin ( ts ) ; tw = length ( tr ) * tt * sin ( 2.0 * 3.14 * ts * tx + tw ) ; return eL ( tw ) ; }".split(" ")}]}}]},
{type:"textline",b:"mat4 tG ( in vec3 tz , in vec3 tA , in mat4 tB ) { vec3 tC ; float tD , tE ; mat4 tF ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",d:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"tF = tk ( tA , tB ) ;".split(" ")}]}},{type:"elif",c:["BILLBOARD_RANDOM"],group:{type:"group",a:[{type:"textline",
b:"tD = fract ( ( tA . x * 1.43 + tA . y * 0.123 + tA . z * 6.1 ) ) ; tD = 2.0 * M_PI * tD ; tC = normalize ( vec3 ( tB [ 0 ] [ 2 ] , 0.0 , tB [ 2 ] [ 2 ] ) ) ; tE = acos ( tC [ 2 ] ) ; if ( tC [ 0 ] < 0.0 ) tE = 2.0 * M_PI - tE ; tE = tE - tD ; if ( tE < 0.0 ) tE = 2.0 * M_PI + tE ; tD = tD ; if ( tE <= MAX_BILLBOARD_ANGLE ) tD += tE ; else if ( tE <= M_PI - MAX_BILLBOARD_ANGLE ) tD += MAX_BILLBOARD_ANGLE * ( 2.0 * tE - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( tE <= M_PI + MAX_BILLBOARD_ANGLE ) tD += tE - M_PI ; else if ( tE <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) tD += MAX_BILLBOARD_ANGLE * ( 2.0 * tE - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else tD += tE - 2.0 * M_PI ; tF = eJ ( tD ) ; tF [ 3 ] = vec4 ( tA , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"tF = tq ( tz , tA ) ;".split(" ")}]}}]},{type:"textline",b:["return","tF",";","}"]},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"mat4 tM ( in vec3 tH , in vec3 tI , in mat4 tJ , mat4 tK ) { mat4 tL ; tL = tG ( tH , tI , tJ ) ; tK [ 3 ] = vec4 ( 0.0 , 0.0 , 0.0 , 1.0 ) ; tL = tL * tK ; return tL ; }".split(" ")}]}}]},
{type:"textline",b:"el tT ( in vec3 tN , in vec3 tO , in vec3 tP , in vec3 tQ , in vec3 tR , in mat4 tS ) { tN = ( tS * vec4 ( tN , 1.0 ) ) . xyz ; tO = ( tS * vec4 ( tO , 1.0 ) ) . xyz ; tP = ( tS * vec4 ( tP , 0.0 ) ) . xyz ; tQ = ( tS * vec4 ( tQ , 0.0 ) ) . xyz ; tR = ( tS * vec4 ( tR , 0.0 ) ) . xyz ; return eN ( el ( tN , tO , tP , tQ , tR , vec3 ( 0.0 ) ) ) ; }".split(" ")}]};a["include/scale_texcoord.glslv"]={type:"group",a:[{type:"textline",b:"vec2 tW ( vec2 tU , vec3 tV ) { return ( tU + 0.5 ) * tV . xy - 0.5 ; }".split(" ")}]};
a["include/skin.glslv"]={type:"group",a:[{type:"define",name:"SKIN_SLERP",b:["0"]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"vec4 uc ( in vec4 tX , in vec4 tY , in float tZ ) { float t_ , ua , ub ; t_ = tX [ 0 ] * tY [ 0 ] + tX [ 1 ] * tY [ 1 ] + tX [ 2 ] * tY [ 2 ] + tX [ 3 ] * tY [ 3 ] ; if ( t_ < 0.0 ) { tY *= - 1.0 ; t_ = - t_ ; } if ( abs ( t_ ) >= 1.0 ) return tX ; ua = acos ( t_ ) ; t_ = sqrt ( 1.0 - t_ * t_ ) ; if ( abs ( t_ ) < 0.001 ) return vec4 ( tX * 0.5 + tY * 0.5 ) ; ub = sin ( ( 1.0 - tZ ) * ua ) / t_ ; t_ = sin ( tZ * ua ) / t_ ; return tX * ub + tY * t_ ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"vec3 uo ( in vec3 ud , in vec4 ue , in vec4 uf , in vec4 ug , in vec4 uh , in float ui ) { vec4 uj , uk ; vec3 ul , um , un ; ul = ey ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( ud , 1.0 ) ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"uj = uc ( ue , uf , ui ) ; uk = mix ( ug , uh , ui ) ; um = er ( uj , ul ) ; um = um * uk . w + uk . xyz ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"un = er ( ue , ul ) ; ul = er ( uf , ul ) ; un = un * ug . w + ug . xyz ; ul = ul * uh . w + uh . xyz ; um = mix ( un , ul , ui ) ;".split(" ")}]}}]},{type:"textline",b:"return eE ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( um , 1.0 ) ) ; } vec3 ux ( in vec3 up , in vec4 uq , in vec4 ur , in float us ) { vec4 ut ; vec3 uu , uv , uw ; uu = ey ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( up , 0.0 ) ) ;".split(" ")},{type:"condition",a:[{type:"if",
c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"ut = uc ( uq , ur , us ) ; uv = er ( ut , uu ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uw = er ( uq , uu ) ; uu = er ( ur , uu ) ; uv = mix ( uw , uu , us ) ;".split(" ")}]}}]},{type:"textline",b:"return eE ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uv , 0.0 ) ) ; }".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 uo ( in vec3 uy , in vec4 uz , in vec4 uA ) { vec3 uB ; uB = ey ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uy , 1.0 ) ) ; uB = er ( uz , uB ) ; uB = uB * uA . w + uA . xyz ; return eE ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uB , 1.0 ) ) ; } vec3 ux ( in vec3 uC , in vec4 uD ) { vec3 uE ; uE = ey ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uC , 0.0 ) ) ; uE = er ( uD , uE ) ; return eE ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uE , 0.0 ) ) ; }".split(" ")}]}}]},
{type:"textline",b:"void uT ( inout vec3 uF , inout vec3 uG , inout vec3 uH , inout vec3 uI ) { int uJ , uK ; vec4 uL ; vec3 uM , uN , uO , uP ; float uQ , uR ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:["uQ","=","u_frame_factor",";"]}]}}]},{type:"textline",b:"if ( a_influence . y > 0.0 ) { uM = vec3 ( 0.0 , 0.0 , 0.0 ) ; uN = vec3 ( 0.0 , 0.0 , 0.0 ) ; uO = vec3 ( 0.0 , 0.0 , 0.0 ) ; uP = vec3 ( 0.0 , 0.0 , 0.0 ) ; uL = a_influence ; for ( int uS = 0 ; uS < 4 ; uS ++ ) { uJ = int ( uL [ uS ] ) ; uR = fract ( uL [ uS ] ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uM += uR * uo ( uF , u_quatsb [ uJ ] , u_quatsa [ uJ ] , u_transb [ uJ ] , u_transa [ uJ ] , uQ ) ; uN += uR * ux ( uG , u_quatsb [ uJ ] , u_quatsa [ uJ ] , uQ ) ; uO += uR * ux ( uH , u_quatsb [ uJ ] , u_quatsa [ uJ ] , uQ ) ; uP += uR * ux ( uI , u_quatsb [ uJ ] , u_quatsa [ uJ ] , uQ ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uM += uR * uo ( uF , u_quatsb [ uJ ] , u_transb [ uJ ] ) ; uN += uR * ux ( uG , u_quatsb [ uJ ] ) ; uO += uR * ux ( uH , u_quatsb [ uJ ] ) ; uP += uR * ux ( uI , u_quatsb [ uJ ] ) ;".split(" ")}]}}]},
{type:"textline",b:"} uF = uM ; uG = uN ; uH = uO ; uI = uP ; } if ( ! ( a_influence . y > 0.0 ) ) { uK = int ( a_influence [ 0 ] - 1.0 ) ; if ( uK > - 1 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uF = uo ( uF , u_quatsb [ uK ] , u_quatsa [ uK ] , u_transb [ uK ] , u_transa [ uK ] , uQ ) ; uG = ux ( uG , u_quatsb [ uK ] , u_quatsa [ uK ] , uQ ) ; uH = ux ( uH , u_quatsb [ uK ] , u_quatsa [ uK ] , uQ ) ; uI = ux ( uI , u_quatsb [ uK ] , u_quatsa [ uK ] , uQ ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"uF = uo ( uF , u_quatsb [ uK ] , u_transb [ uK ] ) ; uG = ux ( uG , u_quatsb [ uK ] ) ; uH = ux ( uH , u_quatsb [ uK ] ) ; uI = ux ( uI , u_quatsb [ uK ] ) ;".split(" ")}]}}]},{type:"textline",b:["}","}","}"]}]}}]}]};a["include/wind_bending.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"void vd ( inout vec3 uU , in vec3 uV , in float uW , in float uX , in float uY , in vec3 uZ , in float u_ ) { vec3 va ; float vb , vc ; vb = length ( uV ) ; vc = uX * ( 1.0 + 0.1 * fract ( vb ) ) ; vb = uW * u_ * ( 1.0 + sin ( 2.0 * 3.14 * uY * vc + vb ) ) ; vc = ( uU . y - uV . y ) * abs ( vb ) ; vc += 1.0 ; vc *= vc ; vc = vc * vc - vc ; va = uU ; va . xz += uZ . xz * vc * sign ( vb ) ; va = va - uV ; if ( all ( equal ( va , vec3 ( 0.0 ) ) ) ) uU = uV ; else { vb = length ( uU - uV ) ; uU = uV + normalize ( va ) * vb ; } }".split(" ")},
{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"vec4 vf ( vec4 ve ) { return ve * ve * ( 3.0 - 2.0 * ve ) ; } vec4 vh ( vec4 vg ) { return abs ( fract ( vg + 0.5 ) * 2.0 - 1.0 ) ; } vec4 vj ( vec4 vi ) { return vf ( vh ( vi ) ) ; } void vA ( inout vec3 vk , in float vl , in vec3 vm , in vec3 vn , in vec3 vo , in float vp , in float vq , in float vr , in vec3 vs ) { vec3 vt ; vec4 vu ; vec2 vv , vw ; float vx , vy , vz ; vx = dot ( vo , vec3 ( 1.0 ) ) ; vy = vx + vs . g ; vz = dot ( vk , vec3 ( vs . g ) ) ; vv = ( vl + vec2 ( vz , vy ) ) ; vu = ( ( fract ( ( vv . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( vn ) * vp ; vu = vj ( vu ) ; vw = vu . xz + vu . yw ; vw . y = 0.5 - vw . y ; vt = vw . xyx * vs . rbr * vec3 ( vq * vm . x , vr , vq * vm . z ) ; vk += vt ; }".split(" ")}]}}]},
{type:"textline",b:"void vH ( inout vec3 vB , inout vec3 vC , in vec3 vD ) { vec3 vE , vF , vG ; vE = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:"vF = vC ; vG = a_emitter_center ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vF = vB ; vG = vC ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"vA ( vF , u_time , vD , vE , vG , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail ) ;".split(" ")}]}}]},{type:"textline",b:"vd ( vF , vG , au_wind_bending_amp , au_wind_bending_freq , u_time , vE , a_bending_col_main ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vd ( vF , vG , au_wind_bending_amp , au_wind_bending_freq , u_time , vE , 1.0 ) ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:"vB += vF - vC ; vC = vF ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vB = vF ; vC = vG ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/nodes.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_orco_tex_coord ; varying vec3 hJ ;".split(" ")}]}}]},
{type:"node",name:"TEX_COORD_UV",i:[{type:"node_param",name:"node_TEX_COORD_UV_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"ik",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["ik","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{type:"node",name:"UV_MERGED",i:[{type:"node_param",name:"node_UV_MERGED_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"ij",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["ij","=","node_UV_MERGED_var_a_uv",";"]}]},{type:"node",
name:"UVMAP",i:[{type:"node_param",name:"node_UVMAP_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"il",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["il","=","node_UVMAP_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_UV",i:[{type:"node_param",name:"node_GEOMETRY_UV_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"ic",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["ic","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_VC",i:[{type:"node_param",
name:"node_GEOMETRY_VC_var_a_vertex_color",qualifier:["attribute","vec3"]},{type:"node_param",name:"vI",qualifier:["varying","vec3"]}],g:[{type:"textline",b:["vI","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC1",i:[{type:"node_param",name:"node_GEOMETRY_VC1_var_a_vertex_color",qualifier:["attribute","float"]},{type:"node_param",name:"vJ",qualifier:["varying","float"]}],g:[{type:"textline",b:["vJ","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC2",
i:[{type:"node_param",name:"node_GEOMETRY_VC2_var_a_vertex_color",qualifier:["attribute","vec2"]},{type:"node_param",name:"vK",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["vK","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC3",i:[{type:"node_param",name:"node_GEOMETRY_VC3_var_a_vertex_color",qualifier:["attribute","vec3"]},{type:"node_param",name:"vL",qualifier:["varying","vec3"]}],g:[{type:"textline",b:["vL","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},
{type:"nodes_global"},{type:"textline",b:["void","vM","(",")","{"]},{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["hJ","=","a_orco_tex_coord",";"]}]}}]},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/dynamic_grass.glslv"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"vec2 vR ( vec3 vN , float vO , vec2 vP ) { vec2 vQ ; vQ = vec2 ( ( vN . x - vP . x ) / vO , - ( vN . z - vP . y ) / vO ) ; return fract ( vQ ) ; } vec2 vV ( vec2 vS , float vT , vec2 vU ) { return vec2 ( vS . x * vT , - vS . y * vT ) + vU ; } el vW ( ) { return el ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; } el wr ( vec3 vX , vec3 vY , vec3 vZ , vec3 v_ , vec3 wa , PRECISION sampler2D wb , sampler2D wc , vec3 wd , float we , vec3 wf , vec4 wg , mat4 wh ) { mat4 wi ; vec4 wj ; vec2 wk , wl , wm ; float wn , wo ; vec3 wp ; wp = er ( wg , vec3 ( 0.0 , - 1.0 , 0.0 ) ) ; wn = - wp . x ; wo = - wp . z ; wk = vec2 ( wf . x + we * ( - 1.0 - wn ) / 2.0 , wf . z + we * ( 1.0 - wo ) / 2.0 ) ; wl = vR ( wa , we , wk ) ; wo = we / 2.0 ; wm = abs ( vV ( wl - vec2 ( 0.5 ) , we , vec2 ( 0.0 ) ) ) ; wo = wo * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( wm ) > wo ) return vW ( ) ; wo = we / wd . z ; wm = ( wl - vec2 ( 0.5 ) ) * wo + vec2 ( 0.5 ) ; wp = wp * ( we / wd . z - 1.0 ) / 2.0 ; wm . x += wp . x ; wm . y -= wp . z ; wj = texture2D ( wc , wm ) ; wo = wj . r ; if ( wo < u_scale_threshold ) return vW ( ) ; wn = wd . y - wd . x ; wn = wd . y - texture2D ( wb , wm ) . r * wn ; wm = vX . xz - wa . xz ; wa . xz = vV ( wl , we , wk ) ; wa . y = wn ; vX . xz = wa . xz + wm ; vX . y *= wo ; vX . y += wn ; wp = wj . gba ;".split(" ")},
{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"vX -= wa ; wi = tG ( wf , wa , wh ) ; el wq = tT ( vX , wa , vY , vZ , v_ , wi ) ; wq . b = wa ; wq . f = wp ; return eN ( wq ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return eN ( el ( vX , wa , vY , vZ , v_ , wp ) ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/shadow.glslv"]={type:"group",a:[{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"condition",
a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 wx ( mat4 ws , vec4 wt ) { vec4 wu ; float wv ; vec2 ww ; ww = ( ws * u_v_light_matrix [ 3 ] ) . xy ; wv = SHADOW_TEX_RES / 2.0 ; ww = floor ( ww * wv + 0.5 ) / wv - ww ; wu = ws * wt ; wu . xy += ww ; wu = u_b_light_matrix * wu ; return wu ; } void wB ( vec3 wy , vec3 wz ) { vec4 wA ; wA = u_v_light_matrix * vec4 ( wy + u_normal_offset * wz , 1.0 ) ; e_ = wx ( u_p_light_matrix0 , wA ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"fa = wx ( u_p_light_matrix1 , wA ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"fb = wx ( u_p_light_matrix2 , wA ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"fc = wx ( u_p_light_matrix3 , wA ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/particles.glslv"]=
{type:"group",a:[{type:"var",name:"EPSILON",b:["0.0001"]},{type:"textline",b:"struct wJ { float a ; vec3 b ; float c ; vec3 d ; float e ; } ;".split(" ")},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void wP ( inout float wK , float wL , vec2 wM , vec2 wN ) { float wO ; wO = wN . x - wM . x ; wO = ( wL - wM . x ) / wO ; wK = mix ( wK , wN . y , clamp ( wO , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["COLOR_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void wV ( inout vec3 wQ , float wR , vec4 wS , vec4 wT ) { float wU ; wU = wT . x - wS . x ; wU = ( wR - wS . x ) / wU ; wQ = mix ( wQ , wT . yzw , clamp ( wU , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float xa ( float wW , float wX , vec2 wY [ SIZE_RAMP_LENGTH ] ) { float wZ , w_ ; wZ = wW / wX ; w_ = wY [ 0 ] . y ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",1,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wP ( w_ , wZ , wY [ 0 ] , wY [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",2,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wP ( w_ , wZ , wY [ 1 ] , wY [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",3,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wP ( w_ , wZ , wY [ 2 ] , wY [ 3 ] ) ;".split(" ")}]}}]},
{type:"textline",b:["return","w_",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 xg ( float xb , float xc , vec4 xd [ COLOR_RAMP_LENGTH ] ) { vec3 xe ; float xf ; xf = xb / xc ; xe = xd [ 0 ] . yzw ;".split(" ")},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",1,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wV ( xe , xf , xd [ 0 ] , xd [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["COLOR_RAMP_LENGTH",2,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wV ( xe , xf , xd [ 1 ] , xd [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",3,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"wV ( xe , xf , xd [ 2 ] , xd [ 3 ] ) ;".split(" ")}]}}]},{type:"textline",b:["return","xe",";","}"]}]}}]},{type:"textline",b:"float xo ( float xh , float xi , float xj , float xk ) { float xl , xm , xn ; xl = max ( 0.01 , min ( xi , xj ) ) ; xm = max ( 0.01 , min ( xi , xk ) ) ; xn = xi - xm ; xm = clamp ( xh / xl , 0.0 , 1.0 ) - step ( xn , xh ) * ( xh - xn ) / xm ; return xm ; } wJ xu ( ) { vec3 xp , xq ; float xr , xs ; wJ xt ; if ( u_p_cyclic == 1 ) { xr = mod ( u_p_time , u_p_length ) - a_p_delay ; if ( xr < 0.0 ) xr += u_p_length ; } if ( u_p_cyclic != 1 ) { xr = u_p_time - a_p_delay ; } if ( xr < 0.0 || xr >= a_p_lifetime ) { xt . a = 0.0001 ; xt . b = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( xr < 0.0 || xr >= a_p_lifetime ) ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["WORLD_SPACE"],group:{type:"group",a:[{type:"textline",b:"xp = a_position ; xq = a_normal ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xp = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; xq = ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ;".split(" ")}]}}]},{type:"textline",b:"xp += u_p_nfactor * xr * xq ; xp += a_p_vels . xyz * xr ; xp . y -= u_p_gravity * xr * xr / 2.0 ; xs = max ( u_p_mass , EPSILON ) ; xp += ( u_p_wind / xs ) * xr * xr / 2.0 ; xt . b = xp ; xt . e = a_p_vels . w * xr ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xt . a = xa ( xr , u_p_max_lifetime , u_p_size_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xt . a = 1.0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xt . d = xg ( xr , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"xt . d = vec3 ( 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"xt . c = xo ( xr , a_p_lifetime , u_p_fade_in , u_p_fade_out ) ; } return xt ; }".split(" ")}]};a["include/blending.glslf"]={type:"group",a:[{type:"textline",b:"float xw = 0.0 ; float xx = 1.0 ; vec3 xy = vec3 ( xw ) ; vec3 xz = vec3 ( xx ) ; vec3 xE ( vec3 xA ) { float xB , xC ; vec4 xD ; xD = vec4 ( xw , - xx / 3.0 , 2.0 / 3.0 , - xx ) ; xD = mix ( vec4 ( xA . bg , xD . wz ) , vec4 ( xA . gb , xD . xy ) , step ( xA . b , xA . g ) ) ; xD = mix ( vec4 ( xD . xyw , xA . r ) , vec4 ( xA . r , xD . yzx ) , step ( xD . x , xA . r ) ) ; xB = xD . x - min ( xD . w , xD . y ) ; xC = 1.0e-10 ; return vec3 ( abs ( xD . z + ( xD . w - xD . y ) / ( 6.0 * xB + xC ) ) , xB / ( xD . x + xC ) , xD . x ) ; } vec3 xI ( vec3 xF ) { vec3 xG ; vec4 xH ; xH = vec4 ( xx , 2.0 / 3.0 , xx / 3.0 , 3.0 ) ; xG = abs ( fract ( vec3 ( xF . r , xF . r , xF . r ) + xH . xyz ) * 6.0 - xH . www ) ; return xF . b * mix ( xH . xxx , clamp ( xG - xH . xxx , xw , xx ) , xF . g ) ; } vec3 xM ( vec3 xJ , vec3 xK , float xL ) { return mix ( xJ , xK , xL ) ; } vec3 xQ ( vec3 xN , vec3 xO , float xP ) { return xP * xN + xO ; } vec3 xU ( vec3 xR , vec3 xS , float xT ) { return xS - xT * xR ; } vec3 xZ ( vec3 xV , vec3 xW , float xX ) { float xY ; xY = xx - xX ; return ( vec3 ( xY ) + xX * xV ) * xW ; } vec3 yd ( vec3 x_ , vec3 ya , float yb ) { vec3 yc ; yc = vec3 ( xx - yb ) ; return xz - ( yc + yb * ( xz - x_ ) ) * ( xz - ya ) ; } vec3 yi ( vec3 ye , vec3 yf , float yg ) { vec3 yh ; yh = vec3 ( xx - yg ) ; return mix ( yf * ( yh + 2.0 * yg * ye ) , xz - ( yh + 2.0 * yg * ( xz - ye ) ) * ( xz - yf ) , step ( 0.5 , yf ) ) ; } vec3 ym ( vec3 yj , vec3 yk , float yl ) { return mix ( yk , abs ( yj - yk ) , yl ) ; } vec3 yq ( vec3 yn , vec3 yo , float yp ) { return mix ( yo , yo / ( yn + step ( yn , xy ) ) , yp ) ; } vec3 yu ( vec3 yr , vec3 ys , float yt ) { return mix ( ys , min ( yr , ys ) , yt ) ; } vec3 yy ( vec3 yv , vec3 yw , float yx ) { return max ( yx * yv , yw ) ; } vec3 yE ( vec3 yz , vec3 yA , float yB ) { vec3 yC , yD ; yC = xE ( yA ) ; if ( yC . y != xw ) { yD = xE ( yz ) ; yD = xI ( vec3 ( yC . x , yD . yz ) ) ; return mix ( yz , yD , yB ) ; } return yz ; } vec3 yK ( vec3 yF , vec3 yG , float yH ) { vec3 yI , yJ ; yI = xE ( yF ) ; if ( yI . y != xw ) { yJ = xE ( yG ) ; return xI ( vec3 ( yI . x , mix ( yI . y , yJ . y , yH ) , yI . z ) ) ; } return yF ; } vec3 yQ ( vec3 yL , vec3 yM , float yN ) { vec3 yO , yP ; yO = xE ( yL ) ; yP = xE ( yM ) ; return xI ( vec3 ( yO . xy , mix ( yO . z , yP . z , yN ) ) ) ; } vec3 yW ( vec3 yR , vec3 yS , float yT ) { vec3 yU , yV ; yU = xE ( yS ) ; if ( yU . y != xw ) { yV = xE ( yR ) ; yV = xI ( vec3 ( yU . xy , yV . z ) ) ; return mix ( yR , yV , yT ) ; } return yR ; } vec3 za ( vec3 yX , vec3 yY , float yZ ) { vec3 y_ ; y_ = xz - ( xz - yY ) * ( xz - yX ) ; return mix ( yX , ( ( xz - yX ) * yY * yX ) + yX * y_ , yZ ) ; } vec3 ze ( vec3 zb , vec3 zc , float zd ) { return zb + zd * ( 2.0 * zc - xx ) ; } float zk ( float zf , float zg , float zh , float zi ) { float zj ; zj = xx - zi ; return ( zj + zh * zf ) * zg ; } float zq ( float zl , float zm , float zn , float zo ) { float zp ; zp = xx - zo ; return xx - ( zp + zn * ( xx - zl ) ) * ( xx - zm ) ; } float zw ( float zr , float zs , float zt , float zu ) { float zv ; zv = xx - zu ; return mix ( zs * ( zv + 2.0 * zt * zr ) , xx - ( zv + 2.0 * zt * ( xx - zr ) ) * ( xx - zs ) , step ( 0.5 , zs ) ) ; }".split(" ")}]};
a["include/depth_fetch.glslf"]={type:"group",a:[{type:"textline",b:"float zI ( in sampler2D zC , in vec2 zD , in vec2 zE ) { float zF , zG , zH ; zF = texture2D ( zC , zD ) . r ; zG = zE . x ; zH = zE . y ; zG = 2.0 * zG / ( zG + zH - ( 2.0 * zF - 1.0 ) * ( zH - zG ) ) ; return zG ; }".split(" ")}]}};b4w.module.__objects=function(a,y){function e(a){a={type:a,Oc:0,FF:[0,0],h:new Float32Array(3),quat:new Float32Array(4),Pb:new Float32Array(8),Z:new Float32Array(16),Hw:new Float32Array(16),cc:new Float32Array(3),lc:new Float32Array(3),vi:0,wi:0,mq:!1,Nl:null,ee:0,Tr:!1,Gz:!1,Da:C.ld,ps:1,os:1,qs:1,dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,Me:null,xz:!1,Le:0,Lg:0,hb:!1,kc:null,qc:null,Mb:null,pp:!0,J:null,uk:null,Mc:null,Xc:null,Cc:null,$j:0,Tj:0,Dp:0,pk:0,hh:0,Nx:"",En:!1,cd:!1,Gc:!1,Fc:!1,
nc:!1,dc:!1,$c:!1,af:"",Ee:!1,kd:!1,Xl:!1,Vd:!1,Lb:!1,ii:!1,ui:!1,Bm:!1,Ah:!1,Km:!1,Vb:!1,Jm:!1,ux:!1,xm:!1,zm:!1,Fp:!1,cl:0,qe:0,qf:0,Ie:0,He:0,Ce:0,Ye:"",Zb:null,El:!1,Sd:!1,wo:!1,Aj:"",zj:!1,Pg:0,time:0,ms:0,Jz:0,Ze:0,Zj:!1,In:!1,oe:!1,cg:[],zi:!1,xf:!1,wf:1,ho:0,fo:1,Bn:new Int8Array([-1,-1]),un:[],ix:[],Ty:[],Zc:null,Yc:null,jd:null,hd:null,pd:null,Px:null,oo:null,no:null,Tf:null,jh:null,Cm:null,de:null,ih:null,Dm:null,hc:null,to:null,ro:null,so:null,sb:null,xd:null,Kb:null,Bg:null,Cg:null,scale:1,
Qf:1E4};E.identity(a.quat);B.identity(a.Pb);K.identity(a.Z);K.identity(a.Hw);return a}function c(a){var b=a.parent;if(b&&b.Qh)return!0;switch(a.type){case "MESH":var d=g.um(a),c=a.b4w_do_not_batch,f=a.b4w_collision,e=a.b4w_vehicle,k=a.b4w_floating,b=a.b4w_character,n=r.JF(a),p=A.Aw(a),h=0<a.data.b4w_shape_keys.length,t=a.b4w_dynamic_geometry;if(!(d=d||c||f||e||h||k))a:{a=a.data;for(d=0;d<a.materials.length;d++)if("LENS_FLARES"===a.materials[d].name){d=!0;break a}d=!1}return d||n||b||p||t;case "EMPTY":return b=
g.um(a),n=A.Aw(a),a=a.b4w_do_not_batch,b||n||a;default:return!0}}function b(a,d,c,f,e,g,k,n,r){for(var p=0;p<a.nodes.length;p++){var t=a.nodes[p];if("VALUE"==t.type){var l=d+t.name;f.push(t.outputs[0].default_value);e.push(l,e.length/2)}else"RGB"==t.type?(l=d+t.name,t=t.outputs[0].default_value.slice(0,3),k.push(t[0],t[1],t[2]),n.push(l,n.length/2)):"GROUP"==t.type&&(l=t.node_group.node_tree,b(l,d+t.name+"%join%",l.animation_data,f,e,g,k,n,r))}if(c)for((a=c.action)&&h(a,d,g,e,r,n),c=c.nla_tracks,
f=0;f<c.length;f++)for(k=c[f].strips,p=0;p<c[f].strips.length;p++)a=k[p].action,h(a,d,g,e,r,n)}function h(a,b,d,c,f,e){var g=a.e.eb,k;for(k in g){var n=b+k.match(/"(.*?)"/)[1],g=m(c,n);null!=g?(n=a.name+"%join%"+k,d.push(n,g)):(g=m(e,n),null!=g&&(n=a.name+"%join%"+k,f.push(n,g)))}}function m(a,b){for(var d=0;d<a.length;d+=2)if(a[d]==b)return a[d+1];return null}function q(a,b,d){return{name:a,type:b,modifiers:[],particle_systems:[],constraints:[],data:null,parent:null,b4w_vehicle_settings:null,b4w_floating_settings:null,
b4w_character_settings:null,b4w_vehicle:!1,b4w_character:!1,b4w_floating:!1,o:[],AB:d,nd:[],vf:[],xe:[],vd:null,kb:null,od:null,l:null,D:[],n:null,k:null,rb:null,sl:null,Fa:null,kt:[]}}function u(a){return a instanceof Array?a.slice():a}function w(a){if(!(a instanceof Object))return a;var b=null,d=null,c=null;a.X&&(b=a.X,a.X=null);a.fd&&(d=a.fd,a.fd=null);a.ca&&(c=a.ca,a.ca=null);var f;f=a.constructor;switch(f){case Float32Array:case Uint32Array:case Uint16Array:f=new f(a);break;case Array:f=new f(a.length);
for(var e=0;e<a.length;e++)f[e]=w(a[e]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:f=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:f=null;break;case Function:f=a;break;default:for(e in f=new f,a)f[e]=w(a[e])}b&&(f.X=b,a.X=b);d&&(f.fd=d,a.fd=d);c&&(f.ca=c,a.ca=c);return f}var g=y("__animation"),l=y("__batch"),z=y("__boundings"),C=y("__camera"),F=y("__config"),G=y("__constraints"),D=y("__curve"),H=y("__geometry"),x=y("__lights"),A=y("__nla"),r=y("__particles"),
k=y("__print"),d=y("__scenes"),n=y("__transform"),B=y("__tsr"),I=y("__util"),E=y("quat"),M=y("vec3"),K=y("mat4"),J=F.Vb,f=0,p=0,t=[],L=new Float32Array(4);a.Rl=e;a.Dn=function(a,r){var h=c(a);a.Qh=h;a.e=e("MESH"===a.type?h?"DYNAMIC":"STATIC":a.type);a.AB=!1;a.kb=null;a.nd=[];a.D=[];a.n=null;a.k=null;a.rb=null;a.sl=a.sl||null;a.Fa=a.Fa||null;a.kt=a.kt||[];var h=a.e,m=a.location,u=a.scale[0];I.br(a.rotation_quaternion,L);n.Hd(a,m);n.gf(a,L);n.ge(a,u);switch(a.type){case "ARMATURE":m=a.pose.bones;for(u=
0;u<m.length;u++){var w=m[u],A=w.bone,y=new Float32Array(A.matrix_local),H=new Float32Array(16);K.invert(y,H);var F=new Float32Array(w.matrix_basis),ba=new Float32Array(3);M.subtract(A.tail_local,A.head_local,ba);I.FJ(ba,H,ba);w.FB=ba;w.yB=[w].concat(w.parent_recursive);w.mt=B.cm(y,B.create());w.lt=B.cm(F,B.create());w.ao=B.create();w.ul=!1}m=g.xC(a);h.pd=m;m=g.Tt(a,m);a.b4w_animation_mixing?(h.Zc=new Float32Array(m.Ia),h.Yc=new Float32Array(m.Ia),h.jd=new Float32Array(m.h),h.hd=new Float32Array(m.h)):
(h.Zc=m.Ia,h.Yc=m.Ia,h.jd=m.h,h.hd=m.h);h.Px=m;h.Pg=0;h.xf=a.b4w_animation_mixing;break;case "MESH":h.Ah=J.outlining_overview_mode||a.b4w_selectable;h.Km=a.b4w_selectable;h.Vb=J.outlining_overview_mode||a.b4w_outlining;h.Jm=a.b4w_outlining;h.ux=J.outlining_overview_mode||a.b4w_outline_on_select;h.Sd=a.b4w_billboard;h.wo=a.b4w_pres_glob_orientation;h.Aj="BASIC";h.zj="SPHERICAL"==a.b4w_billboard_geometry;h.uk={Lm:a.b4w_outline_settings.outline_duration,Mm:a.b4w_outline_settings.outline_period,Nm:a.b4w_outline_settings.outline_relapses};
h.Ah&&(a.e.Nl=I.qv(f),f++);if("MESH"!=a.type)throw"Wrong object type: "+a.name;a.e.In=a.data.b4w_vertex_anim.length?!0:!1;if("MESH"!=a.type)throw"Wrong object type: "+a.name;u=a.e;if(a.data.b4w_shape_keys.length)for(u.oe=!0,m=0;m<a.data.b4w_shape_keys.length;m++)w={},w.value=a.data.b4w_shape_keys[m].value,w.name=a.data.b4w_shape_keys[m].name,u.cg.push(w);else u.oe=!1;if(u=g.dk(a)){a.sl=u;m=a.e;A=a.data.vertex_groups;if(A.length){y=u.data.bones;H=u.pose.bones;F=0;w={};for(ba=0;ba<y.length;ba++){var V=
y[ba].name,aa=I.vb("name",V,A);if(aa){var Y=I.Qp(H,"name",V);w[V]={Rt:ba,Mj:F++,Xq:Y,Nz:aa.index}}}A=F;m.pd=w;w=g.Uv();m.Ze=A;A>2*w?(m.zi=!1,k.error('too many bones for "'+a.name+'" / '+m.Ze+" bones (max "+w+" with blending, "+2*w+" without blending). Skinning will be disabled.")):m.zi=!0}m=a.e.pd;m=g.Tt(u,m);u.b4w_animation_mixing?(h.Zc=new Float32Array(m.Ia),h.Yc=new Float32Array(m.Ia),h.jd=new Float32Array(m.h),h.hd=new Float32Array(m.h)):(h.Zc=m.Ia,h.Yc=m.Ia,h.jd=m.h,h.hd=m.h);h.oo=new Float32Array(4);
h.no=E.create();h.Px=m;h.Pg=0}u=a.e;m=a.data.materials;w=[];A=[];y=[];H=[];F=[];ba=[];for(V=0;V<m.length;V++)aa=m[V],(Y=aa.node_tree)&&b(Y,aa.name+"%join%",Y.animation_data,w,A,y,H,F,ba);u.Tf=w;u.jh=A;u.Cm=y;u.de=H;u.ih=F;u.Dm=ba;a.o=[];h.cd=a.b4w_shadow_cast;h.Gc=a.b4w_shadow_receive;h.Fc=a.b4w_shadow_cast_only&&h.cd;h.nc=a.b4w_reflexible;h.dc=a.b4w_reflexible_only&&h.nc;h.$c=a.b4w_reflective;h.af=a.b4w_reflection_type;a.$n=null;if(a.b4w_reflective)if(u=a.e,"CUBE"==a.b4w_reflection_type)u.Mc=p++;
else{a:{m=a.constraints;for(w=0;w<m.length;w++)if(A=m[w],"LOCKED_TRACK"==A.type&&"REFLECTION PLANE"==A.name){m=A.target;break a}m=null}m||(m=q(I.Vk("%reflection%"),"EMPTY",!1),w=e("EMPTY"),m.e=w,G.ko(m,a,[0,0,0],null,1));w=null;for(A=0;A<t.length;A++)if(t[A]==m){w=A;break}null==w?(t.push(m),u.Xc=t.length-1):u.Xc=w;a.$n=m}h.Ee=a.b4w_caustics;h.kd=a.b4w_wind_bending;h.cl=a.b4w_wind_bending_angle;u=l.MJ(a.b4w_wind_bending_angle,l.mC(a.data.b4w_bounding_box),a.scale[0]);h.qe=u;h.qf=a.b4w_wind_bending_freq;
h.Ie=a.b4w_detail_bending_freq;h.He=a.b4w_detail_bending_amp;h.Ce=a.b4w_branch_bending_amp;h.ui=!1;h.Ye=a.b4w_main_bend_stiffness_col;u=a.b4w_detail_bend_colors;h.Zb={};h.Zb.$w=u.leaves_stiffness_col;h.Zb.Zw=u.leaves_phase_col;h.Zb.wx=u.overall_stiffness_col;h.ii=a.b4w_do_not_cull;h.Xl=a.b4w_disable_fogging;h.Vd=a.b4w_dynamic_geometry;if("MESH"!==a.type)throw"Wrong object";u=a.data.materials[0];h.$j=u.physics.friction;h.Tj=u.physics.elasticity;h.pk=0;h.Qf=1E4;h.hh=a.b4w_lod_transition;h.Bm=!0;break;
case "CAMERA":C.BC(a);C.hC(a);break;case "LAMP":x.fG(a);break;case "CURVE":if(u=D.GD(a))a.EB=u;break;case "EMPTY":h.hc=z.re(),u=z.dl(),h.xd=u}if(!r&&(a.parent&&"OBJECT"==a.parent_type?(m=h.h,w=h.quat,u=h.scale,G.ko(a,a.parent,m,w,u)):a.parent&&"BONE"==a.parent_type&&"ARMATURE"==a.parent.type?(m=h.h,w=h.quat,u=h.scale,G.tt(a,a.parent,a.parent_bone,m,w,u)):a.Fa&&a.Fa.b4w_group_relative?(u=B.Cf(h.h,h.scale,h.quat),G.JB(a,a.Fa,u)):a.Fa&&!a.Fa.b4w_group_relative&&(n.w(a),B.multiply(a.Fa.e.Pb,a.e.Pb,a.e.Pb),
n.Hd(a,B.ri(a.e.Pb)),n.ge(a,B.Vg(a.e.Pb)),n.gf(a,B.qi(a.e.Pb))),u=a.dupli_group))for(m=u.objects,u=0;u<m.length;u++)m[u].Fa=a;a.field&&(h.Dp=a.field.strength,d.Cz(a));h.En=a.game.use_collision_compound;h.Nx=a.game.physics_type;n.w(a)};a.iJ=function(a){for(var b=0;b<a.length;b++){var d=a[b];!d.e||"DYNAMIC"!=d.e.type&&"CAMERA"!=d.e.type||n.w(d);d.b4w_use_default_animation&&g.um(d)&&(g.mo(d),d.D.length&&g.play(d,null,g.Wn))}};a.Sc=function(a){return a.Qh?!0:!1};a.nq=function(a){return"MESH"==a.type&&
a.Qh?!0:!1};a.ek=function(a){a=a.b4w_object_tags;return{title:a?a.title:"",description:a?a.description:"",YL:a?a.category:""}};a.aa=function(){p=f=0;t=[]};a.Fw=q;a.copy=function(a,b,d){b=q(b,a.type,!1);var c=[];if(d){for(var e=0;e<a.o.length;e++)a.o[e].Og||(b.o.push(w(a.o[e])),c.push(a.o[e].ja));for(e=0;e<a.o.length;e++)if(a.o[e].Og){var g=w(a.o[e]);b.o.push(g);for(var k=0;k<c.length;k++)c[k]==a.o[e].ja&&(g.ja=b.o[k].ja)}}else b.o=u(a.o);b.e=w(a.e);a.Qh&&(b.Qh=a.Qh);a.Fa&&(b.Fa=a.Fa);a.xe&&(b.xe=
u(a.xe));!a.n||a.b4w_vehicle||a.b4w_character||a.b4w_floating||(b.n=w(a.n));b.game=w(a.game);b.b4w_collision_id=a.b4w_collision_id;b.b4w_correct_bounding_offset=a.b4w_correct_bounding_offset;b.b4w_collision=a.b4w_collision;b.data=a.data;b.particle_systems=d?w(a.particle_systems):u(a.particle_systems);if(d)for(e=0;e<b.o.length;e++){b.o[e].ja&&H.eJ(b.o[e].ja);if("PARTICLES"==b.o[e].type&&b.o[e].ar)for(k=0;k<b.iP.length;k++)if(b.particle_systems[k].name==b.o[e].ar){b.o[e].Wc=b.particle_systems[k];break}b.o[e].Ji=
b.uuid;l.XI(b.o[e],I.Zh(b.e,0))}b.uuid=I.sv();b.e.mq=!0;b.e.Nl=I.qv(f);f++;return b};a.vu=w;a.aO=function(a,b){for(var d=a.e.jh,c=0;c<d.length;c+=2)if(d[c]==b)return d[c+1];return null};a.QN=function(a,b){for(var d=a.e.ih,c=0;c<d.length;c+=2)if(d[c]==b)return d[c+1];return null}};b4w.module.__curve=function(a,y){function e(a,b,c,e,g){var h=e.length;g||(g=new Float32Array(h));for(var z=h+a,y=new Float32Array(z),F=1;F<=z-1;F++)y[F-1]=b>=c[F-1]&&b<c[F+1-1]?1:0;for(var G=2;G<=a;G++)for(F=1;F<=z-G;F++)y[F-1]=(0!=y[F-1]?(b-c[F-1])*y[F-1]/(c[F+G-1-1]-c[F-1]):0)+(0!=y[F+1-1]?(c[F+G-1]-b)*y[F+1-1]/(c[F+G-1]-c[F+1-1]):0);b==c[z-1]&&(y[h-1]=1);a=0;for(F=1;F<=h;F++)a+=y[F-1]*e[F-1];for(F=1;F<=h;F++)g[F-1]=0!=a?y[F-1]*e[F-1]/a:0;return g}function c(a){a=a.Am;return a[a.length-1]}function b(a){a=
a.Mu;return a[a.length-1]}var h=y("__util");a.GD=function(a){var b={},c=a.data;a=c.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var h=a.order_u;b.Vf=h;a=a.points;var g=a.length/5,l=[],z=g+h,g=g+2;l[0]=0;for(var y=2;y<=z;y++)l[y-1]=y>h&&y<g?l[y-2]+1:l[y-2];b.Am=l;if("2D"==c.dimensions)b.Of=!1;else if("3D"==c.dimensions)b.Of=!0;else throw"Wrong curve dimensions";h=[];l=[];for(c=0;c<a.length;c+=5)h.push(a[c]),h.push(a[c+1]),h.push(a[c+2]),b.Of&&h.push(a[c+3]),l.push(a[c+4]);b.To=
h;b.xs=l;a=[];for(var c=b.To,h=b.Of?4:3,l=b.xs,z=b.Am,g=b.Vf,y=c.length/h,F=y+g,G=0,D=z[F-1]/999,H=0;1E3>H;H++){5E-6>z[F-1]-G&&(G=z[F-1]);for(var x=e(g,G,z,l),A=0;A<h;A++)for(var r=a[h*H+A]=0;r<y;r++)a[h*H+A]+=x[r]*c[h*r+A];G+=D}h=b.Of?4:3;l=new Float32Array(1E3);l[0]=0;for(c=1;1E3>c;c+=1)z=a[(c-1)*h],g=a[(c-1)*h+1],y=a[(c-1)*h+2],F=a[c*h],G=a[c*h+1],D=a[c*h+2],l[c]=l[c-1]+Math.sqrt((F-z)*(F-z)+(G-g)*(G-g)+(D-y)*(D-y));b.Mu=l;return b};a.xI=function(a,b,h){h||(h=[]);var w=b,g=Math.max(w,0);b=g=Math.min(w,
c(a));var w=a.To,g=a.Of?4:3,l=a.xs,z=a.Am,y=a.Vf;a=w.length/g;var F=a+y;5E-6>z[F-1]-b&&(b=z[F-1]);F=new Float32Array(a);e(y,b,z,l,F);for(b=0;b<g;b++)for(l=h[b]=0;l<a;l++)h[b]+=F[l]*w[g*l+b]};a.uI=function(a,b,c){c||(c=[]);var e=a.To,g=a.Of?4:3,h=a.xs,z=a.Am,y=a.Vf;a=e.length/g;var F=a+y;5E-6>z[F-1]-b&&(b=z[F-1]);var F=new Float32Array(a),G=b;b=F;var D=h.length;b||(b=new Float32Array(D));var H=new Float32Array(D),x=new Float32Array(D),A=H,r=x;A||(A=new Float32Array(D));r||(r=new Float32Array(D));for(var k=
D+y,d=new Float32Array(k),n=new Float32Array(k),B=1;B<=k-1;B++)d[B-1]=G>=z[B-1]&&G<z[B+1-1]?1:0;G==z[k-1]&&(d[D-1]=1);for(var I=2;I<=y;I++)for(B=1;B<=k-I;B++){var E=0!=d[B-1]?d[B-1]/(z[B+I-1-1]-z[B-1]):0,M=0!=d[B+1-1]?-d[B+1-1]/(z[B+I-1]-z[B+1-1]):0,K=0!=n[B-1]?(G-z[B-1])*n[B-1]/(z[B+I-1-1]-z[B-1]):0,J=0!=n[B+1-1]?(z[B+I-1]-G)*n[B+1-1]/(z[B+I-1]-z[B+1-1]):0;d[B-1]=(0!=d[B-1]?(G-z[B-1])*d[B-1]/(z[B+I-1-1]-z[B-1]):0)+(0!=d[B+1-1]?(z[B+I-1]-G)*d[B+1-1]/(z[B+I-1]-z[B+1-1]):0);n[B-1]=E+M+K+J}for(B=1;B<=
D;B++)A[B-1]=d[B-1],r[B-1]=n[B-1];z=0;for(y=1;y<=D;y++)z+=H[y-1]*h[y-1];G=0;for(y=1;y<=D;y++)G+=x[y-1]*h[y-1];for(y=1;y<=D;y++)b[y-1]=0!=z?x[y-1]*h[y-1]/z+H[y-1]*h[y-1]*G/(z*z):0;for(h=0;h<g;h++)for(z=c[h]=0;z<a;z++)c[h]+=F[z]*e[g*z+h]};a.wQ=c;a.wI=b;a.vI=function(a,e){if(0>=e)return 0;var u=c(a);if(e>=b(a))return u;var w=a.Mu,g=h.Fl(w,e,0,w.length-1);return u*(g+(e-w[g])/(w[g+1]-w[g]))/1E3}};b4w.module.__lights=function(a,y){function e(a){return{name:"",index:0,type:a,direction:new Float32Array(3),color:new Float32Array(3),bi:new Float32Array(3),ie:0,Wi:0,RE:!1,fE:!1,Hh:!0,mg:!0,Vj:1,distance:25,VM:"INVERSE_SQUARE"}}function c(a){a.bi[0]=a.color[0]*a.Vj;a.bi[1]=a.color[1]*a.Vj;a.bi[2]=a.color[2]*a.Vj}var b=y("__util"),h=y("vec3");a.vO=e;a.fG=function(a){var q=a.data,u=e(q.type);u.name=a.name;u.Hh=q.use_diffuse;u.mg=q.use_specular;var w=b.va(a.e.quat,b.jb,[]);h.normalize(w,w);u.direction[0]=
w[0];u.direction[1]=w[1];u.direction[2]=w[2];u.color[0]=q.color[0];u.color[1]=q.color[1];u.color[2]=q.color[2];u.Vj=q.energy;c(u);u.distance=q.distance;if("POINT"===u.type||"SPOT"===u.type)u.distance=q.distance;"SPOT"===u.type?(u.Wi=q.spot_blend,u.ie=q.spot_size):"POINT"===u.type&&(u.ie=Math.PI/2);u.RE=q.b4w_generate_shadows;u.fE=q.b4w_dynamic_intensity;a.rb=u};a.TP=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];c(a)};a.WP=function(a,b){a.Wi=b};a.UP=function(a,b){a.distance=b};a.XP=
function(a,b){a.ie=b};a.VP=function(a,b){a.Vj=b;c(a)};a.ZF=function(a){return"LAMP"===a.type?!0:!1};a.gJ=function(a){if("LAMP"!=a.type)throw"Wrong light object";var c=a.rb;c&&(b.va(a.e.quat,b.jb,c.direction),h.normalize(c.direction,c.direction))}};b4w.module.__nla=function(a,y){function e(){return{type:"CLIP",M:0,ba:0,df:!1,paused:!1,xg:"",yj:"",Yb:0,vj:0,uj:0,cv:0,bv:0,cj:!1,Hz:!1,scale:1,repeat:1}}function c(a,b){if(a.animation_data){var d=a.animation_data.nla_tracks;if(d)for(var e=0;e<d.length;e++)b.push(d[e])}d=a.nodes;for(e=0;e<d.length;e++){var g=d[e];g.node_group&&(g=g.node_group.node_tree)&&c(g,b)}}function b(a,b){for(var d=a.b4w_nla_script,c=b.Zf,e=0;e<d.length;e++){var g=d[e];switch(g.type){case "PLAY":c.push({type:"PLAY",M:g.frame_range[0],
ba:g.frame_range[1],Nf:!1});break;case "SELECT":case "SELECT_PLAY":var k=A.$d(A.tg,g.object,0),h=A.vF(a),n=h.indexOf(k);if(-1==n){x.error("NLA script error: non-selectable object");return}for(var g={type:g.type,Zy:"SELECT"==g.type?g.target_slot:e+1,iI:e+1,$f:-1,EH:h.length,DH:n,M:g.frame_range[0],ba:g.frame_range[1],Nf:!1},n=[],r=0;r<h.length;r++)n.push(D.Zo(h[r],!0));D.R(k,"NLA_SELECT_"+e,D.Nd,n,D.UD,function(a,d,c,f){if(!(b.Tb>=b.Zf.length)&&(c=b.Zf[b.Tb],"SELECT"==c.type||"SELECT_PLAY"==c.type&&
!c.Nf)){for(c=0;c<f.EH;c++)if(D.vc(a,d,c)&&c==f.DH){f.$f=1;return}f.$f=0}},g);c.push(g);break;case "JUMP":c.push({type:"JUMP",Er:g.target_slot});break;case "CONDJUMP":c.push({type:"CONDJUMP",Er:g.target_slot,dD:g.condition,Ik:g.register1,Jk:g.register2,Oq:g.number1,Pq:g.number2});break;case "REGSTORE":c.push({type:"REGSTORE",gH:g.registerd,JG:g.number1});break;case "MATH":c.push({type:"MATH",LG:g.operation,Ik:g.register1,Jk:g.register2,Oq:g.number1,Pq:g.number2,Mi:g.registerd});break;case "SHOW":case "HIDE":k=
A.$d(A.tg,g.object,0);c.push({type:g.type,Ac:k});break;case "REDIRECT":c.push({type:"REDIRECT",url:g.url});break;case "PAGEPARAM":c.push({type:"PAGEPARAM",NG:g.param_name,Mi:g.registerd});break;case "NOOP":c.push({type:"NOOP"})}}}function h(a,b,d,c){if(a.Zf.length){if(a.Tb>=a.Zf.length)if(a.sc)a.Tb=0;else{a.ta-=B.Pa*d;return}var e=q(a,b,!1,c),g=a.Zf[a.Tb];switch(g.type){case "PLAY":g.Nf?e>=g.ba&&(g.Nf=!1,a.Tb++,h(a,b,d,c)):(a.ta+=g.M-e,g.Nf=!0,m(a,g));break;case "SELECT":case "SELECT_PLAY":-1<g.$f?
"SELECT"==g.type||"SELECT_PLAY"==g.type&&0==g.$f?(a.Tb=g.$f?g.Zy:g.iI,g.$f=-1,h(a,b,d,c)):g.Nf?e>=g.ba&&(g.Nf=!1,a.Tb=g.Zy,g.$f=-1,h(a,b,d,c)):(a.ta+=g.M-e,g.Nf=!0,m(a,g)):a.ta-=B.Pa*d;break;case "JUMP":a.Tb=g.Er;h(a,b,d,c);break;case "CONDJUMP":var e=-1==g.Ik?g.Oq:a.fe[g.Ik],n=-1==g.Jk?g.Pq:a.fe[g.Jk],r=!1;switch(g.dD){case "EQUAL":e==n&&(r=!0);break;case "NOTEQUAL":e!=n&&(r=!0);break;case "LESS":e<n&&(r=!0);break;case "GREATER":e>n&&(r=!0);break;case "LEQUAL":e<=n&&(r=!0);break;case "GEQUAL":e>=
n&&(r=!0)}r?a.Tb=g.Er:a.Tb++;h(a,b,d,c);break;case "REGSTORE":a.fe[g.gH]=g.JG;a.Tb++;h(a,b,d,c);break;case "MATH":e=-1==g.Ik?g.Oq:a.fe[g.Ik];n=-1==g.Jk?g.Pq:a.fe[g.Jk];switch(g.LG){case "ADD":a.fe[g.Mi]=e+n;break;case "MUL":a.fe[g.Mi]=e*n;break;case "SUB":a.fe[g.Mi]=e-n;break;case "DIV":0==n&&k.ma("Division by zero in NLA script"),a.fe[g.Mi]=e/n}a.Tb++;h(a,b,d,c);break;case "SHOW":A.Ar(g.Ac);a.Tb++;h(a,b,d,c);break;case "HIDE":A.ik(g.Ac);a.Tb++;h(a,b,d,c);break;case "REDIRECT":window.location.href=
g.url;a.Zf.length=0;break;case "PAGEPARAM":a:{e=location.href.toString();if(-1!=e.indexOf("?"))for(e=e.split("?")[1].split("&"),n=0;n<e.length;n++)if(r=e[n].split("="),1<r.length&&r[0]==g.NG){e=Number(r[1]);break a}e=0}a.fe[g.Mi]=e;a.Tb++;h(a,b,d,c);break;case "NOOP":a.Tb++,h(a,b,d,c)}}}function m(a,b){for(var d=a.Zf,c=0;c<d.length;c++){var e=d[c];e!=b&&(e.$f=-1)}}function q(a,b,d,c){b=(b-c)*B.Pa+a.ta-a.M;a.sc&&d&&(b%=a.ba-a.M+1);return b+=a.M}function u(a,b){a=k.qa(a,b.M,b.ba);var d=a-b.M,c=(b.ba-
b.M)/b.repeat,d=d/c&&0==d%c?b.uj:b.vj+d%c/b.scale;b.Hz&&(d=b.uj-d+b.vj);return d}function w(a,b,d){b?n.OG(a.name,d):(n.sH(a.name,d),n.VG(a.name,d))}function g(a,b){for(var d=[],c=0;c<a.length;c++){var g=a[c].strips;if(g)for(var k=0;k<g.length;k++){var n=g[k],h=e();h.type=n.type;h.M=n.frame_start;h.ba=n.frame_end;h.Yb=b;h.vj=n.action_frame_start;h.uj=n.action_frame_end;h.Hz=n.use_reverse;h.scale=n.scale;h.repeat=n.repeat;n.action&&(h.xg=n.action.name,h.yj=n.action.uuid);d.push(h)}}return d}function l(a){return r.Ve(a)&&
a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function z(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var d=a[b],c=d.node_tree;if(d=d.use_nodes&&c)a:{if(c.animation_data&&(d=c.animation_data.nla_tracks)&&d.length){d=!0;break a}c=c.nodes;for(d=0;d<c.length;d++);d=!1}if(d)return!0}return!1}function C(a,b){var d=A.p();d.oa&&(d.oa.ta-=q(d.oa,b,!0,M)-a,d.oa.Ep=!0)}var F=y("__animation"),G=y("__camera"),D=y("__controls"),H=y("__config");
y("__loader");var x=y("__print"),A=y("__scenes"),r=y("__sfx"),k=y("__util"),d=y("__lights"),n=y("__textures"),B=H.ze,I=H.r,E=[],M=-1;a.kJ=function(a,n,f){n={M:a.frame_start,ba:a.frame_end,ta:0,ok:-1,$m:a.frame_end,er:a.frame_start,kj:null,Oc:f,sc:n,$e:[],X:[],Zf:[],mk:!1,Ep:!1,zP:a.name,Tb:0,fe:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}};a.oa=n;b(a,n);for(var h=A.Ab(a,"ALL",A.L),t=0;t<h.length;t++){var m=h[t],q=0,u=[];if((f=m.animation_data)&&f.nla_tracks.length){var w=f.nla_tracks;if(k.Se(m)||G.Te(m)||
k.ac(m)||k.vm(m)||d.ZF(m)||r.Ve(m))w=g(w,q),w.length&&(u=u.concat(w),q++)}l(m)&&(w=m.data.animation_data.nla_tracks,w=g(w,q),w.length&&(u=u.concat(w),q++));if(F.GF(m)){var z=m.data.materials;for(f=0;f<z.length;f++){var B=z[f].node_tree;if(B&&(w=[],c(B,w),w=g(w,q),w.length)){for(var B=q,y=w,C=F.vv(),M=[],H=0,D=0;D<y.length;D++){var ba=y[D];""!=ba.yj?ba=k.vb("uuid",ba.yj,C):(ba=ba.xg,ba=k.vb("name",ba,C)||k.vb("name",ba+"_B4W_BAKED",C));var ba=ba.fcurves,V=[],aa;for(aa in ba)V.push(aa);M.push(V)}for(D=
0;D<M.length;D++){C=!1;for(ba=0;ba<D;ba++)if(k.eC(M[D],M[ba])){y[D].Yb=y[ba].Yb;C=!0;break}C||(y[D].Yb=q+H++)}q=B+H;u=u.concat(w)}}}for(f=0;f<m.particle_systems.length;f++)w=m.particle_systems[f],z=w.settings,"EMITTER"==z.type&&z.b4w_allow_nla&&(z=e(),z.type="CLIP",z.M=n.M,z.ba=n.ba+1,z.xg=w.name,z.Yb=q,z.vj=z.M,z.uj=z.ba,u.push(z),q++);w=q+1;if(k.ac(m)&&m.data)for(f=0;f<m.data.b4w_vertex_anim.length;f++)B=m.data.b4w_vertex_anim[f],B.allow_nla&&(q=w,z=e(),z.type="CLIP",z.M=n.M,z.ba=n.ba+1,z.xg=B.name,
z.Yb=q,z.vj=z.M,z.uj=z.ba,u.push(z));u.length&&(m.Zn=u,n.$e.push(m))}a=a.e.nj;for(f=0;f<a.length;f++)if(aa=a[f].e,aa.Va||aa.Qi)z=e(),z.type="VIDEO",h=1,I.ud&&(h=aa.uc),z.M=Math.min(aa.M*h,n.ba),z.ba=aa.Gh?n.ba:Math.min((aa.mi+aa.M+aa.ta)*h,n.ba),z.xg=a[f].name,aa.BB=z,n.X.push(aa);a=n.M;f=n.ba;for(aa=0;aa<n.$e.length;aa++)for(h=n.$e[aa],t=h.Zn,m=0;m<t.length;m++)u=t[m],z=h.name+" ["+u.M+":"+u.ba+"]",u.M=Math.max(a,u.M),u.ba=Math.min(f+1,u.ba),u.M>u.ba?(x.warn("NLA: out of scene range: "+z),t.splice(m,
1),m--):u.xg||"CLIP"!=u.type||(x.warn('NLA: no action in strip for object "'+h.name+'".'),t.splice(m,1),m--);for(a=0;a<n.$e.length;a++)for(f=n.$e[a].Zn,aa=0;aa<f.length;aa++){h=f[aa];t=n.M;m=n.ba+1;for(u=0;u<f.length;u++)z=f[u],h.Yb==z.Yb&&(z.ba<=h.M&&(t=h.M),z.M>=h.ba&&(m=Math.min(m,z.M)));h.cv=t;h.bv=m}E.push(n)};a.start=function(){M=0};a.update=function(a,b){if(!(0>M)){0==M&&(M=a);for(var d=0;d<E.length;d++){var c=E[d];if(c.mk&&(c.ta-=B.Pa*b,!c.Ep))continue;c.Ep=!1;h(c,a,b,M);var e=q(c,a,!0,M);
if(e>=c.$m)if(c.sc)c.kj&&c.kj(),C(c.er,a),e=q(c,a,!0,M);else{c.mk=!0;c.ta-=e-c.$m;c.kj&&c.kj();continue}for(var g=0;g<c.$e.length;g++){for(var k=c.$e[g],n=k.Zn,l=0;l<n.length;l++){var m=n[l];"SOUND"==m.type&&e<c.ok-1E-6&&(m.df=!1)}for(l=0;l<n.length;l++)switch(m=n[l],m.type){case "CLIP":if(m.cv<=e&&e<m.bv&&!m.df){var x=k,z=m;""!=z.yj?F.YB(x,z.yj,z.Yb):F.apply(x,z.xg,z.Yb);F.fn(x,F.Nn,z.Yb);var A=u(z.M,z);F.ag(x,A,z.Yb);for(x=0;x<n.length;x++)n[x]!=m&&n[x].Yb==m.Yb&&(n[x].df=!1);m.df=!0}m.df&&(x=k,
z=u(e,m),A=F.Np(x,m.Yb),1E-6<Math.abs(z-A)&&F.ag(x,z,m.Yb));break;case "SOUND":(e<c.ok-1E-6||c.ok<m.M)&&m.M<=e&&e<m.ba&&!m.df&&(r.play(k,(m.M-e)/B.Pa,(m.ba-m.M)/B.Pa),m.df=!0),c.ok<m.ba&&m.ba<=e&&m.df&&(m.df=!1)}}for(g=0;g<c.X.length;g++)m=c.X[g].BB,m.M<=Math.round(e)&&Math.round(e)<m.ba&&!m.cj&&(w(c.X[g],m.cj,c.Oc),m.cj=!0),m.ba<=Math.round(e)&&m.cj&&(w(c.X[g],m.cj,c.Oc),m.cj=!1);c.ok=e}}};a.aa=function(){E.length=0;M=-1};a.Aw=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||l(a)||
z(a)?!0:!1};a.ag=C;a.Rv=function(a){var b=A.p();return b.oa?q(b.oa,a,!0,M):-1};a.zQ=function(){var a=A.p();a.oa&&(a.oa.mk=!0)};a.mP=function(a){var b=A.p();b.oa&&(b.oa.mk=!1,b.oa.kj=a?a:null)};a.CN=function(){var a=A.p();return a.oa?a.oa.M:-1};a.AN=function(){var a=A.p();return a.oa?a.oa.ba:-1};a.yi=function(){var a=A.p();return a.oa?!a.oa.mk:!1};a.cM=function(){var a=A.p();return a.oa?a.b4w_use_nla:!1};a.dM=function(){var a=A.p();return a.oa?0<a.b4w_nla_script.length:!1};a.gQ=function(a,b){var d=
A.p();if(d.oa)d.oa.er=a,d.oa.$m=b;else return!1};a.tP=function(){var a=A.p();if(a.oa)a=a.oa,a.er=a.M,a.$m=a.ba;else return!1};a.HP=function(a){var b=A.p();if(b.oa)b.oa.sc=a;else return!1};a.lM=function(){var a=A.p();a.oa&&(a.oa.kj=null)}};b4w.module.__controls=function(a,y){function e(a){return{type:a,value:0,ha:null,zd:!1,key:0,Ya:"",Td:!1,Oo:null,No:function(){},Mo:null,ou:function(){},jf:null,T:new Float32Array(3),wa:new Float32Array(3),Lw:!1,pm:!1,cy:0,by:function(){},axis:"",gd:0,hj:new Float32Array(3),Xm:new Float32Array(4),threshold:0,Wx:new Float32Array(4),Cl:0,Bl:0,ny:0,Dl:0,sd:0,repeat:!1,It:!1,om:0,nm:0,mm:0,Zp:0,Yp:0,Xp:0}}function c(a,b){a.value=Number(b)}function b(a){for(var b=a.Gd,d=a.GH,c=0;c<b.length;c++)d[c]=b[c].value;
return a.mG(d)}function h(a){a=f.indexOf(a);-1<a?f.splice(a,1):k.error("Wrong object")}function m(a,b){for(var d=0,c=0;c<b.length;c++)for(var e=b[c].vf,f=0;f<e.length;f++)for(var g=e[f].Gd,k=0;k<g.length;k++)g[k]===a&&d++;return d}function q(a,b){switch(a.type){case 80:d.mr(a.Oo,a.Ya,a.No);a.zd=!0;break;case 90:d.Ko(a.Mo);a.zd=!0;break;case 100:d.nr(a.cy);a.zd=!0;break;case 130:a.zd=!0}var c=b.indexOf(a);-1<c&&b.splice(c,1)}function u(a){for(var b=0;b<p.length;b++){var d=p[b];20==d.type&&a.keyCode==
d.key&&c(d,1)}pa&&a.preventDefault();wa&&wa(a)}function w(a){for(var b=0;b<p.length;b++){var d=p[b];20==d.type&&0==a.keyCode&&16==d.key&&c(d,0);20==d.type&&a.keyCode==d.key&&c(d,0)}pa&&a.preventDefault();wa&&wa(a)}function g(a){var b=!1,d=null;ia=!0;Q=a.clientX;X=a.clientY;N=a.clientX;T=a.clientY;for(var e=0;e<p.length;e++){var f=p[e];50==f.type&&(c(f,1),f.ha=a.which);160==f.type&&(b||(b=r.Ml(a.clientX,a.clientY,ea),d=n.Um(b[0],b[1]),b=!0),f.value=d==f.jf?1:0)}na&&a.preventDefault();v&&v(a)}function l(a){for(var b=
0;b<p.length;b++){var d=p[b];50==d.type&&c(d,0);160==d.type&&d.It&&(d.value=0)}ia=!1;na&&!Z&&a.preventDefault();v&&v(a)}function z(a){var b=a.clientX,d=a.clientY;N=b;T=d;if(!J.hq||ia)for(var e=b-Q,f=d-X,g=Math.sqrt(e*e+f*f),k=0;k<p.length;k++){var n=p[k];if(40===n.type)switch(n.axis){case "X":c(n,e);n.ha=b;break;case "Y":c(n,f);n.ha=d;break;case "XY":c(n,g),n.ha[0]=b,n.ha[1]=d}}na&&!Z&&a.preventDefault();v&&v(a)}function C(a){r.Mw(a.relatedTarget)||l(a)}function F(a){var b=a.wheelDelta||-40*a.detail,
b=b*K.BG;L+=b;for(b=0;b<p.length;b++){var d=p[b];30===d.type&&c(d,L)}ka&&a.preventDefault();S&&S(a)}function G(a){var b=a.targetTouches;if(1==b.length){for(var d=b[0],b=d.clientX,d=d.clientY,c=!1,e=null,f=0;f<p.length;f++){var g=p[f];160==g.type&&(c||(c=r.Ml(b,d,ea),e=n.Um(c[0],c[1]),c=!0),g.value=e==g.jf)}R[0]=b;R[1]=-1;oa[0]=d;oa[1]=-1}else 1<b.length&&(V=aa=x(b),R[0]=b[0].clientX,R[1]=b[1].clientX,oa[0]=b[0].clientY,oa[1]=b[1].clientY);U.set(R);ha.set(oa);fa&&fa(a)}function D(b){var d=b.targetTouches;
if(0!==d.length){if(1===d.length){U[0]=d[0].clientX;U[1]=-1;ha[0]=d[0].clientY;ha[1]=-1;var d=U[0]-R[0],e=ha[0]-oa[0],f=Math.sqrt(d*d+e*e);if(-1!=R[1]&&-1!=oa[1]){var g=U[0]-R[1],k=ha[0]-oa[1],n=Math.sqrt(g*g+k*k);n<f&&(d=g,e=k,f=n)}for(n=0;n<p.length;n++){var h=p[n];if(60===h.type)switch(h.ha=a.nl,h.axis){case "X":c(h,d);break;case "Y":c(h,e);break;case "XY":c(h,f)}}}else if(1<d.length){U[0]=d[0].clientX;U[1]=d[1].clientX;ha[0]=d[0].clientY;ha[1]=d[1].clientY;V=x(d);f=V-aa;g=ea;g[0]=(U[0]+U[1])/
2;g[1]=(ha[0]+ha[1])/2;k=ba;k[0]=(R[0]+R[1])/2;k[1]=(oa[0]+oa[1])/2;var r,d=g[0],e=g[1],n=k[0],h=k[1];r=Math.sqrt((d-n)*(d-n)+(e-h)*(e-h));for(n=0;n<p.length;n++)if(h=p[n],70===h.type&&Math.abs(r)<Math.abs(f)&&(h.ha=a.ml,c(h,f)),60===h.type&&Math.abs(r)>Math.abs(f))switch(h.ha=a.ll,h.axis){case "X":d=g[0]-k[0];c(h,d);break;case "Y":e=g[1]-k[1];c(h,e);break;case "XY":c(h,r)}}ca&&b.preventDefault();fa&&fa(b)}}function H(a){for(var b=0;b<p.length;b++){var d=p[b];if(170==d.type||180==d.type)d.nm=a.beta,
d.om=a.gamma,d.mm=a.alpha,d.value||(d.Zp=a.gamma,d.Yp=a.beta,d.Xp=a.alpha,c(d,1))}}function x(a){var b=a[0],d=a[1];a=b.clientX;var b=b.clientY,c=d.clientX,d=d.clientY;return Math.sqrt((a-c)*(a-c)+(b-d)*(b-d))}var A=y("__config"),r=y("__container"),k=y("__print"),d=y("__physics"),n=y("__scenes"),B=y("__time"),I=y("__util"),E=y("vec3"),M=y("quat"),K=A.controls,J=A.r,f=[],p=[],t={},L=0,N=0,T=0,Q=0,X=0,ia=!1,U=new Float32Array(2),ha=new Float32Array(2),R=new Float32Array(2),oa=new Float32Array(2),ea=
new Float32Array(2),ba=new Float32Array(2),V=0,aa=0,Y=!1,O=0,pa=!1,na=!1,ka=!1,ca=!1,Z=!1,wa=null,v=null,S=null,fa=null;a.ia=10;a.Sn=20;a.Nd=30;a.Md=40;a.Rn=50;a.nl=0;a.ml=1;a.ll=2;a.update=function(d,e){for(var g=0;g<p.length;g++){var k=p[g],n=d,h=e;if(h)switch(k.type){case 110:var r=k.jf,l=r.e.h,r=r.e.quat,m=E.dist(k.hj,l),v=k.Wx;M.invert(k.Xm,v);M.multiply(r,v,v);M.normalize(v,v);v=Math.abs(2*Math.acos(v[3]));m/=h;k.Cl=I.fc(m,k.Cl,h,.3);k.ha[0]=m;m=v/h;k.Bl=I.fc(m,k.Bl,h,.3);k.ha[1]=m;k.Cl>=k.threshold||
k.Bl>=k.ny?c(k,1):c(k,0);E.copy(l,k.hj);M.copy(r,k.Xm);k.gd=n;break;case 120:r=k.jf;l=r.e.h;r=Math.abs(l[1]-k.hj[1])/h;k.Dl=I.fc(r,k.Dl,h,.3);k.ha=r;k.Dl>=k.threshold?c(k,1):c(k,0);E.copy(l,k.hj);k.gd=n;break;case 130:!k.zd&&0<=k.sd&&n-k.gd>=k.sd&&(c(k,1),k.repeat?k.gd=n:k.sd=-k.sd);break;case 140:k.gd||(k.gd=n);c(k,n-k.gd);k.gd=n;break;case 150:c(k,n);break;case 170:k.ha[0]=Math.PI*(k.om-k.Zp)/180;k.ha[1]=Math.PI*(k.nm-k.Yp)/180;k.ha[2]=Math.PI*(k.mm-k.Xp)/180;k.Zp=k.om;k.Yp=k.nm;k.Xp=k.mm;break;
case 180:k.ha[0]=Math.PI*k.om/180,k.ha[1]=Math.PI*k.nm/180,k.ha[2]=Math.PI*k.mm/180}}for(g=0;g<f.length;g++)for(h=f[g],k=h.vf,n=0;n<k.length;n++)if(l=k[n],l.Az!=O){l.Az=O;v=l;r=0;switch(v.type){case a.ia:r=v.Xe;(m=b(v))?(r=1,v.Xe=1):1==r?(r=-1,v.Xe=-1):r=0;break;case a.Sn:r=v.Xe;(m=b(v))&&-1==r?(r=1,v.Xe=1):m||1!=r?r=0:(r=-1,v.Xe=-1);break;case a.Nd:r=v.Xe;(m=b(v))&&-1==r?(r=1,v.Xe=1):m||1!=r?r=0:(r=0,v.Xe=-1);break;case a.Md:m=b(v);v.Yw!=m?(r=1,v.Yw=m):r=0;break;case a.Rn:for(var m=v.Gd,v=v.hG,q=
0;q<m.length;q++){var u=m[q].value;r||u==v[q]||(r=1);v[q]=u}break;default:I.ma("Wrong sensor manifold type: "+v.type)}if(r&&(m=h==t?null:h,Y=!1,l.callback(m,l.id,r,l.AC),Y)){g=-1;break}}for(g=0;g<f.length;g++)for(h=f[g],k=h.vf,n=0;n<k.length;n++)for(l=k[n],h=l.Gd,l=0;l<h.length;l++)switch(r=h[l],r.type){case 30:c(r,0);break;case 40:c(r,0);break;case 60:c(r,0);break;case 70:c(r,0);break;case 130:c(r,0)}L=0;Q=N;X=T;R.set(U);oa.set(ha);aa=V;O++};a.Xo=function(a){var b=e(10);c(b,a);return b};a.nb=function(a){var b=
e(20);b.key=a;return b};a.Wo=function(a,b,f){if(!a||!d.C(a))return k.error("Wrong collision object"),null;var g=e(80);g.Oo=a;g.Ya=b;g.Td=f;g.ha={coll_obj:null,coll_pos:f?new Float32Array(3):null,coll_norm:f?new Float32Array(3):null,coll_dist:0};g.No=function(a,b,d,e,f){c(g,a);a=g.ha;a.coll_obj=b;g.Td&&(a.coll_pos.set(d),a.coll_norm.set(e),a.coll_dist=f)};g.zd=!0;return g};a.Au=function(a){if(!a||!a.n)return k.error("Wrong collision impulse object"),null;var b=e(90);b.Mo=a;b.ou=function(a){c(b,a)};
b.zd=!0;return b};a.Gu=function(a,b,d,f,g,k,n){var h=e(100);h.jf=a;h.T=b;h.wa=d;h.Ya=f;h.Lw=g;h.Td=k;h.pm=n;h.ha={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3)};h.by=function(a,b,d,e,f,g){h.Lw?c(h,-1==b?0:1):c(h,b);h.ha.hit_fract=b;h.ha.obj_hit=d;h.ha.hit_time=e;h.Td&&(h.ha.hit_pos.set(f),h.ha.hit_norm.set(g))};h.zd=!0;return h};a.Ql=function(){return e(50)};a.Yo=function(){return e(30)};a.fi=function(a){var b=e(40);b.axis=a||"XY";b.ha="XY"==b.axis?new Float32Array(2):
0;return b};a.Ij=function(a){var b=e(60);b.axis=a||"XY";b.ha=0;return b};a.Tl=function(){var a=e(70);a.ha=0;return a};a.Eu=function(a,b,d){if(!a)return k.error("Wrong collision object"),null;var c=e(110);c.jf=a;var f=a.e.h;a=a.e.quat;c.Wx=new Float32Array(4);c.hj=new Float32Array(f);c.Xm=new Float32Array(a);c.Cl=0;c.Bl=0;c.threshold=b||.1;c.ny=d||.1;c.gd=0;c.ha=new Float32Array([0,0]);return c};a.Ju=function(a,b){if(!a)return k.error("Wrong collision object"),null;var d=e(120);d.jf=a;var c=a.e.quat;
d.hj=new Float32Array(a.e.h);d.Xm=new Float32Array(c);d.Dl=0;d.threshold=b||1;d.gd=0;d.ha=0;return d};a.Iu=function(a,b){var d=e(130);d.sd=a;d.repeat=b;d.zd=!0;return d};a.ky=function(a,b,d,c){a=a||t;a=a.vd;if(!a||!a[b])return k.error("reset_timer_sensor(): wrong object"),null;b=a[b].Gd[d];if(!b)return k.error("reset_timer_sensor(): sensor not found"),null;b.gd=B.Jf();b.sd=c};a.di=function(){var a=e(140);a.gd=0;return a};a.Du=function(){var a=e(170);a.ha=new Float32Array(3);return a};a.Cu=function(){var a=
e(180);a.ha=new Float32Array(3);return a};a.Hu=function(){return e(150)};a.Zo=function(a,b){var d=e(160);d.jf=a;d.It=b;return d};a.FH=c;a.vc=function(a,b,d){a=a||t;a=a.vd;if(!a||!a[b])return k.error("get_sensor_value(): wrong object"),null;b=a[b].Gd[d];return b?b.value:(k.error("get_sensor_value(): sensor not found"),null)};a.ae=function(a,b,d){a=a||t;a=a.vd;if(!a||!a[b])return k.error("get_sensor_payload(): wrong object"),null;b=a[b].Gd[d];return b?b.ha:(k.error("get_sensor_payload(): sensor not found"),
null)};a.aa=function(){f=[];p=[];t={}};a.$h=function(a,b){a=a||t;if(!a.vd)return!1;if(b&&a.vd[b])return!0;if(!b)for(var d in a.vd)return!0;return!1};a.bf=function(a,b){a=a||t;var d=a.vd;if(d){var c=a.vf;if(b){var e=d[b];if(e){for(var g=e.Gd,k=0;k<g.length;k++)1===m(g[k],f)&&q(g[k],p);delete d[b];e=c.indexOf(e);-1<e?c.splice(e,1):I.ma("Incorrect manifolds array");Object.getOwnPropertyNames(d).length||h(a)}}else{for(b in d){e=d[b];g=e.Gd;for(k=0;k<g.length;k++)1===m(g[k],f)&&q(g[k],p);delete d[b];e=
c.indexOf(e);-1<e?c.splice(e,1):I.ma("Incorrect manifolds array")}h(a);Y=!0}}};a.R=function(a,b,c,e,g,k,n){a=a||t;a.vd=a.vd||{};a.vf=a.vf||[];var h=a.vd,r=a.vf,l=h[b];if(l){e=l.Gd;for(var v=0;v<e.length;v++)1===m(e[v],f)&&q(e[v],p);l=r.indexOf(l);-1<l?r.splice(l,1):I.ma("Incorrect manifolds array")}c={id:b,type:c,Gd:e.slice(0),mG:g,GH:Array(e.length),callback:k,AC:n,Xe:-1,Yw:0,hG:Array(e.length),Az:-1};h[b]=c;r.push(c);-1==f.indexOf(a)&&f.push(a);a=c.Gd;for(b=0;b<a.length;b++){h=a[b];if(h.zd){switch(h.type){case 80:d.jo(h.Oo,
h.Ya,h.No,h.Td);break;case 90:d.lo(h.Mo,h.ou);break;case 100:h.cy=d.Al(h.jf,h.T,h.wa,h.Ya,h.by,!1,!1,h.Td,h.pm);break;case 130:h.gd=B.Jf(),0>h.sd&&(h.sd=-h.sd)}h.zd=!1}-1==p.indexOf(h)&&p.push(h)}Y=!0};a.Ru=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.UD=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.reset=function(){for(var a=0;a<f.length;a++){var b=f[a],d=b.vd,b=b.vf,c;for(c in d)delete d[c];b.splice(0,b.length)}for(a=0;a<
p.length;a++)q(p[a],p),a--;f.splice(0,f.length)};a.debug=function(){k.log(String(f.length)+" objects with manifolds",f);k.log(String(p.length)+" sensors",p);for(var a=[],b=[],d=0;d<p.length;d++){var c=p[d];80==c.type&&a.push(c);100==c.type&&b.push(c)}k.log(String(a.length)+" collision sensors",a);k.log(String(b.length)+" ray sensors",b)};a.ir=function(a,b){a.addEventListener("keydown",u,!1);a.addEventListener("keyup",w,!1);pa=b};a.jr=function(a,b,d){if(d)var c=window;else c=a,c.addEventListener("mouseout",
C,!1);a.addEventListener("mousedown",g,!1);c.addEventListener("mousemove",z,!1);c.addEventListener("mouseup",l,!1);na=b;Z=d};a.lr=function(a,b){a.addEventListener("mousewheel",F,!1);a.addEventListener("DOMMouseScroll",F,!1);ka=b};a.kr=function(a,b){a.addEventListener("touchstart",G,!1);a.addEventListener("touchmove",D,!1);document.addEventListener("touchstart",function(){});ca=b};a.hr=function(){window.DeviceOrientationEvent&&J.gyro_use&&window.addEventListener("deviceorientation",H,!1)};a.cs=function(a){a.removeEventListener("keydown",
u,!1);a.removeEventListener("keyup",w,!1)};a.ds=function(a){a.removeEventListener("mousedown",g,!1);a.removeEventListener("mousemove",z,!1);a.removeEventListener("mouseout",C,!1);a.removeEventListener("mouseup",l,!1)};a.fs=function(a){a.removeEventListener("mousewheel",F,!1);a.removeEventListener("DOMMouseScroll",F,!1)};a.es=function(a){a.removeEventListener("touchstart",G,!1);a.removeEventListener("touchmove",D,!1);document.removeEventListener("touchstart",function(){})};a.bs=function(){window.DeviceOrientationEvent&&
J.gyro_use&&window.removeEventListener("deviceorientation",H,!1)};a.ML=function(a){wa=a};a.NL=function(a){v=a};a.QL=function(a){S=a};a.PL=function(a){fa=a}};b4w.module.__physics=function(a,y){function e(a,b){for(var d=a.nd,c=0;c<d.length;c++)d[c].e.En&&b.push(d[c]),e(d[c],b)}function c(a,b){for(var d=a.n.q,c=0;c<d.length;c++)for(var e=d[c].fb,f=0;f<e.rc.length;f++){var g=e.rc[f];"ANY"!=g.Ya&&b!=g.Ya||x(g)}}function b(a,b){if(ea)switch(a){case f.hA:ea.n.Tz=!0;f.v(f.YA,Date.now()-performance.now(),U.Cd,U.Do?ha.lv:0);break;case f.iA:K.Cq("URANIUM:",b.slice(1));break;case f.dA:K.error(b);break;case f.eA:J.am.apply(this,b.slice(1));break;case f.nA:var d=h(b.I);
if(d){var c=b.h,e=b.quat,g=b.ce,n=b.Rd,d=d.n;d.cp=b.time;L.Bh(c,1,e,d.dp);Q.copy(g,d.ce);Q.copy(n,d.Rd)}break;case f.kA:(c=h(b.Io))&&L.Bh(b.h,1,b.quat,c.l.Gk[b.$q]);break;case f.fA:if(e=h(b[1]))c=b[4],e=e.od.Gl[b[2]],t.Hd(e,b[3]),t.gf(e,c),t.w(e);break;case f.oA:if(d=h(b[1]))d.l.speed=b[2];break;case f.$z:m(ea,b.Dg,b.Eg,b.result,null,null,0);break;case f.bA:m(ea,b.Dg,b.Eg,b.result,b.Ig,b.coll_norm,b.coll_dist);break;case f.aA:if(d=h(b[1]))c=d.n,c.Hg&&c.Hg(b[2]);break;case f.Is:case f.lA:if(c=ea.n.Li[b.id])if(e=
h(b.Yh),a==f.Is)g=c.callback,g(c.id,b.hit_fract,e,b.hit_time);else{var g=b.hit_fract,n=b.hit_time,d=b.hit_pos,r=c.callback;d?r(c.id,g,e,n,d,b.hit_norm):r(c.id,g,e,n)}break;case f.mA:k(id);break;case f.jA:console.log("Physics Ping: OUT "+(b[2]-b[1]).toFixed(3)+" ms, IN "+(performance.now()-b[2]).toFixed(3)+" ms, ALL "+(performance.now()-b[1]).toFixed(3)+" ms");break;case f.gA:R=b[1];break;case f.cA:console.log(b[1]);break;default:K.error("Wrong message: "+a)}}function h(a){return ba[a]||null}function m(a,
b,d,c,e,f,g){a=a.n.q;for(var k=0;k<a.length;k++)for(var n=a[k].fb,r=0;r<n.rc.length;r++){for(var p=n.rc[r],l=p.Xf,t=!1,m=0;m<l.length;m++){var u=l[m];if(u[0]===b&&u[1]===d){p.wk[m]=c;t=!0;break}}t&&(l=q(p),e&&p.yo!=b&&(t=e,m=f,u=g,t[0]+=m[0]*u,t[1]+=m[1]*u,t[2]+=m[2]*u,m[0]*=-1,m[1]*=-1,m[2]*=-1),p.callback(l,l?p.yo==b?h(d):h(b):null,e,f,g))}}function q(a){a=a.wk;for(var b=!1,d=0;d<a.length;d++)b=b||a[d];return b}function u(){Y.body++;return Y.body}function w(a){if("ANY"==a)return 0;var b=aa.indexOf(a);
return-1==b?(aa.push(a),aa.length-1):b}function g(a){return{I:a,Eq:0,wm:!1,gg:!0,IO:!1,jk:!1,WF:!1,Ol:null,Ya:"",Fj:0,uM:{},rc:[],Hg:null,cp:0,dp:new Float32Array([0,0,0,1,0,0,0,1]),ce:new Float32Array(3),Rd:new Float32Array(3),Kl:new Float32Array(3),Jl:new Float32Array(4)}}function l(a,b){switch(a){case "BOX":var d=b.hc;break;case "CYLINDER":d=b.to;break;case "CONE":d=b.so;break;case "SPHERE":d=b.xd;break;case "CAPSULE":d=b.ro}return d}function z(a){if(!a)return null;var b={};"number"===typeof a.min_x&&
(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.G&&(b.center=a.G);"number"===typeof a.La&&(b.radius=a.La);"number"===typeof a.height&&(b.height=a.height);return b}function C(a,b,d,c){var e=a.e.h,g=b.e.Z,k=new Float32Array(16);ia.invert(g,k);g=new Float32Array(3);Q.transformMat4(e,k,g);
switch(b.l.type){case 10:b=b.b4w_vehicle_settings;a=a.e.hc;f.v(f.BA,d,g,b.suspension_rest_length,b.roll_influence,(a.max_y-a.min_y)/2,c);break;case 20:f.v(f.AA,d,g,a.BQ)}}function F(a){return a.n&&a.n.Ol?!0:!1}function G(a,b,d,c,e,g,k,h,n,r){var p;Y.tu++;p=Y.tu.toString(16);f.v(f.IA,p,a,h,b.n.I,d,c,e.n.I,g,k,n,r);b.n.Ol=p}function D(a){var b=a.n;if(b&&(0===b.Eq||!0===b.wm||!1===b.gg||"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type)&&(a.e.h[0]!=a.n.Kl[0]||a.e.h[1]!=a.n.Kl[1]||a.e.h[2]!=a.n.Kl[2]||a.e.quat[0]!=
a.n.Jl[0]||a.e.quat[1]!=a.n.Jl[1]||a.e.quat[2]!=a.n.Jl[2])){var b=a.n,d=a.e;Q.copy(d.h,b.Kl);X.copy(d.quat,b.Jl);var c=f.Vv(f.kl);c.I=b.I;c.h=d.h;"DYNAMIC"==b.type?X.identity(c.quat):c.quat=d.quat;f.v(f.kl)}a=a.nd;for(b=0;b<a.length;b++)D(a[b])}function H(a,b,d,c,e){e=e||new Float32Array(3);a=a.e.quat;e[0]=b;e[1]=d;e[2]=c;Q.transformQuat(e,a,e)}function x(a){var b=a.Xf,d=a.wk,c=a.yo,e=[],g=a.Ya,k=ea;if(!e)throw"At least one destination required";for(var h=0;h<k.n.q.length;h++){var n=k.n.q[h];if("ANY"==
g||n.fb.Ya==g)n=n.fb.I,e&&-1==e.indexOf(n)&&e.push(n)}for(g=0;g<e.length;g++)k=e[g],c<k&&!A(b,c,k)?(b.push([c,k]),d.push(!1)):c>k&&!A(b,k,c)&&(b.push([k,c]),d.push(!1));f.v(f.zA,c);f.v(f.HA,b,a.Td)}function A(a,b,d){for(var c=0;c<a.length;c++)if(a[c][0]==b&&a[c][1]==d)return!0;return!1}function r(a){a.n&&a.n.Hg&&(a=a.n,f.v(f.UA,a.I),a.Hg=null)}function k(a){var b=ea.n;b.Li[a]&&(delete b.Li[a],b.fr.splice(b.fr.indexOf,1),f.v(f.cB,a))}function d(a,b){if(b.aj){var d=a.n.I,c=b.li*b.kv,e=b.Bj*b.St,g=-b.$i*
b.Nr*2*Math.PI/b.iz;b.Iw&&(g*=-1);switch(b.type){case 10:f.v(f.pB,d,c,e,g);break;case 20:f.v(f.oB,d,c,e,g)}}}function n(a){return a.b4w_vehicle&&"CHASSIS"==a.b4w_vehicle_settings.part?!0:!1}function B(a){return a.b4w_vehicle&&"HULL"==a.b4w_vehicle_settings.part?!0:!1}function I(a){return a.b4w_character?!0:!1}function E(a){return a.b4w_floating&&"MAIN_BODY"==a.b4w_floating_settings.part?!0:!1}var M=y("__config");y("__constraints");var K=y("__print"),J=y("__debug"),f=y("__ipc");y("__renderer");var p=
y("__scenes"),t=y("__transform"),L=y("__tsr"),N=y("__util"),T=y("__version"),Q=y("vec3"),X=y("quat"),ia=y("mat4"),U=M.fb,ha=M.r,R=0,oa=null,ea=null,ba={},V=[],aa=[],Y={body:0,tu:0,ay:0},O=new Float32Array(3),pa=new Float32Array(4),na=new Float32Array(4),ka=new Float32Array(16),ca=new Float32Array(8),Z=new Float32Array(8);a.PF=function(a){if(ea)K.warn("Multiple physics scenes are currently not supported");else{a.n={Tz:!1,q:[],Li:{},fr:[]};var d=U.Xk+T.timestamp();K.log("%cLOAD PHYSICS","color: #0a0",
d,"Max FPS: "+U.Cd);oa=new Worker(d);f.$b(oa,b);ea=a;U.ping&&setInterval(function(){f.v(f.$A,performance.now())},1E3)}};a.TC=function(a){return a.n?a.n.Tz:!0};a.aa=function(){if(ea){oa.terminate();ea=oa=null;ba={};V.length=0;aa.length=0;for(var a in Y)Y[a]=0}};a.yf=function(a,b){var k=a.e;if(!k)throw"No object render: "+a.name;if(a.parent&&k.En)return null;var h=[];k.En&&e(a,h);var r=b.n.q;if(n(a)||B(a)||I(a)||E(a)||a.b4w_collision){var t,m=a,q=k.Nx,x=m.e,A=m.game,y=u();if("CAMERA"==m.type)var J=
A.use_collision_bounds?A.collision_bounds_type:"BOX",M=l(J,x),H=x.$j,D=x.Tj,H=.5,D=0;else"EMPTY"==m.type?(J="EMPTY",M=null,D=H=0):(J=A.use_collision_bounds?A.collision_bounds_type:"BOX",M=l(J,x),H=x.$j,D=x.Tj);var L=x.h,O=x.quat,hc=A.use_ghost,R=A.use_sleep,T=A.mass,U=A.velocity_min,Z=A.velocity_max,ca=A.damping,Y=A.rotation_damping,pa=m.b4w_collision_id,ha=w(pa),aa=A.collision_margin,oa=A.collision_group,oc=A.collision_mask,ma=x.xd.La,Qc=z(M),ga=m.b4w_correct_bounding_offset,Ab;var Sa=J;if(h.length){var Fb=
[],sb={};sb.quat=new Float32Array([0,0,0,1]);sb.trans=new Float32Array(3);sb.worker_bounding=Qc;sb.bounding_type=Sa;Fb.push(sb);ia.invert(x.Z,ka);X.invert(x.quat,na);for(var Ga=0;Ga<h.length;Ga++){var Xb={},bb=h[Ga],rc=bb.game.collision_bounds_type,bd=new Float32Array(4),cd=new Float32Array(3);Q.transformMat4(bb.e.h,ka,cd);X.multiply(na,bb.e.quat,bd);Xb.trans=cd;Xb.quat=bd;Xb.bounding_type=rc;Xb.worker_bounding=z(l(rc,bb.e));Fb.push(Xb)}Ab=Fb}else Ab=[];f.v(f.EA,y,L,O,q,hc,R,T,U,Z,ca,Y,ha,aa,oa,oc,
J,Qc,ma,H,D,Ab,ga);ba[y]=m;V.push(m);var cb=g(y);cb.type=q;cb.Eq=T;cb.wm=hc;cb.Ya=pa;cb.Fj=ha;t=cb;a.n=t;var Ha={B:null,fb:t};r.push(Ha);c(b,t.Ya)}else for(var fb=a.o||[],Ra=0;Ra<fb.length;Ra++){var Va=fb[Ra],Zb;if(Zb="PHYSICS"==Va.type){var nb;a:{for(var Pa=b.n.q,Ca=0;Ca<Pa.length;Ca++){var jb=Pa[Ca].B;if(jb&&jb.id==Va.id){nb=!0;break a}}nb=!1}Zb=!nb}if(Zb)if(Va.ed.N)if(Va.Lh&&b.e.qb){var La=Va,Ka=ea,Ba=p.ea(Ka,"MAIN_OPAQUE");f.v(f.NA,Ba.pg);if(Ba.qb&&La.LJ){var za={};za.dst_noise_scale0=La.dst_noise_scale0;
za.dst_noise_scale1=La.dst_noise_scale1;za.dst_noise_freq0=La.dst_noise_freq0;za.dst_noise_freq1=La.dst_noise_freq1;za.dir_min_shore_fac=La.dir_min_shore_fac;za.dir_freq=La.dir_freq;za.dir_noise_scale=La.dir_noise_scale;za.dir_noise_freq=La.dir_noise_freq;za.dir_min_noise_fac=La.dir_min_noise_fac;za.dst_min_fac=La.dst_min_fac;za.waves_hor_fac=La.waves_hor_fac;var ra=Ba.qg,Mb=Ba.Mh;Ba.Gn?f.v(f.Zs,za,Ba.fg[0],Ba.fg[1],Ba.eg[0],Ba.eg[1],Ba.Ei,ra,Mb,Ba.Si,Ka.e.zr):f.v(f.Zs,za,0,0,0,0,0,ra,Mb,0,null)}}else{var jc;
if(Va.tJ){var ya=a,Yb=Va,W=u(),Rb=Yb.ed,Wa=Rb.A[0].a_position,Aa=Rb.la||null,ua=Yb.Ya,Wb=w(ua);f.v(f.KA,W,Wa,Aa,ya.e.h,Wb,Yb.qu,Yb.pu,Yb.ru);var qc=g(W);qc.wm=!0;qc.Ya=ua;qc.Fj=Wb;jc=qc}else{var pb=a,Qa=Va,rb=u(),Ia=Qa.ed,ib=Ia.A[0].a_position,ic=Ia.la||null,Jb=pb.e.h,ab=Qa.$j,Kb=Qa.Tj,Ec=Qa.Ya,Lb=w(Ec);f.v(f.MA,rb,ib,ic,Jb,ab,Kb,Lb,Qa.qu,Qa.pu,Qa.ru);var Fc=g(rb);Fc.Ya=Ec;Fc.Fj=Lb;jc=Fc}t=jc;Ha={B:Va,fb:t};r.push(Ha);c(b,t.Ya)}else K.error("Object "+a.name+" has collision material with no assigned vertices")}if(n(a)||
B(a)){var Ua=a,eb=Ua.n.I;n(Ua)?(Ua.l.type=10,f.v(f.FA,eb,Ua.l.JI,Ua.l.LI,Ua.l.KI,Ua.l.NJ,Ua.l.xG)):B(Ua)&&(Ua.l.type=20,f.v(f.DA,eb,Ua.l.zp,Ua.l.ts,Ua.l.us));if(Ua.l.vh){var qb=Ua.l.vh;switch(Ua.l.type){case 10:C(qb[1],Ua,eb,!0);C(qb[0],Ua,eb,!0);C(qb[3],Ua,eb,!1);C(qb[2],Ua,eb,!1);break;case 20:for(var Sb=0;Sb<qb.length;Sb++)C(qb[Sb],Ua,eb,!1)}}d(a,a.l)}else if(I(a)){var gb=a.e,Tb=a.n,Gb=gb.hc.max_y-gb.hc.min_y,kc=Tb.I,ta=a.b4w_character_settings,Ta=ta.walk_speed,Xa=ta.run_speed,$b=ta.step_height,
Da=ta.jump_strength,wc=ta.waterline,wb=N.cE(a);f.v(f.GA,kc,wb,Gb,Ta,Xa,$b,Da,wc);Tb.jk=!0}else if(E(a)){var Ma=a,kb=Ma.n.I;f.v(f.JA,kb,Ma.od.zp,Ma.od.ts,Ma.od.us);if(Ma.od.Gl)for(var Ub=Ma.od.Gl,Bb=0;Bb<Ub.length;Bb++){var xc=Ub[Bb],tb=xc.e.h,lb=Ma.e.Z,Cb=new Float32Array(16);ia.invert(lb,Cb);var lc=new Float32Array(3);Q.transformMat4(tb,Cb,lc);f.v(f.CA,kb,lc,xc.uC)}Ma.n.WF=!0}for(Ra=0;Ra<V.length;Ra++)if(a=V[Ra],a.n){var ub=a;if(!F(ub))for(var ac=0;ac<ub.constraints.length;ac++){var xb=ub.constraints[ac],
bc=xb.target,Db=xb.pivot_type;if("RIGID_BODY_JOINT"==xb.type&&bc.n){var Nb=new Float32Array([xb.pivot_x,xb.pivot_y,xb.pivot_z]),Rc,Eb=new Float32Array([xb.axis_x,xb.axis_y,xb.axis_z]);Rc=N.Gf(Eb,new Float32Array(4));var Ea=ia.fromRotationTranslation(Rc,Nb,new Float32Array(16)),dd=ia.multiply(ub.e.Z,Ea,new Float32Array(16)),yc=ia.invert(bc.e.Z,new Float32Array(16)),Ob=ia.multiply(yc,dd,yc),mc=N.Ci(Ob),Gc=N.Sf(Ob),Ja=xb,Ya={};Ya.use_limit_x=Ja.use_limit_x;Ya.use_limit_y=Ja.use_limit_y;Ya.use_limit_z=
Ja.use_limit_z;Ya.use_angular_limit_x=Ja.use_angular_limit_x;Ya.use_angular_limit_y=Ja.use_angular_limit_y;Ya.use_angular_limit_z=Ja.use_angular_limit_z;Ya.limit_max_x=Ja.limit_max_x;Ya.limit_min_x=Ja.limit_min_x;Ya.limit_max_y=Ja.limit_max_y;Ya.limit_min_y=Ja.limit_min_y;Ya.limit_max_z=Ja.limit_max_z;Ya.limit_min_z=Ja.limit_min_z;Ya.limit_angle_max_x=Ja.limit_angle_max_x;Ya.limit_angle_min_x=Ja.limit_angle_min_x;Ya.limit_angle_max_y=Ja.limit_angle_max_y;Ya.limit_angle_min_y=Ja.limit_angle_min_y;
Ya.limit_angle_max_z=Ja.limit_angle_max_z;Ya.limit_angle_min_z=Ja.limit_angle_min_z;G(Db,ub,Nb,Rc,bc,mc,Gc,Ya,null,null)}}}};a.xE=h;a.update=function(){for(var a=0;a<V.length;a++){var b=V[a],d=b.n;if(d.gg&&d.cp){var c=performance.now()/1E3-d.cp,c=Math.min(c,10/U.Cd),c=c-1/U.Cd;ha.EG&&(c=0);var e=ca;L.QF(d.dp,c,d.ce,d.Rd,ca);t.WH(b,e);t.w(b);D(b);if(b.l)for(var d=b,c=d.l.vh,e=d.e.Pb,g=ca,k=0;k<c.length;k++){var h=c[k];L.multiply(e,d.l.Gk[k],g);t.Pk(h,g);t.w(h)}b.l&&b.l.aj&&(d=b.l,c=d.aj)&&(e=b.l.jz,
h=ka,g=b.e.h,k=b.e.quat,N.$r(b.l.kz,k,g,h),N.Ci(h,c.e.h),N.Sf(h,c.e.quat),h=pa,N.as(e,k,g,h),e=na,X.setAxisAngle(h,-d.$i*d.Nr*2*Math.PI,e),X.multiply(e,c.e.quat,c.e.quat),t.w(c));b.l&&b.l.Kr&&(d=b.l,c=d.Kr)&&(g=b.l.fz,e=ka,k=b.e.h,h=b.e.quat,N.$r(b.l.gz,h,k,e),N.Ci(e,c.e.h),N.Sf(e,c.e.quat),e=pa,N.as(g,h,k,e),g=na,k=Math.abs(d.speed)*d.ez,k>d.Gq&&(k=d.Gq),X.setAxisAngle(e,-k,g),X.multiply(g,c.e.quat,c.e.quat),t.w(c));b.l&&b.l.Sr&&(d=b.l,c=d.Sr)&&(e=b.l.pz,h=ka,g=b.e.h,k=b.e.quat,N.$r(b.l.qz,k,g,h),
N.Ci(h,c.e.h),N.Sf(h,c.e.quat),b=pa,N.as(e,k,g,b),e=na,X.setAxisAngle(b,-Math.abs(d.li)*d.Tu,e),X.multiply(e,c.e.quat,c.e.quat),t.w(c))}}if(a=ea)a=p.ea(a,"MAIN_OPAQUE"),a.qb&&0<a.qb.waves_height&&(b=Q.length(a.bl),f.v(f.nB,a.time*b));f.XG()};a.UE=function(){return ea};a.pause=function(){ea&&f.v(f.ZA)};a.Fd=function(){ea&&f.v(f.dB)};a.$u=function(a){a=a.n;if(!a)throw"No object physics";if(!a.gg){var b=a.I;a.gg=!0;f.v(f.XA,b)}};a.mp=function(a){a=a.n;if(!a)throw"No object physics";if(a.gg){var b=a.I;
a.gg=!1;f.v(f.WA,b)}};a.C=function(a){return a.n?!0:!1};a.yw=function(a){return(a=a.n)&&a.gg&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.Eq&&0==a.wm?!0:!1};a.dq=function(a){return(a=a.n)&&a.gg?!0:!1};a.Fy=function(a,b){f.v(f.mB,a.n.I,b)};a.IF=F;a.vt=G;a.lu=function(a){a=a.n;f.v(f.bB,a.Ol);a.Ol=null};a.Vx=function(b,d,c,e,f,g){d=L.Cf(d,1,c,ca);f=L.Cf(f,1,g,Z);L.invert(d,d);L.multiply(f,d,d);t.gk(e,f);L.multiply(f,d,d);t.Pk(b,d);t.w(b);a.mn(b,b.e.h,b.e.quat)};a.mn=function(a,b,d){L.Bh(a.e.h,1,a.e.quat,
a.n.dp);var c=f.Vv(f.kl);c.I=a.n.I;c.h=b;c.quat=d;f.v(f.kl)};a.P=D;a.Bt=function(a,b,d,c){H(a,b,d,c,O);a=a.n.I;b=Math.abs(0);d=Math.abs(0);c=Math.abs(0);var e=Math.abs(O[0]),g=Math.abs(O[1]),k=Math.abs(O[2]);O[0]=e?O[0]/e*Math.max(e,b):0;O[1]=g?O[1]/g*Math.max(g,d):0;O[2]=k?O[2]/k*Math.max(k,c):0;f.v(f.at,a,O[0],O[1],O[2])};a.Ct=function(a,b,d,c){f.v(f.at,a.n.I,b,d,c)};a.wt=function(a,b,d,c){H(a,b,d,c,O);f.v(f.OA,a.n.I,O[0],O[1],O[2])};a.At=function(a,b,d,c){H(a,b,d,c,O);f.v(f.QA,a.n.I,O[0],O[1],
O[2])};a.sr=function(a,b,d){f.v(f.gB,a.n.I,b,d)};a.gn=function(a,b){f.v(f.hB,a.n.I,b)};a.wy=function(a,b){f.v(f.lB,a.n.I,b)};a.vy=function(a,b){f.v(f.jB,a.n.I,b)};a.sy=function(a,b){f.v(f.eB,a.n.I,b)};a.$t=function(a){f.v(f.SA,a.n.I)};a.au=function(a,b,d){f.v(f.TA,a.n.I,b,d)};a.hn=function(a,b,d){f.v(f.iB,a.n.I,b,d)};a.ty=function(a,b){f.v(f.fB,a.n.I,b)};a.uy=function(a,b){f.v(f.kB,a.n.I,b)};a.jo=function(a,b,d,c){a=a.n;var e=a.I;b=b||"ANY";for(var f=0;f<a.rc.length;f++){var g=a.rc[f];if(g.Ya==b&&
g.callback==d)return}g={yo:e,Td:c||!1,Ya:b,callback:d,Xf:[],wk:[]};a.rc.push(g);x(g)};a.mr=function(a,b,d){a=a.n;for(var c=0;c<a.rc.length;c++){var e=a.rc[c];if(e.Ya==b&&e.callback==d){if(q(e)){var g=Q.set(0,0,0,O);e.callback(!1,null,g,g,0)}a.rc.splice(c,1);c--;for(var e=e.Xf,g=ea.n.q,k=0;k<g.length;k++)for(var h=g[k].fb,n=0;n<h.rc.length;n++)for(var r=h.rc[n],p=0;p<r.Xf.length;p++)for(var t=r.Xf[p],l=0;l<e.length;l++){var m=e[l];t[0]==m[0]&&t[1]==m[1]&&(e.splice(l,1),l--)}e.length&&f.v(f.$s,e)}}};
a.lo=function(a,b){a.n&&a.n.Hg&&r(a);var d=a.n;f.v(f.PA,d.I);d.Hg=b};a.Ko=r;a.Al=function(a,b,d,c,e,g,k,h,n){var r;Y.ay++;r=Y.ay;c=c||"ANY";a={id:r,I:a?a.n.I:0,T:new Float32Array(b),wa:new Float32Array(d),Ya:c,Fj:w(c),Kt:g,wC:k,Td:h,pm:n,callback:e};b=ea.n;r=a.id;b.Li[r]=a;b.fr.push(a);f.v(f.LA,a.id,a.I,a.T,a.wa,a.Fj,a.Kt,a.wC,a.Td,a.pm);return r};a.nr=k;a.Zt=function(a,b,d){var c=ea.n.Li[a];c&&!c.Kt&&(c.T.set(b),c.wa.set(d),f.v(f.RA,a,b,d))};a.Pw=function(a){return ea.n.Li[a]?!0:!1};a.mj=function(a,
b){var c=a.l;c.li=b;d(a,c)};a.lj=function(a,b){var c=a.l;c.$i=b;d(a,c)};a.ns=function(a,b){var c=a.l;c.Bj=b;d(a,c)};a.xc=n;a.yc=B;a.VF=function(a){if(!a.b4w_vehicle)return!1;a=a.b4w_vehicle_settings.part;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.TF=function(a){return a.b4w_vehicle?"BOB"==a.b4w_vehicle_settings.part?!0:!1:!1};a.XF=function(a){return a.b4w_floating?"BOB"==a.b4w_floating_settings.part?!0:!1:!1};a.Sw=function(a){return a.b4w_vehicle&&
"STEERING_WHEEL"==a.b4w_vehicle_settings.part?!0:!1};a.Rw=function(a){return a.b4w_vehicle&&"SPEEDOMETER"==a.b4w_vehicle_settings.part?!0:!1};a.Tw=function(a){return a.b4w_vehicle&&"TACHOMETER"==a.b4w_vehicle_settings.part?!0:!1};a.kw=function(a){return a.l.speed};a.OJ=function(a){switch(a){case "WHEEL_FRONT_LEFT":return 0;case "WHEEL_FRONT_RIGHT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.jk=I;a.DO=E;a.kF=function(){return R};a.SD=function(){f.v(f.VA)};a.iH=function(a){var b=
V.indexOf(a);-1==b&&K.error("Object "+a.name+" doesn't have bounding physics");for(var d=ea,c=a.n.I,e=d.n.q,g=[],k=0;k<e.length;k++)for(var h=e[k].fb,n=0;n<h.rc.length;n++)for(var p=h.rc[n],t=0;t<p.Xf.length;t++){var l=p.Xf[t],m=p.wk[t];if(l[0]==c||l[1]==c)p.Xf.splice(t,1),p.wk.splice(t,1),t--,m&&!q(p)&&(m=Q.set(0,0,0,O),p.callback(!1,null,m,m,0)),g.push(l)}g.length&&f.v(f.$s,g);a.n&&a.n.Hg&&r(a);delete ba[c];V.splice(b,1);a=d.n.q;for(b=0;b<a.length;b++)a[b].fb.I==c&&(a.splice(b,1),b--);f.v(f.aB,
c)}};b4w.module.__ipc=function(a){function y(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,e;for(e in c){var g=c[e];switch(g.constructor){case Float32Array:d+=g.length;break;case Number:d+=1}}--d;c.len=d}}a.hA=0;var e=a.$z=1,c=a.bA=2;a.aA=3;a.dA=4;a.eA=5;a.fA=6;a.iA=7;var b=a.kA=8,h=a.Is=9,m=a.lA=10;a.mA=11;var q=a.nA=12;a.oA=13;a.jA=14;a.gA=15;a.cA=16;a.YA=100;a.zA=101;a.AA=102;a.BA=103;a.CA=104;a.EA=105;a.DA=106;a.FA=107;a.GA=108;a.HA=109;a.IA=110;a.JA=111;a.KA=112;a.MA=113;a.NA=114;a.aB=115;a.OA=116;
a.PA=117;a.QA=118;a.SA=119;a.TA=120;a.UA=121;a.WA=122;a.XA=123;a.ZA=124;a.LA=125;a.cB=126;a.RA=127;a.$s=128;a.bB=129;a.dB=130;a.eB=131;a.fB=132;a.gB=133;a.hB=134;a.iB=135;a.jB=136;a.kB=137;a.lB=138;a.mB=139;a.at=140;var u=a.kl=141;a.nB=142;a.Zs=143;a.oB=144;a.pB=145;a.$A=146;a.VA=147;var w=null,g=[],l={Vc:q,I:0,time:0,h:new Float32Array(3),quat:new Float32Array(4),ce:new Float32Array(3),Rd:new Float32Array(3),len:0},z={Vc:b,Io:0,$q:0,h:new Float32Array(3),quat:new Float32Array(4),len:0},C={Vc:h,id:0,
Yh:0,hit_fract:0,hit_time:0,len:0},F={Vc:m,id:0,Yh:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},G={Vc:e,Dg:0,Eg:0,result:0,len:0},D={Vc:c,Dg:0,Eg:0,result:0,Ig:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},H={Vc:u,I:0,h:new Float32Array(3),quat:new Float32Array(4),len:0},x=[l,z,C,F,G,D,H];a.$b=function(a,g){function k(a){if(a.constructor==ArrayBuffer)a=new Float32Array(a);else if(a[0].constructor==ArrayBuffer){for(var n=0;n<a.length;n++)k(a[n]);
return}n=a[0]|0;switch(n){case q:var x=l;x.I=a[1]|0;x.time=a[2];x.h[0]=a[3];x.h[1]=a[4];x.h[2]=a[5];x.quat[0]=a[6];x.quat[1]=a[7];x.quat[2]=a[8];x.quat[3]=a[9];x.ce[0]=a[10];x.ce[1]=a[11];x.ce[2]=a[12];x.Rd[0]=a[13];x.Rd[1]=a[14];x.Rd[2]=a[15];break;case b:x=z;x.Io=a[1]|0;x.$q=a[2]|0;x.h[0]=a[3];x.h[1]=a[4];x.h[2]=a[5];x.quat[0]=a[6];x.quat[1]=a[7];x.quat[2]=a[8];x.quat[3]=a[9];break;case h:x=C;x.id=a[1]|0;x.Yh=a[2]|0;x.hit_fract=a[3];x.hit_time=a[4];break;case m:x=F;x.id=a[1]|0;x.Yh=a[2]|0;x.hit_fract=
a[3];x.hit_time=a[4];x.hit_pos[0]=a[5];x.hit_pos[1]=a[6];x.hit_pos[2]=a[7];x.hit_norm[0]=a[8];x.hit_norm[1]=a[9];x.hit_norm[2]=a[10];break;case e:x=G;x.Dg=a[1]|0;x.Eg=a[2]|0;x.result=!!a[3];break;case c:x=D;x.Dg=a[1]|0;x.Eg=a[2]|0;x.result=!!a[3];x.Ig[0]=a[4];x.Ig[1]=a[5];x.Ig[2]=a[6];x.coll_norm[0]=a[7];x.coll_norm[1]=a[8];x.coll_norm[2]=a[9];x.coll_dist=a[10];break;case u:x=H;x.I=a[1]|0;x.h[0]=a[2];x.h[1]=a[3];x.h[2]=a[4];x.quat[0]=a[5];x.quat[1]=a[6];x.quat[2]=a[7];x.quat[3]=a[8];break;default:x=
a}g(n,x)}y(x);a.addEventListener("message",function(a){k(a.data)},!1);w=a};a.aa=function(){w=null;g.length=0};a.v=function(a){if(w)switch(a){case q:var r=l,k=new Float32Array(r.len);k[0]=r.Vc;k[1]=r.I;k[2]=r.time;k[3]=r.h[0];k[4]=r.h[1];k[5]=r.h[2];k[6]=r.quat[0];k[7]=r.quat[1];k[8]=r.quat[2];k[9]=r.quat[3];k[10]=r.ce[0];k[11]=r.ce[1];k[12]=r.ce[2];k[13]=r.Rd[0];k[14]=r.Rd[1];k[15]=r.Rd[2];g.push(k.buffer);break;case b:r=z;k=new Float32Array(r.len);k[0]=r.Vc;k[1]=r.Io;k[2]=r.$q;k[3]=r.h[0];k[4]=r.h[1];
k[5]=r.h[2];k[6]=r.quat[0];k[7]=r.quat[1];k[8]=r.quat[2];k[9]=r.quat[3];g.push(k.buffer);break;case h:r=C;k=new Float32Array(r.len);k[0]=r.Vc;k[1]=r.id;k[2]=r.Yh;k[3]=r.hit_fract;k[4]=r.hit_time;g.push(k.buffer);break;case m:r=F;k=new Float32Array(r.len);k[0]=r.Vc;k[1]=r.id;k[2]=r.Yh;k[3]=r.hit_fract;k[4]=r.hit_time;k[5]=r.hit_pos[0];k[6]=r.hit_pos[1];k[7]=r.hit_pos[2];k[8]=r.hit_norm[0];k[9]=r.hit_norm[1];k[10]=r.hit_norm[2];g.push(k.buffer);break;case e:r=G;k=new Float32Array(r.len);k[0]=r.Vc;k[1]=
r.Dg;k[2]=r.Eg;k[3]=r.result;g.push(k.buffer);break;case c:r=D;k=new Float32Array(r.len);k[0]=r.Vc;k[1]=r.Dg;k[2]=r.Eg;k[3]=r.result;k[4]=r.Ig[0];k[5]=r.Ig[1];k[6]=r.Ig[2];k[7]=r.coll_norm[0];k[8]=r.coll_norm[1];k[9]=r.coll_norm[2];k[10]=r.coll_dist;g.push(k.buffer);break;case u:r=H;k=new Float32Array(r.len);k[0]=r.Vc;k[1]=r.I;k[2]=r.h[0];k[3]=r.h[1];k[4]=r.h[2];k[5]=r.quat[0];k[6]=r.quat[1];k[7]=r.quat[2];k[8]=r.quat[3];g.push(k.buffer);break;default:k=[];for(r=0;r<arguments.length;r++)k.push(arguments[r]);
w.postMessage(k)}};a.XG=function(){g.length&&(w.postMessage(g),g.length=0)};a.Vv=function(a){switch(a){case q:return l;case b:return z;case h:return C;case m:return F;case e:return G;case c:return D;case u:return H;default:return null}}};b4w.module.__renderer=function(a,y){function e(a){for(var c=a.j,d=a.q,e=0;e<d.length;e++){var g=d[e];if(g.Za){var l=a,m=c,q=g.Dd,u=g.B,w=u.pc;x.useProgram(w.Fk);for(var g=u.ja,f=u.Gt,p=w.vz,t=p.length;t--;){var y=p[t];y.Hp(x,y.gh,l,q,u,m)}m=u.su;x.colorMask(m,m,m,m);x.depthMask(u.da);u.Sa?x.enable(x.CULL_FACE):x.disable(x.CULL_FACE);m=u.X;for(u=0;u<m.length;u++)p=m[u],x.activeTexture(x.TEXTURE0+u),x.bindTexture(p.gc,p.ib);if("SKY"==l.type){m=l;w=w.Uk;u=m.j.tb.ib;p=m.Kj;for(t=0;6>t;t++)if(y=h(t),z.Lo?
(x.bindTexture(x.TEXTURE_CUBE_MAP,u),x.texImage2D(y,0,x.RGBA,1,1,0,x.RGBA,x.UNSIGNED_BYTE,H)):(x.uniformMatrix4fv(w.u_cube_view_matrix,!1,p[t]),x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,y,u,0),b(g,f,q.ms)),m.Fm&&3!=t){var y=m,C=t,D=A;z.Lo?D.set(H):(x.readPixels(191,191,1,1,x.RGBA,x.UNSIGNED_BYTE,D),255!=D[0]&&255!=D[1]&&255!=D[2]||x.readPixels(191,220,1,1,x.RGBA,x.UNSIGNED_BYTE,D));var F=D[0],G=D[1],D=D[2],F=F/255,G=G/255,D=D/255;2===C?(y.Lc[3]=F,y.Lc[7]=G,y.Lc[11]=D):2>C?(y.Lc[4*C]=
F,y.Lc[4*C+1]=G,y.Lc[4*C+2]=D):(y.Lc[4*(C-2)]=F,y.Lc[4*(C-2)+1]=G,y.Lc[4*(C-2)+2]=D)}l.Lj+=6}else b(g,f,q.ms),l.Lj++}}}function c(a){if(a){var b=(a.ka?x.COLOR_BUFFER_BIT:0)|(a.ra?x.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case "MAIN_GLOW":a=D;break;case "SHADOW_CAST":a=C;break;case "DEPTH":a=F;break;case "COLOR_PICKING":case "COLOR_PICKING_XRAY":case "ANCHOR_VISIBILITY":a=G;break;case "OUTLINE_MASK":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_EDGE_DETECTION":a=D;break;default:a=z.background_color}}else b=
x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT,a=z.background_color;x.colorMask(!0,!0,!0,!0);x.depthMask(!0);x.clearColor(a[0],a[1],a[2],a[3]);x.clear(b)}function b(a,b,d){x.bindBuffer(x.ARRAY_BUFFER,a.ng);for(var c=0;c<b.length;c++){var e=b[c];x.enableVertexAttribArray(e.gh);x.vertexAttribPointer(e.gh,e.nh,x.FLOAT,!1,0,e.lC+e.AE*d)}a.Re?(x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,a.Re),x.drawElements(a.mode,a.count,a.gq,0)):x.drawArrays(a.mode,0,a.count);for(c=0;c<b.length;c++)e=b[c],x.disableVertexAttribArray(e.gh)}
function h(a){switch(a){case 0:return x.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return x.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return x.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return x.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return x.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return x.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function m(a){var b=a.Uk,d=[],c=[],e={},g;for(g in b){var h=!1;switch(g){case "u_proj_matrix":var l=function(a,b,d,c,e,g){a.uniformMatrix4fv(b,!1,g.Aa)},h=!0;break;case "u_view_matrix":case "u_view_matrix_frag":l=
function(a,b,d,c,e,g){a.uniformMatrix4fv(b,!1,g.xa)};h=!0;break;case "u_shadow_cast_billboard_view_matrix":l=function(a,b,d,c,e,g){a.uniformMatrix4fv(b,!1,g.Sy)};h=!0;break;case "u_view_proj_prev":l=function(a,b,d,c,e,g){a.uniformMatrix4fv(b,!1,g.cH)};h=!0;break;case "u_view_proj_inverse":l=function(a,b,d,c,e,g){a.uniformMatrix4fv(b,!1,g.oj)};h=!0;break;case "u_sky_vp_inverse":l=function(a,b,d,c,e,g){a.uniformMatrix4fv(b,!1,g.he)};h=!0;break;case "u_camera_eye":case "u_camera_eye_frag":l=function(a,
b,d,c,e,g){a.uniform3fv(b,g.Hf)};h=!0;break;case "u_camera_eye_last":l=function(a,b,d,c,e,g){a.uniform3fv(b,g.gv)};h=!0;break;case "u_camera_quat":l=function(a,b,d,c,e,g){a.uniform4fv(b,g.quat)};h=!0;break;case "u_view_max_depth":l=function(a,b,d,c,e,g){a.uniform1f(b,g.$a)};h=!0;break;case "u_camera_range":l=function(a,b,d,c,e,g){a.uniform2f(b,g.cb,g.$a)};break;case "u_csm_center_dists":l=function(a,b,d,c,e,g){a.uniform4fv(b,g.Ku)};break;case "u_cam_water_depth":l=function(a,b,d){a.uniform1f(b,d.Go)};
h=!0;break;case "u_waves_height":l=function(a,b,d){a.uniform1f(b,d.qg)};break;case "u_waves_length":l=function(a,b,d){a.uniform1f(b,d.Mh)};break;case "u_fog_color_density":l=function(a,b,d){a.uniform4fv(b,d.Qc)};break;case "u_underwater_fog_color_density":l=function(a,b,d){a.uniform4fv(b,d.Ld)};break;case "u_bloom_key":l=function(a,b,d){a.uniform1f(b,d.bloom_key)};break;case "u_bloom_edge_lum":l=function(a,b,d){a.uniform1f(b,d.bloom_edge_lum)};break;case "u_time":l=function(a,b,d){a.uniform1f(b,d.time)};
h=!0;break;case "u_wind":l=function(a,b,d){a.uniform3fv(b,d.bl)};break;case "u_sky_tex_dvar":l=function(a,b,d){a.uniform1f(b,d.Wy)};break;case "u_sky_tex_fac":l=function(a,b,d){a.uniform4fv(b,d.Xy)};break;case "u_sky_tex_color":l=function(a,b,d){a.uniform3fv(b,d.Vy)};break;case "u_horizon_color":l=function(a,b,d){a.uniform3fv(b,d.Mf)};break;case "u_zenith_color":l=function(a,b,d){a.uniform3fv(b,d.rg)};break;case "u_environment_energy":l=function(a,b,d){a.uniform1f(b,d.Ff)};break;case "u_sky_color":l=
function(a,b,d){a.uniform3fv(b,d.Ti)};break;case "u_rayleigh_brightness":l=function(a,b,d){a.uniform1f(b,d.rayleigh_brightness)};break;case "u_mie_brightness":l=function(a,b,d){a.uniform1f(b,d.mie_brightness)};break;case "u_spot_brightness":l=function(a,b,d){a.uniform1f(b,d.spot_brightness)};break;case "u_scatter_strength":l=function(a,b,d){a.uniform1f(b,d.scatter_strength)};break;case "u_rayleigh_strength":l=function(a,b,d){a.uniform1f(b,d.rayleigh_strength)};break;case "u_mie_strength":l=function(a,
b,d){a.uniform1f(b,d.mie_strength)};break;case "u_rayleigh_collection_power":l=function(a,b,d){a.uniform1f(b,d.rayleigh_collection_power)};break;case "u_mie_collection_power":l=function(a,b,d){a.uniform1f(b,d.mie_collection_power)};break;case "u_mie_distribution":l=function(a,b,d){a.uniform1f(b,d.mie_distribution)};break;case "u_light_positions":l=function(a,b,d){a.uniform3fv(b,d.Pf)};break;case "u_light_directions":l=function(a,b,d){a.uniform3fv(b,d.dh)};break;case "u_light_color_intensities":l=
function(a,b,d){a.uniform3fv(b,d.bh)};break;case "u_light_factors":l=function(a,b,d){a.uniform4fv(b,d.eh)};break;case "u_sun_quaternion":l=function(a,b,d){a.uniform4fv(b,d.oz)};break;case "u_sun_intensity":l=function(a,b,d){a.uniform3fv(b,d.nz)};break;case "u_sun_direction":l=function(a,b,d){a.uniform3fv(b,d.xn)};break;case "u_height":l=function(a,b,d,c,e,g){a.uniform1f(b,g.height)};h=!0;break;case "u_model_matrix":l=function(a,b,d,c){a.uniformMatrix4fv(b,!1,c.Z)};h=!0;break;case "u_transb":l=function(a,
b,d,c){a.uniform4fv(b,c.jd)};h=!0;break;case "u_transa":l=function(a,b,d,c){a.uniform4fv(b,c.hd)};h=!0;break;case "u_arm_rel_trans":l=function(a,b,d,c){a.uniform4fv(b,c.oo)};h=!0;break;case "u_arm_rel_quat":l=function(a,b,d,c){a.uniform4fv(b,c.no)};h=!0;break;case "u_quat":l=function(a,b,d,c){a.uniform4fv(b,c.quat)};h=!0;break;case "u_quatsb":l=function(a,b,d,c){a.uniform4fv(b,c.Zc)};h=!0;break;case "u_quatsa":l=function(a,b,d,c){a.uniform4fv(b,c.Yc)};h=!0;break;case "u_frame_factor":l=function(a,
b,d,c){a.uniform1f(b,c.Pg)};h=!0;break;case "au_center_pos":l=function(){};h=!0;break;case "au_wind_bending_amp":l=function(a,b,d,c){a.uniform1f(b,c.qe)};h=!0;break;case "au_wind_bending_freq":l=function(a,b,d,c){a.uniform1f(b,c.qf)};h=!0;break;case "au_detail_bending_freq":l=function(a,b,d,c){a.uniform1f(b,c.Ie)};h=!0;break;case "au_detail_bending_amp":l=function(a,b,d,c){a.uniform1f(b,c.He)};h=!0;break;case "au_branch_bending_amp":l=function(a,b,d,c){a.uniform1f(b,c.Ce)};h=!0;break;case "u_node_values":l=
function(a,b,d,c){a.uniform1fv(b,c.Tf)};h=!0;break;case "u_node_rgbs":l=function(a,b,d,c){a.uniform3fv(b,c.de)};h=!0;break;case "u_diffuse_color":l=function(a,b,d,c,e){a.uniform4fv(b,e.Je)};h=!0;break;case "u_diffuse_intensity":l=function(a,b,d,c,e){a.uniform1f(b,e.Pj)};h=!0;break;case "u_diffuse_params":l=function(a,b,d,c,e){a.uniform2fv(b,e.Pc)};h=!0;break;case "u_emit":l=function(a,b,d,c,e){a.uniform1f(b,e.ki)};h=!0;break;case "u_ambient":l=function(a,b,d,c,e){a.uniform1f(b,e.Rh)};h=!0;break;case "u_specular_color":l=
function(a,b,d,c,e){a.uniform3fv(b,e.Rk)};h=!0;break;case "u_specular_alpha":l=function(a,b,d,c,e){a.uniform1f(b,e.Ir)};h=!0;break;case "u_specular_params":l=function(a,b,d,c,e){a.uniform3fv(b,e.Vi)};h=!0;break;case "u_reflect_factor":l=function(a,b,d,c,e){a.uniform1f(b,e.bn)};h=!0;break;case "u_mirror_factor":l=function(a,b,d,c,e){a.uniform1f(b,e.Iq)};h=!0;break;case "u_grass_map_dim":l=function(a,b,d,c,e){a.uniform3fv(b,e.wc)};h=!0;break;case "u_grass_size":l=function(a,b,d,c,e){a.uniform1f(b,e.Wp)};
h=!0;break;case "u_scale_threshold":l=function(a,b,d,c,e){a.uniform1f(b,e.qw)};h=!0;break;case "u_cube_fog":l=function(a,b,d,c,e){a.uniformMatrix4fv(b,!1,e.Lc)};break;case "u_jitter_amp":l=function(a,b,d,c,e){a.uniform1f(b,e.Uw)};h=!0;break;case "u_jitter_freq":l=function(a,b,d,c,e){a.uniform1f(b,e.Vw)};h=!0;break;case "u_wireframe_mode":l=function(a,b,d,c,e){a.uniform1i(b,e.wireframe_mode)};break;case "u_wireframe_edge_color":l=function(a,b,d,c,e){a.uniform3fv(b,e.wireframe_edge_color)};break;case "u_subpixel_jitter":l=
function(a,b,d){a.uniform2fv(b,d.dG)};h=!0;break;case "u_subsample_indices":l=function(a,b,d){a.uniform4fv(b,d.eG)};h=!0;break;case "u_refr_bump":l=function(a,b,d,c,e){a.uniform1f(b,e.ey)};h=!0;break;case "u_lamp_light_positions":l=function(a,b,d,c,e){a.uniform3fv(b,e.tq)};break;case "u_lamp_light_directions":l=function(a,b,d,c,e){a.uniform3fv(b,e.rq)};break;case "u_lamp_light_color_intensities":l=function(a,b,d,c,e){a.uniform3fv(b,e.qq)};break;case "u_lamp_light_factors":l=function(a,b,d,c,e){a.uniform4fv(b,
e.sq)};break;case "u_halo_size":l=function(a,b,d,c,e){a.uniform1f(b,e.vw)};h=!0;break;case "u_halo_hardness":l=function(a,b,d,c,e){a.uniform1f(b,e.sw)};h=!0;break;case "u_halo_rings_color":l=function(a,b,d,c,e){a.uniform3fv(b,e.uw)};h=!0;break;case "u_halo_lines_color":l=function(a,b,d,c,e){a.uniform3fv(b,e.tw)};h=!0;break;case "u_halo_stars_blend":l=function(a,b,d,c,e){a.uniform1f(b,e.ww)};h=!0;break;case "u_halo_stars_height":l=function(a,b,d,c,e){a.uniform1f(b,e.xw)};h=!0;break;case "u_fresnel_params":l=
function(a,b,d,c,e){a.uniform4fv(b,e.Rg)};h=!0;break;case "u_texture_scale":l=function(a,b,d,c,e){a.uniform3fv(b,e.kg)};h=!0;break;case "u_parallax_scale":l=function(a,b,d,c,e){a.uniform1f(b,e.Pm)};h=!0;break;case "u_color_id":l=function(a,b,d,c){a.uniform3fv(b,c.Nl)};h=!0;break;case "u_line_points":l=function(a,b,d,c,e){a.uniform3fv(b,e.NO)};h=!0;break;case "u_diffuse_color_factor":l=function(a,b,d,c,e){a.uniform1f(b,e.Oj)};h=!0;break;case "u_alpha_factor":l=function(a,b,d,c,e){a.uniform1f(b,e.xj)};
h=!0;break;case "u_specular_color_factor":l=function(a,b,d,c,e){a.uniform1f(b,e.dz)};h=!0;break;case "u_normal_factor":l=function(a,b,d,c,e){a.uniform1f(b,e.px)};h=!0;break;case "u_normalmap0_scale":l=function(a,b,d,c,e){a.uniform2fv(b,e.mh[0])};h=!0;break;case "u_normalmap1_scale":l=function(a,b,d,c,e){a.uniform2fv(b,e.mh[1])};h=!0;break;case "u_normalmap2_scale":l=function(a,b,d,c,e){a.uniform2fv(b,e.mh[2])};h=!0;break;case "u_normalmap3_scale":l=function(a,b,d,c,e){a.uniform2fv(b,e.mh[3])};h=!0;
break;case "u_foam_factor":l=function(a,b,d,c,e){a.uniform1f(b,e.bm)};h=!0;break;case "u_foam_uv_freq":l=function(a,b,d,c,e){a.uniform2fv(b,e.jv)};h=!0;break;case "u_foam_mag":l=function(a,b,d,c,e){a.uniform2fv(b,e.iv)};h=!0;break;case "u_foam_scale":l=function(a,b,d,c,e){a.uniform2fv(b,e.Ap)};h=!0;break;case "u_water_norm_uv_velocity":l=function(a,b,d,c,e){a.uniform1f(b,e.Kn)};h=!0;break;case "u_shallow_water_col":l=function(a,b,d,c,e){a.uniform3fv(b,e.nn)};h=!0;break;case "u_shore_water_col":l=
function(a,b,d,c,e){a.uniform3fv(b,e.rn)};h=!0;break;case "u_water_shallow_col_fac":l=function(a,b,d,c,e){a.uniform1f(b,e.on)};h=!0;break;case "u_water_shore_col_fac":l=function(a,b,d,c,e){a.uniform1f(b,e.sn)};h=!0;break;case "u_p_length":l=function(a,b,d,c,e){a.uniform1f(b,e.Fx)};h=!0;break;case "u_p_cyclic":l=function(a,b,d,c,e){a.uniform1i(b,e.Bx)};h=!0;break;case "u_p_max_lifetime":l=function(a,b,d,c,e){a.uniform1f(b,e.Hx)};h=!0;break;case "u_p_fade_in":l=function(a,b,d,c,e){a.uniform1f(b,e.Cx)};
h=!0;break;case "u_p_fade_out":l=function(a,b,d,c,e){a.uniform1f(b,e.Dx)};h=!0;break;case "u_p_size":l=function(a,b,d,c,e){a.uniform1f(b,e.Sq)};h=!0;break;case "u_p_alpha_start":l=function(a,b,d,c,e){a.uniform1f(b,e.yx)};h=!0;break;case "u_p_alpha_end":l=function(a,b,d,c,e){a.uniform1f(b,e.xx)};h=!0;break;case "u_p_nfactor":l=function(a,b,d,c,e){a.uniform1f(b,e.Rq)};h=!0;break;case "u_p_gravity":l=function(a,b,d,c,e){a.uniform1f(b,e.Ex)};h=!0;break;case "u_p_mass":l=function(a,b,d,c,e){a.uniform1f(b,
e.Gx)};h=!0;break;case "u_p_size_ramp":l=function(a,b,d,c,e){a.uniform2fv(b,e.Ix)};h=!0;break;case "u_p_color_ramp":l=function(a,b,d,c,e){a.uniform4fv(b,e.zx)};h=!0;break;case "u_p_wind":l=function(a,b,d,c,e){a.uniform3fv(b,e.Om)};h=!0;break;case "u_texel_size":l=function(a,b,d){a.uniform2fv(b,d.Vr)};h=!0;break;case "u_p_time":l=function(a,b,d,c,e){a.uniform1f(b,e.Wc.W.time)};h=!0;break;case "u_position":l=function(a,b,d,c,e){a.uniform3fv(b,e.Ek)};h=!0;break;case "u_va_frame_factor":l=function(a,
b,d,c){a.uniform1f(b,c.Jz)};h=!0;break;case "u_perspective_cast_far_bound":l=function(a,b,d){a.uniform1f(b,d.PG)};break;case "u_normal_offset":l=function(a,b,d){a.uniform1f(b,d.self_shadow_normal_offset)};break;case "u_pcf_blur_radii":l=function(a,b,d,c,e,g){a.uniform4fv(b,g.Tm)};break;case "u_v_light_matrix":l=function(a,b,d){a.uniformMatrix4fv(b,!1,d.Iz)};h=!0;break;case "u_b_light_matrix":l=function(a,b,d){a.uniformMatrix4fv(b,!1,d.Mt)};break;case "u_p_light_matrix0":l=function(a,b,d){a.uniformMatrix4fv(b,
!1,d.th[0])};h=!0;break;case "u_p_light_matrix1":l=function(a,b,d){a.uniformMatrix4fv(b,!1,d.th[1])};h=!0;break;case "u_p_light_matrix2":l=function(a,b,d){a.uniformMatrix4fv(b,!1,d.th[2])};h=!0;break;case "u_p_light_matrix3":l=function(a,b,d){a.uniformMatrix4fv(b,!1,d.th[3])};h=!0;break;case "u_motion_blur_exp":l=function(a,b,d){a.uniform1f(b,d.jx)};h=!0;break;case "u_motion_blur_decay_threshold":l=function(a,b,d){a.uniform1f(b,d.mb_decay_threshold)};h=!0;break;case "u_refl_plane":l=function(a,b,
d,c){a.uniform4fv(b,c.Cc)};break;case "u_radial_blur_step":l=function(a,b,d){a.uniform1f(b,d.Zm)};break;case "u_god_rays_intensity":l=function(a,b,d){a.uniform1f(b,d.god_rays_intensity)};break;case "u_ssao_radius_increase":l=function(a,b,d){a.uniform1f(b,d.Zi)};break;case "u_ssao_blur_discard_value":l=function(a,b,d){a.uniform1f(b,d.ssao_blur_discard_value)};h=!0;break;case "u_ssao_influence":l=function(a,b,d){a.uniform1f(b,d.Yi)};break;case "u_ssao_dist_factor":l=function(a,b,d){a.uniform1f(b,d.Xi)};
break;case "u_dof_dist":l=function(a,b,d,c,e,g){a.uniform1f(b,g.dof_distance)};h=!0;break;case "u_dof_front":l=function(a,b,d,c,e,g){a.uniform1f(b,g.dof_front)};h=!0;break;case "u_dof_rear":l=function(a,b,d,c,e,g){a.uniform1f(b,g.dof_rear)};h=!0;break;case "u_outline_intensity":l=function(a,b,d,c){a.uniform1f(b,c.ee)};h=!0;break;case "u_outline_color":l=function(a,b,d){a.uniform3fv(b,d.Wf)};break;case "u_draw_outline":l=function(a,b,d){a.uniform1f(b,d.op)};h=!0;break;case "u_glow_mask_small_coeff":l=
function(a,b,d){a.uniform1f(b,d.small_glow_mask_coeff)};h=!0;break;case "u_glow_mask_large_coeff":l=function(a,b,d){a.uniform1f(b,d.large_glow_mask_coeff)};h=!0;break;case "u_brightness":l=function(a,b,d){a.uniform1f(b,d.brightness)};break;case "u_contrast":l=function(a,b,d){a.uniform1f(b,d.contrast)};break;case "u_exposure":l=function(a,b,d){a.uniform1f(b,d.exposure)};break;case "u_saturation":l=function(a,b,d){a.uniform1f(b,d.saturation)};break;default:l=null}l&&(l={name:g,Hp:l,gh:b[g]},h?d.push(l):
(c.push(l),e[g]=l))}a.vz=d;a.zk=c;a.Uq=e}var q=y("__config"),u=y("__debug"),w=y("__textures"),g=y("__util"),l=y("__camera");y("mat4");var z=q.r,C=[1,1,1,1],F=[1,1,1,1],G=[0,0,0,1],D=[0,0,0,0],H=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var x=null,A=new Uint8Array(4);a.Id=function(a){var b=z.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);
a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);x=a};a.Rj=function(a){if(a.Za){var b=a.j;x.bindFramebuffer(x.FRAMEBUFFER,b.Oe);if(a.po){var d=b.tb;x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,d.gc,d.ib,0)}x.viewport(0,0,b.width,b.height);"MAIN_CUBE_REFLECT"!=a.type&&c(a);a.Ja?x.enable(x.BLEND):x.disable(x.BLEND);a.Ub?x.enable(x.DEPTH_TEST):x.disable(x.DEPTH_TEST);if(a.ua){for(var b=a.j,d=a.q,g=0;g<d.length;g++){var q=
d[g],w=q.B,A=w.pc;x.useProgram(A.Fk);q=q.Dd;A.zk.length||m(A);for(var A=A.zk,y=A.length;y--;){var C=A[y];C.Hp(x,C.gh,a,q,w,b)}}a.ua=!1}switch(a.type){case "DEPTH":z.Jw?(x.enable(x.POLYGON_OFFSET_FILL),x.polygonOffset(5,5)):x.disable(x.POLYGON_OFFSET_FILL);x.cullFace(x.BACK);break;case "SHADOW_CAST":x.enable(x.POLYGON_OFFSET_FILL);x.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);x.cullFace(x.BACK);break;case "MAIN_PLANE_REFLECT":x.disable(x.POLYGON_OFFSET_FILL);x.cullFace(x.FRONT);
break;default:x.disable(x.POLYGON_OFFSET_FILL),x.cullFace(x.BACK)}if("MAIN_CUBE_REFLECT"==a.type)for(b=a.j,d=b.tb.ib,g=0;6>g;g++){w=h(g);b.xa=a.Kj[g];l.Eo(b);x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,w,d,0);c(a);w=a.q;for(q=0;q<w.length;q++)w[q].Za=w[q].np[g];e(a)}else e(a);u.OC("draw subscene: "+a.type);x.bindFramebuffer(x.FRAMEBUFFER,null)}};a.clear=function(a){x.bindFramebuffer(x.FRAMEBUFFER,a.j.Oe);c(a)};a.gC=function(a){var b=a.Gt;b.length=0;var d=a.ja;a=a.pc;d&&a||g.ma("Incomplete batch");
d=d.Ki;a=a.attributes;for(var c in a){var e=d[c];b.push({gh:a[c],lC:4*e.offset,AE:1<e.frames?4*e.length:0,nh:e.nh})}};a.kC=m;a.Et=function(a){var b=a.pc,d=a.X;a=a.fd;x.useProgram(b.Fk);for(var c=0;c<d.length;c++)x.uniform1i(b.Uk[a[c]],c)};a.dy=function(a,b,d,c,e,h){c||(c=1);e||(e=1);h||(h=new Uint8Array(4*c*e));h.length!=4*c*e&&g.ma("read_pixels(): Wrong storage");x.bindFramebuffer(x.FRAMEBUFFER,a);x.readPixels(b,d,c,e,x.RGBA,x.UNSIGNED_BYTE,h);x.bindFramebuffer(x.FRAMEBUFFER,null);return h};a.ZI=
function(a){var b=a.pc;x.useProgram(b.Fk);b.zk.length||m(b);b=b.Uq.u_cube_fog;b.Hp(x,b.gh,null,null,a,null)};a.oH=function(a,b){var d=x.createFramebuffer();x.bindFramebuffer(x.FRAMEBUFFER,d);if(a){var c=a,e=c.ib,c=c.gc==x.TEXTURE_CUBE_MAP?x.TEXTURE_CUBE_MAP_NEGATIVE_Z:c.gc;x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,c,e,0)}w.Qw(b)?x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_ATTACHMENT,x.RENDERBUFFER,b.og):w.nk(b)&&(c=b,e=c.ib,c=c.gc,x.framebufferTexture2D(x.FRAMEBUFFER,x.DEPTH_ATTACHMENT,
c,e,0));u.JC();x.bindFramebuffer(x.FRAMEBUFFER,null);return d};a.nH=function(a,b,d,c,e){null==a?(x.bindFramebuffer(x.FRAMEBUFFER,a),x.viewport(0,0,c,e),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT)):(w.nk(b)&&x.deleteTexture(b.ib),w.Qw(d)?x.deleteRenderbuffer(d.og):w.nk(d)&&x.deleteTexture(d.ib),x.deleteFramebuffer(a))};a.sO=function(){};a.aa=function(){}};b4w.module.__transform=function(a,y){function e(a,b){var d=a.e;d.h[0]=b[0];d.h[1]=b[1];d.h[2]=b[2];d.scale=b[3];d.quat[0]=b[4];d.quat[1]=b[5];d.quat[2]=b[6];d.quat[3]=b[7]}function c(a){var e=a.e,r=z.pi(),u=a.type;"CAMERA"==u&&h.js(a);m.cJ(a,d);"CAMERA"==u&&h.aJ(a);var x=e.h,A=e.scale,y=e.quat;F.Bh(x,A,y,e.Pb);var f=e.Z;w.fromQuat(y,f);"CAMERA"!=u&&G.zH(f,A,f);f[12]=x[0];f[13]=x[1];f[14]=x[2];w.invert(f,e.Hw);a.D.length&&g.$p(a)&&g.dJ(a);e.hc&&e.sb&&(b.zo(e.hc,f,e.sb),b.Bo(e.xd,f,e.Kb),b.Ao(e.Bg,
e.Pb,e.Cg),e.cd&&z.qr(r),null!=e.Mc&&r&&z.Bz(r,a));if(r&&r.e.Nb)for(f=r.e.Nb.an,A=0;A<f.length;A++)if(f[A]==a){z.Dz(A,r);break}switch(u){case "SPEAKER":C.rI(a,d);break;case "CAMERA":h.bJ(a);r&&z.fm(r)==a&&C.kG(r,x,y,d);break;case "LAMP":q.gJ(a);r&&z.fJ(a,r);break;case "EMPTY":a.field&&z.Cz(a);break;case "MESH":if(x=a.sl)F.invert(x.e.Pb,k),F.multiply(k,e.Pb,k),H.set(k[0],k[1],k[2],k[3],e.oo),l.set(k[4],k[5],k[6],k[7],e.no)}"LAMP"!=u&&"CAMERA"!=u||!r||(z.qr(r),z.CH(r));a=a.nd;for(A=0;A<a.length;A++)c(a[A]);
e.Fp=!0}var b=y("__boundings"),h=y("__camera"),m=y("__constraints"),q=y("__lights"),u=y("__mat3"),w=y("__mat4"),g=y("__particles"),l=y("__quat"),z=y("__scenes"),C=y("__sfx"),F=y("__tsr"),G=y("__util"),D=y("__vec3"),H=y("__vec4"),x=new Float32Array(3),A=new Float32Array(4),r=new Float32Array(9),k=new Float32Array(8),d=0;a.pl=0;a.ol=1;a.update=function(a){d=a};a.Hd=function(a,b){m.Qe(a)==m.ue?F.ln(b,m.Pe(a)):D.copy(b,a.e.h)};a.be=function(a,b){m.Qe(a)==m.ue?D.copy(F.ri(m.Pe(a)),b):D.copy(a.e.h,b)};
a.gf=function(a,b){m.Qe(a)==m.ue?F.Ok(b,m.Pe(a)):l.copy(b,a.e.quat)};a.If=function(a,b){m.Qe(a)==m.ue?l.copy(F.qi(m.Pe(a)),b):l.copy(a.e.quat,b)};a.vr=function(a,b){if(m.Qe(a)==m.ue){var d=G.Gf(b,A);F.Ok(d,m.Pe(a))}else G.Gf(b,a.e.quat)};a.ge=function(a,b){m.Qe(a)==m.ue?F.ge(b,m.Pe(a)):a.e.scale=b};a.Vg=function(a){return m.Qe(a)==m.ue?F.Vg(m.Pe(a)):a.e.scale};a.gk=function(a,b){if(m.Qe(a)==m.ue)F.copy(m.Pe(a),b);else{var d=a.e;F.Bh(d.h,d.scale,d.quat,b)}};a.Pk=function(a,b){m.Qe(a)==m.ue?F.copy(b,
m.Pe(a)):e(a,b)};a.WH=e;a.Rp=function(a){var b=a.e,d=a.data.b4w_bounding_box;a=b.scale*(d.max_x-d.min_x);var c=b.scale*(d.max_y-d.min_y),b=b.scale*(d.max_z-d.min_z);return.5*Math.sqrt(a*a+c*c+b*b)};a.jm=function(a,b,d){d||(d=new Float32Array(3));b?(b=a.e,D.copy(b.Kb.G,d)):(b=a.e,a=a.data.b4w_bounding_box,d[0]=(a.max_x+a.min_x)/2,d[1]=(a.max_y+a.min_y)/2,d[2]=(a.max_z+a.min_z)/2,D.transformMat4(d,b.Z,d));return d};a.Uc=function(a,b,d,c){a=a.e;x[0]=b;x[1]=d;x[2]=c;b=u.fromMat4(a.Z,r);D.transformMat3(x,
b,x);D.add(a.h,x,a.h)};a.w=c;a.distance=function(a,b){return D.dist(a.e.h,b.e.h)};a.KG=function(a,b){return D.dist(a.e.h,b)};a.Wv=function(a){return{max_x:a.e.sb.max_x,min_x:a.e.sb.min_x,max_y:a.e.sb.max_y,min_y:a.e.sb.min_y,max_z:a.e.sb.max_z,min_z:a.e.sb.min_z}}};b4w.module.__loader=function(a,y){function e(b,e,g,d){var h=x,l=G.create(),m;for(m in e){var q=c(e[m]);(d&&q.ob||!b&&q.Eb)&&z(q);G.u(l,q)}for(m in e)for(q=e[m],q.name=m,b=0;b<q.H.length;b++)G.m(l,e[q.H[b]],q,null);e=c({name:"out",Ua:a.Yz,mb:function(a,b,d,c,e){0===b.id&&(h.Mr=!0);F(b)||(b.status=2);b.dx(b.id,!0);e(b,d);D.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},pb:5});var u=[];if(g)for(g=G.ew(l),b=0;b<g.length;b++)u.push(G.ab(l,g[b]));else G.V(l,function(a,b){b.lb||u.push(b)});G.u(l,
e);for(b=0;b<u.length;b++)e.H.push(u[b].name),G.m(l,u[b],e,null);return l}function c(a){a.lb=a.lb||!1;a.Ua||0===a.Ua||(a.Ua=a.Od);a.H=a.H||[];a.kk=a.kk||!1;a.Cr=a.Cr||!1;a.pb=a.pb||0;a.ob=a.ob||!1;a.Eb=a.Eb||!1;a.status=0;a.RO=0;a.Aq=0;a.Fg=a.Fg||null;return a}function b(a,b){for(var c=[],d=[],e=0;e<b.length;e++){var g=b[e];G.ab(a.je,g).kk&&(G.lg(a.je,g,function(d){var e=!0;G.of(a.je,d,function(a,b){if(!b.kk)return e=!1,1});e&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(e))}for(e=d.length-
1;0<=e;e--)b.splice(d[e],1);return c}function h(a){function c(b,d){var e=G.ab(a.je,b),g=G.ab(a.je,d),k=g.Ua-e.Ua;0==k&&(k=e.lb-g.lb);return k}var e=[],d=a.mf,g=!1;do{var h=b(a,d);e.push.apply(e,d);0<h.length&&(g=!0);d=h}while(0<h.length);g&&e.sort(c);a.mf=e;return a.mf.length}function m(a,b,c){if(b.Cr)return b.kk=!0,u(a,b),!1;if(!b.mb&&!b.Af&&!b.Cj)return u(a,b),!1;if(0==b.status&&(b.status++,b.mb))return b.mb(c,a,b,b.Fg,u,w),!0;if(1==b.status){if(b.Af)return b.Af(c,a,b,b.Fg,u,w),!0;b.status++}return 2==
b.status&&(b.status++,b.Cj)?(b.Cj(c,a,b,b.Fg,u,w),!0):!1}function q(a){if(0==a.wn)return 100;var b=0;G.V(a.je,function(c,d){a.do_not_load_resources&&d.ob||(b+=d.Aq*d.pb)});return H.trunc(100*b/a.wn)}function u(a,b){b.kk=!0;b.status=3;g(a,b,1)}function w(a,b,c){1>c?g(a,b,c):b.status++}function g(a,b,c){var d=x;if(b.mb||b.Af||b.Cj)if(b.Aq=c,b=q(a),a.Nu!=b||1==c)a.Lr(b,performance.now()-a.rz),a.Nu=b,d.Dq=!0}function l(a,b){var c=null;G.V(a.je,function(a,e){if(e.name==b)return c=e,1});return c}function z(a){a.Cr=
!0;a.Aq=1}function C(a){a.Lr=null;a.Qo=null;a.je=null;a.mf=null}function F(a){return a&&(3==a.status||4==a.status)}var G=y("__graph"),D=y("__print"),H=y("__util");a.Od=0;a.se=1;a.Yz=2;var x=null;a.cw=function(){return x};a.DD=function(){var a={me:[],ep:0,vl:0,Mr:!1,Dq:!1};return x=a};a.KD=function(a,b,c,d,g,h,l,m){var q=x,u={id:q.me.length,status:0,s:b,Nt:"",dx:c||function(){},zq:m||!1,SQ:h,rz:0,Nu:0,wn:0,pr:!1,Lr:d||function(){},Qo:g||function(){},je:null,mf:null,eq:!1,aq:!1,iq:!1};a=e(0===u.id,
a,h,l);u.je=a;b=[];c=G.wF(a);for(d=0;d<c.length;d++)b.push(c[d]);u.mf=b;G.V(a,function(a,b){!(b.mb||b.Af||b.Cj)||u.do_not_load_resources&&b.ob||(u.wn+=b.pb)});q.me.push(u);q.vl++;return u.id};a.lJ=function(b){var c=x;if(c&&0!=x.vl)if(c.Dq)c.Dq=!1;else{var e=performance.now();do{var d=c.me[c.ep],g=b[d.id];if(!F(d))if(0==d.status&&(d.status=1,d.rz=performance.now(),d.Lr(0,0)),h(d)){var l=d,q=l.mf.length;do{var u=G.ab(l.je,l.mf[0]),w=m(l,u,g);u.Ua==a.se&&(l.pr=!0);u=l.mf.shift();l.mf.push(u);q--}while(!w&&
0!=q)}else l=c,q=d,q.Qo(g,q),q.status=3,l.vl--,C(q);c.Mr&&(c.ep=(c.ep+1)%c.me.length);if(d.pr){d.pr=!1;break}}while(16>performance.now()-e)}};a.nt=function(a){var b=x;a.Qo(null,a);a.status=3;b.vl--;C(a);a.status=4;0===a.id&&(b.Mr=!0);a.dx(a.id,!1)};a.yQ=w;a.Uy=function(a,b){var c=l(a,b);null!==c&&z(c)};a.NI=F;a.Ue=function(a){var b=x;if(!b)return!1;a|=0;return b.me[a]&&(3==b.me[a].status||2==b.me[a].status)};a.aa=function(){x=null}};b4w.module.__primitives=function(a,y){function e(a,b,c,e){for(var h=[],m=[],u=[],y=[],H=2*c/(a-1),x=2*e/(b-1),A=0;A<a;A++)for(var r=-c+A*H,k=0;k<b;k++)if(m.push(r,0,-e+k*x),u.push(0,1,0),y.push(A/(a-1),k/(b-1)),A&&k){var d=A*b+k,n=d-1,B=(A-1)*b+k,I=B-1;h.push(d,n,B);h.push(n,I,B)}a=q.yd();a.a_position=new Float32Array(m);a.a_normal=new Float32Array(u);u=q.yb("GRID_PLANE");u.A[0]=a;u.K.a_texcoord=new Float32Array(y);u.la=new Uint32Array(h);u.N=m.length/3;return u}function c(a){var b=a.length;if(b%
4)throw"Wrong array";for(var c=[],e=[],m=0;m<b;m+=4){var u=a[m+1],y=a[m+2],D=a[m+3];h(a[m],e);h(u,e);h(y,e);h(D,e);c.push(m,m+1,m+2);c.push(m,m+2,m+3)}a=q.yd();a.a_position=new Float32Array(e);b=q.yb("FROM_QUADS");b.A[0]=a;b.la=new Uint32Array(c);b.N=e.length/3;return b}function b(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function h(a,b){b.push(a[0],a[1],a[2])}var m=y("__geometry"),q=y("__util"),u=y("__config").r;a.jN=function(a){for(var b=q.yb("LINE"),c=[],e=0;e<2*a;e++)c.push(e);e=q.yd();e.a_point=
new Float32Array(c);b.A[0]=e;b.la=new Uint32Array(c);b.N=2*a;return b};a.kN=function(a,b){var c=e(2,2,a,b);c.name="PLANE";return c};a.iN=e;a.QE=function(a,b,c){function e(a,b){return 1==a%2&&(0==b||b==D-1)||1==b%2&&(0==a||a==G-1)?!0:!1}var h=c/=Math.pow(2,a-1),y=c,G=b+1,D=b+1;b=[];c=[];for(var H=0,x=0,A=-1,r=[],k=0;k<a;k++){for(var d=2*h/(G-1),n=2*y/(D-1),B=[],I=[],E=0,M=0;M<G;M++){for(var K=-h+M*d,J=[],f=0;f<D;f++){var p=-y+f*n;if(K>-H&&K<H&&p>-x&&p<x)J.push(-1),E++;else{for(var t=null,L=0;L<r.length;L+=
3)if(K==r[L]&&p==r[L+1]){t=r[L+2];break}L=null!==t?t:A+1;e(M,f)?(J.push(-2),E++):(null==t&&(0==f||f==D-1||0==M||M==G-1?(t=k==a-1?d:2*d,B.push(K,p,L)):t=d,c.push(K,t,p),A++),J.push(L));if(M&&f)if(1==M)if(e(M-1,f)){if(1<f){var p=L-1,t=I[M-1][f+1],N=t-1;b.push(L,p,N)}else t=I[M-1][f+1],N=t-1;b.push(L,N,t)}else e(M,f)||(p=L-1,t=I[M-1][f],b.push(L,p,t));else if(M==G-1){if(!e(M,f))if(f==D-1)p=L-1,t=I[M-1][f-1],N=I[M-2][f],b.push(L,p,t),b.push(L,t,N);else{var p=L-1,t=I[M-1][f],N=t-1,T=t+1;b.push(L,p,N);
b.push(L,N,t);b.push(L,t,T);2==f&&(T=I[M-2][f-2],b.push(p,T,N))}}else 1==f?e(M,f-1)?(p=I[M-1][f],t=I[M-1][f-1],b.push(L,t,p)):(p=J[f-1],t=I[M-1][f],N=I[M-2][f-1],b.push(L,p,t),b.push(p,N,t)):f==D-1?e(M,f)||(p=J[f-1],t=I[M-1][f-1],N=I[M-2][f],b.push(L,p,t),b.push(L,t,N)):-1!=I[M-1][f]&&-1!=I[M-1][f-1]&&-1!=J[f-1]?(p=J[f-1],t=I[M-1][f],N=I[M-1][f-1],b.push(L,p,t),b.push(p,N,t),f==D-2&&e(M,f+1)&&(T=I[M-1][f+1],b.push(L,t,T))):f==D-2&&e(M,f+1)&&(t=I[M-1][f],T=I[M-1][f+1],b.push(L,t,T))}}I.push(J)}r=B;
H=h;x=y;h*=2;y*=2}2E4>H&&(a=-(2*H)/(G-1),c.push(-2E4,a,-2E4),c.push(-2E4,a,2E4),c.push(-H,a,-x),c.push(-H,a,x),c.push(2E4,a,-2E4),c.push(2E4,a,2E4),c.push(H,a,-x),c.push(H,a,x),L=A+1,b.push(L+3,L+2,L+1,L+2,L+0,L+1,L+6,L+4,L+2,L+4,L+0,L+2,L+5,L+7,L+1,L+7,L+3,L+1,L+5,L+4,L+7,L+7,L+4,L+6));a=q.yd();a.a_position=new Float32Array(c);h=q.yb("multigrid_plane");h.A[0]=a;h.la=new Uint32Array(b);h.N=c.length/3;u.Sz&&(m.Qr(h,1,!0),a.a_polyindex=m.dv(h));return h};a.hN=function(a){var b=a.length;if(b%3)throw"Wrong array";
for(var c=[],e=[],m=0;m<b;m+=3){var u=a[m+1],y=a[m+2];h(a[m],e);h(u,e);h(y,e);c.push(m,m+1,m+2)}a=q.yd();a.a_position=new Float32Array(e);b=q.yb("FROM_TRIANGLES");b.A[0]=a;b.la=new Uint32Array(c);b.N=e.length/3;return b};a.gN=c;a.ME=function(a){a=q.GJ(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=c(b);a.name="FRUSTUM";return a};a.zb=function(){var a=q.yb("FULLSCREEN_TRI"),
b=q.yd();b.a_position=new Float32Array([0,0,1,0,0,1]);a.A[0]=b;a.la=new Uint32Array([0,1,2]);a.N=3;return a};a.NE=function(){var a=q.yb("FULLSCREEN_QUAD"),b=q.yd();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.A[0]=b;a.la=new Uint32Array([0,2,1,1,2,3]);a.N=4;return a};a.IE=function(){var a=q.yb("BILLBOARD"),b=q.yd();b.a_bb_vertex=new Float32Array([-.5,-.5,-.5,.5,.5,.5,.5,-.5]);a.A[0]=b;a.la=new Uint32Array([0,2,1,0,3,2]);a.N=4;return a};a.JE=function(){var a=q.yb("CUBEMAP_BOARD"),b=q.yd();
b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.A[0]=b;a.la=new Uint32Array([0,2,1,0,3,2]);a.N=4;return a};a.uv=function(a,c){var e=q.yb("UV_SPHERE"),u,y,F=[],G=[],D=[];for(y=0;8>=y;y++)for(u=0;16>=u;u++){var H=u/16,x=y/8;G.push(-a*Math.cos(2*H*Math.PI)*Math.sin(x*Math.PI)+c[0],a*Math.cos(x*Math.PI)+c[1],a*Math.sin(2*H*Math.PI)*Math.sin(x*Math.PI)+c[2])}for(y=H=0;8>y;y++)for(u=0;16>u;u++){var x=b(G,17*y+u+1),A=b(G,17*y+u),r=b(G,17*(y+1)+u),k=b(G,17*(y+1)+u+1);Math.abs(x[1])==a+c[1]?(h(x,F),
h(r,F),h(k,F),D.push(H,H+1,H+2),H+=3):Math.abs(r[1])==a+c[1]?(h(x,F),h(A,F),h(r,F),D.push(H,H+1,H+2),H+=3):(h(x,F),h(A,F),h(r,F),h(k,F),D.push(H,H+1,H+2),D.push(H,H+2,H+3),H+=4)}u={};u.a_position=F;G=m.zC(D,G,F);u.a_normal=m.yC(D,F,G);u.a_tangent=[];e.K.a_influence=[];e.K.a_color=[];e.K.a_texcoord=[];e.A[0]=u;e.la=D;e.N=F.length/3;return e};a.tv=function(a){var b=q.yb("INDEX"),c=q.yd();c.a_index=new Float32Array(a);for(var e=0;e<a;e++)c.a_index[e]=e;b.A[0]=c;b.la=new Uint16Array(0);b.N=a;return b}};b4w.module.__reformer=function(a,y){function e(a){switch(a.type){case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in
a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));
"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",
a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":switch(a.node_tree_name=a.node_tree_name.replace(/\.[0-9]{3,}$/g,""),a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}}}
function c(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var e=a[c],g=0;g<e.strips.length;g++){var h=e.strips[g];"action"in h||(h.action=null,b("strip",h,"action"));"action_frame_start"in h||(h.action_frame_start=0,b("strip",h,"action_frame_start"));"action_frame_end"in h||(h.action_frame_end=h.frame_end-h.frame_start,b("strip",h,"action_frame_end"));"repeat"in h||(h.repeat=1,b("strip",h,"repeat"));"use_reverse"in h||(h.use_reverse=!1,b("strip",h,"use_reverse"));"scale"in h||(h.scale=1,b("strip",
h,"scale"))}}function b(a,b,c){c=c+">>"+a;c in D||(D[c]={Or:[],jy:"undefined",type:a});D[c].Or.push(b.name)}function h(a,b){param_id in D||(D[param_id]={Or:[],jy:"deprecated",type:a});D[param_id].Or.push(b.name)}function m(a,b){b||(b=a.name+"_COPY");var c=a.materials,e=a.submeshes;a.materials=null;a.submeshes=null;var h=g.Gg(a);a.materials=c;a.submeshes=e;h.name=b;h.materials=a.materials.slice(0);h.submeshes=[];for(c=0;c<e.length;c++){var d=g.Ej(e[c]);h.submeshes.push(d)}return h}var q=y("__boundings"),
u=y("__curve"),w=y("__print"),g=y("__util"),l=y("vec3"),z=y("vec4"),C=y("quat"),F=y("mat4"),G=[5,4],D={};a.gu=function(a){return-1!=g.Lz(a,G)};a.KC=function(a){D={};var l=a.worlds;if(0==l.length){w.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var m={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},use_sky_paper:!1,use_sky_blend:!1,
use_sky_real:!1,b4w_fog_color:[.5,.5,.5],b4w_fog_density:0,texture_slots:[]};l.push(m)}for(var l=a.worlds,r=0;r<l.length;r++){m=l[r];"use_sky_blend"in m||(b("world",m,"use_sky_blend"),m.use_sky_blend=!1);"use_sky_paper"in m||(b("world",m,"use_sky_paper"),m.use_sky_paper=!1);"use_sky_real"in m||(b("world",m,"use_sky_real"),m.use_sky_real=!1);"b4w_sky_settings"in m&&"rayleigh_brightness"in m.b4w_sky_settings||(b("world",m,"rayleigh_brightness"),m.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,
use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"render_sky"in m.b4w_sky_settings||(b("world",m,"render_sky"),m.b4w_sky_settings.render_sky=!1);"b4w_fog_density"in m||(b("world",m,"b4w_fog_density"),m.b4w_fog_density=0);for(var k=m.texture_slots,m=0;m<k.length;m++){var d=k[m];"blend_type"in d||(d.blend_type=
"MIX",b("world_texture_slot",d,"blend_type"));"use_map_blend"in d||(d.use_map_blend=!1,b("world_texture_slot",d,"use_map_blend"));"use_map_horizon"in d||(d.use_map_horizon=!0,b("world_texture_slot",d,"use_map_horizon"));"use_map_zenith_up"in d||(d.use_map_zenith_up=!1,b("world_texture_slot",d,"use_map_zenith_up"));"use_rgb_to_intensity"in d||(d.use_rgb_to_intensity=!1,b("world_texture_slot",d,"use_rgb_to_intensity"));"invert"in d||(d.invert=!1,b("world_texture_slot",d,"invert"));"color"in d||(d.color=
[1,0,1],b("world_texture_slot",d,"color"));"blend_factor"in d||(d.blend_factor=0,b("world_texture_slot",d,"blend_factor"));"horizon_factor"in d||(d.horizon_factor=1,b("world_texture_slot",d,"horizon_factor"));"zenith_up_factor"in d||(d.zenith_up_factor=0,b("world_texture_slot",d,"zenith_up_factor"));"zenith_down_factor"in d||(d.zenith_down_factor=0,b("world_texture_slot",d,"zenith_down_factor"));"default_value"in d||(d.default_value=1,b("world_texture_slot",d,"default_value"))}}m=a.scenes;for(r=0;r<
m.length;r++)k=m[r],d=k.world,"timeline_markers"in k||(k.timeline_markers=null,b("scene",k,"timeline_markers")),"b4w_reflection_quality"in k||(k.b4w_reflection_quality="MEDIUM",b("scene",k,"b4w_reflection_quality")),"b4w_use_nla"in k||(k.b4w_use_nla=!1,b("scene",k,"b4w_use_nla")),"fps"in k||(k.fps=24,b("scene",k,"fps")),"b4w_nla_cyclic"in k||(k.b4w_nla_cyclic=!1,b("scene",k,"b4w_nla_cyclic")),"b4w_nla_script"in k||(k.b4w_nla_script=[],b("scene",k,"b4w_nla_script")),"b4w_detect_collisions"in k&&(h("scene",
k),delete k.b4w_detect_collisions),"audio_doppler_speed"in k||(k.audio_doppler_speed=343.3),"audio_doppler_factor"in k||(k.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in k||(k.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},b("scene",k,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in k||(k.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in k||(k.b4w_enable_bloom=!1,b("scene",k,"b4w_enable_bloom")),"b4w_enable_motion_blur"in
k||(k.b4w_enable_motion_blur=!1,b("scene",k,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in k||(k.b4w_enable_color_correction=!1,b("scene",k,"b4w_enable_color_correction")),"b4w_enable_antialiasing"in k||(k.b4w_enable_antialiasing=!0,b("scene",k,"b4w_enable_antialiasing")),"b4w_tags"in k||(k.b4w_tags={title:"",description:""},b("scene",k,"b4w_tags")),"b4w_enable_object_selection"in k||(k.b4w_enable_object_selection="AUTO",b("scene",k,"b4w_enable_object_selection")),"b4w_enable_outlining"in
k||(k.b4w_enable_outlining="AUTO",b("scene",k,"b4w_enable_outlining")),"b4w_enable_glow_materials"in k||(k.b4w_enable_glow_materials="AUTO",b("scene",k,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in k||(k.b4w_enable_anchors_visibility="AUTO",b("scene",k,"b4w_enable_anchors_visibility")),"b4w_outline_color"in k||(k.b4w_outline_color=[1,1,1],b("scene",k,"b4w_outline_color")),"b4w_outline_factor"in k||(k.b4w_outline_factor="b4w_glow_factor"in k?k.b4w_glow_factor:1,b("scene",k,"b4w_outline_factor")),
"b4w_shadow_settings"in k||(b("scene",k,"b4w_shadow_settings"),l=d.b4w_shadow_settings,k.b4w_shadow_settings=l?l:{csm_resolution:2048,self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),l=k.b4w_shadow_settings,"csm_resolution"in l||(b("scene",k,"b4w_shadow_settings.csm_resolution"),l.csm_resolution=2048),"self_shadow_polygon_offset"in
l||(b("scene",k,"b4w_shadow_settings.self_shadow_polygon_offset"),l.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in l||(b("scene",k,"b4w_shadow_settings.self_shadow_normal_offset"),l.self_shadow_normal_offset=.01),"b4w_enable_csm"in l||(b("scene",k,"b4w_shadow_settings.b4w_enable_csm"),l.b4w_enable_csm=!1),"csm_num"in l||(b("scene",k,"b4w_shadow_settings.csm_num"),l.csm_num=1),"csm_first_cascade_border"in l||(b("scene",k,"b4w_shadow_settings.csm_first_cascade_border"),l.csm_first_cascade_border=
10),"first_cascade_blur_radius"in l||(b("scene",k,"b4w_shadow_settings.first_cascade_blur_radius"),l.first_cascade_blur_radius=3),"csm_last_cascade_border"in l||(b("scene",k,"b4w_shadow_settings.csm_last_cascade_border"),l.csm_last_cascade_border=100),"last_cascade_blur_radius"in l||(b("scene",k,"b4w_shadow_settings.last_cascade_blur_radius"),l.last_cascade_blur_radius=1.5),"fade_last_cascade"in l||(b("scene",k,"b4w_shadow_settings.fade_last_cascade"),l.fade_last_cascade=!0),"blend_between_cascades"in
l||(b("scene",k,"b4w_shadow_settings.blend_between_cascades"),l.blend_between_cascades=!0),"b4w_ssao_settings"in k||(b("scene",k,"b4w_ssao_settings"),l=d.b4w_ssao_settings,k.b4w_ssao_settings=l?l:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),l=k.b4w_ssao_settings,"dist_factor"in l||(b("scene",k,"b4w_ssao_settings.dist_factor"),l.dist_factor=0),"samples"in l||(b("scene",k,"b4w_ssao_settings.samples"),l.samples=16),"hemisphere"in l||(b("scene",k,"b4w_ssao_settings.hemisphere"),
l.hemisphere=!1),"blur_depth"in l||(b("scene",k,"b4w_ssao_settings.blur_depth"),l.blur_depth=!1),"blur_discard_value"in l||(b("scene",k,"b4w_ssao_settings.blur_discard_value"),l.blur_discard_value=1),"b4w_bloom_settings"in k||(b("scene",k,"b4w_bloom_settings"),l=d.b4w_bloom_settings,k.b4w_bloom_settings=l?l:{key:.2,blur:4,edge_lum:1}),"key"in k.b4w_bloom_settings||(b("scene",k,"b4w_bloom_settings.key"),k.b4w_bloom_settings.key=.2),"blur"in k.b4w_bloom_settings||(b("scene",k,"b4w_bloom_settings.blur"),
k.b4w_bloom_settings.blur=4),"edge_lum"in k.b4w_bloom_settings||(b("scene",k,"b4w_bloom_settings.edge_lum"),k.b4w_bloom_settings.edge_lum=1),"b4w_motion_blur_settings"in k||(b("scene",k,"b4w_motion_blur_settings"),l=d.b4w_motion_blur_settings,k.b4w_motion_blur_settings=l?l:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in k.b4w_motion_blur_settings||(b("scene",k,"b4w_motion_blur_settings.motion_blur_factor"),k.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in
k.b4w_motion_blur_settings||(b("scene",k,"b4w_motion_blur_settings.motion_blur_decay_threshold"),k.b4w_motion_blur_settings.motion_blur_decay_threshold=.01),"b4w_color_correction_settings"in k||(b("scene",k,"b4w_color_correction_settings"),l=d.b4w_color_correction_settings,k.b4w_color_correction_settings=l?l:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in k||(b("scene",k,"b4w_god_rays_settings"),l=d.b4w_god_rays_settings,k.b4w_god_rays_settings=l?l:{intensity:.7,max_ray_length:1,
steps_per_pass:10}),"steps_per_pass"in k.b4w_god_rays_settings||(b("scene",k,"b4w_god_rays_settings.steps_per_pass"),k.b4w_god_rays_settings.steps_per_pass=10),"b4w_glow_settings"in k||(b("scene",k,"b4w_glow_settings"),k.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},l=k.b4w_glow_settings,"b4w_render_glow_over_blend"in d&&(l.render_glow_over_blend=d.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in
d&&(l.small_glow_mask_coeff=d.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in d&&(l.large_glow_mask_coeff=d.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in d&&(l.small_glow_mask_width=d.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in d&&(l.large_glow_mask_width=d.b4w_large_glow_mask_width)),d=k.b4w_render_shadows,"AUTO"!=d&&"OFF"!=d&&"ON"!=d&&(k.b4w_render_shadows=d?"ON":"OFF"),d=k.b4w_render_reflections,"OFF"!=d&&"ON"!=d&&(k.b4w_render_reflections=d?"ON":"OFF"),d=k.b4w_render_refractions,
"AUTO"!=d&&"OFF"!=d&&"ON"!=d&&(k.b4w_render_refractions=d?"ON":"OFF");k=a.meshes;for(r=0;r<k.length;r++){d=k[r];d.b4w_bounding_box||(b("mesh",d,"b4w_bounding_box"),d.b4w_bounding_box={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0});d.b4w_bounding_box_source||(b("mesh",d,"b4w_bounding_box_source"),d.b4w_bounding_box_source=d.b4w_bounding_box);d.uv_textures||(b("mesh",d,"uv_textures"),d.uv_textures=[]);d.b4w_bounding_sphere_center||(d.b4w_bounding_sphere_center=[0,0,0]);d.b4w_bounding_cylinder_center||
(d.b4w_bounding_cylinder_center=[0,0,0]);d.b4w_bounding_ellipsoid_center||(d.b4w_bounding_ellipsoid_center=[0,0,0]);d.b4w_bounding_ellipsoid_axes||(m=d.b4w_bounding_box,d.b4w_bounding_ellipsoid_axes=[(m.max_x-m.min_x)/2,(m.max_y-m.min_y)/2,(m.max_z-m.min_z)/2]);"b4w_shape_keys"in d||(d.b4w_shape_keys=[],b("mesh",d,"b4w_shape_keys"));for(var m=d,l=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],n=null,q=0;q<l.length;q++)m[l[q]]&&(n?
(m[l[q]]=!1,w.warn('WARNING property "'+l[q]+'" of object "'+m.name+'" has been set to "false". Foreground property "'+n+'" already exists.')):n=l[q]);for(m=0;m<d.b4w_vertex_anim.length;m++)l=d.b4w_vertex_anim[m],"allow_nla"in l||(b('mesh["b4w_vertex_anim"]',d,"allow_nla"),l.allow_nla=!0)}m=a.cameras;for(r=0;r<m.length;r++)k=m[r],k.type||(k.type="PERSP",b("camera",k,"type")),"b4w_eye_target_dist"in k&&(delete k.b4w_eye_target_dist,h("camera",k)),"b4w_hover_zero_level"in k||(k.b4w_hover_zero_level=
0,b("camera",k,"b4w_hover_zero_level")),"b4w_trans_velocity"in k||(k.b4w_trans_velocity=1,b("camera",k,"b4w_trans_velocity")),"b4w_rot_velocity"in k||(k.b4w_rot_velocity=1,b("camera",k,"b4w_rot_velocity")),"b4w_zoom_velocity"in k||(k.b4w_zoom_velocity=.1,b("camera",k,"b4w_zoom_velocity")),"b4w_use_distance_limits"in k||(k.b4w_use_distance_limits=!1,b("camera",k,"b4w_use_distance_limits")),"b4w_distance_min"in k||(k.b4w_distance_min=1,b("camera",k,"b4w_distance_min")),"b4w_distance_max"in k||(k.b4w_distance_max=
100,b("camera",k,"b4w_distance_max")),"b4w_horizontal_translation_min"in k||(k.b4w_horizontal_translation_min=-100,b("camera",k,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in k||(k.b4w_horizontal_translation_max=100,b("camera",k,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in k||(k.b4w_vertical_translation_min=-100,b("camera",k,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in k||(k.b4w_vertical_translation_max=100,b("camera",k,"b4w_vertical_translation_max")),
"b4w_use_horizontal_clamping"in k||(k.b4w_use_horizontal_clamping=!1,b("camera",k,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in k||(k.b4w_rotation_left_limit=-Math.PI,b("camera",k,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in k||(k.b4w_rotation_right_limit=Math.PI,b("camera",k,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in k||(k.b4w_horizontal_clamping_type="LOCAL",b("camera",k,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in k||(k.b4w_use_vertical_clamping=
!1,b("camera",k,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in k||(k.b4w_rotation_down_limit=-Math.PI/2,b("camera",k,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in k||(k.b4w_rotation_up_limit=Math.PI/2,b("camera",k,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in k||(k.b4w_vertical_clamping_type="LOCAL",b("camera",k,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in k||(k.b4w_hover_angle_min=Math.PI/6,b("camera",k,"b4w_hover_angle_min")),"b4w_hover_angle_max"in k||(k.b4w_hover_angle_max=
Math.PI/6,b("camera",k,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in k||(k.b4w_enable_hover_hor_rotation=!0,b("camera",k,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in k||(k.b4w_use_panning=!0,b("camera",k,"b4w_use_panning"));m=a.lamps;for(r=0;r<m.length;r++)k=m[r],"b4w_generate_shadows"in k||(k.b4w_generate_shadows=!1,b("lamp",k,"b4w_generate_shadows")),"b4w_dynamic_intensity"in k||(k.b4w_dynamic_intensity=!1,b("lamp",k,"b4w_dynamic_intensity")),"use_diffuse"in k||(k.use_diffuse=
!0,b("lamp",k,"use_diffuse")),"use_specular"in k||(k.use_specular=!0,b("lamp",k,"use_specular"));m=a.speakers;for(r=0;r<m.length;r++)k=m[r],"b4w_behavior"in k||(k.b4w_behavior=k.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_disable_doppler"in k||(k.b4w_disable_doppler=!1),"b4w_delay"in k||(k.b4w_delay=0),"b4w_delay_random"in k||(k.b4w_delay_random=0),"b4w_volume_random"in k||(k.b4w_volume_random=0),"b4w_pitch_random"in k||(k.b4w_pitch_random=0),"b4w_fade_in"in k||(k.b4w_fade_in=0),"b4w_fade_out"in
k||(k.b4w_fade_out=0),"b4w_loop"in k||(k.b4w_loop=!1),"b4w_loop_count"in k||(k.b4w_loop_count=0),"b4w_loop_count_random"in k||(k.b4w_loop_count_random=0),"b4w_playlist_id"in k||(k.b4w_playlist_id=""),k.animation_data&&c(k.animation_data);m=a.textures;for(r=0;r<m.length;r++)k=m[r],"b4w_anisotropic_filtering"in k||(k.b4w_anisotropic_filtering="OFF",b("texture",k,"b4w_anisotropic_filtering")),"b4w_water_foam"in k||(k.b4w_water_foam=!1,b("texture",k,"b4w_water_foam")),"b4w_foam_uv_freq"in k||(k.b4w_foam_uv_freq=
[1,1],b("texture",k,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in k||(k.b4w_foam_uv_magnitude=[1,1],b("texture",k,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in k||(k.b4w_parallax_steps=5,b("material",k,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in k||(k.b4w_parallax_lod_dist=10,b("material",k,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in k||(k.b4w_shore_dist_map=!1,b("texture",k,"b4w_shore_dist_map")),"b4w_shore_boundings"in k||(k.b4w_shore_boundings=new Float32Array(4),k.b4w_shore_boundings=
[1E3,-1E3,1E3,-1E3],b("texture",k,"b4w_shore_boundings")),"b4w_max_shore_dist"in k||(k.b4w_max_shore_dist=100,b("texture",k,"b4w_max_shore_dist")),"b4w_disable_compression"in k||(k.b4w_disable_compression=!1,b("texture",k,"b4w_disable_compression")),"b4w_source_type"in k||(k.b4w_source_type="",b("texture",k,"b4w_source_type")),"b4w_source_id"in k||(k.b4w_source_id="",b("texture",k,"b4w_source_id")),"b4w_source_size"in k||(k.b4w_source_size=1024,b("texture",k,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in
k||(k.b4w_enable_canvas_mipmapping=!0,b("texture",k,"b4w_enable_canvas_mipmapping"));l=a.materials;for(r=0;r<l.length;r++){n=l[r];"b4w_node_mat_type"in n&&h("material",n);"b4w_skydome"in n&&h("material",n);"b4w_procedural_skydome"in n&&h("material",n);n.b4w_water&&("b4w_water_shore_smoothing"in n||(n.b4w_water_shore_smoothing=!1,b("material",n,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in n||(n.b4w_water_dynamic=!1,b("material",n,"b4w_water_dynamic")),"b4w_waves_height"in n||(n.b4w_waves_height=
1,b("material",n,"b4w_waves_height")),"b4w_waves_length"in n||(n.b4w_waves_length=1,b("material",n,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in n||(n.b4w_water_dst_noise_scale0=.05,b("material",n,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in n||(n.b4w_water_dst_noise_scale1=.03,b("material",n,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in n||(n.b4w_water_dst_noise_freq0=1.3,b("material",n,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in n||(n.b4w_water_dst_noise_freq1=
1,b("material",n,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in n||(n.b4w_water_dir_min_shore_fac=.4,b("material",n,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in n||(n.b4w_water_dir_freq=.5,b("material",n,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in n||(n.b4w_water_dir_noise_scale=.05,b("material",n,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in n||(n.b4w_water_dir_noise_freq=.07,b("material",n,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in
n||(n.b4w_water_dir_min_noise_fac=.5,b("material",n,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in n||(n.b4w_water_dst_min_fac=.2,b("material",n,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in n||(n.b4w_water_waves_hor_fac=5,b("material",n,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in n||(n.b4w_water_absorb_factor=6,b("material",n,"b4w_water_absorb_factor")),"b4w_water_fog_color"in n||(n.b4w_water_fog_color=new Float32Array(3),n.b4w_water_fog_color=[.5,.7,.7],b("material",
n,"b4w_water_fog_color")),"b4w_foam_factor"in n||(n.b4w_foam_factor=5,b("material",n,"b4w_foam_factor")),"b4w_generated_mesh"in n||(n.b4w_generated_mesh=!1,b("material",n,"b4w_generated_mesh")),"b4w_water_num_cascads"in n||(n.b4w_water_num_cascads=5,b("material",n,"b4w_water_num_cascads")),"b4w_water_subdivs"in n||(n.b4w_water_subdivs=64,b("material",n,"b4w_water_subdivs")),"b4w_water_detailed_dist"in n||(n.b4w_water_detailed_dist=1E3,b("material",n,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in
n||(n.b4w_water_enable_caust=!1,b("material",n,"b4w_water_enable_caust")),"b4w_water_caust_scale"in n||(n.b4w_water_caust_scale=.25,b("material",n,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in n||(n.b4w_water_caust_brightness=.5,b("material",n,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in n||(n.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in n||(n.b4w_dynamic_grass_color="");"diffuse_intensity"in n||(n.diffuse_intensity=1,b("material",n,"diffuse_intensity"));"b4w_use_ghost"in
n||(n.b4w_use_ghost=!1);"b4w_collision_margin"in n||(n.b4w_collision_margin=.04,b("material",n,"b4w_collision_margin"));"b4w_collision_group"in n||(n.b4w_collision_group=128,b("material",n,"b4w_collision_group"));"b4w_collision_mask"in n||(n.b4w_collision_mask=127,b("material",n,"b4w_collision_mask"));"b4w_do_not_render"in n||(n.b4w_do_not_render=!1,b("material",n,"b4w_do_not_render"));"HALO"!=n.type||"b4w_halo_sky_stars"in n||(n.b4w_halo_sky_stars=!1,b("material",n,"b4w_halo_sky_stars"));"HALO"!=
n.type||"b4w_halo_stars_blend_height"in n||(n.b4w_halo_stars_blend_height=10,b("material",n,"b4w_halo_stars_blend_height"));"HALO"!=n.type||"b4w_halo_stars_min_height"in n||(n.b4w_halo_stars_min_height=0,b("material",n,"b4w_halo_stars_min_height"));"specular_shader"in n||(n.specular_shader="COOKTORR",b("material",n,"specular_shader"));"diffuse_shader"in n||(n.diffuse_shader="LAMBERT",b("material",n,"diffuse_shader"));"roughness"in n||(n.roughness=.5,b("material",n,"roughness"));"diffuse_fresnel"in
n||(n.diffuse_fresnel=.1,b("material",n,"diffuse_fresnel"));"diffuse_fresnel_factor"in n||(n.diffuse_fresnel_factor=.5,b("material",n,"diffuse_fresnel_factor"));"specular_slope"in n||(n.specular_slope=.2,b("material",n,"specular_slope"));"specular_toon_size"in n||(n.specular_toon_size=.5,b("material",n,"specular_toon_size"));"specular_toon_smooth"in n||(n.specular_toon_smooth=.1,b("material",n,"specular_toon_smooth"));"specular_alpha"in n||(n.specular_alpha=1,b("material",n,"specular_alpha"));"b4w_wettable"in
n||(n.b4w_wettable=!1,b("material",n,"b4w_wettable"));"b4w_refractive"in n||(n.b4w_refractive=!1,b("material",n,"b4w_refractive"));"b4w_refr_bump"in n||(n.b4w_refr_bump=0,b("material",n,"b4w_refr_bump"));"b4w_shallow_water_col"in n||(n.b4w_shallow_water_col=[0,.8,.3],b("material",n,"b4w_shallow_water_col"));"b4w_shore_water_col"in n||(n.b4w_shore_water_col=[0,.9,.2],b("material",n,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in n||(n.b4w_shallow_water_col_fac=1,b("material",n,"b4w_shallow_water_col_fac"));
"b4w_shore_water_col_fac"in n||(n.b4w_shore_water_col_fac=.5,b("material",n,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in n||(n.b4w_water_sss_strength=5.9,b("material",n,"b4w_water_sss_strength"));"b4w_water_sss_width"in n||(n.b4w_water_sss_width=.45,b("material",n,"b4w_water_sss_width"));"b4w_render_above_all"in n||(n.b4w_render_above_all=!1,b("material",n,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in n||(n.b4w_water_norm_uv_velocity=.05,b("material",n,"b4w_water_norm_uv_velocity"));
"specular_ior"in n||(n.specular_ior=1,b("material",n,"specular_ior"));"darkness"in n||(n.darkness=0,b("material",n,"darkness"));"diffuse_toon_size"in n||(n.diffuse_toon_size=0,b("material",n,"diffuse_toon_size"));"diffuse_toon_smooth"in n||(n.diffuse_toon_smooth=0,b("material",n,"diffuse_toon_smooth"));k=n.texture_slots;for(m=0;m<k.length;m++)d=k[m],"blend_type"in d||(d.blend_type="MIX",b("texture_slot",d,"blend_type"));if(n.node_tree){k=n.node_tree.nodes;for(m=0;m<k.length;m++)e(k[m]);n.node_tree.animation_data&&
c(n.node_tree.animation_data)}}d=a.node_groups;for(r=0;r<d.length;r++)for(k=d[r].node_tree.nodes,m=0;m<k.length;m++)e(k[m]);k=a.objects;for(r=0;r<k.length;r++){d=k[r];switch(d.type){case "MESH":"b4w_dynamic_geometry"in d||(d.b4w_dynamic_geometry=!1);"b4w_reflexible"in d||(d.b4w_reflexible=!1);"b4w_reflexible_only"in d||(d.b4w_reflexible_only=!1);"b4w_reflective"in d||(d.b4w_reflective=!1);"b4w_reflection_type"in d||(d.b4w_reflection_type="PLANE",b("object",d,"b4w_reflection_type"));"b4w_wind_bending"in
d||(d.b4w_wind_bending=!1,b("object",d,"b4w_wind_bending"));"b4w_wind_bending_angle"in d||(d.b4w_wind_bending_angle=10,d.b4w_wind_bending_freq=.25,b("object",d,"wind bending params"));"b4w_detail_bending_amp"in d||(d.b4w_detail_bending_amp=.1,d.b4w_branch_bending_amp=.3,b("object",d,"detail bending params"));"b4w_detail_bending_freq"in d||(d.b4w_detail_bending_freq=1,b("object",d,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in d||(d.b4w_main_bend_stiffness_col="",b("object",d,"b4w_main_bend_stiffness_col"));
"b4w_detail_bend_colors"in d||(d.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",d,"b4w_detail_bend_colors"));"b4w_caustics"in d||(d.b4w_caustics=!1);"vertex_groups"in d&&d.vertex_groups.length&&d.data&&0==d.data.vertex_groups.length&&(d.data.vertex_groups=d.vertex_groups,delete d.vertex_groups,b("object",d,"vertex_groups"));"b4w_vertex_anim"in d&&d.b4w_vertex_anim.length&&d.data&&0==d.data.b4w_vertex_anim.length&&(d.data.b4w_vertex_anim=d.b4w_vertex_anim,
delete d.b4w_vertex_anim,b("object",d,"b4w_vertex_anim"));"b4w_do_not_render"in d||(d.b4w_do_not_render=!1);"use_ghost"in d.game||(d.game.use_ghost=!1);"use_sleep"in d.game||(d.game.use_sleep=!1);"velocity_min"in d.game||(d.game.velocity_min=0);"velocity_max"in d.game||(d.game.velocity_max=0);"collision_group"in d.game||(d.game.collision_group=1);"collision_mask"in d.game||(d.game.collision_mask=255);"b4w_vehicle_settings"in d?d.b4w_vehicle_settings&&("steering_ratio"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.steering_ratio=
10),"steering_max"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.steering_max=1),"inverse_control"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.inverse_control=!1),"force_max"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.force_max=1500),"brake_max"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.brake_max=100),"speed_ratio"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.max_speed_angle=Math.PI),
"delta_tach_angle"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in d.b4w_vehicle_settings||
(d.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.floating_factor=3),"floating_factor"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.water_rot_damp=.9)):(d.b4w_vehicle_settings=
null,b("object",d,"b4w_vehicle_settings"));"b4w_floating_settings"in d?d.b4w_floating_settings&&("floating_factor"in d.b4w_floating_settings||(d.b4w_floating_settings.floating_factor=3),"water_lin_damp"in d.b4w_floating_settings||(d.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in d.b4w_floating_settings||(d.b4w_floating_settings.water_rot_damp=.8)):(d.b4w_floating_settings=null,b("object",d,"b4w_floating_settings"));"b4w_character_settings"in d?d.b4w_character_settings&&("walk_speed"in
d.b4w_character_settings||(d.b4w_character_settings.walk_speed=4),"run_speed"in d.b4w_character_settings||(d.b4w_character_settings.run_speed=8),"step_height"in d.b4w_character_settings||(d.b4w_character_settings.step_height=.25),"jump_strength"in d.b4w_character_settings||(d.b4w_character_settings.jump_strength=5),"waterline"in d.b4w_character_settings||(d.b4w_character_settings.waterline=0)):(d.b4w_character_settings=null,b("object",d,"b4w_character_settings"));"b4w_selectable"in d||(d.b4w_selectable=
!1,b("object",d,"b4w_selectable"));"b4w_outlining"in d||(d.b4w_outlining=!1,b("object",d,"b4w_outlining"));"b4w_outline_on_select"in d||(d.b4w_outline_on_select=!1,b("object",d,"b4w_outline_on_select"));"b4w_billboard"in d||(d.b4w_billboard=!1,b("object",d,"b4w_billboard"));"b4w_billboard_geometry"in d||(d.b4w_billboard_geometry="SPHERICAL",b("object",d,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in d||(d.b4w_pres_glob_orientation=!1,b("object",d,"b4w_pres_glob_orientation"));"b4w_outline_settings"in
d||("b4w_glow_settings"in d?d.b4w_outline_settings=d.b4w_glow_settings:(d.b4w_outline_settings={},d.b4w_outline_settings.outline_duration=1,d.b4w_outline_settings.outline_period=1,d.b4w_outline_settings.outline_relapses=0),b("object",d,"b4w_outline_settings"));"b4w_lod_transition"in d||(d.b4w_lod_transition=.01,b("object",d,"b4w_lod_transition"));"lod_levels"in d||(d.lod_levels=[],b("object",d,"lod_levels"));"b4w_animation_mixing"in d||(d.b4w_animation_mixing=!1,b("object",d,"b4w_animation_mixing"));
break;case "EMPTY":"b4w_group_relative"in d||(d.b4w_group_relative=!1,b("object",d,"b4w_group_relative")),"b4w_anchor"in d||(d.b4w_anchor=null,b("object",d,"b4w_anchor")),!d.b4w_anchor||"max_width"in d.b4w_anchor||(d.b4w_anchor.max_width=250)}"collision_margin"in d.game||(d.game.collision_margin=.04,b("object",d,"collision_margin"));"b4w_anim_behavior"in d||(d.b4w_anim_behavior=d.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",d,"b4w_anim_behavior"));if(!("rotation_quaternion"in d)){m=[0,0,
0,1];g.Gf(d.rotation_euler,m);var l=m,n=m[0],q=m[1],u=m[2];l[0]=m[3];l[1]=n;l[2]=q;l[3]=u;d.rotation_quaternion=m;b("object",d,"rotation_quaternion")}"webgl_do_not_batch"in d&&(d.b4w_do_not_batch=d.webgl_do_not_batch)&&h("object",d);"b4w_shadow_cast_only"in d||(d.b4w_shadow_cast_only=!1,b("object",d,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in d||(d.b4w_correct_bounding_offset="AUTO",b("object",d,"b4w_correct_bounding_offset"));l=d.particle_systems;for(m=0;m<l.length;m++)n=l[m],q=n.settings,
"use_rotation_dupli"in q||(q.use_rotation_dupli=!1,b("object",q,"use_rotation_dupli")),"use_whole_group"in q||(q.use_whole_group=!1,b("object",q,"use_whole_group")),n.transforms||(n.transforms=new Float32Array,b("particle_system",n,"transforms")),"b4w_billboard_align"in q||(q.b4w_billboard_align="VIEW",b("particle_settings",q,"b4w_billboard_align")),"b4w_dynamic_grass"in q||(q.b4w_dynamic_grass=!1,b("object",q,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in q||(q.b4w_dynamic_grass_scale_threshold=
.01,b("object",q,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in q||(q.b4w_initial_rand_rotation=!1,b("particle_settings",q,"b4w_initial_rand_rotation")),"b4w_rotation_type"in q||(q.b4w_rotation_type="Z",b("particle_settings",q,"b4w_rotation_type")),"b4w_rand_rotation_strength"in q||(q.b4w_rand_rotation_strength=1,b("particle_settings",q,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in q||(q.b4w_hair_billboard=!1,b("particle_settings",q,"b4w_hair_billboard")),"b4w_hair_billboard_type"in
q||(q.b4w_hair_billboard_type="BASIC",b("particle_settings",q,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in q||(q.b4w_hair_billboard_jitter_amp=0,b("particle_settings",q,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in q||(q.b4w_hair_billboard_jitter_freq=0,b("particle_settings",q,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in q||(q.b4w_hair_billboard_geometry="SPHERICAL",b("particle_settings",q,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in
q||(q.b4w_wind_bend_inheritance="PARENT",b("particle_settings",q,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in q||(q.b4w_shadow_inheritance="PARENT",b("particle_settings",q,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in q||(q.b4w_reflection_inheritance="PARENT",b("particle_settings",q,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in q||(q.b4w_vcol_from_name="",b("particle_settings",q,"b4w_vcol_from_name")),"b4w_vcol_to_name"in q||(q.b4w_vcol_to_name="",b("particle_settings",
q,"b4w_vcol_to_name")),"b4w_coordinate_system"in q||(q.b4w_coordinate_system="LOCAL",b("particle_settings",q,"b4w_coordinate_system")),"b4w_allow_nla"in q||(q.b4w_allow_nla=!0,b("particle_settings",q,"b4w_allow_nla")),"b4w_enable_soft_particles"in q||(q.b4w_enable_soft_particles=!1,b("particle_settings",q,"b4w_enable_soft_particles")),"b4w_particles_softness"in q||(q.b4w_particles_softness=1,b("particle_settings",q,"b4w_particles_softness"));"constraints"in d||(d.constraints=[],b("object",d,"constraints"));
l=d.modifiers;for(m=0;m<l.length;m++){a:{n=l[m];switch(n.type){case "ARRAY":if(!("fit_type"in n)){w.error("WARNING Incomplete modifier "+String(n.type)+' for "'+d.name+'", reexport "'+a.b4w_filepath_blend+'" scene');n=!1;break a}}n=!0}n||(l.splice(m,1),m--)}"animation_data"in d||(d.animation_data={action:null,nla_tracks:[]},b("object",d,"animation_data"));d.animation_data&&("action"in d.animation_data||(d.animation_data.action=null,w.warn("no action in animation data "+d.name)),"nla_tracks"in d.animation_data||
(d.animation_data.nla_tracks=[],w.warn("no NLA in animation data "+d.name)),c(d.animation_data));"b4w_collision_id"in d||(d.b4w_collision_id="",b("material",d,"b4w_collision_id"));m=d.scale;0==m[0]&&0==m[1]&&0==m[2]?m=!0:(l=Math.abs((m[1]-m[2])/m[1]),m=.005>Math.abs((m[0]-m[1])/m[0])&&.005>l);m||w.warn("non-uniform scale for object "+d.name);if(0>d.scale[0]||0>d.scale[1]||0>d.scale[2])w.warn("negative scale for object "+d.name+", using positive scale instead"),d.scale[0]=Math.abs(d.scale[0]),d.scale[1]=
Math.abs(d.scale[1]),d.scale[2]=Math.abs(d.scale[2])}for(var z in D)r=D[z],m=z.match(/.*?(?=>>|$)/i)[0],w.warn("WARNING "+String(m)+" is "+r.jy+" for "+r.type+", reexport "+a.b4w_filepath_blend)};a.GC=function(a,b){"num_channels"in a||(a.num_channels=1,w.warn('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.$B=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var e=b[c].type;if("ARRAY"==e||"CURVE"==e){b=!0;break a}}b=!1}if(!b)return null;
b=m(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var h=a[c];switch(h.type){case "ARRAY":for(var e=b,d=h,n=0,w=0,y=0,E=new Float32Array(16),h=[],D=1;D<d.count;D++){d.use_constant_offset&&(n+=d.constant_offset_displace[0],w+=d.constant_offset_displace[1],y+=d.constant_offset_displace[2]);if(d.use_relative_offset)var G=e.b4w_bounding_box,n=n+(G.max_x-G.min_x)*d.relative_offset_displace[0],w=w+(G.max_y-G.min_y)*d.relative_offset_displace[1],y=y+(G.max_z-G.min_z)*d.relative_offset_displace[2];
g.QI(n,w,y,E);for(var J=G=m(e),f=E,p=0;p<J.submeshes.length;p++){var t=J.submeshes[p];g.Yf(t.position,f,t.position,0);g.HJ(t.normal,f,t.normal);g.MI(t.tangent,f,t.tangent)}h.push(G)}for(D=0;D<h.length;D++)for(d=e,n=h[D],w=0;w<d.submeshes.length;w++){y=d.submeshes[w];E=n.submeshes[w];G=y.base_length;J=y.indices.length;y.base_length+=E.base_length;for(var L in y)if("base_length"!=L)if("indices"==L)for(y[L]=g.UI(y[L],E[L]),f=J;f<y.indices.length;f++)y.indices[f]+=G;else"vertex_colors"!=L&&(y[L]=g.yE(y[L],
E[L]))}break;case "CURVE":for(var e=b,D=h.object.EB,d=new Float32Array(16),w=D.Of?4:3,n=new Float32Array(w),w=new Float32Array(w),y=new Float32Array(3),E=new Float32Array(4),G=new Float32Array(4),J=new Float32Array(3),f=new Float32Array(3),p=new Float32Array(3),t=new Float32Array(4),N=new Float32Array(4),T=0;T<e.submeshes.length;T++){var Q=e.submeshes[T],X=Q.position,ia=Q.normal,Q=Q.tangent,U;a:switch(U=h.deform_axis,U){case "POS_X":case "NEG_X":U=0;break a;case "POS_Y":case "NEG_Y":U=1;break a;case "POS_Z":case "NEG_Z":U=
2;break a;default:throw"Wrong deform axis value "+U;}J[0]=0;J[1]=0;J[2]=0;J[U]=1;for(var ha=u.wI(D),R=0;R<X.length/3;R++){p[0]=X[3*R];p[1]=X[3*R+1];p[2]=X[3*R+2];var oa=p[U],ea=u.vI(D,oa);u.xI(D,ea,n);y[0]=n[0];y[1]=n[1];y[2]=n[2];u.uI(D,ea,w);f[0]=w[0];f[1]=0;f[2]=w[2];l.normalize(f,f);C.rotationTo(J,f,E);0>oa?(n[0]=f[0],n[1]=f[1],n[2]=f[2],l.scale(n,oa,n),l.add(y,n,y)):oa>ha&&(n[0]=f[0],n[1]=f[1],n[2]=f[2],l.scale(n,oa-ha,n),l.add(y,n,y));F.fromRotationTranslation(E,y,d);D.Of&&(C.setAxisAngle(J,
n[3],G),l.transformQuat(p,G,p));p[U]=0;l.transformMat4(p,d,p);X[3*R]=p[0];X[3*R+1]=p[1];X[3*R+2]=p[2];ia.length&&(t[0]=ia[3*R],t[1]=ia[3*R+1],t[2]=ia[3*R+2],t[3]=0,z.transformMat4(t,d,t),ia[3*R]=t[0],ia[3*R+1]=t[1],ia[3*R+2]=t[2]);Q.length&&(N[0]=Q[3*R],N[1]=Q[3*R+1],N[2]=Q[3*R+2],N[3]=0,z.transformMat4(N,d,N),Q[3*R]=N[0],Q[3*R+1]=N[1],Q[3*R+2]=N[2])}}}q.eH(b)}return b};a.xM=function(){return{name:"DEFAULT",use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,
raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,
b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,
texture_slots:[]}};a.iC=function(a,b){for(var c=0;c<b.length;c++){var e=b[c];if(e.b4w_use_nla)for(var e=e.b4w_nla_script,g=0;g<e.length;g++){var d=e[g];switch(d.type){case "SELECT":case "SELECT_PLAY":for(var h=0;h<a.length;h++){var l=a[h];l.name==d.object&&(l.b4w_selectable=!0)}break;case "SHOW":case "HIDE":for(h=0;h<a.length;h++)l=a[h],l.name==d.object&&(l.b4w_do_not_batch=!0)}}}}};b4w.module.__scenegraph=function(a,y){function e(a){a=Ib.vu(a);a.Oe=null;a.tb=null;a.qd=null;return a}function c(a,d){var c=[];P.ne(a,function(b,d,e){-1<c.indexOf(e)?P.pH(a,b,d,e,h(e)):c.push(e)});P.V(a,function(b,e){for(var f=0;f<e.na.length;f++){var g=e.na[f];d||"MAIN_PLANE_REFLECT"!=e.type&&"MAIN_CUBE_REFLECT"!=e.type&&"MAIN_XRAY"!=e.type||(g.Ih=!0);-1<c.indexOf(g)?e.na[f]=h(g):c.push(g)}"ANTIALIASING"==e.type&&P.of(a,b,function(a,b){if("MOTION_BLUR"==b.type)for(var d=0;d<b.na.length;d++){var c=
b.na[d];c.ga=da.t;c.fa=da.t}});d||P.of(a,b,function(a,b,d){"DEPTH"==d.T&&(d.Ih=!0)})});P.V(a,function(d){var c={};b(a,d,c);for(var e in c){d=c[e];for(var f=d[0],g=0;g<d.length;g++)if(d[g].ga==da.t){f=d[g];break}for(var h=d[0],g=0;g<d.length;g++)if(d[g].fa==da.t){h=d[g];break}for(var k=d[0],g=0;g<d.length;g++)if(!d[g].Ih){k=d[g];break}for(g=0;g<d.length;g++)d[g].ga=f.ga,d[g].fa=h.fa,d[g].Ih=k.Ih}})}function b(a,d,c){P.of(a,d,function(d,e,f){f.Xa&&f.T==f.wa&&(c[f.T]=c[f.T]||[],-1==c[f.T].indexOf(f)&&
c[f.T].push(f),b(a,d,c))});P.lg(a,d,function(a,b,d){d.Xa&&(c[d.T]=c[d.T]||[],-1==c[d.T].indexOf(d)&&c[d.T].push(d))});d=P.ab(a,d);if("MOTION_BLUR"==d.type)for(var e=0;e<d.na.length;e++){var f=d.na[e];c[f.T].push(f)}}function h(a){if(a.Ba)throw"Failed to clone slink with attached texture";return Fa.Gg(a)}function m(a){var b=P.Yr(a),d=[];P.V(b,function(a,c){switch(c.type){case "MOTION_BLUR":case "SMAA_RESOLVE":case "SMAA_NEIGHBORHOOD_BLENDING":case "MAIN_PLANE_REFLECT":var e=[];break;default:e=d}for(var f=
0;f<c.na.length;f++){var h=c.na[f],k=l(e,h,u(h));h.Ba=k;c.le[f]=k}for(f=0;f<c.le.length;f++)k=c.le[f],g(e,k);switch(c.type){case "MOTION_BLUR":case "SMAA_RESOLVE":case "SMAA_NEIGHBORHOOD_BLENDING":case "MAIN_PLANE_REFLECT":e=[]}P.lg(b,a,function(d,c,f){if(!f.Ba){if((d=w(b,a,f.T))&&f.Xa&&!f.Ba){c=e;for(var g=d,h=0;h<c.length;h++){var k=c[h];k.Ur===g&&k.Hk++}}else d=l(e,f,u(f));f.Ba=d}});P.of(b,a,function(a,b,d){g(e,d.Ba)});P.lg(b,a,function(a,b,d){d.Ba&&"NONE"==d.wa&&g(e,d.Ba)})})}function q(a){C(a,
function(b,d,c){b.jj&&(na(a,c,"SMAA_NEIGHBORHOOD_BLENDING")&&"SMAA_NEIGHBORHOOD_BLENDING"!=c.type||na(a,c,"ANTIALIASING")||"ANCHOR_VISIBILITY"==c.type)&&(b.hg*=la.render_resolution_factor)})}function u(a){a=Fa.Gg(a);delete a.wa;delete a.Xa;delete a.Ba;return JSON.stringify(a)}function w(a,b,d){var c=null;P.of(a,b,function(a,b,e){if(e.Xa&&e.T==e.wa&&e.T==d&&e.Ba)return c=e.Ba,!0});P.lg(a,b,function(a,b,e){if(e.Xa&&e.T==d&&e.Ba)return c=e.Ba,!0});return c}function g(a,b){for(var d=0;d<a.length;d++){var c=
a[d];c.Ur===b&&c.Hk&&c.Hk--}}function l(a,b,d){for(var c=null,e=0;e<a.length;e++){var f=a[e];if(f.id==d&&0===f.Hk){c=f;break}}if(c&&!la.nG)return c.Hk++,c.Ur;b=z(b);a.push({id:d,Hk:1,Ur:b});return b}function z(a){var b=a.hg*a.size;switch(a.T){case "COLOR":var d=da.Sl("COLOR",da.Ph);da.resize(d,b,b);da.Nk(d,a.ga,a.fa);return d;case "DEPTH":return a.Ih?(d=da.Sl("DEPTH_RBUF",da.Oh),da.resize(d,b,b)):(d=da.Sl("DEPTH_TEX",da.sj),da.resize(d,b,b),da.Nk(d,a.ga,a.fa)),d;case "CUBEMAP":return d=da.pD(b);case "SCREEN":return null;
default:throw"Wrong slink param: "+a.T;}}function C(a,b){var d=!1;P.ne(a,function(c,e,f){if(f&&(c=P.ab(a,c),e=P.ab(a,e),b(f,!1,c,e)))return d=!0});d||P.V(a,function(a,d){for(var c=0;c<d.na.length;c++)if(b(d.na[c],!0,d,null))return!0})}function F(a){P.V(a,function(b,d){if("SINK"!=d.type){var c=d.j;P.lg(a,b,function(a,b,d){d.Xa&&d.Ba&&(S.en(c,d.T,d.Ba),d.T==d.wa&&b.j&&S.en(b.j,d.T,d.Ba))});for(var e=0;e<d.na.length;e++){var f=d.na[e];f.Xa&&f.T==f.wa&&S.en(c,f.T,d.le[e])}!c.tb&&!c.qd||c.Oe||(c.Oe=qa.oH(c.tb,
c.qd))}})}function G(a){var b=null,d=0;P.V(a,function(a,c){if(c.type==vb.II){if(d==vb.HI)return b=c,!0;d++}});return b}function D(a,b){var c=P.lh(a,b),e=d("NONE"),f=P.u(a,e),g=P.ew(a)[0];P.ne(a,function(b,d){d==g&&P.fH(a,b,g,b,f)});P.ne(a,function(d,f,g){if(d==c)return P.m(a,b,e,A(vb.hI,"u_color",g.size,g.hg,g.jj)),!0});P.wd(a,f,g,A("SCREEN","NONE",.5,.5,!0))}function H(a,b){var d=x("SHADOW_CAST");d.$o=a;d.self_shadow_polygon_offset=b.self_shadow_polygon_offset;switch(b.uq){case "SPOT":case "POINT":d.j=
S.xb(S.Xb);S.jn(d.j,180*b.ie/Math.PI,.1,2*b.distance);break;default:d.j=S.xb(S.wg)}return d}function x(a){a={type:a,Qa:"",Ja:!1,Kx:!1,po:!1,Fm:!1,Lj:0,time:0,j:null,Kj:null,bp:[],q:[],na:[],le:[],bl:new Float32Array(3),Vz:new Float32Array(3),wc:new Float32Array(3),Qc:new Float32Array(4),Lc:new Float32Array(16),Wy:0,Ff:0,oh:0,dh:null,Pf:null,bh:null,eh:null,Mf:new Float32Array(3),rg:new Float32Array(3),Xy:new Float32Array(4),nz:new Float32Array([0,0,0]),xn:new Float32Array(3),oz:new Float32Array(4),
Vy:new Float32Array(3),vk:0,op:0,lk:!1,Wf:new Float32Array(3),Lh:0,qb:null,Gn:!1,eg:new Float32Array(2),fg:new Float32Array(2),Si:0,Ei:0,Go:0,Ld:null,qg:0,Mh:0,pg:0,Ee:!1,Wt:0,Xt:new Float32Array(2),Vt:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,Ti:new Float32Array(3),ssao_hemisphere:0,ssao_blur_depth:0,ssao_blur_discard_value:0,
Zi:0,Yi:0,Xi:0,hz:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,Di:0,Zm:0,bj:0,$o:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,Iz:null,Mt:null,th:null,bloom_key:0,bloom_blur:0,bloom_edge_lum:0,xo:0,up:0,mb_decay_threshold:0,mb_factor:0,jx:0,Vm:"",dG:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,Vr:new Float32Array(2),Ra:new Float32Array(2),Za:!0,tc:!0,ka:!0,ra:!0,Ub:!0,
ua:!0,nf:1};a.Ra[0]=1;a.Ra[1]=1;return a}function A(a,b,d,c,e){return{T:a,wa:b,size:d,hg:c,jj:e,Xa:!0,Ba:null,Ih:!1,ga:da.Hc,fa:da.Hc}}function r(a,b){for(var d=0,c=ca(a,b),e=0;e<c.length;e++){var f=c[e];"SHADOW_CAST"==f.type&&(f=f.j,b.PG=f.$a/(f.$a-f.cb),b.Iz=f.xa,b.Mt=new Float32Array([.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1]),b.th=b.th||[],b.th[d]=f.Aa,d++)}}function k(){var a=x("GRASS_MAP");a.j=S.xb(S.uf);return a}function d(a){var b=x("POSTPROCESSING");b.ka=!1;b.ra=!1;b.Ub=!1;b.j=S.xb(S.Ib);b.Vm=
a;switch(a){case "NONE":b.Ra[0]=1;b.Ra[1]=1;break;case "GRAYSCALE":b.Ra[0]=1;b.Ra[1]=1;break;case "X_BLUR":b.Ra[0]=1;b.Ra[1]=0;break;case "Y_BLUR":b.Ra[0]=0;b.Ra[1]=1;break;case "X_GLOW_BLUR":b.Ra[0]=1;b.Ra[1]=0;break;case "Y_GLOW_BLUR":b.Ra[0]=0;b.Ra[1]=1;break;case "X_EXTEND":b.Ra[0]=1;b.Ra[1]=0;break;case "Y_EXTEND":b.Ra[0]=0;b.Ra[1]=1;break;default:throw"Wrong postprocessing effect: "+a;}return b}function n(a){var b=x("BLOOM_BLUR");b.ka=!1;b.ra=!1;b.Ub=!1;b.j=S.xb(S.Ib);b.Vm=a;switch(a){case "X_BLUR":b.Ra[0]=
1;b.Ra[1]=0;break;case "Y_BLUR":b.Ra[0]=0;b.Ra[1]=1;break;default:throw"Wrong postprocessing effect for bloom blur: "+a;}return b}function B(a,b){var d=x("GLOW_COMBINE");d.ka=!1;d.ra=!1;d.Ub=!1;d.small_glow_mask_coeff=b.Lf.small_glow_mask_coeff;d.large_glow_mask_coeff=b.Lf.large_glow_mask_coeff;d.small_glow_mask_width=b.Lf.small_glow_mask_width;d.large_glow_mask_width=b.Lf.large_glow_mask_width;d.j=a;return d}function I(a,b,d,c,e,f,g,h,k){var n=x("MAIN_"+a);if("OPAQUE"===a)n.ka=!0,n.ra=d,n.Ja=!1;
else if("BLEND"===a)n.ka=!1,n.ra=!1,n.Ja=!0;else if("XRAY"===a)n.ka=!1,n.ra=!0,n.Ja=!0;else if("PLANE_REFLECT"===a||"CUBE_REFLECT"===a)n.ka=!0,n.ra=!0,n.Ja=!1;else if("GLOW"===a)n.ka=!0,n.ra=!1,n.Ja=!1;else throw"wrong main subscene type";n.Ja&&h&&(n.self_shadow_normal_offset=h.self_shadow_normal_offset);n.j=b;if(a=g.Dr)n.Xy.set([a.qC,a.MF,a.QJ,a.PJ]),n.Vy.set(a.color),n.Wy=a.Ca;n.Mf.set(g.Mf);n.rg.set(g.rg);n.Ff=g.Ff;n.Qc=f;c&&(n.qb=c,c.Qc&&(n.Ld=new Float32Array(c.Qc)),n.qg=c.waves_height,n.Mh=
c.waves_length,n.pg=c.pg,c.Ee&&k&&(n.Ee=!0,n.Wt=c.DC,n.Xt.set(c.EC),n.Vt=c.CC),c.tn&&(n.Gn=!0,f=c.fI,n.eg[0]=(f[0]+f[1])/2,n.eg[1]=(f[2]+f[3])/2,n.fg[0]=f[0]-f[1],n.fg[1]=f[2]-f[3],n.Si=c.Si,n.Ei=c.Ei));n.dh=new Float32Array(3*e);n.Pf=new Float32Array(3*e);n.bh=new Float32Array(3*e);n.eh=new Float32Array(0==e%2?2*e:2*e+2);return n}function E(a,b){var d=x("COLOR_PICKING");b&&(d.type+="_XRAY",d.ka=!1,d.ra=!0);d.tc=!1;d.j=a;return d}function M(a){var b=x("WIREFRAME");b.Za=!1;b.ka=!1;b.ra=!1;b.j=a;return b}
function K(a){var b=x("ANCHOR_VISIBILITY");b.ka=!0;b.ra=!1;b.j=a;return b}function J(a,b){var d=x("DEPTH");d.j=a;d.self_shadow_normal_offset=b.self_shadow_normal_offset;return d}function f(a,b,d){var c=x("SSAO");c.ka=!1;c.ra=!1;c.Ub=!1;c.j=a;c.Qc=b;c.Ld=new Float32Array(b);c.Zi=d.radius_increase;c.ssao_hemisphere=d.LF;c.Yi=d.influence;c.Xi=d.dist_factor;c.hz=d.yH;return c}function p(a,b){var d=x("SSAO_BLUR");d.ka=!1;d.ra=!1;d.Ub=!1;d.j=a;d.ssao_blur_depth=b.tC;d.ssao_blur_discard_value=b.Qt;return d}
function t(){var a=x("ANTIALIASING");a.ka=!1;a.ra=!1;a.Ub=!1;a.nf=1/la.render_resolution_factor;a.j=S.xb(S.Ib);return a}function L(a){var b=x(a);b.ka="SMAA_BLENDING_WEIGHT_CALCULATION"==a||"SMAA_EDGE_DETECTION"==a?!0:!1;b.ra=!1;b.Ub=!1;b.nf=1/la.render_resolution_factor;b.j=S.xb(S.Ib);"SMAA_BLENDING_WEIGHT_CALCULATION"==a&&(b.eG=new Float32Array(4));return b}function N(a,b,d,c){var e=x("COMPOSITING");e.ka=!1;e.ra=!1;e.Ub=!1;e.j=S.xb(S.Ib);e.brightness=a;e.contrast=b;e.exposure=d;e.saturation=c;return e}
function T(a,b){var d=x("MOTION_BLUR");d.ka=!1;d.ra=!1;d.Ub=!1;d.j=S.xb(S.Ib);d.po=!0;d.mb_decay_threshold=a;d.mb_factor=b;return d}function Q(a){var b=x("DOF");b.ka=!1;b.ra=!1;b.Ub=!1;b.j=a;b.nf=b.j.dof_power;return b}function X(a){var b=x("OUTLINE_MASK");b.Ub=!1;b.j=a;return b}function ia(a){var b=x("OUTLINE");b.Wf.set(a.Wf);b.vk=a.vk;b.up=5;b.xo=3;b.Ub=!1;b.j=S.xb(S.Ib);return b}function U(){var a=x("REFRACT");a.ka=!1;a.ra=!1;a.Ub=!1;a.j=S.xb(S.Ib);return a}function ha(a,b,d,c,e,f,g){var h=x("GOD_RAYS");
h.ka=!1;h.ra=!1;h.Ub=!1;h.Mf=new Float32Array([1,1,1]);h.rg=new Float32Array([1,1,1]);h.Ff=1;h.Kx=c;h.Lh=b;h.Zm=e;h.Di=d;h.bj=g;h.j=a;h.oh=f;h.dh=new Float32Array(3*f);h.Pf=new Float32Array(3*f);h.bh=new Float32Array(3*f);h.eh=new Float32Array(0==f%2?2*f:2*f+2);return h}function R(a,b){var d=x("GOD_RAYS_COMBINE");d.ka=!1;d.ra=!1;d.Ub=!1;d.j=S.xb(S.Ib);d.god_rays_intensity=a;d.oh=b;d.dh=new Float32Array(3*b);d.Pf=new Float32Array(3*b);d.bh=new Float32Array(3*b);d.eh=new Float32Array(0==b%2?2*b:2*b+
2);return d}function oa(a,b){var d=x("SKY");d.tc=!1;d.ka=!1;d.ra=!1;d.Ub=!1;var c=S.xb(S.Ib);c.width=xa.Vl;c.height=xa.Vl;d.j=c;d.Kj=Fa.KE();d.oh=a;d.dh=new Float32Array(3*a);d.Pf=new Float32Array(3*a);d.bh=new Float32Array(3*a);d.eh=new Float32Array(0==a%2?2*a:2*a+2);d.Mf=new Float32Array([1,1,1]);d.rg=new Float32Array([1,1,1]);d.Ff=1;d.Ti.set(b.Ti);d.procedural_skydome=b.procedural_skydome;d.use_as_environment_lighting=b.use_as_environment_lighting;d.rayleigh_brightness=b.rayleigh_brightness;d.mie_brightness=
b.mie_brightness;d.spot_brightness=b.spot_brightness;d.scatter_strength=b.scatter_strength;d.rayleigh_strength=b.rayleigh_strength;d.mie_strength=b.mie_strength;d.rayleigh_collection_power=b.rayleigh_collection_power;d.mie_collection_power=b.mie_collection_power;d.mie_distribution=b.mie_distribution;return d}function ea(){var a=x("COPY");a.ka=!1;a.ra=!1;a.j=S.xb(S.Ib);return a}function ba(){var a=x("ANAGLYPH");a.ka=!1;a.ra=!1;a.j=S.xb(S.Ib);return a}function V(){var a=x("LUMINANCE");a.ka=!1;a.ra=
!1;a.j=S.xb(S.Ib);return a}function aa(){var a=x("AVERAGE_LUMINANCE");a.ka=!1;a.ra=!1;a.j=S.xb(S.Ib);return a}function Y(a,b,d,c){var e=x("LUMINANCE_TRUNCED");e.ka=!1;e.ra=!1;e.bloom_key=a;e.bloom_edge_lum=b;e.j=c;e.dh=new Float32Array(3*d);e.Pf=new Float32Array(3*d);e.bh=new Float32Array(3*d);e.eh=new Float32Array(0==d%2?2*d:2*d+2);return e}function O(a){var b=x("BLOOM");b.ka=!1;b.ra=!1;b.j=S.xb(S.Ib);b.bloom_blur=a;return b}function pa(){var a=x("SINK");a.tc=!1;return a}function na(a,b,d){if(b.type===
d)return!0;b=Z(a,b);for(var c=0;c<b.length;c++)if(na(a,b[c],d))return!0;return!1}function ka(a,b,d){if(b.type===d)return!0;b=ca(a,b);for(var c=0;c<b.length;c++)if(ka(a,b[c],d))return!0;return!1}function ca(a,b){var d=P.lh(a,b);if(d==P.Rs)throw"Subscene not in graph";for(var c=[],e=P.Ew(a,d),f=0;f<e;f++){var g=P.im(a,d,f);g!=d&&c.push(P.ab(a,g))}return c}function Z(a,b){var d=P.lh(a,b);if(d==P.Rs)throw"Subscene not in graph";for(var c=[],e=P.sh(a,d),f=0;f<e;f++){var g=P.Ug(a,d,f);g!=d&&c.push(P.ab(a,
g))}return c}function wa(a){var b=[],d=[];C(a,function(a){a.Ba&&-1==b.indexOf(a.Ba)&&(b.push(a.Ba),d.push(a.Ba,b.length-1))});return d}function v(a,b){var d;d=""+(a.T+"\\n");d+="NONE"!=a.wa?a.wa+"\\n":"";d+="(";if(a.jj){var c=a.hg;Math.round(c)!=c&&(c=c.toFixed(2));c=(1==c?"":c)+"S";d+=c+"x"+c}else d+=a.size+"x"+a.size;if("SCREEN"!=a.T){d+=" ";if(a.Ih)d+="RR";else{var c=a.ga,e=a.fa,f="";c==da.t?f+="L":c==da.Hc&&(f+="N");e==da.t?f+="L":e==da.Hc&&(f+="N");d+=f}for(c=0;c<b.length;c+=2)b[c]==a.Ba&&(d+=
" "+b[c+1])}return d+")\\n"}var S=y("__camera"),fa=y("__config"),va=y("__debug"),P=y("__graph"),qa=y("__renderer"),da=y("__textures"),Fa=y("__util"),Ib=y("__objects");y("vec4");var vb=fa.hp,la=fa.r,xa=fa.Pi;a.SC=function(a){switch(a.wa){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "NONE":return!1;default:return!0}};a.TI=C;a.BD=function(a,b,g){function h(d,c){var f=e(ra[c]);b.J.push(f);f=I(d,f,!1,Ab,ga,Ra,fb,Va,a.Dh);v.push(f);P.u(l,f);P.m(l,u[c],f,z[c]);"XRAY"==d?f.na.push(A("DEPTH",
"DEPTH",1,1,!0)):P.m(l,u[c],f,y[c]);pb&&(P.m(l,pb,f,Qa),P.m(l,pb,f,rb));if(Ka){for(var g=0;g<ka.length;g++)P.m(l,ka[g],f,qa[g]);if(bb.Dc&&Ba||Sa||Fb){var g=ic[c],k=e(g.j);b.J.push(k);var n=x("DEPTH_PACK");n.ka=!1;n.ra=!1;n.j=k;P.u(l,n);var k=A("DEPTH","u_depth",1,1,!0),r=A("COLOR","u_scene_depth",1,1,!0);r.ga=da.Hc;r.fa=da.Hc;P.m(l,g,n,k);P.m(l,n,f,r)}}if(C.length)for(n=C.length/ra.length,g=0;g<n;g++)k=n*c+g,P.m(l,C[k],f,Z[k]);if(fa.length)for(g=0;g<fa.length;g++)P.m(l,fa[g],f,Ib[g]);na.length&&P.m(l,
na[c],f,ca[c]);return f}var l=P.create(),u=[],v=[],w=[],z=[],y=[],C=[],Z=[],na=[],ca=[],ka=[],qa=[],fa=[],Ib=[],ga=a.gG,Ab=a.qb,Sa=a.dg,Fb=a.jI,sb=a.or,Ga=a.lf,Xb=a.si,bb=a.uG,rc=a.Nb,bd=a.Xh,cd=a.Gi,cb=a.ci,Ha=a.antialiasing,fb=a.ys,Ra=a.Qc,Va=a.hf,Zb=a.yG,nb=a.sC,Pa=a.FC,Ca=a.EF,jb=a.MG,La=a.ji,Ka=a.$D,Ba=a.Dc,za=Boolean(g.length),ra=[];if(a.anaglyph_use&&!za){var Mb=b.J[0],wa=e(Mb);S.fx(Mb,S.Jb);S.fx(wa,S.Sb);ra.push(Mb,wa);b.J.push(wa)}else{var ya=b.J[0];ra.push(ya)}if(sb){S.hs(ra[0],Va);for(var Yb=
Va.csm_num,W=0;W<Yb;W++){var Rb=H(W,Va);P.u(l,Rb);ka.push(Rb);var Wa=Va.csm_resolution,ya=Rb.j;ya.width=Wa;ya.height=Wa;Rb.ka=!1;qa.push(A("DEPTH","u_shadow_map"+W,Wa,1,!1));(va.cu()||la.hv)&&Rb.na.push(A("COLOR","COLOR",Wa,1,!1))}}if(rc&&rc.qx&&!za)for(W=0;W<rc.qx;W++){ya=S.xb(S.Xb);ya.width=a.Kg;ya.height=a.Kg;S.jn(ya,90,.1,100);S.bg(ya,ya.Ga);var Aa=I("CUBE_REFLECT",ya,!1,Ab,ga,Ra,fb,null,a.Dh);Aa.Kj=Fa.OE();for(var ua=0;6>ua;ua++)Aa.bp.push(S.sD());P.u(l,Aa);var Wb=A("CUBEMAP","u_cube_reflection",
a.Kg,1,!1);Wb.ga=da.t;Wb.fa=da.t;var qc=A("DEPTH","DEPTH",a.Kg,1,!1);Ib.push(Wb);Aa.na.push(qc);fa.push(Aa);rc.Ul.push(Aa)}if(rc&&0<rc.an.length&&!za)for(W=0;W<ra.length;W++)for(ua=0;ua<rc.an.length;ua++)ya=e(ra[W]),ya.Cc=new Float32Array(4),b.J.push(ya),Aa=I("PLANE_REFLECT",ya,!1,Ab,ga,Ra,fb,null,a.Dh),P.u(l,Aa),Wb=A("COLOR","u_plane_reflection",1,a.Bk,!0),Wb.ga=da.t,Wb.fa=da.t,qc=A("DEPTH","DEPTH",1,a.Bk,!0),Z.push(Wb),Aa.na.push(qc),C.push(Aa),rc.Ck.push(Aa);u=[];v=[];if(a.Lb){var pb=k();P.u(l,
pb);Wa=xa.lm;pb.j.width=Wa;pb.j.height=Wa;var Qa=A("DEPTH","u_grass_map_depth",Wa,1,!1);Qa.ga=da.t;Qa.fa=da.t;var rb=A("COLOR","u_grass_map_color",Wa,1,!1);rb.ga=da.t;rb.fa=da.t}else rb=Qa=pb=null;for(var Ia=[],ib=[],ic=[],Jb=[],W=0;W<ra.length;W++){var ya=ra[W],ab={};y.push(A("DEPTH","DEPTH",1,1,!0));if(Ka){var Kb=e(ya);b.J.push(Kb);ab=J(Kb,Va);ic.push(ab);P.u(l,ab);if(sb){for(ua=0;ua<ka.length;ua++)Rb=ka[ua],P.m(l,Rb,ab,qa[ua]);var Ec=A("COLOR","u_color",1,1,!0),Lb=A("DEPTH","u_depth",1,1,!0);if(Ga){var Fc=
e(ya);b.J.push(Fc);var Ua=a.zI,eb=f(Fc,Ra,Ua);P.u(l,eb);var qb=A("COLOR","u_ssao_mask",1,1,!0);P.m(l,ab,eb,Ec);P.m(l,ab,eb,Lb);var Sb=e(ya);b.J.push(Sb);var gb=p(Sb,Ua);P.u(l,gb);var Tb=A("COLOR","u_shadow_mask",1,1,!0);P.m(l,eb,gb,qb);P.m(l,ab,gb,Lb)}}else va.cu()&&ab.na.push(A("COLOR","COLOR",1,1,!0));pb&&(P.m(l,pb,ab,Qa),P.m(l,pb,ab,rb))}Aa=I("OPAQUE",ya,!Ka,Ab,ga,Ra,fb,null,a.Dh);P.u(l,Aa);v.push(Aa);ib.push(Aa);Ka&&(P.m(l,ab,Aa,y[W]),qb?P.m(l,gb,Aa,Tb):sb&&P.m(l,ab,Aa,A("COLOR","u_shadow_mask",
1,1,!0)));var Gb=A("COLOR","u_color",1,1,!0);z.push(A("COLOR","COLOR",1,1,!0));pb&&(P.m(l,pb,Aa,Qa),P.m(l,pb,Aa,rb));if(C.length)for(var kc=C.length/ra.length,ua=0;ua<kc;ua++){var ta=kc*W+ua;P.m(l,C[ta],Aa,Z[ta])}if(fa.length)for(ua=0;ua<fa.length;ua++)P.m(l,fa[ua],Aa,Ib[ua])}u=v;v=[];if(!za&&a.aD){ya=e(u[0].j);b.J.push(ya);var Ta=E(ya,!1);P.u(l,Ta);if(a.rf){ya=e(u[0].j);b.J.push(ya);var Xa=E(ya,!0);P.u(l,Xa);P.m(l,Ta,Xa,A("COLOR","COLOR",1,1,!0));P.m(l,Ta,Xa,A("DEPTH","DEPTH",1,1,!0))}}else Ta=null;
if(bb.Dc&&!za)for(W=0;W<ra.length;W++){var $b=U();P.u(l,$b);P.m(l,u[W],$b,Gb);na.push($b);ca.push(A("COLOR","u_refractmap",1,1,!0))}if(a.Vp){for(W=0;W<ra.length;W++)Aa=h("BLEND",W),Ia.push(Aa);u=v;v=[]}if(a.Kf){for(W=0;W<ra.length;W++){var Da=e(ra[W]);b.J.push(Da);var wc=I("GLOW",Da,!1,Ab,ga,Ra,fb);P.u(l,wc);P.m(l,ib[W],wc,y[W]);var wb=d("X_GLOW_BLUR");wb.Qa="GLOW_MASK_SMALL";wb.nf=a.Lf.small_glow_mask_width;var Ma=A("COLOR","u_color",1,1,!0);Ma.ga=da.t;Ma.fa=da.t;P.u(l,wb);P.m(l,wc,wb,Ma);var kb=
d("Y_GLOW_BLUR");kb.Qa="GLOW_MASK_SMALL";kb.nf=a.Lf.small_glow_mask_width;var Ub=A("COLOR","u_color",1,.5,!0);Ub.ga=da.t;Ub.fa=da.t;P.u(l,kb);P.m(l,wb,kb,Ub);var Bb=d("X_GLOW_BLUR");Bb.Qa="GLOW_MASK_LARGE";Bb.nf=a.Lf.large_glow_mask_width;var xc=A("COLOR","u_color",1,.5,!0);xc.ga=da.t;xc.fa=da.t;P.u(l,Bb);P.m(l,kb,Bb,xc);var tb=d("Y_GLOW_BLUR");tb.Qa="GLOW_MASK_LARGE";tb.nf=a.Lf.large_glow_mask_width;var lb=A("COLOR","u_color",1,.25,!0);lb.ga=da.t;lb.fa=da.t;P.u(l,tb);P.m(l,Bb,tb,lb);var Cb=e(ra[W]);
b.J.push(Cb);var lc=B(Cb,a);P.u(l,lc);a.Vp?P.m(l,Ia[W],lc,A("COLOR","u_src_color",1,1,!0)):P.m(l,ib[W],lc,A("COLOR","u_src_color",1,1,!0));var ub=A("COLOR","u_glow_mask_small",1,.5,!0);ub.ga=da.t;ub.fa=da.t;P.m(l,kb,lc,ub);var ac=A("COLOR","u_glow_mask_large",1,.25,!0);ac.ga=da.t;ac.fa=da.t;P.m(l,tb,lc,ac);w.push(lc)}u=w;v=[]}if(!a.Vp){for(W=0;W<ra.length;W++)Aa=h("BLEND",W),Ia.push(Aa);u=v;v=[]}if(a.rf){for(W=0;W<ra.length;W++){var xb=h("XRAY",W);Jb.push(xb)}u=v;v=[]}if(la.wireframe_debug){for(W=
0;W<ra.length;W++){ya=e(ra[W]);b.J.push(ya);var bc=M(ya);v.push(bc);P.u(l,bc);P.m(l,u[W],bc,z[W]);P.m(l,u[W],bc,y[W]);pb&&(P.m(l,pb,bc,Qa),P.m(l,pb,bc,rb))}u=v;v=[]}if(!za&&a.GB){ya=e(ra[0]);b.J.push(ya);var Db=K(ya);P.u(l,Db);P.m(l,u[0],Db,y[0])}if(Xb&&Ka&&!za){for(W=0;W<ra.length;W++){var Nb=Ca.Di,Rc=Ca.RF,Eb=Ca.bj,Ea=u[W],dd=Ab?1:0,yc=A("DEPTH","u_input",1,1,!0);yc.ga=da.t;yc.fa=da.t;var Ob=A("COLOR","u_input",1,.25,!0);Ob.ga=da.t;Ob.fa=da.t;var mc=Nb/Eb,Gc=e(ra[W]);b.J.push(Gc);var Ja=ha(Gc,dd,
Nb,!0,mc,ga,Eb);P.u(l,Ja);P.m(l,Ea,Ja,yc);var mc=Nb/Eb*.5,Ya=e(ra[W]);b.J.push(Ya);var zc=ha(Ya,dd,Nb,!1,mc,ga,Eb);P.u(l,zc);P.m(l,Ja,zc,Ob);var mc=Nb/Eb*.25,sd=e(ra[W]);b.J.push(sd);var ec=ha(sd,dd,Nb,!1,mc,ga,Eb);P.u(l,ec);P.m(l,zc,ec,Ob);var Sc=R(Rc,ga);v.push(Sc);P.u(l,Sc);P.m(l,Ea,Sc,A("COLOR","u_main",1,1,!0));P.m(l,ec,Sc,A("COLOR","u_god_rays",1,1,!0))}u=v;v=[]}if(bd&&!za){for(W=0;W<ra.length;W++){var Ea=u[W],td=V();P.u(l,td);P.m(l,Ea,td,A("COLOR","u_input",1,1,!0));var Pb=aa();P.u(l,Pb);Pb.j.width=
1;Pb.j.height=1;var xd=A("COLOR","u_input",1,.25,!0);xd.ga=da.t;xd.fa=da.t;var jd=A("COLOR","u_luminance",1,.25,!0);jd.ga=da.t;jd.fa=da.t;P.m(l,td,Pb,xd);var Cd=nb.key,pd=nb.gE,yb=e(ra[W]);b.J.push(yb);var Hc=Y(Cd,pd,ga,yb);P.u(l,Hc);P.m(l,Ea,Hc,A("COLOR","u_main",1,1,!0));P.m(l,td,Hc,jd);P.m(l,Pb,Hc,A("COLOR","u_average_lum",1,1,!1));var sc=A("COLOR","u_color",1,.25,!0);sc.ga=da.t;sc.fa=da.t;wb=n("X_BLUR");P.u(l,wb);P.m(l,Hc,wb,sc);kb=n("Y_BLUR");P.u(l,kb);P.m(l,wb,kb,sc);var Tc=O(nb.blur);P.u(l,
Tc);var kd=A("COLOR","u_bloom",1,.25,!0);kd.ga=da.t;kd.fa=da.t;P.m(l,kb,Tc,kd);P.m(l,Ea,Tc,A("COLOR","u_main",1,1,!0));v.push(Tc)}u=v;v=[]}if(cd&&!za){for(W=0;W<u.length;W++){var qd=u[W],ed=T(Zb.mb_decay_threshold,Zb.mb_factor);v.push(ed);P.u(l,ed);P.m(l,qd,ed,A("COLOR","u_mb_tex_curr",1,1,!0));ed.na.push(A("COLOR","u_mb_tex_accum",1,1,!0))}u=v;v=[]}if(La&&Ka&&!za){for(W=0;W<u.length;W++){var Ea=u[W],Ic=e(ra[W]);b.J.push(Ic);sc=A("COLOR","u_color",1,1,!0);sc.ga=da.t;sc.fa=da.t;var Jc=d("X_BLUR");
P.u(l,Jc);P.m(l,Ea,Jc,sc);var Kc=d("Y_BLUR");P.u(l,Kc);P.m(l,Jc,Kc,sc);var ab=Ia[W],Lc=Q(Ic);Ic.dof_distance=b.dof_distance;Ic.Me=b.Me;Ic.dof_front=b.dof_front;Ic.dof_rear=b.dof_rear;Ic.dof_power=b.dof_power;Ic.dof_on=1;v.push(Lc);P.u(l,Lc);P.m(l,Ea,Lc,A("COLOR","u_sharp",1,1,!0));P.m(l,Kc,Lc,A("COLOR","u_blurred",1,1,!0));P.m(l,ab,Lc,A("DEPTH","u_depth",1,1,!0))}u=v;v=[]}if(!za&&a.outline){for(W=0;W<ra.length;W++){var Ea=u[W],ld=e(ra[W]);b.J.push(ld);var Uc=X(ld);P.u(l,Uc);var Ac=d("X_EXTEND"),Xc=
A("COLOR","u_color",1,1,!0),fc=A("COLOR","u_outline_mask",1,1,!0);Ac.lk=!0;P.u(l,Ac);P.m(l,Uc,Ac,Xc);var Nc=A("COLOR","u_color",1,.5,!0);Nc.ga=da.t;Nc.fa=da.t;var Yc=d("Y_EXTEND");Yc.lk=!0;P.u(l,Yc);P.m(l,Ac,Yc,Nc);Jc=d("X_BLUR");Jc.lk=!0;P.u(l,Jc);P.m(l,Yc,Jc,Nc);var nc=A("COLOR","u_color",1,.25,!0);nc.ga=da.t;nc.fa=da.t;var md=A("COLOR","u_outline_mask_blurred",1,.25,!0);md.ga=da.t;md.fa=da.t;Kc=d("Y_BLUR");Kc.lk=!0;P.u(l,Kc);P.m(l,Jc,Kc,nc);var Mc=ia(jb);P.u(l,Mc);P.m(l,Ea,Mc,A("COLOR","u_outline_src",
1,1,!0));P.m(l,Uc,Mc,fc);P.m(l,Kc,Mc,md);v.push(Mc)}u=v;v=[]}if(cb&&!za){for(W=0;W<u.length;W++){var Ea=u[W],Bc=N(Pa.brightness,Pa.contrast,Pa.exposure,Pa.saturation);P.u(l,Bc);P.m(l,Ea,Bc,A("COLOR","u_color",1,1,!0));v.push(Bc)}u=v;v=[]}if(Ha){for(W=0;W<u.length;W++)if(Ea=u[W],la.smaa){var tc=A("COLOR","u_color",1,1,!0);tc.ga=da.t;tc.fa=da.t;var fd=L("SMAA_EDGE_DETECTION");P.u(l,fd);P.m(l,Ea,fd,tc);var ja=L("SMAA_BLENDING_WEIGHT_CALCULATION");P.u(l,ja);P.m(l,fd,ja,tc);var db=A("COLOR","u_search_tex",
1,1,!1),nd=A("COLOR","u_area_tex",1,1,!1);db.ga=da.t;db.fa=da.t;nd.ga=da.t;nd.fa=da.t;ja.na.push(db);ja.na.push(nd);var Cc=L("SMAA_NEIGHBORHOOD_BLENDING");P.u(l,Cc);P.m(l,Ea,Cc,tc);var Na=A("COLOR","u_blend",1,1,!0);Na.ga=da.t;Na.fa=da.t;P.m(l,ja,Cc,Na);v.push(Cc)}else{var hb=t();P.u(l,hb);var gd=A("COLOR","u_color",1,1,!0);gd.ga=da.t;gd.fa=da.t;P.m(l,Ea,hb,gd);if(1<la.render_resolution_factor){var zb=d("NONE");P.u(l,zb);P.m(l,hb,zb,gd);v.push(zb)}else v.push(hb)}u=v;v=[]}if(a.anaglyph_use&&!za){var Oc=
ba();P.u(l,Oc);P.m(l,u[0],Oc,A("COLOR","u_sampler_left",1,1,!0));P.m(l,u[1],Oc,A("COLOR","u_sampler_right",1,1,!0));v.push(Oc)}else v.push(u[0]);var Vc=P.lh(l,u[0]);if("MOTION_BLUR"==u[0].type)var Wc=!0;else Wc=!1,P.of(l,Vc,function(a,b,d){if(d.T==d.wa)return Wc=!0});if(Wc){var gc=ea();P.u(l,gc);P.m(l,u[0],gc,A("COLOR","u_color",1,1,!0));u=v;v=[];v.push(gc)}Ta&&(Xa?v.push(Xa):v.push(Ta));Db&&v.push(Db);if(!za&&a.vn.procedural_skydome){var Zc=oa(ga,a.vn);P.u(l,Zc);v.push(Zc)}var cc=pa();P.u(l,cc);
for(W=0;W<v.length;W++){var $c=v[W];switch($c.type){case "COLOR_PICKING":case "COLOR_PICKING_XRAY":P.m(l,$c,cc,A("COLOR","NONE",1,1,!0));P.m(l,$c,cc,A("DEPTH","NONE",1,1,!0));break;case "SKY":P.m(l,$c,cc,A("CUBEMAP","u_sky",xa.Vl,1,!1));break;case "ANCHOR_VISIBILITY":P.m(l,$c,cc,A("COLOR","NONE",1,1,!0));break;default:if(za){var od=g[0].e,dc=A("COLOR","OFFSCREEN",1,1,!0);dc.Ba=od;P.m(l,v[W],cc,dc);for(ua=1;ua<g.length;ua++){var ad=g[ua].e,gc=ea();P.u(l,gc);P.m(l,v[W],gc,A("COLOR","u_color",1,1,!0));
dc=A("COLOR","OFFSCREEN",1,ad.Ch/od.Ch,!0);dc.Ba=ad;P.m(l,gc,cc,dc)}}else P.m(l,v[W],cc,A("SCREEN","NONE",1,1,!0))}}if(vb.enabled){var rd=G(l);rd&&D(l,rd)}c(l,Ka);1<la.render_resolution_factor&&q(l);m(l);F(l);if(sb){for(W=0;W<ic.length;W++)r(l,ic[W]);for(W=0;W<Ia.length;W++)r(l,Ia[W]);for(W=0;W<Jb.length;W++)r(l,Jb[W])}return l};a.wO=x;a.bd=function(a,b,d){var c=a.nf;a.Vr[0]=b*a.Ra[0]*c;a.Vr[1]=d*a.Ra[1]*c};a.ec=function(a,b){a.nf=b};a.ZM=function(a){var b=null;P.V(a,function(a,d){return d.j&&null===
d.j.Oe?(b=d,!0):!1});return b};a.Na=function(a,b,d){a=ca(a,b);for(b=0;b<a.length;b++)if(a[b].type===d)return a[b];return null};a.mO=na;a.pO=ka;a.pF=ca;a.PN=Z;a.Oa=function(a,b){var d=null;P.V(a,function(a,c){return c.type==b?(d=c,!0):!1});return d};a.QD=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',d=wa(a);P.V(a,function(a,c){var e=b+="    ",f="",f=c.type.replace(/_/g," ");"POSTPROCESSING"==
c.type&&(f+=" ("+c.Vm.replace(/_/g," ")+")");if(c.j){for(var f=f+"\\n",g=0;g<d.length;g+=2)d[g]==c.j.tb&&(f+="C"+d[g+1]+" ");for(g=0;g<d.length;g+=2)d[g]==c.j.qd&&(f+="D"+d[g+1])}c.na.length&&(f+="\\n-----\\n");for(g=0;g<c.na.length;g++)f+=v(c.na[g],d);g="SINK"==c.type?"dotted":c.tc?"solid":"dashed";b=e+(String(a)+' [label="'+f+'" color="black" style="'+(g+",bold")+'"];\n')});P.ne(a,function(a,c,e){b+="    ";b+=String(a)+" -> "+String(c)+' [label="'+v(e,d)+'" style="'+(e.Xa?"solid":"dotted")+'"];\n'});
return b+="}"};a.CD=function(a){a=P.OI(a);for(var b=[],d=0;d<a.length;d++){var c=a[d];c.tc&&b.push(c)}return b}};b4w.module.__data=function(a,y){function e(a,b){if(a)for(var d=R(a,b.id),c=0;c<d.length;c++){var e=d[c];"MESH"==e.type&&delete e.data.submeshes}sa[b.id]=null;Dc[b.id]=null}function c(a,b,d){var c;a instanceof ArrayBuffer&&(a=na.ow(a));c=a.width;a=a.height;fa.log("%cLOAD IMAGE "+c+"x"+a,"color: #"+(2048<c||2048<a?"a00":1024<c||1024<a?"aa0":"0a0"),b);-1==b.indexOf(Vb)&&d&&fa.warn("image",b,"is not from app root.")}function b(a,b,d,c,e,f){c=b.s;if(!c)throw"Nothing requested";Z.tc([[c,Z.Ds,c]],function(c,
f,g,h){if(c){fa.log("%cLOAD METADATA","color: #616",h);f=xa.AI(c.b4w_format_version);switch(xa.Lz(f,$a.qk)){case -1:f[0]<$a.qk[0]?xa.ma("JSON version is too old relative to B4W engine: "+xa.Hn(f)+", required: "+xa.Hn($a.qk)+". Reexport scene with the latest B4W addon to fix it."):fa.warn("JSON version is a bit old relative to B4W engine: "+ +xa.Hn(f)+", required: "+xa.Hn($a.qk)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>$a.qk[0]?
xa.ma("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):fa.warn("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}$a.Bq=f;for(var k in c)a[k]=c[k];0===b.id&&(Oa=a);(c=a.binaries[0].binfile)?b.Nt=c:(ca.Uy(b,"load_binaries"),ca.Uy(b,"prepare_bindata"));c=a==Oa;if(a.b4w_export_errors)for(k=0;k<a.b4w_export_errors.length;k++)f=a.b4w_export_errors[k],(c&&"PRIMARY"==
f.type||"ALL"==f.type)&&fa.qE(f.text);c=a==Oa;if(a.b4w_export_warnings)for(k=0;k<a.b4w_export_warnings.length;k++)f=a.b4w_export_warnings[k],(c&&"PRIMARY"==f.type||"ALL"==f.type)&&fa.rE(f.text);e(b,d)}else ca.nt(b)},null,function(a){f(b,d,a)})}function h(a,b,d,c,e,f){c=U(b.s)+b.Nt;if(!c)throw"Binary data is missing";Z.tc([[c,Z.el,c]],function(c,f,g,h){c?(fa.log("%cLOAD BINARY","color: #616",h),a.bin_data=c,e(b,d)):ca.nt(b)},null,function(a){f(b,d,a)})}function m(a,b,d,c,e){Ib.RC()&&e(b,d)}function q(a,
b,d,c,e){c=a.bin_data;var f=a.binaries[0],g=a.objects,h=a.meshes;a=a.actions;for(var k=xa.MC(),l=["indices"],n=["normal","tangent"],r=["color","group"],m=["position","texcoord","texcoord2"],p=0;p<h.length;p++)for(var q=h[p].submeshes,t=0;t<q.length;t++)for(var v in q[t]){var x=q[t][v][1];if(-1!=l.indexOf(v)){var w=4*q[t][v][0]+f["int"],z=q[t],y=v,A=c;if(k)var C=new Uint32Array(A,w,x);else for(var C=new Uint32Array(x),A=new DataView(A),B=0;B<x;B++)C[B]=A.getUint32(w+4*B,!0);z[y]=C}else if(-1!=m.indexOf(v))w=
4*q[t][v][0]+f["float"],q[t][v]=u(c,w,x,k);else if(-1!=n.indexOf(v)){w=2*q[t][v][0]+f["short"];z=q[t];y=v;A=c;C=new Float32Array(x);A=new DataView(A);for(B=0;B<x;B++)C[B]=A.getInt16(w+2*B,!0)/32767;z[y]=C}else if(-1!=r.indexOf(v)){w=2*q[t][v][0]+f.ushort;z=q[t];y=v;A=c;C=new Float32Array(x);A=new DataView(A);for(B=0;B<x;B++)C[B]=A.getUint16(w+2*B,!0)/65535;z[y]=C}}for(v=0;v<g.length;v++)for(h=g[v].particle_systems,l=0;l<h.length;l++)n=h[l],n.transforms=u(c,4*n.transforms[0]+f["float"],n.transforms[1],
k);for(g=0;g<a.length;g++){v=a[g];h=v.fcurves;l=v.frame_range;r=l[0];m=l[1];p=aa.YE(r,m);l=null;0>p&&(p=0);var t=q=!1,E;for(E in h)q|=-1<E.indexOf("rotation_euler"),t|=-1<E.indexOf("rotation_quaternion");n=[];for(E in h)if(q&&t&&-1<E.indexOf("rotation_euler"))delete h[E];else{var x=h[E],D;for(D in x)w=x[D],z=u(c,f["float"]+4*w.bin_data_pos[0],w.bin_data_pos[1],k),y=new Float32Array(p),null===l&&(l=new Int8Array(p)),aa.cC(w,z,y,l,r,m),w.Jc=y;-1<E.indexOf("rotation_euler")&&(aa.wE(h[E]),n.push(E))}for(r=
0;r<n.length;r++)m=n[r],p=m.replace("euler","quaternion"),h[p]=h[m],delete h[m];v.xB=l}e(b,d)}function u(a,b,d,c){if(c)c=new Float32Array(a,b,d);else{c=new Float32Array(d);a=new DataView(a);for(var e=0;e<d;e++)c[e]=a.getFloat32(b+4*e,!0)}return c}function w(a,b,d,c,e){var f=a.cameras,h=a.groups,k=a.materials,l=a.meshes,n=a.node_groups,r=a.objects,m=a.particles,p=a.scenes,q=a.speakers,t=a.textures,u=a.worlds;n||(fa.warn('"node_groups" datablock undefined. reexport main scene.'),n=a.node_groups=[]);
for(var x="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),w={},z=0;z<x.length;z++)for(var y=a[x[z]],A=0;A<y.length;A++){var C=y[A];w[C.uuid]=C}for(var B=0;B<p.length;B++){for(var F=p[B],H=F.objects,I=0;I<H.length;I++)D(H,I,w);F.camera&&D(F,"camera",w);F.world&&D(F,"world",w)}for(B=0;B<h.length;B++)for(var K=h[B].objects,I=0;I<K.length;I++)D(K,I,w);for(B=0;B<r.length;B++){var J=r[B];J.dupli_group&&
D(J,"dupli_group",w);J.parent&&D(J,"parent",w);if(J.animation_data){var P=J.animation_data;P.action&&D(P,"action",w);if(P.nla_tracks)for(I=0;I<P.nla_tracks.length;I++)for(var L=P.nla_tracks[I],N=0;N<L.strips.length;N++)L.strips[N].action&&D(L.strips[N],"action",w)}switch(J.type){case "MESH":if(!J.data)throw"mesh not found for object "+J.name;D(J,"data",w);for(var O=!1,Q=J.modifiers,I=0;I<Q.length;I++){var da=Q[I];"ARMATURE"==da.type?(O&&fa.warn('Object "'+J.name+'" has more than one armature modifiers. Only the first one will be used.'),
O=!0,D(da,"object",w)):"CURVE"==da.type&&D(da,"object",w)}var U=J.particle_systems;if(U)for(I=0;I<U.length;I++)D(U[I],"settings",w);break;case "ARMATURE":D(J,"data",w);for(var T=J.pose.bones,Z=J.data.bones,I=0;I<T.length;I++){var na=T[I];na.bone=Z[na.bone];for(var X=na.parent_recursive,N=0;N<X.length;N++)X[N]=T[X[N]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":D(J,"data",w)}var ka=J.constraints;if(ka)for(I=0;I<ka.length;I++){var V=ka[I];V.target&&D(V,"target",w)}var ca=J.lod_levels;
if(ca)for(I=0;I<ca.length;I++){var Y=ca[I];Y.object&&D(Y,"object",w)}}for(B=0;B<l.length;B++)for(var pa=l[B].materials,I=0;I<pa.length;I++)D(pa,I,w);for(B=0;B<k.length;B++){for(var ha=k[B],ba=ha.texture_slots,I=0;I<ba.length;I++)D(ba[I],"texture",w);var ia=ha.node_tree;ia&&G(ia,w)}for(B=0;B<n.length;B++)(ia=n[B].node_tree)&&G(ia,w);for(B=0;B<t.length;B++){var ea=t[B],ga=ea.type;"IMAGE"!=ga&&"ENVIRONMENT_MAP"!=ga||D(ea,"image",w)}for(B=0;B<f.length;B++){var la=f[B];la.dof_object&&D(la,"dof_object",
w)}for(B=0;B<q.length;B++){var ma=q[B];ma.sound&&D(ma,"sound",w);if(ma.animation_data&&(P=ma.animation_data,P.action&&D(P,"action",w),P.nla_tracks))for(I=0;I<P.nla_tracks.length;I++)for(L=P.nla_tracks[I],N=0;N<L.strips.length;N++)L.strips[N].action&&D(L.strips[N],"action",w)}for(B=0;B<m.length;B++){for(var Ib=m[B],ba=Ib.texture_slots,I=0;I<ba.length;I++)D(ba[I],"texture",w);Ib.dupli_group&&D(Ib,"dupli_group",w);Ib.dupli_object&&D(Ib,"dupli_object",w)}for(B=0;B<u.length;B++)if(ba=u[B].texture_slots)for(I=
0;I<ba.length;I++)D(ba[I],"texture",w);va.KC(a);for(var Fa=a.textures,wa=a==Oa?a.scenes[0].b4w_anisotropic_filtering:g().b4w_anisotropic_filtering,sa=0;sa<Fa.length;sa++)a==Oa||"SCENE"!=Fa[sa].b4w_source_type||(Fa[sa].b4w_source_id=""),vb.JD(Fa[sa],wa,a.scenes,b.id);for(var Za={},ta=a.objects,Ta=0;Ta<ta.length;Ta++){var Xa=ta[Ta];if("MESH"===Xa.type&&!Xa.particle_systems.length)for(var $a=Xa.data,Da=$a.name,mb=$a.submeshes,wb=$a.materials,Ma=0;Ma<mb.length;Ma++)0!==mb[Ma].base_length||Za[Da]||(wb[Ma]&&
fa.warn('material "'+wb[Ma].name+'" is not assigned to any face (object "'+Xa.name+'").'),Za[Da]=!0)}for(var kb=a.meshes,Ub=0;Ub<kb.length;Ub++){var Bb=kb[Ub];Bb.materials.length||Bb.uv_textures.length&&fa.warn('mesh "'+Bb.name+'" has a UV map but has no exported material.')}a.materials.push({name:"DEFAULT",use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},
specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,
b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]});for(var Hb=a.meshes,tb=xa.vb("name","DEFAULT",a.materials),lb=0;lb<Hb.length;lb++){var Cb=Hb[lb];0==Cb.materials.length&&
Cb.materials.push(tb)}for(var lc=a.actions,ub=b.id,ac=0;ac<lc.length;ac++){var xb=lc[ac];xb.zB=ub;aa.IB(xb)}for(var bc=a.scenes,Db=0;Db<bc.length;Db++){for(var Nb=bc[Db],Vb=qa.Po(Nb,"ALL"),Eb=[],Ea=0;Ea<Vb.length;Ea++)for(var pc=Vb[Ea].particle_systems,yc=0;yc<pc.length;yc++){var Ob=pc[yc].settings;if("HAIR"==Ob.type)if("OBJECT"==Ob.render_type)v.Dn(Ob.dupli_object,!0);else if("GROUP"==Ob.render_type){for(var mc=Ob.dupli_group,Gc=qa.Po(Nb,"EMPTY"),Ja=0;Ja<Gc.length;Ja++)Gc[Ja].dupli_group==mc&&Eb.push(Gc[Ja]);
for(Ja=0;Ja<mc.objects.length;Ja++)v.Dn(mc.objects[Ja],!0)}else fa.warn("render type",Ob.render_type,"not supported for particle systems ("+Ob.name+").")}for(Ea=0;Ea<Eb.length;Ea++)M(Eb[Ea],[Nb])}oa(a,b.id);for(var Ya=a.scenes,zc=0;zc<Ya.length;zc++){for(var Dc=Ya[zc],ec=[],Sc=[],uc=Ya[zc].objects,Pb=0;Pb<uc.length;Pb++){var Qc=uc[Pb];E(uc,Qc,ec,Sc);var jd=Qc.dupli_group;if(jd)for(var Pc=jd.objects,pd=0;pd<Pc.length;pd++)E(Pc,Pc[pd],ec,Sc)}for(Pb=0;Pb<Sc.length;Pb++)M(Sc[Pb],[Dc]);for(Pb=0;Pb<ec.length;Pb++)xa.XB(ec[Pb][0],
ec[Pb][1])}oa(a,b.id);var yb=R(a,b.id);va.iC(yb,a.scenes);for(sa=0;sa<yb.length;sa++){var Hc=yb[sa];a!=Oa&&Hc.parent&&-1<oc.indexOf(Hc.parent.type)&&(Hc.parent="");v.Dn(Hc,!1);Hc.e.Oc=b.id}for(var sc=0;sc<yb.length;sc++){var Tc=yb[sc];if("MESH"==Tc.type){var kd=aa.dk(Tc);if(kd){var qd=kd.e;if(qd.xf){var ed=Tc.e.pd,Ic=[],Jc;for(Jc in ed){var Kc=ed[Jc];Ic.push(4*Kc.Mj,4*Kc.Rt)}qd.ix.push(Ic)}qd.un.push(Tc.e)}}}for(var Lc=-1,ld=-1,Uc=aa.Uv(),Ac=0;Ac<yb.length;Ac++){var Xc=yb[Ac],fc=Xc.e;if(xa.ac(Xc)&&
fc.zi){var Nc=fc.Ze;Nc>Lc&&(Lc=Nc);Uc>=Nc&&Nc>ld&&(ld=Nc)}}for(Ac=0;Ac<yb.length;Ac++)Xc=yb[Ac],fc=Xc.e,xa.ac(Xc)&&fc.zi&&(fc.Zj=!0,Lc<Uc?fc.Ze=Lc:fc.Ze<=Uc?fc.Ze=ld:(fa.warn('too many bones for "'+Xc.name+'" / '+fc.Ze+" bones (max "+Uc+" with blending, "+2*Uc+" without blending). Blending between frames will be disabled."),fc.Ze=Lc,fc.Zj=!1),fc.Zj=fc.Zj&&!vc.nv);for(var Yc=0;Yc<yb.length;Yc++){var nc=yb[Yc];if(xa.ac(nc)){var md=nc.lod_levels.length;if(md)for(var Mc=nc,Bc=0;Bc<md;Bc++){var tc=nc.lod_levels[Bc].object;
if(!tc){Mc.e.Bm=!0;Mc.e.Qf=nc.lod_levels[Bc].distance;break}tc.e.hh=nc.e.hh;Mc.e.Qf=nc.lod_levels[Bc].distance;tc.e.pk=nc.lod_levels[Bc].distance;if(nc.lod_levels[Bc+1])tc.e.Qf=nc.lod_levels[Bc+1].distance;else{tc.e.Bm=!0;tc.e.Qf=1E4;break}Mc.e.Bm=!1;Mc=tc}}}for(var fd=0;fd<yb.length;fd++){var ja=yb[fd];if(ja.b4w_vehicle){var db=ja.b4w_vehicle_settings;if("CHASSIS"==db.part){ja.l={};ja.l.kv=db.force_max;ja.l.St=db.brake_max;ja.l.JI=db.suspension_compression;ja.l.LI=db.suspension_stiffness;ja.l.KI=
db.suspension_damping;ja.l.NJ=db.wheel_friction;ja.l.wP=db.roll_influence;ja.l.xG=db.max_suspension_travel_cm;ja.l.li=0;ja.l.Bj=1;ja.l.$i=0;ja.l.speed=0;ja.l.vh=[];ja.l.Gk=[];ja.l.aj=null;for(var nd=ja.Fa?ja.Fa.dupli_group.objects:yb,Cc=0;Cc<nd.length;Cc++){var Na=nd[Cc];if(Na.b4w_vehicle){var hb=Na.b4w_vehicle_settings;if(S.VF(Na)&&db.name==hb.name){var gd=S.OJ(Na.b4w_vehicle_settings.part);ja.l.vh[gd]=Na;ja.l.Gk[gd]=new Float32Array(8)}else if(S.Sw(Na)&&db.name==hb.name){ja.l.aj=Na;ja.l.Nr=hb.steering_max;
ja.l.iz=hb.steering_ratio;ja.l.Iw=hb.inverse_control;var zb=Qb.invert(ja.e.Z,new Float32Array(16)),Oc=Qb.multiply(zb,Na.e.Z,zb);ja.l.kz=Oc;var Vc=new Float32Array([1,0,0,0]);ob.transformMat4(Vc,Oc,Vc);ja.l.jz=Vc}else if(S.Rw(Na)&&db.name==hb.name){ja.l.Kr=Na;ja.l.ez=hb.speed_ratio;ja.l.Gq=hb.max_speed_angle;var zb=Qb.invert(ja.e.Z,new Float32Array(16)),Wc=Qb.multiply(zb,Na.e.Z,zb);ja.l.gz=Wc;var gc=new Float32Array([1,0,0,0]);ob.transformMat4(gc,Wc,gc);ja.l.fz=gc}else if(S.Tw(Na)&&db.name==hb.name){ja.l.Sr=
Na;ja.l.Tu=hb.delta_tach_angle;var zb=Qb.invert(ja.e.Z,new Float32Array(16)),Zc=Qb.multiply(zb,Na.e.Z,zb);ja.l.qz=Zc;var cc=new Float32Array([1,0,0,0]);ob.transformMat4(cc,Zc,cc);ja.l.pz=cc}}}if(4!=ja.l.vh.length)throw"Not enough wheels for chassis "+ja.name;}else if("HULL"==db.part){ja.l={};ja.l.vh=[];ja.l.Gk=[];ja.l.kv=db.force_max;ja.l.St=db.brake_max;ja.l.zp=db.floating_factor;ja.l.ts=db.water_lin_damp;ja.l.us=db.water_rot_damp;ja.l.li=0;ja.l.Bj=1;ja.l.$i=0;ja.l.speed=0;ja.l.aj=null;for(var $c=
ja.Fa?ja.Fa.dupli_group.objects:yb,Cc=0;Cc<$c.length;Cc++)Na=$c[Cc],Na.b4w_vehicle&&(hb=Na.b4w_vehicle_settings,S.TF(Na)&&db.name==hb.name?(ja.l.vh.push(Na),ja.l.Gk.push(new Float32Array(8))):S.Sw(Na)&&db.name==hb.name?(ja.l.aj=Na,ja.l.Nr=hb.steering_max,ja.l.iz=hb.steering_ratio,ja.l.Iw=hb.inverse_control,zb=Qb.invert(ja.e.Z,new Float32Array(16)),Oc=Qb.multiply(zb,Na.e.Z,zb),ja.l.kz=Oc,Vc=new Float32Array([1,0,0,0]),ob.transformMat4(Vc,Oc,Vc),ja.l.jz=Vc):S.Rw(Na)&&db.name==hb.name?(ja.l.Kr=Na,ja.l.ez=
hb.speed_ratio,ja.l.Gq=hb.max_speed_angle,zb=Qb.invert(ja.e.Z,new Float32Array(16)),Wc=Qb.multiply(zb,Na.e.Z,zb),ja.l.gz=Wc,gc=new Float32Array([1,0,0,0]),ob.transformMat4(gc,Wc,gc),ja.l.fz=gc):S.Tw(Na)&&db.name==hb.name&&(ja.l.Sr=Na,ja.l.Tu=hb.delta_tach_angle,zb=Qb.invert(ja.e.Z,new Float32Array(16)),Zc=Qb.multiply(zb,Na.e.Z,zb),ja.l.qz=Zc,cc=new Float32Array([1,0,0,0]),ob.transformMat4(cc,Zc,cc),ja.l.pz=cc))}}}for(var od=0;od<yb.length;od++){var dc=yb[od];if(dc.b4w_floating){var ad=dc.b4w_floating_settings;
if("MAIN_BODY"==ad.part){dc.od={};dc.od.zp=ad.floating_factor;dc.od.ts=ad.water_lin_damp;dc.od.us=ad.water_rot_damp;dc.od.Gl=[];for(var rd=dc.Fa?dc.Fa.dupli_group.objects:yb,vd=0;vd<rd.length;vd++){var hd=rd[vd];if(hd.b4w_floating){var Bd=hd.b4w_floating_settings;S.XF(hd)&&ad.name==Bd.name&&(dc.od.Gl.push(hd),hd.uC=hd.b4w_floating_settings.synchronize_position)}}}}}for(sa=0;sa<a.scenes.length;sa++){var wd=a.scenes[sa];hc.enabled&&wd.b4w_enable_physics&&(a==Oa||!S.C(g())&&wd==qa.xp(a))&&S.PF(wd)}e(b,
d)}function g(){return qa.xp(Oa.scenes)}function l(a,b,d,c,e){a!=Oa&&1<a.scenes.length&&(a.scenes=[qa.xp(a.scenes)],fa.warn("loading data contains multiple scenes.","Only the first one will be loaded."));c=g();-1==vc.Pa&&(vc.Pa=c.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(c),1),a.scenes.unshift(c));for(var f=0;f<a.scenes.length;f++){var h=a.scenes[f];if(a==Oa&&!h.camera)throw"Scene check failed: No camera";for(var k=qa.Po(h,"MESH"),l=0;l<k.length;l++){var n=k[l],r=va.$B(n);r&&(a.meshes.push(r),
n.data=r)}for(var n=R(a,b.id),r=a.meshes,l=r.slice(0),m=0;m<n.length;m++){var p=n[m];"MESH"==p.type&&(p=l.indexOf(p.data),-1<p&&l.splice(p,1))}for(m=0;m<l.length;m++)r.splice(r.indexOf(l[m]),1);a==Oa?(qa.NB(h,a.textures),h.e.nj.length&&(b.eq=!0),h.b4w_enable_audio&&Fa.Ft(h),n=qa.Pp(h),l=h.b4w_batch_grid_size):(qa.UB(h,c,a.textures),h.b4w_enable_audio&&!c.k&&Fa.Ft(c),n=qa.Pp(c),l=c.b4w_batch_grid_size);r=[];Y.PE(n,l,k,r);l=c.e.vn;if(l.mH||l.procedural_skydome)l=Y.SE(c.e.ys,l),r.push(l);for(l=0;l<k.length;l++)Y.Bu(k[l],
n);for(l=0;l<r.length;l++)Y.Bu(r[l],n);a==Oa?(qa.rt(h,r),qa.HE(n)):qa.rt(c,r)}c=a.materials;if(Pc.gp&&$a.Fz)for(a=0;a<c.length;a++){k=c[a];n=k.texture_slots;for(f=0;f<n.length;f++)if(r=n[f],l=r.texture,"IMAGE"==l.type||"ENVIRONMENT_MAP"==l.type)h=l.image,h.Ic||(-1<h.filepath.indexOf(".dds")?h.Ic=!0:(h.Ic=!l.b4w_disable_compression&&!r.use_map_normal&&"ENVIRONMENT_MAP"!=l.type&&!l.b4w_shore_dist_map&&"MOVIE"!=h.source,h.Ic&&(h.filepath+=".dds")));if(f=k.node_tree)for(k=f.nodes,f=0;f<k.length;f++)h=
k[f],"TEXTURE"==h.type&&(n=h.texture)&&(h=n.image)&&!h.Ic&&(h.Ic=n.e.wl&&!n.b4w_disable_compression&&"MOVIE"!=h.source,h.Ic&&(h.filepath+=".dds"))}else for(a=a.images,c=0;c<a.length;c++)f=a[c],f.Ic=Boolean("FILE"==f.source&&-1<f.filepath.indexOf(".dds"));e(b,d)}function z(a,b,d,c,e){c=a.groups;a=a.objects;for(var f={},g={},h={},k={},l=0;l<c.length;l++){var n=c[l];f[n.uuid]=n;h[n.uuid]=n}for(l=0;l<a.length;l++)n=a[l],g[n.uuid]=n,k[n.uuid]=n;C(a,null,k,h);for(var r in h)r in f||c.push(h[r]);for(r in k)r in
g||a.push(k[r]);e(b,d)}function C(a,b,d,c){for(var e=[],f=0;f<a.length;f++){var g=a[f],h=d[g.uuid];if(g=h.proxy){b&&-1==e.indexOf(g.uuid)&&e.push(g.uuid);for(var k=d[g.uuid],l=k.constraints,g=0;g<l.length;g++){var n=xa.Gg(l[g]);n.name+="_CLONE";h.constraints.push(n)}"b4w_proxy_inherit_anim"in h&&!h.b4w_proxy_inherit_anim||(h.animation_data&&(k.animation_data=xa.Gg(h.animation_data)),k.b4w_use_default_animation=h.b4w_use_default_animation,k.b4w_auto_skel_anim=h.b4w_auto_skel_anim,k.b4w_anim_behavior=
h.b4w_anim_behavior,k.b4w_cyclic_animation=h.b4w_cyclic_animation)}}for(f=0;f<e.length;f++)h=xa.Qp(a,"uuid",e[f]),-1<h&&a.splice(h,1);e={};for(f=0;f<a.length;f++)g=a[f],h=d[g.uuid],b&&(l=xa.Gg(h),h="origin_name"in h?h.origin_name:h.name,l.name=b+"*"+h,l.origin_name=h,F(l),d[l.uuid]=l,e[g.uuid]=l.uuid,g.uuid=l.uuid),h=d[g.uuid],h.dupli_group&&(g=h.dupli_group,l=c[g.uuid],k=xa.Gg(l),k.name=xa.Vk(l.name+"_CLONE"),k.uuid=wa.Cw("Group"+k.name),c[k.uuid]=k,g.uuid=k.uuid,C(k.objects,h.name,d,c));if(b)for(f=
0;f<a.length;f++){g=a[f];h=d[g.uuid];h.parent&&h.parent.uuid in e?h.parent.uuid=e[h.parent.uuid]:h.parent&&(fa.warn("Object's \""+h.name+'" parent is not in dupli group. Disabling parenting.'),h.parent=null);l=h.constraints;for(g=0;g<l.length;g++)b=l[g],b.target&&b.target.uuid in e&&(b.target.uuid=e[b.target.uuid]);b=h.modifiers;for(g=0;g<b.length;g++)c=b[g],c.object&&c.object.uuid in e&&(c.object.uuid=e[c.object.uuid]);if((h=h.lod_levels)&&h.length)for(g=0;g<h.length;g++)b=h[g],b.object&&b.object.uuid in
e&&(b.object.uuid=e[b.object.uuid])}for(var r in e)uc[r]=e[r]}function F(a){a.uuid=wa.Cw("Object"+a.name)}function G(a,b){for(var d=a.nodes,c=0;c<d.length;c++){var e=d[c];"TEXTURE"==e.type&&e.texture&&D(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in uc&&(e.lamp.uuid=uc[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&D(e,"node_group",b)}e=a.links;for(c=0;c<e.length;c++){var f=e[c];H(f,"from_node",d);H(f,"to_node",d);x(f,"from_socket",f.from_node.outputs);x(f,"to_socket",
f.to_node.inputs)}if(d=a.animation_data)if(d.action&&D(d,"action",b),d.nla_tracks)for(c=0;c<d.nla_tracks.length;c++)for(e=d.nla_tracks[c],f=0;f<e.strips.length;f++)e.strips[f].action&&D(e.strips[f],"action",b)}function D(a,b,d){(d=d[a[b].uuid])||fa.error("Dangling link found:",b,a);a[b]=d}function H(a,b,d){d=xa.vb("name",a[b].name,d);a[b]=d}function x(a,b,d){d=xa.vb("identifier",a[b].identifier,d);a[b]=d}function A(a,b,d,e,f,g){if(!$a.do_not_load_resources){for(var h=U(b.s),k=a.images,l={},n=[],m=
0;m<k.length;m++){var p=k[m],q=p.uuid;if("FILE"===p.source||"MOVIE"===p.source){var t=r(p,a.textures);if(!t.length)fa.warn("image ",p.name," has no users.");else if(!t[0].b4w_shore_dist_map){t=xa.Hm(h+p.filepath);if("FILE"===p.source){var u=p.Ic?Z.el:Z.fl;Pc.Hq&&$a.Fn&&(t=Z.Sk(t),"dds"==t[1]?(t=Z.Sk(t[0]),t=t[0]+".min50."+t[1]+".dds"):t=t[0]+".min50."+t[1])}else"MOVIE"===p.source&&($a.ud?(t=Z.Sk(t),t=t[0]+".altconv.seq",u=Z.gl):(t=Z.Sk(t),u=Fa.kp(t[1]),t=u!=t[1]?t[0]+".altconv."+u:t[0]+"."+u,u=Z.hl));
n.push([q,u,t]);l[q]=p}}}n.length?(e.Dw=0,Z.tc(n,function(f,h,k,m){if(f){if(k==Z.hl||k==Z.gl){if(k==Z.hl)var p=f.videoWidth,q=f.videoHeight;else p=f.images[0].width,q=f.images[0].height;fa.log("%cLOAD VIDEO "+p+"x"+q,"color: #"+(2048<p||2048<q?"a00":1024<p||1024<q?"aa0":"0a0"),m);-1==m.indexOf(Vb)&&fa.warn("video",m,"is not from app root.")}else c(f,m,!0);h=l[h];m=r(h,a.textures);for(p=0;p<m.length;p++){var q=m[p],t=q.image.filepath;k==Z.gl?(q.e.py=f.uc,vb.Wk(q.e,f.images,h.Ic,t,b.id)):vb.Wk(q.e,
f,h.Ic,t,b.id)}}f=++e.Dw/n.length;g(b,d,f)},function(){fa.log("%cLOADED ALL IMAGES","color: #0a0");f(b,d)})):f(b,d)}}function r(a,b){for(var d=[],c=0;c<b.length;c++){var e=b[c];e.image===a&&d.push(e)}return d}function k(a,b,c,e,f,g){if(!$a.do_not_load_resources){a=R(a,b.id);for(var h=U(b.s),k=[],l={},n=0;n<a.length;n++){var r=a[n];if(d(r)){var m=r.data.sound,p=m.uuid;"BACKGROUND_MUSIC"==Fa.Up(r)?(p=xa.sv(),b.aq=!0):"NONE"!=Fa.Up(r)&&$a.Gw&&(b.iq=!0);if(!(p in l)){l[p]=[];m=xa.Hm(h+m.filepath);switch(Fa.bz(r)){case Fa.On:var q=
Z.Bs;break;case Fa.zs:q=Z.Cs}var m=Z.Sk(m),t=Fa.jp(m[1]),m=t!=m[1]?m[0]+".altconv."+t:m[0]+"."+t;k.push([p,q,m])}l[p].push(r)}}k.length?Z.tc(k,function(a,d,f,h){if(a)for(fa.log("%cLOAD SOUND","color: #0aa",h),-1==h.indexOf(Vb)&&fa.warn("sound",h,"is not from app root."),d=l[d],f=0;f<d.length;f++)Fa.nJ(d[f],a);a=++e.nI/k.length;g(b,c,a)},function(){fa.log("%cLOADED ALL SOUNDS","color: #0aa");f(b,c)}):f(b,c)}}function d(a){return Fa.Ve(a)&&Fa.bz(a)!=Fa.As?!0:!1}function n(a,b){for(var d=qa.Ab(a,"SPEAKER",
qa.L),c=0;c<d.length;c++){var e=d[c];Fa.Ve(e)&&(Fa.xi(e)||b)&&Fa.Vq(e)}}function B(a){a=a.e.nj;for(var b=0;b<a.length;b++)$a.ud&&a[b].use_auto_refresh?a[b].e.Ri=!0:a[b].e.Va&&a[b].use_auto_refresh&&a[b].e.Va.play()}function I(a,b,d,c,e){da.start();fa.log("%cSTART NLA","color: #0a0");e(b,d)}function E(a,b,d,c){if(b.lod_levels&&b.lod_levels.length)for(var e=b.lod_levels.length,f=0;f<e;f++){var g=b.lod_levels[f],h=g.object;if(h){var k=xa.Ej(h);k.name=b.name+"_LOD_"+String(f+1);F(k);k.lod_levels=[];d.push([a,
k]);c.push(h);g.object=k}}}function M(a,b){for(var d=0;d<b.length;d++){for(var c=b[d].objects,e=0;e<c.length;e++){var f=c[e].dupli_group;f&&(f=f.objects,g=f.indexOf(a),-1<g&&f.splice(g,1))}var g=c.indexOf(a);-1<g&&c.splice(g,1)}}function K(a,b,d,c,e){c=!0;for(var f=0;f<a.scenes.length;f++)if(!S.TC(a.scenes[f])){c=!1;break}c&&(e(b,d),fa.log("%cPHYSICS READY","color: #0a0"))}function J(a,b,d,c,e){c=g();for(var f=0;f<a.scenes.length;f++){var h=a.scenes[f],k=a==Oa?S.C(h):S.C(c)||S.C(h);a==Oa||(h=c);for(var l=
0;l<ma.length;l++)for(var n=qa.Ab(h,ma[l],qa.L),r=0;r<n.length;r++){var m=n[r];m.e.Oc==b.id&&hc.enabled&&k&&(S.yf(m,h),b.zq&&S.C(m)&&S.mp(m))}}e(b,d)}function f(a,b,d,e,f){var g={};e=[];for(var h=a.scenes,k=0;k<a.scenes.length;k++){var l=h[k];if(l.e.qb&&(l=l.e.qb.tn)&&"FILE"===l.source){var n=l.uuid,m=xa.Hm(U(b.s)+l.filepath);e.push([n,l.Ic?Z.el:Z.fl,m]);g[n]=l}}e.length?Z.tc(e,function(d,e,f,k){if(d){c(d,k,!0);e=g[e];k=r(e,a.textures);for(f=0;f<k.length;f++){var l=k[f];vb.Wk(l.e,d,e.Ic,l.image.filepath,
b.id)}for(f=0;f<h.length;f++)if(k=h[f],k.e.qb.tn===e){var n=d,m=document.createElement("canvas"),l=e.size[0],p=e.size[1];m.width=l;m.height=p;m=m.getContext("2d");m.drawImage(n,0,0);n=m.getImageData(0,0,l,p).data;m=new Float32Array(4);m[0]=1/16581375;m[1]=1/65025;m[2]=1/255;m[3]=1;for(var l=l*p,p=new Float32Array(l),q=0;q<l;q++)p[q]=m[1]*n[4*q+2]+m[2]*n[4*q+3];k.e.zr=p}}},function(){f(b,d)}):f(b,d)}function p(a,b,d,e,f){if($a.antialiasing&&$a.smaa){e=a.scenes[0];a=[];for(var g=["SMAA_EDGE_DETECTION",
"SMAA_BLENDING_WEIGHT_CALCULATION","SMAA_NEIGHBORHOOD_BLENDING","SMAA_RESOLVE"],h=0;h<g.length;h++){var k=qa.ea(e,g[h]);k&&a.push(k)}if(a.length){e=[];h=Z.fl;e.push(["SEARCH_TEXTURE",h,O.mc.smaa_search_texture_path]);e.push(["AREA_TEXTURE",h,O.mc.smaa_area_texture_path]);for(h=0;h<a.length;h++)if(g=a[h],"SMAA_BLENDING_WEIGHT_CALCULATION"==g.type){a=g.na;for(h=0;h<a.length;h++)if(g=a[h],"u_search_tex"==g.wa)var l=g.Ba;else if("u_area_tex"==g.wa)var n=g.Ba;break}e.length?Z.tc(e,function(a,d,e,f){a&&
(c(a,f,!1),d="SEARCH_TEXTURE"==d?l:n,d.source="IMAGE",d.Lt=!0,vb.Wk(d,a,-1!=f.indexOf(".dds")?1:0,f,b.id),vb.Nk(d,vb.t,vb.t))},function(){f(b,d)}):f(b,d)}else f(b,d)}else f(b,d)}function t(a,b,d,c){for(d=0;d<a.scenes.length;d++){var e=a.scenes[d];a==Oa||(e=g());for(var f=qa.Ab(e,"LAMP",qa.L),h=0;h<f.length;h++){var k=f[h];k.e.Oc==b.id&&(b.zq&&xa.ac(k)&&qa.ik(k),c.co.push({oy:e,Ac:k}))}f=qa.Ab(e,"ALL",qa.L);for(h=0;h<f.length;h++)k=f[h],"LAMP"!=k.type&&k.e.Oc==b.id&&(b.zq&&xa.ac(k)&&qa.ik(k),c.co.push({oy:e,
Ac:k}))}}function L(a,b,d,c,e,f){e=c.co;var g=c.tx;e.length?(a=e[g].Ac,g=e[g].oy,qa.yf(g,a,!1),-1!=Qc.indexOf(a.type)&&g.b4w_enable_audio&&Fa.yf(a,g),V.Kw(a)&&V.append(a),c=++c.tx/e.length,"LAMP"==a.type&&qa.mI(g),null!=a.e.Mc&&qa.Bz(g,a),a.e.$c&&"PLANE"==a.e.af&&g.e.Nb&&(qa.jC(a,g),qa.Dz(a.e.Xc,g))):c=1;f(b,d,c)}function N(a,b,d,c,e){if(a==Oa){c=qa.uF();for(var f=qa.pi(),h=0;h<c.length;h++){var k=c[h];qa.aH(k,f);k.b4w_use_nla&&da.kJ(k,k.b4w_nla_cyclic,b.id)}qa.rr(f)}else qa.Ez(g());a=R(a,b.id);v.iJ(a);
e(b,d)}function T(a,b,d,c,e){if(a==Oa)for(c=0;c<a.scenes.length;c++)a.scenes[c].b4w_use_nla||B(a.scenes[c]),n(a.scenes[c]);else a.scenes[0].b4w_use_nla||B(g()),n(g());e(b,d)}function Q(a,b,d,c,e){$a.$g&&(b.eq||b.aq||b.iq)?mb||X(a,e,b,d):e(b,d)}function X(a,b,d,c){var e=ga.parentElement;Za=e.style.zIndex;e.style.zIndex="999";mb=document.createElement("div");mb.style.position="relative";mb.style.height="88px";mb.style.width="88px";var f=Math.round(ga.offsetWidth/2-44);mb.style.top=Math.round(ga.offsetHeight/
2-44).toString()+"px";mb.style.left=f.toString()+"px";mb.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
mb.style.backgroundSize="88px";Hb=document.createElement("div");Hb.style.position="relative";Hb.style.height=ga.offsetHeight.toString()+"px";Hb.style.width=ga.offsetWidth.toString()+"px";Hb.style.background="rgba(0, 0, 0, 0.5)";Hb.style.zIndex="999";e.appendChild(Hb);Hb.appendChild(mb);mb.addEventListener("click",function(){d.eq&&(vb.play(),vb.pause(),vb.reset());if(d.aq){if(a==Oa)for(var e=0;e<a.scenes.length;e++)n(a.scenes[e],!0);else n(g(),!0);Fa.pause()}d.iq&&Fa.UG();ia();b(d,c)},!1)}function ia(){if(mb){var a=
ga.parentElement;a.style.zIndex=Za;Hb.removeChild(mb);a.removeChild(Hb);mb=Hb=null;Za=0}}function U(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function ha(a,b,d){aa.Ka(b)&&aa.remove(b);qa.Dj(b);S.C(b)&&S.iH(b);pa.$h(b)&&pa.bf(b);qa.kH(a,b,d);Fa.Ve(b)&&Fa.pI(b);V.Kw(b)&&V.remove(b)}function R(a,b){Dc[b]||oa(a,b);return Dc[b]}function oa(a,b){for(var d=a.scenes,c=[],e=0;e<d.length;e++)ea(d[e].objects,0,a==Oa,c);Dc[b]=[];for(e=0;e<c.length;e++)for(var d=c[e],f=0;f<d.length;f++)for(var g=
d[f],h=0;h<g.length;h++)Dc[b].push(g[h])}function ea(a,b,d,c){c[b]=c[b]||[];for(var e=c[b],f=0;f<a.length;f++){var g=a[f],h=ba(g);e[h]=e[h]||[];(d||-1==oc.indexOf(g.type))&&-1==e[h].indexOf(g)&&e[h].push(g);(g=g.dupli_group)&&ea(g.objects,b+1,d,c)}}function ba(a){return(a=a.parent||aa.dk(a))?1+ba(a):0}var V=y("__anchors"),aa=y("__animation"),Y=y("__batch"),O=y("__config"),pa=y("__controls"),na=y("__dds"),ka=y("__extensions");y("__lights");var ca=y("__loader"),Z=y("__assets"),wa=y("__md5"),v=y("__objects"),
S=y("__physics"),fa=y("__print"),va=y("__reformer"),P=y("__renderer"),qa=y("__scenes"),da=y("__nla"),Fa=y("__sfx"),Ib=y("__shaders"),vb=y("__textures"),la=y("__nodemat"),xa=y("__util");y("__transform");var ob=y("vec4"),Qb=y("mat4"),$a=O.r,Pc=O.Ae,hc=O.fb,vc=O.ze,pc=O.Jd,sa=null,Dc=null,Vb="",Oa=null,uc={},mb=null,Hb=null,Za=0,oc=["LAMP","CAMERA"],ma=["MESH","CAMERA","EMPTY"],Qc=["SPEAKER"],ga=null;a.Ue=function(a){return ca.Ue(a)};a.update=function(){ca.lJ(sa)};a.bI=function(a){ga=a};a.hJ=function(a,
b){if(mb){Hb.style.height=b.toString()+"px";Hb.style.width=a.toString()+"px";var d=Math.round(a/2-44);mb.style.top=Math.round(b/2-44).toString()+"px";mb.style.left=d.toString()+"px"}};a.load=function(a,d,c,g,n){var r={load_main:{Ua:ca.se,lb:!1,H:[],ob:!1,pb:500,Eb:!1,mb:b},duplicate_objects:{Ua:ca.Od,lb:!1,H:["load_main"],ob:!1,pb:50,Eb:!1,mb:z},load_binaries:{Ua:ca.se,lb:!1,H:["load_main"],ob:!1,pb:500,Eb:!1,mb:h},wait_for_shaders:{Ua:ca.se,lb:!0,H:[],ob:!1,pb:50,Eb:!0,mb:m,Af:m},prepare_bindata:{Ua:ca.Od,
lb:!1,H:["duplicate_objects","load_binaries"],ob:!1,pb:0,Eb:!1,mb:q},prepare_root_datablocks:{Ua:ca.Od,lb:!1,H:["duplicate_objects","prepare_bindata"],ob:!1,pb:150,Eb:!1,mb:w},prepare_root_scenes:{Ua:ca.Od,lb:!1,H:["prepare_root_datablocks","wait_for_shaders"],ob:!1,pb:350,Eb:!1,mb:l},load_smaa_textures:{Ua:ca.se,lb:!0,H:["prepare_root_scenes"],ob:!1,pb:10,Eb:!0,mb:p},load_shoremap:{Ua:ca.se,lb:!0,H:["prepare_root_scenes"],ob:!1,pb:10,Eb:!0,mb:f},load_textures:{Ua:ca.se,lb:!0,H:["prepare_root_scenes"],
ob:!0,pb:500,Eb:!1,mb:A,Fg:{Dw:0}},wait_physics_workers:{Ua:ca.se,lb:!0,H:["load_shoremap"],ob:!1,pb:20,Eb:!1,Af:K},add_physics_objects:{Ua:ca.Od,lb:!1,H:["wait_physics_workers"],ob:!1,pb:20,Eb:!1,mb:J},add_objects:{Ua:ca.Od,lb:!1,H:["add_physics_objects"],ob:!1,pb:800,Eb:!1,mb:t,Af:L,Cj:N,Fg:{co:[],tx:0}},load_speakers:{Ua:ca.se,lb:!0,H:["add_objects"],ob:!0,pb:30,Eb:!1,mb:k,Fg:{nI:0}},mobile_media_start:{Ua:ca.Od,lb:!$a.$g,H:["load_textures","load_speakers"],ob:!0,pb:5,Eb:!1,mb:Q,Af:Q},synchronize_media:{Ua:ca.Od,
lb:!0,H:["mobile_media_start"],ob:!0,pb:70,Eb:!1,mb:T},start_nla:{Ua:ca.Od,lb:!0,H:["mobile_media_start"],ob:!1,pb:5,Eb:!1,mb:I}},u=ca.cw();u||(u=ca.DD(),sa={},Dc={},uc={});sa[u.me.length]={};return ca.KD(r,a,d,c,e,g||pc.Ht,$a.do_not_load_resources,n)};a.Cn=function(a){var b=ca.cw();if(!b||!b.me.length||a&&!ca.NI(b.me[a]))fa.error("Unable to unload data!");else{if(0==a)fa.log("%cUNLOAD ALL","color: #00a"),V.aa(),aa.aa(),Fa.aa(),da.aa(),qa.aa(),ca.aa(),S.aa(),v.aa(),xa.aa(),P.aa(),la.aa(),Ib.aa(),
pa.aa(),ka.aa(),Z.aa(),vb.aa(),Dc=null,uc={},sa=Oa=null;else{fa.log("%cUNLOAD DATA "+a,"color: #00a");aa.hH(a);for(var b=qa.ck(),d=0;d<b.length;d++)for(var c=b[d],e=qa.Ab(c,"ALL",qa.L),f=e.length-1;0<=f;f--){var g=e[f];if(g.e.Oc==a){ha(c,g,!0);e.splice(f,1);var h=qa.Ab(c,g.type,qa.L),g=h.indexOf(g);-1!=g&&h.splice(g,1)}}}ia()}};a.$G=ha;a.yy=function(a){Vb=a}};b4w.module.__anchors=function(a,y){function e(a,d){var e=document.createElement("div"),l=e.style;l.position="absolute";l.backgroundColor="black";l.borderRadius="20px 20px 20px 0px";l.boxShadow="0px 0px 10px rgb(180, 180, 200)";l.opacity=1;l.padding="8px 12px";l.lineHeight="15px";l.visibility="hidden";l.fontSize="12px";var r=w.Yd();r.appendChild(e);var m=g.ek(a),q=document.createElement("span"),u=q.style;q.innerHTML=m.title||a.name;u.fontWeight="bold";u.fontSize="12px";u.lineHeight="15px";u.color=
"#fff";u.fontFamily="Arial";h(q);e.appendChild(q);var x=m.description;if(x){var m=document.createElement("div"),f=m.style;f.position="absolute";f.bottom="0px";f.left="0px";f.backgroundColor="#000";f.borderRadius="20px 20px 20px 0px";f.boxShadow="0px 0px 10px rgb(180, 180, 200)";f.visibility="hidden";f.padding="8px 12px";f.overflow="hidden";f.lineHeight="15px";f.fontSize="12px";f.zIndex="2";e.appendChild(m);var p=document.createElement("span"),t=p.style;p.innerHTML=x;t.fontSize="12px";t.fontFamily=
"Arial";t.fontWeight="bold";t.lineHeight="15px";t.color="#fff";t.visibility="hidden";m.appendChild(p);var z=!1,y=!1;r.addEventListener("click",function(a){if(!(z||y||G))if(a.target!=q&&a.target!=e||"hidden"!=f.visibility||1!=l.opacity)"visible"==f.visibility&&(l.visibility="visible",u.visibility="visible",f.visibility="hidden",t.visibility="hidden");else{l.visibility="hidden";u.visibility="hidden";f.visibility="visible";z=y=!0;a=e.offsetWidth-24;var g=e.offsetHeight-16,h=Math.min(d,c(x)),k=b(x,h);
k==g&&(f.height=k+"px");h!=a?F.Sh(a,h,200,function(a){a==h&&("visible"==f.visibility&&(t.visibility="visible"),z=!1);f.width=a+"px"}):z=!1;k!=g?F.Sh(g,k,200,function(a){a==k&&("visible"==f.visibility&&(t.visibility="visible"),y=!1);f.height=a+"px"}):y=!1;y||z||(t.visibility="visible")}},!1)}return e}function c(a){var b=document.createElement("div"),c=document.createElement("span"),e=b.style;c.innerHTML=a;c.style.fontSize="12px";c.style.fontFamily="Arial";c.style.fontWeight="bold";c.style.color="#fff";
c.style.visibility="hidden";e.lineHeight="15px";b.appendChild(c);e.position="absolute";e.visibility="hidden";e.fontSize="12px";e.display="inline-block";e.lineHeight="15px";document.body.appendChild(b);a=b.offsetWidth+1;document.body.removeChild(b);return a}function b(a,b){var c=document.createElement("div"),e=document.createElement("span"),g=c.style;e.innerHTML=a;e.style.fontSize="12px";e.style.fontFamily="Arial";e.style.fontWeight="bold";e.style.color="#fff";e.style.visibility="hidden";g.lineHeight=
"15px";c.appendChild(e);g.position="absolute";g.visibility="hidden";g.fontSize="12px";g.display="inline-block";g.width=b+"px";g.lineHeight="15px";document.body.appendChild(c);e=c.offsetHeight;document.body.removeChild(c);return e}function h(a){a.style["-webkit-touch-callout"]="none";a.style["-webkit-user-select"]="none";a.style["-khtml-user-select"]="none";a.style["-moz-user-select"]="none";a.style["-ms-user-select"]="none";a.style["user-select"]="none";a.style.cursor="default"}function m(){for(var a=
0,b=0;b<D.length;b++)D[b].lp&&a++;H=new Float32Array(3*a)}var q=y("__batch"),u=y("__camera"),w=y("__container"),g=y("__objects"),l=y("__print"),z=y("__renderer"),C=y("__scenes"),F=y("__time");y("__util");y("__config");var G=!1,D=[],H=new Float32Array(0),x=new Uint8Array(16),A=new Float32Array(2),r=new Float32Array(3);a.append=function(a){var b;a:{for(b=0;b<D.length;b++)if(D[b].Ac==a){b=!0;break a}b=!1}if(!b){b=a.b4w_anchor.detect_visibility&&Boolean(C.ea(C.pi(),"ANCHOR_VISIBILITY"));b={type:a.b4w_anchor.type,
Ac:a,x:0,y:0,depth:0,Uh:"out",lp:b,element:null,Hi:null,HB:a.b4w_anchor.max_width,st:0};switch(b.type){case "ANNOTATION":b.element=e(a,b.HB);b.st=b.element.offsetHeight;break;case "ELEMENT":b.element=document.getElementById(a.b4w_anchor.element_id),b.element||(l.warn("Anchor HTML element was not found, making it generic"),b.type="GENERIC")}D.push(b);m()}};a.remove=function(a){for(var b=0;b<D.length;b++){var c=D[b];if(c.Ac==a){"ANNOTATION"==c.type&&(a=c,w.Yd().removeChild(a.element));D.splice(b,1);
m();break}}};a.update=function(){for(var a=0,b=D.length;b--;){var c=D[b];c.lp&&(H.set(c.Ac.e.h,3*a),a++);var e,g=c,h=r;e=C.fm(C.pi());e=h=u.Zq(e,g.Ac.e.h,h);g=e[0];h=e[1];e=e[2];if(g!=c.x||h!=c.y||e!=c.depth){switch(c.type){case "ANNOTATION":var l=c.element;l.style.left=Math.floor(g)+"px";l.style.top=Math.floor(h-c.st)+"px";break;case "ELEMENT":var l=c.element,m=l.getBoundingClientRect();l.style.cssText+="left:"+Math.floor(g-m.width/2)+"px;top:"+Math.floor(h-m.height/2)+"px;"}c.x=g;c.y=h;c.depth=
e;c.Hi&&c.Hi(g,h,c.Uh,c.Ac,l)}}0<a&&(a=C.ea(C.pi(),"ANCHOR_VISIBILITY").q[0].B,q.WI(a,H))};a.qJ=function(){for(var a=w.Yd(),b=D.length;b--;){var c=D[b],e=c.Ac,g=c.x,h=c.y,l=c.depth,l=0>g||0>h||0>l||1<l||C.oq(e)||g>=a.clientWidth||h>=a.clientHeight?"out":"visible";if(c.lp&&"out"!=l){var l=c,r=C.ea(C.pi(),"ANCHOR_VISIBILITY").j,m=w.Ho(l.x,l.y,A,r);z.dy(r.Oe,m[0],r.height-m[1],2,2,x);l=1020==x[0]+x[4]+x[8]+x[12]?"visible":"out"==l.Uh||0==x[0]+x[4]+x[8]+x[12]?"covered":l.Uh}if(l!=c.Uh){switch(c.type){case "ANNOTATION":case "ELEMENT":var f=
c.element;if(!f)break;"out"==l?(f.style.visibility="hidden",f.children.length&&(f.children[0].style.visibility="hidden"),"ANNOTATION"==c.type&&1<f.children.length&&(r=f.children[1],r.style.visibility="hidden",r.children.length&&(r.children[0].style.visibility="hidden"))):"visible"==l?(f.style.visibility="visible",f.children.length&&(f.children[0].style.visibility="visible"),f.style.opacity=1):(f.style.visibility="visible",f.style.opacity=.1,f.children.length&&(f.children[0].style.visibility="visible"),
"ANNOTATION"==c.type&&1<f.children.length&&(r=f.children[1],r.style.visibility="hidden",r.children.length&&(r.children[0].style.visibility="hidden")))}c.Uh=l;c.Hi&&c.Hi(g,h,c.Uh,e,f)}}};a.RL=function(a,b){for(var c=0;c<D.length;c++)D[c].Ac==a&&(D[c].Hi=b)};a.FM=function(a){for(var b=0;b<D.length;b++)D[b].Ac==a&&(D[b].Hi=null)};a.aa=function(){for(var a=0;a<D.length;a++){var b=D[a];"ANNOTATION"==b.type&&w.Yd().removeChild(b.element)}D.length=0};a.Kw=function(a){return a.b4w_anchor?!0:!1};a.xN=function(a){return a.b4w_anchor&&
a.b4w_anchor.element_id?a.b4w_anchor.element_id:!1};a.pause=function(){G=!0};a.Fd=function(){G=!1}};b4w.module.__md5=function(a){function y(a,m){var w=a[0],g=a[1],l=a[2],z=a[3],w=c(w,g,l,z,m[0],7,-680876936),z=c(z,w,g,l,m[1],12,-389564586),l=c(l,z,w,g,m[2],17,606105819),g=c(g,l,z,w,m[3],22,-1044525330),w=c(w,g,l,z,m[4],7,-176418897),z=c(z,w,g,l,m[5],12,1200080426),l=c(l,z,w,g,m[6],17,-1473231341),g=c(g,l,z,w,m[7],22,-45705983),w=c(w,g,l,z,m[8],7,1770035416),z=c(z,w,g,l,m[9],12,-1958414417),l=c(l,z,w,g,m[10],17,-42063),g=c(g,l,z,w,m[11],22,-1990404162),w=c(w,g,l,z,m[12],7,1804603682),z=c(z,w,g,l,
m[13],12,-40341101),l=c(l,z,w,g,m[14],17,-1502002290),g=c(g,l,z,w,m[15],22,1236535329),w=b(w,g,l,z,m[1],5,-165796510),z=b(z,w,g,l,m[6],9,-1069501632),l=b(l,z,w,g,m[11],14,643717713),g=b(g,l,z,w,m[0],20,-373897302),w=b(w,g,l,z,m[5],5,-701558691),z=b(z,w,g,l,m[10],9,38016083),l=b(l,z,w,g,m[15],14,-660478335),g=b(g,l,z,w,m[4],20,-405537848),w=b(w,g,l,z,m[9],5,568446438),z=b(z,w,g,l,m[14],9,-1019803690),l=b(l,z,w,g,m[3],14,-187363961),g=b(g,l,z,w,m[8],20,1163531501),w=b(w,g,l,z,m[13],5,-1444681467),z=
b(z,w,g,l,m[2],9,-51403784),l=b(l,z,w,g,m[7],14,1735328473),g=b(g,l,z,w,m[12],20,-1926607734),w=e(g^l^z,w,g,m[5],4,-378558),z=e(w^g^l,z,w,m[8],11,-2022574463),l=e(z^w^g,l,z,m[11],16,1839030562),g=e(l^z^w,g,l,m[14],23,-35309556),w=e(g^l^z,w,g,m[1],4,-1530992060),z=e(w^g^l,z,w,m[4],11,1272893353),l=e(z^w^g,l,z,m[7],16,-155497632),g=e(l^z^w,g,l,m[10],23,-1094730640),w=e(g^l^z,w,g,m[13],4,681279174),z=e(w^g^l,z,w,m[0],11,-358537222),l=e(z^w^g,l,z,m[3],16,-722521979),g=e(l^z^w,g,l,m[6],23,76029189),w=
e(g^l^z,w,g,m[9],4,-640364487),z=e(w^g^l,z,w,m[12],11,-421815835),l=e(z^w^g,l,z,m[15],16,530742520),g=e(l^z^w,g,l,m[2],23,-995338651),w=h(w,g,l,z,m[0],6,-198630844),z=h(z,w,g,l,m[7],10,1126891415),l=h(l,z,w,g,m[14],15,-1416354905),g=h(g,l,z,w,m[5],21,-57434055),w=h(w,g,l,z,m[12],6,1700485571),z=h(z,w,g,l,m[3],10,-1894986606),l=h(l,z,w,g,m[10],15,-1051523),g=h(g,l,z,w,m[1],21,-2054922799),w=h(w,g,l,z,m[8],6,1873313359),z=h(z,w,g,l,m[15],10,-30611744),l=h(l,z,w,g,m[6],15,-1560198380),g=h(g,l,z,w,m[13],
21,1309151649),w=h(w,g,l,z,m[4],6,-145523070),z=h(z,w,g,l,m[11],10,-1120210379),l=h(l,z,w,g,m[2],15,718787259),g=h(g,l,z,w,m[9],21,-343485551);a[0]=w+a[0]&4294967295;a[1]=g+a[1]&4294967295;a[2]=l+a[2]&4294967295;a[3]=z+a[3]&4294967295}function e(a,b,c,e,h,m){b=(b+a&4294967295)+(e+m&4294967295)&4294967295;return(b<<h|b>>>32-h)+c&4294967295}function c(a,b,c,g,h,m,y){return e(b&c|~b&g,a,b,h,m,y)}function b(a,b,c,g,h,m,y){return e(b&g|c&~g,a,b,h,m,y)}function h(a,b,c,g,h,m,y){return e(c^(b|~g),a,b,h,
m,y)}var m="0123456789abcdef".split("");a.Cw=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var e;for(e=64;e<=b.length;e+=64){for(var h=b.substring(e-64,e),z=[],C=void 0,C=0;64>C;C+=4)z[C>>2]=h.charCodeAt(C)+(h.charCodeAt(C+1)<<8)+(h.charCodeAt(C+2)<<16)+(h.charCodeAt(C+3)<<24);y(a,z)}b=b.substring(e-64);h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<b.length;e++)h[e>>2]|=b.charCodeAt(e)<<(e%4<<3);h[e>>2]|=128<<(e%4<<3);if(55<e)for(y(a,h),e=0;16>e;e++)h[e]=0;h[14]=8*
c;y(a,h);for(b=0;b<a.length;b++){c=a[b];e="";for(h=0;4>h;h++)e+=m[c>>8*h+4&15]+m[c>>8*h&15];a[b]=e}return a.join("")}};b4w.module.__hud=function(a,y){function e(a){a.font="bold 15px Courier";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function c(a){b(' SCENE "'+a.name+'"');if(a.e){var c=0,e=0;u.V(a.e.ub,function(a,g){if("SINK"==g.type)b(" (F)",g.type);else{var h=g.type,l=Math.round(g.j.width)+"x"+Math.round(g.j.height),m=g.q.length,q=g.Lj,r=g.tc&&g.Za;r?b(" (A)",h,g.oh,l,q,"of",m):b(" (P)",h,g.oh,l,q,"of",m);g.Lj=0;r&&(c+=m,e+=q)}});return[c,e]}b("No INFO")}function b(){for(var a=80+20*g[0],b=[5,18,
3,10,4,3,5],c=arguments[0],e=1;e<arguments.length;e++){for(var h="",m=0;m<b[e]-String(arguments[e]).length;m++)h+=" ";c+=h+arguments[e]}g[0]++;w.fillText(c,30,a)}function h(a,b,c){b*=a.Ma;c.x=a.x+b;c.y=a.y;c.Ma=a.Ma-2*b;c.Ha=a.Ha}function m(a){return a.x+a.Ma/2}function q(a){var b=w,c={x:0,y:0,Ma:0,Ha:0},e=b.canvas.width,b=b.canvas.height;c.x=0;c.y=0;c.Ma=e;c.Ha=b;h(c,.01,c);e=.02*c.Ha;c.x=c.x;c.y+=e;c.Ma=c.Ma;c.Ha-=2*e;e=c.Ma/8;c.x+=e*a;c.y=c.y;c.Ma=e;c.Ha=c.Ha;h(c,.02,c);return c}var u=y("__graph"),
w=null,g=[0,0];a.$b=function(a){a=a.getContext("2d");e(a);return w=a};a.jj=function(){w&&e(w)};a.reset=function(){var a=w;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),g[0]=0,g[1]=0)};a.gI=function(a,e){var h=w;if(h){h.textAlign="left";h.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/e).toFixed(2));g[0]++;for(var m=h=0,q=0;q<a.length;q++){var u=c(a[q]),h=h+u[0],m=m+u[1];g[0]++}b(" ---------------------------------------------");
b("    ","TOTAL ACTIVE","","",m,"of",h)}};a.print=function(){var a=w;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.nP=function(a,b,c,e,g,h,u){var x=w;if(x){b=q(b);var y=b.Ha/5;b.x=b.x;b.y+=4*y;b.Ma=b.Ma;b.Ha=y;x.textAlign="center";x.fillStyle="#00FF00";w.fillText(a,m(b),b.y-10);x.strokeStyle="#00FF00";x.lineWidth=.5;x.beginPath();x.moveTo(b.x,b.y);x.lineTo(b.x+b.Ma,b.y);x.lineTo(b.x+b.Ma,b.y+b.Ha);x.lineTo(b.x,b.y+b.Ha);x.closePath();x.stroke();if(!h&&!u)for(h=
1E6,u=-1E6,a=0;a<c.length;a++)h=Math.min(h,c[a]),u=Math.max(u,c[a]);x.textAlign="right";w.fillText(String(h),b.x-10,b.y+b.Ha);w.fillText(String(u),b.x-10,b.y);x.textAlign="center";w.fillText(String(e),b.x,b.y+b.Ha+15);w.fillText(String(g),b.x+b.Ma,b.y+b.Ha+15);x.strokeStyle="#FF0000";x.lineWidth=1.5;x.beginPath();e=b.Ma/(c.length-1);u=b.Ha/(u-h);for(a=0;a<c.length;a++)g=b.x+e*a,y=b.y+b.Ha-(c[a]-h)*u,0==a?x.moveTo(g,y):x.lineTo(g,y);x.stroke()}};a.LM=function(a,b,c,e,g,h,u){var x=w;if(x)for(x.textAlign=
"center",x.fillStyle="#00FF00",x.font="bold 12px Courier",c=q(c),w.fillText(b?"["+a+"]":a,m(c),c.y),0<=h&&w.fillText(h?"[M]":"[ ]",m(c)-15,c.y+30),0<=u&&w.fillText(u?"[S]":"[ ]",m(c)+15,c.y+30),a={x:0,y:0,Ma:0,Ha:0},b=0;b<e.length;b++){h=e[b];var y="VOLUME"==h[0];if(y){u=c.y+350;var r=c.Ma,k=a;k.x=c.x;k.y=u;k.Ma=r;k.Ha=250}else{u=c.y+10+50*b;var r=c.Ma,k=c.Ha,d=a;d.x=c.x;d.y=u;d.Ma=r;d.Ha=k}u=x;var r=a,d=b==g,n=h[0],k=h[1],B=h[2],I=h[3],E=(I-B)/h[4],E=1>E?Math.floor(1/E-1E-5).toFixed(0).length:0;
h=h[5]?Math.log(k/B)/Math.log(I/B):(k-B)/(I-B);u.textAlign="center";d?u.fillText("["+n+"]",m(r),r.y):u.fillText(n,m(r),r.y);u.strokeStyle="#00FF00";u.lineWidth=y?3:1;y?(u.textAlign="right",u.fillText(I.toFixed(E),m(r)-10,r.y+15),u.textAlign="right",u.fillText(B.toFixed(E),m(r)-10,r.y+r.Ha-15)):(u.textAlign="right",u.fillText(B.toFixed(E),r.x+28,r.y+15),u.textAlign="left",u.fillText(I.toFixed(E),r.x+r.Ma-28,r.y+15));u.beginPath();if(y){var M=r.y+15+(r.Ha-30)*(1-h);u.moveTo(m(r),r.y+15);u.lineTo(m(r),
r.y+r.Ha-15);u.moveTo(m(r)-5,r.y+15);u.lineTo(m(r)+5,r.y+15);u.moveTo(m(r)-5,r.y+r.Ha-15);u.lineTo(m(r)+5,r.y+r.Ha-15);u.moveTo(m(r)-5,M);u.lineTo(m(r)+5,M)}else{var K=r.x+30+(r.Ma-60)*h;u.moveTo(r.x+30,r.y+15);u.lineTo(r.x+r.Ma-30,r.y+15);u.moveTo(r.x+30,r.y+15-5);u.lineTo(r.x+30,r.y+15+5);u.moveTo(r.x+r.Ma-30,r.y+15-5);u.lineTo(r.x+r.Ma-30,r.y+15+5);u.moveTo(K,r.y+15-5);u.lineTo(K,r.y+15+5)}u.stroke();"EQ_Q"==n?(h=Math.log(1+1/(2*k*k)+Math.sqrt((2+1/(k*k))*(2+1/(k*k))/4-1))/Math.log(2),y?(u.textAlign=
"left",u.fillText(k.toFixed(E),m(r)+10,M),u.textAlign="left",u.fillText("("+h.toFixed(E+1)+")",m(r)+10,M+10)):(u.textAlign="right",u.fillText(k.toFixed(E),K,r.y+30),u.textAlign="left",u.fillText("("+h.toFixed(E+1)+")",K,r.y+30))):y?(u.textAlign="left",u.fillText(k.toFixed(E),m(r)+10,M)):(u.textAlign="center",u.fillText(k.toFixed(E),K,r.y+30))}}};b4w.module.__prerender=function(a,y){function e(a,c){var e=a.Dd,g=c.j;e.zm=!1;var h;if(!(h=!e||e.ui)){var m=g.Hf,u=e.Kb.G;h=e.Qf;m=Math.sqrt((u[0]-m[0])*(u[0]-m[0])+(u[1]-m[1])*(u[1]-m[1])+(u[2]-m[2])*(u[2]-m[2]));u=e.hh*e.Kb.La;h=!(m>=e.pk&&m<h+u)}if(h)return!1;e.zm=!0;(h="OUTLINE_MASK"==c.type&&!Boolean(e.ee))||(g=g.dm,e.ii?h=!1:("STATIC"===e.type?(h=e.Kb,e=h.G,e=q.tI(e,g,h.La)):(h=e.Cg,e=h.G,e=q.jE(e,g,h.yg,h.zg,h.Ag)),h=e));return h?!1:"WIREFRAME"==c.type?a.B.wireframe_mode==b.it.WM_DEBUG_SPHERES?
a.B.gi:!a.B.gi:!0}var c=y("__config"),b=y("__debug"),h=y("__geometry"),m=y("__renderer"),q=y("__util"),u=y("__vec3"),w=c.r,g="MAIN_OPAQUE MAIN_BLEND MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_GLOW SHADOW_CAST DEPTH OUTLINE_MASK WIREFRAME COLOR_PICKING MAIN_XRAY COLOR_PICKING_XRAY".split(" ");a.Yq=function(a){if(-1<g.indexOf(a.type)){for(var b=!1,c=a.q,q=0;q<c.length;q++){var y=c[q];if("MAIN_CUBE_REFLECT"==a.type)for(var D=0;6>D;D++)a.j.dm=a.bp[D],y.np[D]=e(y,a),y.np[D]&&(b=!0);else y.Za=e(y,a),y.Za&&
(b=!0)}switch(a.type){case "WIREFRAME":break;default:"MAIN_OPAQUE"===a.type||"DEPTH"===a.type||b?a.Za=!0:(a.Za&&m.clear(a),a.Za=!1)}}if("MAIN_BLEND"==a.type&&w.alpha_sort&&a.q){b=a.j.Hf;c=u.dist(b,a.Vz)>w.alpha_sort_threshold;for(q=0;q<a.q.length;q++)if(D=a.q[q],y=D.Dd,y.Fp||c){var H=D.B;if(H&&H.Ja&&H.sf!=h.we){H=H.ja;if(!H||!D.Za)continue;(D=H.qm)&&D.type==h.jt&&h.$I(H,y.Z,b)}y.Fp=!1}c&&u.copy(b,a.Vz)}}};b4w.module.camera=function(a,y){function e(a,c){if(b.Te(a))return c||(c=new Float32Array(3)),l.copy(a.e.h,c),c;q.error("get_eye(): Wrong object")}function c(a,c){b.Cb(a)?(l.copy(c,a.e.cc),w.w(a),m.P(a)):q.error("set_pivot(): Wrong object or camera move style")}var b=y("__camera");y("__config");var h=y("__container"),m=y("__physics"),q=y("__print"),u=y("__constraints"),w=y("__transform"),g=y("__util"),l=y("vec3"),z=y("vec4");y("quat");var C=y("mat3"),F=y("mat4"),G=new Float32Array(2),D=new Float32Array(3),
H=new Float32Array(3),x=new Float32Array(4),A=new Float32Array(9);a.ld=b.ld;a.iL=b.ld;a.za=b.za;a.Rb=b.Rb;a.Hb=b.Hb;a.Te=b.Te;a.Cb=b.Cb;a.Tc=b.Tc;a.bb=b.bb;a.PH=function(a,c){if(b.Te(a))if(c!=b.ld&&c!=b.Rb&&c!=b.Hb&&c!=b.za)q.error("set_move_style(): Wrong camera move style");else{a.e.Da=c;a.e.kc=null;a.e.qc=null;a.e.Mb=null;a.e.hb=!1;b.OF(a);switch(c){case b.za:var d=e(a,D),h=g.va(a.e.quat,g.Wb,H),d=l.scaleAndAdd(d,h,10,h);l.copy(d,a.e.cc)}w.w(a);m.P(a)}else q.error("set_move_style(): Wrong object")};
a.Bd=function(a){return b.Te(a)?b.Bd(a):(q.error("get_move_style(): Wrong object"),null)};a.XH=function(a,c){if(b.Cb(a)||b.Tc(a)||b.bb(a)){var d=a.e;d.ps=g.qa(c[0],0,Infinity);d.os=g.qa(c[1],0,Infinity);d.qs=g.qa(c[2],0,1)}else q.error("set_velocity_params(): Wrong object or camera move style")};a.hk=function(a,c){if(!b.Cb(a)&&!b.Tc(a)&&!b.bb(a))return q.error("get_velocity_params(): Wrong object or camera move style"),null;c||(c=new Float32Array(3));var d=a.e;c[0]=d.ps;c[1]=d.os;c[2]=d.qs;return c};
a.YP=function(a,c,d,e){var g=a.e;b.vE(c,d,e,g.h,g.quat);w.w(a);m.P(a)};a.Lv=e;a.fQ=c;a.mQ=function(a,c,d){b.Cb(a)?(l.copy(c,a.e.h),l.copy(d,a.e.cc),w.w(a),m.P(a)):q.error("set_trans_pivot(): Wrong object or camera move style")};a.Sp=function(a,c){if(b.Cb(a))return c||(c=new Float32Array(3)),l.copy(a.e.cc,c),c;q.error("get_pivot(): Wrong object or camera move style")};a.yP=function(b,c,d){q.error("rotate_pivot() deprecated, use rotate_camera() or rotate_target_camera() instead");a.cf(b,c,d)};a.CG=
function(a,c,d){if(b.Cb(a)){var e=a.e;if(e.Gz){var g=C.fromMat4(e.Z,A),h=l.subtract(e.h,e.cc,H);D[0]=c;D[1]=0;D[2]=d;l.scale(D,l.len(h),D);l.transformMat3(D,g,D);l.add(e.cc,D,e.cc);l.add(e.h,D,e.h);w.w(a);m.P(a)}}else q.error("move_pivot(): wrong object")};a.xP=function(b,c){q.error("rotate_hover_cam() deprecated, use rotate_camera() or rotate_hover_camera() instead");a.zh(b,c,0)};a.FN=function(a){q.error("get_hover_cam_angle() deprecated, use get_camera_angles() instead");return b.bb(a)?-b.Ad(a,
G)[1]:(q.error("get_hover_cam_angle(): wrong object or camera move style"),null)};a.QP=function(a,c){q.error("set_hover_cam_angle() deprecated, use rotate_camera() or rotate_hover_camera() instead");if(b.bb(a))if(a.e.hb){var d=b.Ad(a,G);(d=-c-d[1])&&b.zh(a,0,d);w.w(a);m.P(a)}else q.error("set_hover_cam_angle(): distance/hover_angle limits are not defined or disabled");else q.error("set_hover_cam_angle(): wrong object or camera move style")};a.nF=function(a,c){if(b.bb(a))return a.e.Mb?(c||(c=new Float32Array(2)),
c[0]=a.e.Mb.Ta,c[1]=a.e.Mb.gb):q.error("get_hover_angle_limits(): camera hasn't angle limits"),c;q.error("get_hover_angle_limits(): wrong object")};a.aF=function(a){var c;if(b.bb(a)||b.Cb(a))return a.e.hb?(c||(c=new Float32Array(2)),c[0]=a.e.Lg,c[1]=a.e.Le):q.error("get_cam_dist_limits(): camera hasn't distance limits"),c;q.error("get_cam_dist_limits(): wrong object")};a.EQ=function(b,c){q.error("translate_hover_cam_v() deprecated, use hover_cam_set_translation() instead");a.fq(b,c)};a.fq=function(a,
c){if(b.bb(a)){var d=a.e;if(d.hb){var e=l.subtract(c,d.h,D);l.add(e,d.lc,d.lc)}w.Hd(a,c);w.w(a);m.P(a)}else q.error("hover_cam_set_translation(): wrong object")};a.RP=function(a,c){if(b.bb(a)){var d=a.e;if(d.hb&&d.Mb){var e=l.subtract(c,d.lc,D),e=l.add(e,d.h,e);w.Hd(a,e)}l.copy(c,d.lc);w.w(a);m.P(a)}else q.error("set_hover_pivot(): Wrong object or camera move style")};a.oF=function(a,c){if(!b.bb(a))return q.error("get_hover_cam_pivot(): wrong object"),null;c||(c=new Float32Array(3));l.copy(a.e.lc,
c);return c};a.bq=function(a){return b.Cb(a)||b.bb(a)?a.e.hb:(q.error("has_distance_limits(): wrong object"),null)};a.GL=function(a,c,d,e){switch(b.Bd(a)){case b.za:case b.Rb:e|=w.pl;break;case b.Hb:if(c>d){q.error("apply_vertical_limits(): wrong vertical limits");return}break;default:q.error("apply_vertical_limits(): wrong object");return}a.e.qc={Ta:c,gb:d};b.bH(a,e==w.ol);w.w(a);m.P(a)};a.sM=function(a){a.e.qc=null};a.fO=function(a,c){if(!b.Cb(a)&&!b.Tc(a)&&!b.bb(a))return q.error("get_vertical_limits(): wrong object"),
null;var d=a.e;c=c||new Float32Array(2);return d.qc?(c[0]=d.qc.Ta,c[1]=d.qc.gb,c):null};a.qO=function(a){if(b.Cb(a)||b.Tc(a)||b.bb(a))return Boolean(a.e.qc);q.error("has_vertical_limits(): wrong object")};a.DL=function(a,c,d,e){switch(b.Bd(a)){case b.za:case b.Rb:e|=w.pl;break;case b.Hb:if(c>d){q.error("apply_horizontal_limits(): wrong horizontal limits");return}break;default:q.error("apply_horizontal_limits(): wrong object");return}a.e.kc={left:c,right:d};b.YG(a,e==w.ol);w.w(a);m.P(a)};a.pM=function(a){a.e.kc=
null};a.mF=function(a,c){if(!b.Cb(a)&&!b.Tc(a)&&!b.bb(a))return q.error("get_horizontal_limits(): wrong object"),null;var d=a.e;c=c||new Float32Array(2);return d.kc?(c[0]=d.kc.left,c[1]=d.kc.right,c):null};a.KF=function(a){if(b.Cb(a)||b.Tc(a)||b.bb(a))return Boolean(a.e.kc);q.error("has_horizontal_limits(): wrong object")};a.EL=function(a,c,d){b.bb(a)?c<d?q.error("apply_hover_angle_limits(): wrong hover angle limits"):(c=g.ye(c,-Math.PI,Math.PI),d=g.ye(d,-Math.PI,Math.PI),c=g.qa(c,-Math.PI/2,0),d=
g.qa(d,-Math.PI/2,0),a.e.Mb={Ta:c,gb:d},b.NF(a),w.w(a),m.P(a)):q.error("apply_hover_angle_limits(): wrong object")};a.qM=function(a){b.bb(a)?a.e.Mb=null:q.error("clear_hover_angle_limits(): wrong object")};a.AL=function(a,c,d){if(b.Cb(a)||b.bb(a))if(c>d)q.error("apply_distance_limits(): wrong distance limits");else{var e=a.e;e.hb=!0;e.Le=c;e.Lg=d;w.w(a);m.P(a)}else q.error("apply_distance_limits(): wrong object")};a.mM=function(a){b.Cb(a)||b.bb(a)?a.e.hb=!1:q.error("clear_distance_limits(): wrong object")};
a.KP=function(b,c,d){q.error("set_eye_params() deprecated, use rotate_camera() or rotate_eye_camera() instead");a.ad(b,c,Math.PI/2-d)};a.EO=function(a){g.va(a.e.quat,g.Wb,D);return 0<=D[1]?!0:!1};a.Oi=function(c,e,d,g,h){switch(a.Bd(c)){case b.ld:break;case b.za:b.cf(c,e,d,g,h);break;case b.Rb:b.ad(c,e,d,g,h);break;case b.Hb:b.zh(c,e,d,g,h);break;default:q.error("rotate_camera(): Wrong object")}w.w(c);m.P(c)};a.cf=function(a,c,d,e,g){b.Cb(a)?(b.cf(a,c,d,e,g),w.w(a),m.P(a)):q.error("rotate_target_camera(): wrong object")};
a.ad=function(a,c,d,e,g){b.Tc(a)?(b.ad(a,c,d,e,g),w.w(a),m.P(a)):q.error("rotate_eye_camera(): wrong object")};a.zh=function(a,c,d,e,g){b.bb(a)?(b.zh(a,c,d,e,g),w.w(a),m.P(a)):q.error("rotate_hover_camera(): wrong object")};a.rotate=function(b,c,d){q.error("rotate() deprecated, use rotate_camera() or rotate_eye_camera() instead");a.ad(b,c,-d)};a.Ad=function(a,c){c||(c=new Float32Array(2));b.Ad(a,c);return c};a.gm=function(a,c){c||(c=new Float32Array(2));b.gm(a,c);return c};a.wv=function(a,c){q.error("get_angles() deprecated, use get_camera_angles() instead");
c||(c=new Float32Array(2));b.wv(a,c);return c};a.Ly=function(a,c){for(var d=a.e.J,e=0;e<d.length;e++){var g=d[e];g.type!=b.Jb&&g.type!=b.Sb||b.UH(g,c,g.ke)}};a.jw=function(a){a=a.e.J;for(var c=0;c<a.length;c++){var d=a[c];if(d.type==b.Jb||d.type==b.Sb)return d.Tk}return 0};a.HO=function(a){q.error("is_underwater() deprecated, always returns false");return a.e.xz};a.FQ=function(a,c,d,e){a=a.e.J;for(var g=0;g<a.length;g++){var h=a[g];h.Cc||b.bg(h,h.Ga);var l=D;l[0]=-c;l[1]=-d;l[2]=0;F.translate(h.Aa,
l,h.Aa);F.rotateZ(h.Aa,e,h.Aa);F.multiply(h.Aa,h.xa,h.pe);b.Ut(h);b.Eo(h)}};a.jF=function(a){return g.Ym(a.e.J[0].Rc)};a.NP=function(a,c){for(var d=a.e.J,e=0;e<d.length;e++){var h=d[e];h.Rc=g.WD(c);h.Cc||b.bg(h,h.Ga);F.multiply(h.Aa,h.xa,h.pe);b.Ut(h);b.Eo(h)}};a.Pl=function(a,b){b||(b=g.jb);u.Pl(a,b)};a.TQ=function(a,e){if(b.Cb(a)){w.jm(e,!1,D);c(a,D);w.w(a);var d=w.Rp(e),g=b.VE(a)/2,d=d/Math.sin(g),g=w.KG(a,D);w.Uc(a,0,d-g,0);w.w(a);m.P(a)}else q.error("zoom_object(): wrong object")};a.eQ=function(c,
e){if(b.Te(c)&&a.Ow(c)){var d=c.e;if(b.Cb(c)){var g=l.dist(d.h,d.cc);d.wi=e/2*d.vi/g}else b.bb(c)&&a.bq(c)?(g=l.distance(d.h,d.lc),d.wi=e/2*d.vi/g):c.e.J[0].top=e/2;b.jJ(c)}else q.error("set_ortho_scale(): wrong object")};a.ON=function(c){if(b.Te(c)&&a.Ow(c))return 2*c.e.J[0].top;q.error("get_ortho_scale(): wrong object")};a.Ow=function(a){if(b.Te(a))return a.e.J[0].type==b.md;q.error("is_ortho_camera(): wrong object")};a.WL=function(a,c,d,e){e||(e=new Float32Array(3));var g=a.e.J[0];switch(g.type){case b.Xb:case b.ve:case b.Jb:case b.Sb:var m=
Math.tan(g.Rc*Math.PI/360),u=m*g.Ga;c=h.Ho(c,d,G,g);x[0]=(2*c[0]/g.width-1)*u;x[1]=-1;x[2]=(2*c[1]/g.height-1)*m;x[3]=0;z.transformMat4(x,a.e.Z,x);e[0]=x[0];e[1]=x[1];e[2]=x[2];l.normalize(e,e);return e;default:return q.error("Non-compatible camera"),e}};a.Zq=function(a,c,d){d||(d=new Float32Array(2));return b.Zq(a,c,d)}};b4w.module.config=function(a,y){var e=y("__config");a.vg=e.vg;a.ug=e.ug;a.Nh=e.Nh;a.bt=e.bt;a.set=e.set;a.get=e.get;a.reset=e.reset;a.iw=e.iw};b4w.module.constraints=function(a,y){var e=y("__camera"),c=y("__constraints"),b=y("__physics"),h=y("__print"),m=y("__transform");a.xL=function(a,e,h,g,l){l=l||1;e instanceof Array&&2==e.length?c.tt(a,e[0],e[1],h,g,l):c.ko(a,e,h,g,l);m.w(a);b.P(a)};a.vL=function(a,e,h,g){c.QB(a,e,h,g);m.w(a);b.P(a)};a.wL=function(a,u,w,g,l,z,y,F){if(!e.Tc(a))return h.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented."),null;c.PB(a,u,w,g,l,z,y,F);m.w(a);b.P(a)};a.uL=function(a,
u,w,g){if(!e.Tc(a))return h.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented."),null;if(!g||0>g)g=.25;c.OB(a,u,w,g);m.w(a);b.P(a)};a.RB=function(a,e){c.SB(a,e);m.w(a);b.P(a)};a.rL=function(a,e,h){c.KB(a,e,h);m.w(a);b.P(a)};a.yL=function(a,e,h,g){c.TB(a,e,h,g);m.w(a);b.P(a)};a.zL=function(a,e){3==e.length?c.WB(a,e):c.VB(a,e);m.w(a);b.P(a)};a.sL=function(a,e,h,g){3==e.length?c.MB(a,e,h,g):c.LB(a,e,h,g);m.w(a);b.P(a)};a.ut=function(a,e,h){c.ut(a,e,h);m.w(a);b.P(a)};
a.remove=function(a){a.kb&&c.remove(a)};a.Yv=c.Yv};b4w.module.container=function(a,y){var e=y("__container"),c=y("__print");a.Mp=e.Mp;a.Yd=e.Yd;a.tm=function(a,h){2!=arguments.length?c.error("insert_to_container(): two arguments required"):a&&h&&e.tm(a,h)};a.ry=e.ry;a.zz=e.zz;a.Ml=e.Ml;a.Cp=e.Cp};b4w.module.controls=function(a,y){var e=y("__controls"),c=y("__print");a.ia=e.ia;a.Sn=e.Sn;a.Nd=e.Nd;a.Md=e.Md;a.Rn=e.Rn;a.sK=8;a.cL=9;a.AK=13;a.$K=16;a.wK=17;a.qK=18;a.WK=19;a.uK=20;a.CK=27;a.bL=32;a.Ms=37;a.Ps=38;a.Ns=39;a.Ls=40;a.hK=49;a.iK=50;a.jK=51;a.kK=52;a.lK=53;a.mK=54;a.nK=55;a.oK=56;a.pK=57;a.Js=65;a.rK=66;a.pA=67;a.Ks=68;a.zK=69;a.qA=70;a.EK=71;a.GK=72;a.HK=73;a.IK=74;a.rA=75;a.sA=76;a.JK=77;a.KK=78;a.VK=79;a.uA=80;a.YK=81;a.vA=82;a.Os=83;a.xA=84;a.dL=85;a.eL=86;a.Qs=87;a.fL=88;a.gL=89;
a.hL=90;a.LK=96;a.MK=97;a.NK=98;a.OK=99;a.PK=100;a.QK=101;a.RK=102;a.SK=103;a.TK=104;a.UK=105;a.yK=110;a.ZK=186;a.BK=187;a.vK=188;a.xK=189;a.XK=190;a.DK=191;a.FK=192;a.tA=219;a.tK=220;a.wA=221;a.aL=222;a.nl=e.nl;a.ml=e.ml;a.ll=e.ll;a.Xo=e.Xo;a.nb=e.nb;a.Wo=function(a,c,m){return e.Wo(a,c||"ANY",m||!1)};a.Au=e.Au;a.Gu=function(a,c,m,q,u,w,g){return e.Gu(a,c,m,q||"ANY",u||!1,w||!1,g||!1)};a.Ql=e.Ql;a.Yo=e.Yo;a.fi=e.fi;a.Ij=e.Ij;a.Tl=e.Tl;a.Eu=e.Eu;a.Ju=e.Ju;a.Cu=e.Cu;a.Du=e.Du;a.Iu=function(a,c){return e.Iu(a,
c||!1)};a.ky=e.ky;a.di=e.di;a.Hu=e.Hu;a.Zo=function(a,c){return e.Zo(a,c||!1)};a.GP=function(a,c){e.FH(a,c)};a.vN=function(a){return a.value};a.vc=e.vc;a.ae=e.ae;a.R=function(a,c,m,q,u,w,g){u=u||e.Ru;e.R(a,c,m,q,u,w,void 0===g?null:g)};a.ei=function(a,c,m,q,u){var w;q=e.nb(q);e.R(a,c,m,[q],e.Ru,u,void 0===w?null:w)};a.hM=function(a){return e.$h(a,null)};a.$h=e.$h;a.qP=function(a){c.error("remove_sensor_manifolds() deprecated, use remove_sensor_manifold() instead");e.bf(a,null)};a.bf=e.bf;a.reset=
e.reset;a.ir=e.ir;a.jr=function(a,c,m){e.jr(a,c,!!m)};a.lr=e.lr;a.kr=e.kr;a.hr=e.hr;a.cs=e.cs;a.ds=e.ds;a.fs=e.fs;a.es=e.es;a.bs=e.bs};b4w.module.data=function(a,y){var e=y("__data");y("__print");y("__util");a.load=e.load;a.Cn=function(a){e.Cn(a|0)};a.yy=e.yy;a.Ue=e.Ue;a.OO=e.load;a.aa=a.Cn};b4w.module.debug=function(a,y){function e(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var e=a[c];if(-1!=e.search(new RegExp(/^[A-Z.]+ /))){var d=e.split(" ")[0];d in b||(b[d]=0);b[d]++}}c=a=0;for(d in b)switch(d){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[d];break;default:a+=b[d]}b.ALU_OPS=a;b.TEX_OPS=c;return b}function c(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);
if(200==c.status)return c.responseText;throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.Gp.ALU_OPS-a.Gp.ALU_OPS});for(var b=0;b<a.length;b++){var c=a[b],e=c.Gp,d=c.KJ,l=h(c.MD),l=l?"\t\t("+l.join(", ")+")":"\t\t(NA)";g.groupCollapsed("FRAG --\x3e","ALU",e.ALU_OPS,"TEX",e.TEX_OPS,"\t\tVERT --\x3e","ALU",d.ALU_OPS,"TEX",d.TEX_OPS,l);g.groupCollapsed("directives");for(var l=c.Ob.Df,m=0;m<l.length;m++){var q=l[m];g.log(q[0],q[1])}g.groupEnd();g.groupCollapsed("vert src");
g.log(c.JJ);g.groupEnd();g.groupCollapsed("vert stats");for(var u in d)"ALU_OPS"!=u&&"TEX_OPS"!=u&&g.log(u,d[u]);g.groupEnd();g.groupCollapsed("frag src");g.log(c.FE);g.groupEnd();g.groupCollapsed("frag stats");for(u in e)"ALU_OPS"!=u&&"TEX_OPS"!=u&&g.log(u,e[u]);g.groupEnd();g.groupEnd()}}function h(a){for(var b=l.ck(),c=0;c<b.length;c++)for(var e=l.Ab(b[c],"MESH",l.L),d=0;d<e.length;d++){var g=e[d];if(g.o)for(var h=0;h<g.o.length;h++){var m=g.o[h];if(m.pc==a&&m.Rf.length)return m.Rf}}return null}
y("__batch");y("__config");var m=y("__controls"),q=y("__debug"),u=y("__extensions"),w=y("__physics"),g=y("__print"),l=y("__scenes"),z=y("__scenegraph"),C=y("__shaders"),F=y("__sfx"),G=y("__textures"),D=y("__util"),H=y("vec3");a.lP=function(){w.SD()};a.kP=function(a){g.log("O",w.xE(a));for(var b=w.UE().n.q,c=0;c<b.length;c++){var e=b[c];e.fb.I==a&&g.log("B",e)}};a.QQ=function(){for(var a=l.p(),b=l.Ab(a,"MESH",l.L),a=[l.ea(a,"MAIN_OPAQUE"),l.ea(a,"MAIN_BLEND")],c=0;c<a.length;c++){var e=a[c],d=e.q;
if(d.length){g.group(e.type,"DYNAMIC");for(var h=0;h<b.length;h++){var m=b[h],q=m.e;if("DYNAMIC"==q.type)for(var u=0;u<d.length;u++){var w=d[u];if(w.Za&&w.Dd==q){g.Cq(m.name,m);break}}}g.groupEnd();g.groupCollapsed(e.type,"STATIC");for(h=0;h<b.length;h++)if(m=b[h],q=m.e,"DYNAMIC"!=q.type)for(u=0;u<d.length;u++)if(w=d[u],w.Za&&w.Dd==q){g.Cq(m.name,m);break}g.groupEnd()}}};a.bP=function(a){for(var b=l.p(),c=l.Ab(b,"MESH",l.L),e=0;e<c.length;e++){var d=c[e];if(d.name==a){g.log("Object",d);for(var h=
l.Jp(b),m=0;m<h.length;m++){for(var q=h[m],u=q.q,w=[],z=0;z<u.length;z++)u[z].Dd==d.e&&w.push(u[z]);g.log("Subscene "+q.type,w)}}}};a.cP=function(){var a=l.p();console.log("Armatures: "+l.Ab(a,"ARMATURE",l.L).length);console.log("Cameras: "+l.Ab(a,"CAMERA",l.L).length);console.log("Curves: "+l.Ab(a,"CURVE",l.L).length);console.log("Empties: "+l.Ab(a,"EMPTY",l.L).length);console.log("Lamps: "+l.Ab(a,"LAMP",l.L).length);console.log("Meshes: "+l.Ab(a,"MESH",l.L).length);console.log("Speakers: "+l.Ab(a,
"SPEAKER",l.L).length)};a.Qq=function(){for(var a=0,b=l.p(),b=[l.ea(b,"MAIN_OPAQUE"),l.ea(b,"MAIN_BLEND")],c=0;c<b.length;c++){var e=b[c];if(e)for(var e=e.q,d=0;d<e.length;d++){var g=e[d].B;g&&(a+=g.Qq)}}return a};a.sk=function(){for(var a=0,b=l.p(),b=[l.ea(b,"MAIN_OPAQUE"),l.ea(b,"MAIN_BLEND")],c=0;c<b.length;c++){var e=b[c];if(e)for(var e=e.q,d=0;d<e.length;d++){var g=e[d].B;g&&(a+=g.sk)}}return a};a.XO=function(){var a=l.p(),a=[l.ea(a,"MAIN_OPAQUE"),l.ea(a,"MAIN_BLEND")];return a[0].q.length+a[1].q.length};
a.ZO=function(){return D.Zd(C.Ev())};a.lN=function(){for(var a=l.p(),b=l.Jp(a),a={},c=0;c<b.length;c++){var e=b[c];if("SINK"!=e.type&&"WIREFRAME"!=e.type)for(var d=e.q,g=0;g<d.length;g++){var h=d[g].B,m=d[g].Dd;h&&("COLOR_PICKING"!=e.type&&"OUTLINE_MASK"!=e.type||m.Km||m.Jm)&&(a[h.id]=h)}}var d=e=c=b=0,q;for(q in a)h=a[q],h=h.ja,h.Wl&&(e++,d+=h.Wl/1048576),b++,c+=h.Qu/1048576;return{vbo_number:b,vbo_memory:c,ibo_number:e,ibo_memory:d}};a.$O=function(){for(var a=[],b=0,c=l.p(),c=[l.ea(c,"MAIN_OPAQUE"),
l.ea(c,"MAIN_BLEND")],e=0;e<c.length;e++){var d=c[e];if(d)for(var d=d.q,g=0;g<d.length;g++){var h=d[g].B;if(h)for(var h=h.X,m=0;m<h.length;m++){var q=h[m];if("IMAGE"===q.source||"ENVIRONMENT_MAP"===q.source){var u=q.ib;-1===a.indexOf(u)&&(a.push(u),q=q.width*q.height*4/1048576/q.Ro,q*=1.3333,b+=q)}}}}return{number:a.length,memory:b}};a.YO=function(){for(var a=[],b=0,c=l.p(),c=l.Jp(c),e=0;e<c.length;e++){var d=c[e];if("SINK"!=d.type){var g=d.j,h=[g.tb,g.qd];h.push.apply(h,d.le);for(d=0;d<h.length;d++){var m=
h[d];G.nk(m)&&-1==a.indexOf(m)&&(a.push(m),b+=g.width*g.height*G.yF(m))}}}return{number:a.length,memory:b/1024/1024}};a.pG=function(){var a=l.p();(a=l.ea(a,"MAIN_OPAQUE"))&&l.ex(a.j,a,[1,1,0])};a.sG=function(){var a=l.p(),b=l.ea(a,"MAIN_OPAQUE"),a=l.GI(a,["SHADOW_CAST"]);if(b)for(var c=0;c<a.length;c++){var e=a[c],d;switch(c){case 0:d=[1,0,0];break;case 1:d=[0,1,0];break;case 2:d=[0,0,1];break;default:d=[1,0,1]}l.ex(e.j,b,d)}};a.AP=function(){for(var a=l.ck(),b=0;b<a.length;b++)g.log("\n"+z.QD(l.Pp(a[b])))};
a.BP=function(){};a.vM=m.debug;a.aP=function(a,b){return H.dist(a.e.h,b.e.h)};a.kx=q.kx;a.am=q.am;a.Sx=q.Sx;a.Wq=q.Wq;a.WM=function(a,b){function c(){q.am("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.JL=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),e=new Float32Array([0,1,0]),d=new Float32Array([0,0,1]),g=new Float32Array([-1,0,0]),h=new Float32Array([0,-1,0]),l=new Float32Array([0,0,-1]);if(!D.Bf(a,D.wB))throw"Wrong VEC3_IDENT";if(!D.Bf(b,D.qB))throw"Wrong QUAT4_IDENT";
if(!D.Bf(c,D.tf))throw"Wrong AXIS_X";if(!D.Bf(e,D.jb))throw"Wrong AXIS_Y";if(!D.Bf(d,D.te))throw"Wrong AXIS_Z";if(!D.Bf(g,D.Pn))throw"Wrong AXIS_MX";if(!D.Bf(h,D.Wb))throw"Wrong AXIS_MY";if(!D.Bf(l,D.sg))throw"Wrong AXIS_MZ";};a.WO=function(){for(var a=F.fk(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==F.Up(c)&&F.rk(c,!0)}};a.du=function(a){q.du(a)};a.JP=function(a){var b=l.p();if(b=l.ea(b,"WIREFRAME"))"string"==typeof a.wireframe_mode&&l.aI(b,a.wireframe_mode),"object"==typeof a.wireframe_edge_color&&
l.$H(b,a.wireframe_edge_color);else throw"Wireframe subscene not found.";};a.yN=function(){return g.hF()};a.hO=function(){return g.CF()};a.mu=function(){return g.mu()};a.pL=function(a){var h=C.Ev(),l=0,k;for(k in h)a&&-1===k.indexOf(a)||l++;var l="of "+l+" analyzing...",d={};for(k in h)if(!a||-1!==k.indexOf(a)){var m=h[k],q;var w=m.ss;q=m.pv;var z=u.Gv();if(z){w=z.getTranslatedShaderSource(w);q=z.getTranslatedShaderSource(q);var z=c("/nvidia_vert",w),y=e(z),D=c("/nvidia_frag",q),F=e(D);q={JJ:w,RQ:z,
KJ:y,FE:q,cN:D,Gp:F}}else g.error("WEBGL_debug_shaders not found (run Chrome with --enable-privileged-webgl-extensions)"),q=void 0;z=m.Ob;w=z.$k+" + "+z.Yj;q.MD=m;q.Ob=z;m=d[w]=d[w]||[];m.push(q);g.log(l)}for(w in d)g.group("%c"+w,"color: #800"),m=d[w],b(m),g.groupEnd()}};b4w.module.main=function(a,y){function e(){}function c(){}function b(){}function h(){window.performance||(H.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(H.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});L.My(0)}function m(a,b){a.addEventListener("webglcontextlost",function(a){a.preventDefault();H.error("WebGL context lost");u()},!1);d.Id(b);var e=d.aw();e&&H.log("%cRENDERER INFO:","color: #00a",
b.getParameter(e.UNMASKED_VENDOR_WEBGL)+", "+b.getParameter(e.UNMASKED_RENDERER_WEBGL));K.Id(b);n.Id(b);t.Id(b);p.Id(b);k.Id(b);r.bI(a);x.$b(a);J.Qy(a.width,a.height,1);f.$b();c=z();g()}function q(){e=function(){}}function u(){w()||(oa=performance.now()/1E3,f.pause(),M.pause(),t.pause(),C.pause())}function w(){return ea<oa}function g(){O(g);var a=performance.now()/1E3;R||(R=a);var b=a-R;if(!(b<1/ia.Cd)){for(var d=L.Jf(),e=0;e<ba.length;e++)ba[e](d,b);w()||(ea>R&&(b-=ea-Math.max(oa,R)),d+=b,L.My(d),
k.update(),E.update(),r.update(),l(d,b),c(b));R=a}}function l(a,b){r.Ue()&&(B.reset(),N.update(b),I.update(a,b),f.update(a,b),b&&F.update(b),r.Ue()&&(M.update(a,b),r.Ue()&&(e(b,a),r.Ue()&&(A.update(a,b),r.Ue()&&(C.update(),J.update(a,b),C.qJ(),V&&(V(U.toDataURL()),V=null))))))}function z(){var a=60,c=0,d=ia.lv,e=ia.zE;return function(f){f<1/ia.Cd||(a=T.fc(1/f,a,f,d),f=M.kF(),c=(c+1)%e,0==c&&b(Math.round(a),f))}}var C=y("__anchors"),F=y("__animation"),G=y("__compat"),D=y("__config"),H=y("__print"),
x=y("__container"),A=y("__controls"),r=y("__data"),k=y("__debug"),d=y("__extensions"),n=y("__geometry"),B=y("__hud"),I=y("__nla"),E=y("__assets"),M=y("__physics"),K=y("__renderer"),J=y("__scenes"),f=y("__sfx"),p=y("__shaders"),t=y("__textures"),L=y("__time"),N=y("__transform"),T=y("__util"),Q=y("__version"),X=D.context,ia=D.r,U=null,ha=null,R=0,oa=0,ea=0,ba=[],V=null,aa=["webgl","experimental-webgl"],Y=null,O=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||
window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/ia.Cd)}}();a.$b=function(a,b){D.RH();H.YH(ia.console_verbose);var c=Q.Zk()+" "+Q.type()+" ("+Q.fp()+")";H.log("%cINIT ENGINE","color: #00a",c);if(!window.WebGLRenderingContext)return null;h();U=a;G.ZB();for(var c=null,d=0;d<aa.length;d++){var e=aa[d];try{c=a.getContext(e,X)}catch(f){}if(c)break}c&&G.aE(c);if(!c)return null;Y=c;m(U,c);D.bC();G.NH(c);p.lG();ia.hq&&(a.style["touch-action"]="none");
H.log("%cSET PRECISION:","color: #00a",ia.precision);b?(B.$b(b),ha=b):(D.r.show_hud_debug_info=!1,D.Jd.Em=!1);return c};a.tr=function(a){k.tr(a)};a.resize=function(a,b,c){!1!==c&&(U.style.width=a+"px",U.style.height=b+"px",ha&&(ha.style.width=a+"px",ha.style.height=b+"px"));ha&&(ha.width=a,ha.height=b,B.jj());if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))ia.canvas_resolution_factor=1;c=Math.floor(a*ia.canvas_resolution_factor);b=Math.floor(b*
ia.canvas_resolution_factor);ia.allow_hidpi&&1<window.devicePixelRatio&&(c*=window.devicePixelRatio,b*=window.devicePixelRatio);U.width=c;U.height=b;if(c>Y.drawingBufferWidth||b>Y.drawingBufferHeight){H.warn("Canvas size exceeds platform limits, downscaling");var d=Math.min(Y.drawingBufferWidth/c,Y.drawingBufferHeight/b);c*=d;b*=d;U.width=c;U.height=b}J.Qy(c,b,c/a);J.pa()&&N.w(J.p().camera);l(L.Jf(),0);r.hJ(U.width,U.height)};a.LH=function(a){b=a};a.nM=function(){b=function(){}};a.SH=function(a){e=
a};a.rM=function(){q()};a.iO=function(){return L.Jf()};a.oP=function(){H.error("redraw() deprecated");l(L.Jf(),0)};a.pause=u;a.Fd=function(){w()&&(ea=performance.now()/1E3,f.Fd(),M.Fd(),t.play(!0),C.Fd())};a.ym=w;a.reset=function(){r.Cn(0);ha=U=null;ea=oa=R=0;b=function(){};c=function(){};e=function(){};ba.length=0;Y=null;L.reset()};a.XL=function(a){V=a};a.sN=function(){return U};a.Uu=function(){return G.Uu()};a.yl=function(a){for(var b=0;b<ba.length;b++)if(ba[b]==a)return;ba.push(a)};a.jH=function(a){for(var b=
0;b<ba.length;b++)if(ba[b]==a){ba.splice(b,1);break}}};b4w.module.physics=function(a,y){var e=y("__physics"),c=y("__print"),b=y("__util");a.Wz=0;a.SJ=1;a.RJ=2;a.Fs=3;a.$u=function(a){e.C(a)?e.$u(a):c.error("No physics for object "+a.name)};a.mp=function(a){e.C(a)?e.mp(a):c.error("No physics for object "+a.name)};a.C=function(a){return e.C(a)};a.dq=function(a){return e.dq(a)};a.yw=function(a){return e.yw(a)};a.Fy=function(a,b){e.C(a)?e.Fy(a,b):c.error("No physics for object "+a.name)};a.IP=function(a,b,q){e.C(a)?e.v("set_damping",a.n.I,b,q):c.error("No physics for object "+
a.name)};a.sP=function(a){if(e.C(a)){var b=a.game;e.v("set_damping",a.n.I,b.damping,b.rotation_damping)}else c.error("No physics for object "+a.name)};a.mn=function(a,b,q){e.C(a)?e.mn.apply(this,arguments):c.error("No physics for object "+a.name)};a.P=function(a){e.C(a)?e.P(a):c.error("No physics for object "+a.name)};a.Bt=function(a){e.C(a)?e.Bt.apply(this,arguments):c.error("No physics for object "+a.name)};a.Ct=function(a){e.C(a)?e.Ct.apply(this,arguments):c.error("No physics for object "+a.name)};
a.wt=function(a,b,q,u){e.C(a)?e.wt.apply(this,arguments):c.error("No physics for object "+a.name)};a.At=function(a,b,q,u){e.C(a)?e.At.apply(this,arguments):c.error("No physics for object "+a.name)};a.mj=function(a,m){e.C(a)?(e.xc(a)||e.yc(a)||c.error("Wrong object"),e.mj(a,b.qa(m,-1,1))):c.error("No physics for object "+a.name)};a.PQ=function(a,m,q){if(e.C(a)){e.xc(a)||e.yc(a)||c.error("Wrong object");m=b.qa(m,0,1);var u=a.l.li;-1==q||1==q?u=Math.max(-1,Math.min(u+q*m,1)):0==q&&0<=u?(u-=m,u=Math.max(0,
u)):0==q&&0>u?(u+=m,u=Math.min(0,u)):c.error("Wrong steering direction");e.mj(a,b.qa(u,-1,1))}else c.error("No physics for object "+a.name)};a.lj=function(a,m){e.C(a)?(e.xc(a)||e.yc(a)||c.error("Wrong object"),e.lj(a,b.qa(m,-1,1))):c.error("No physics for object "+a.name)};a.OQ=function(a,m,q){if(e.C(a)){e.xc(a)||e.yc(a)||c.error("Wrong object");m=b.qa(m,0,1);var u=a.l.$i;-1==q||1==q?u=Math.max(-1,Math.min(u+q*m,1)):0==q&&0<=u?(u-=m,u=Math.max(0,u)):0==q&&0>u?(u+=m,u=Math.min(0,u)):c.error("Wrong steering direction");
e.lj(a,b.qa(u,-1,1))}else c.error("No physics for object "+a.name)};a.ns=function(a,m){e.C(a)?(e.xc(a)||e.yc(a)||c.error("Wrong object"),e.ns(a,b.qa(m,0,1))):c.error("No physics for object "+a.name)};a.NQ=function(a,m){if(e.C(a)){e.xc(a)||e.yc(a)||c.error("Wrong object");m=b.qa(m,-1,1);var q=a.l.Bj;e.ns(a,b.qa(q+q*m,0,1))}else c.error("No physics for object "+a.name)};a.xc=function(a){return e.xc(a)};a.yc=function(a){return e.yc(a)};a.cO=function(a){if(!e.C(a))return c.error("No physics for object "+
a.name),null;if(e.xc(a)||e.yc(a))return a.b4w_vehicle_settings.name;c.error("Wrong object");return null};a.eO=function(a){if(!e.C(a))return c.error("No physics for object "+a.name),null;if(e.xc(a)||e.yc(a))return a.l.li;c.error("Wrong object")};a.dO=function(a){if(!e.C(a))return c.error("No physics for object "+a.name),null;if(e.xc(a)||e.yc(a))return a.l.$i;c.error("Wrong object")};a.bO=function(a){if(!e.C(a))return c.error("No physics for object "+a.name),null;if(e.xc(a)||e.yc(a))return a.l.Bj;c.error("Wrong object")};
a.kw=function(a){if(!e.C(a))return c.error("No physics for object "+a.name),null;if(e.xc(a)||e.yc(a))return e.kw(a);c.error("Wrong object")};a.jk=function(a){return e.jk(a)};a.sr=function(a,b,q){e.C(a)?e.sr(a,b,q):c.error("No physics for object "+a.name)};a.gn=function(a,b){e.C(a)?e.gn(a,b):c.error("No physics for object "+a.name)};a.wy=function(a,b){e.C(a)?e.wy(a,b):c.error("No physics for object "+a.name)};a.vy=function(a,b){e.C(a)?e.vy(a,b):c.error("No physics for object "+a.name)};a.sy=function(a,
b){e.C(a)?e.sy(a,b):c.error("No physics for object "+a.name)};a.$t=function(a){e.C(a)?e.$t(a):c.error("No physics for object "+a.name)};a.au=function(a,b,q){e.C(a)?e.au(a,b,q):c.error("No physics for object "+a.name)};a.IH=function(a,b){e.C(a)?e.IH(a,b):c.error("No physics for object "+a.name)};a.hn=function(a,b,q){e.C(a)?e.hn(a,b,q):c.error("No physics for object "+a.name)};a.uy=function(a,b){e.C(a)?e.uy(a,b):c.error("No physics for object "+a.name)};a.ty=function(a,b){e.C(a)?e.ty(a,b):c.error("No physics for object "+
a.name)};a.jo=function(a,b,q,u){e.C(a)?e.jo(a,b,q,u||!1):c.error("No physics for object "+a.name)};a.mr=function(a,b,q){e.C(a)?e.mr(a,b||"ANY",q):c.error("No physics for object "+a.name)};a.lo=function(a,b){e.C(a)?e.lo(a,b):c.error("No physics for object "+a.name)};a.Ko=function(a){e.C(a)?e.Ko(a):c.error("No physics for object "+a.name)};a.Al=function(a,b,c,u,w,g){return e.Al(a,b,c,u,w,g||!1,!1,!1,!1)};a.tL=function(a,b,c,u,w,g,l,z,y){return e.Al(a,b,c,u,w,g||!1,l||!1,z||!1,y||!1)};a.nr=function(a){e.Pw(a)?
e.nr(a):c.error("Wrong ray test ID")};a.Zt=function(a,b,q){e.Pw(a)?e.Zt(a,b,q):c.error("Wrong ray test ID")};a.vt=function(a,b,q,u,w,g,l,z,y,F){e.C(b)&&e.C(w)?e.vt(a,b,q,u,w,g,l,z,y,F):c.error("Wrong objects")};a.lu=function(a){e.C(a)&&e.IF(a)?e.lu(a):c.error("Wrong object")};a.Vx=function(a,b,q,u,w,g){e.C(a)&&e.C(u)?e.Vx(a,b,q,u,w,g):c.error("Wrong objects")}};b4w.module.scenes=function(a,y){var e=y("__batch"),c=y("__camera"),b=y("__graph"),h=y("__objects"),m=y("__print"),q=y("__physics"),u=y("__scenes"),w=y("__util");a.L=u.L;a.rr=function(a){var b=u.ck();u.rr(w.vb("name",a,b))};a.p=function(){return u.pa()?u.p().name:""};a.TN=function(){for(var a=u.ck(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.oi=function(){if(u.pa())return u.fm(u.p());m.error("No active scene");return!1};a.JN=function(a,b){var c=u.$d(u.tg,a,b|0);if(c)return c;m.error("get object "+
a+": not found")};a.HN=function(a,b,c){if(a=u.$d(u.Tn,a,b,c|0))return a;m.error("get object "+b+": not found")};a.IN=function(a,b){var c=u.$d(u.Un,a,b|0);if(c)return c;m.error("get object "+a+": not found")};a.Xv=function(a){return u.Xv(a)};a.Um=u.Um;a.gP=function(a){return a&&a.e&&a.e.Vb};a.QH=function(a,b){a&&a.e&&a.e.Vb?a.e.ee=b:m.error("set_outline_intensity(): wrong object")};a.sF=function(a){a&&a.e&&a.e.Vb||m.error("get_outline_intensity(): wrong object")};a.Wh=function(a,b,c,e){a&&a.e&&a.e.Vb?
u.Wh(a,b,c,e):m.error("apply_outline_anim(): wrong object")};a.aC=function(a){if(a&&a.e&&a.e.Vb){var b=a.e.uk;u.Wh(a,b.Lm,b.Mm,b.Nm)}else m.error("apply_outline_anim_def(): wrong object")};a.Dj=function(a){a&&a.e&&a.e.Vb?u.Dj(a):m.error("clear_outline_anim(): wrong object")};a.ur=u.ur;a.rF=function(a){var b=u.p();if(b=u.ea(b,"OUTLINE"))a=a||new Float32Array(3),a.set(b.Wf)};a.PP=function(b,c){m.error("set_glow_intensity() deprecated, use set_outline_intensity() instead");a.QH(b,c)};a.EN=function(b){m.error("get_glow_intensity() deprecated, use get_outline_intensity() instead");
a.sF(b)};a.BL=function(b,c,e,h){m.error("apply_glow_anim() deprecated, use apply_outline_anim() instead");a.Wh(b,c,e,h)};a.CL=function(b){m.error("apply_glow_anim_def() deprecated, use apply_outline_anim_def() instead");a.aC(b)};a.oM=function(b){m.error("clear_glow_anim() deprecated, use clear_outline_anim() instead");a.Dj(b)};a.OP=function(b){m.error("set_glow_color() deprecated, use set_outline_color() instead");a.ur(b)};a.DN=function(b){m.error("get_glow_color() deprecated, use get_outline_color() instead");
a.rF(b)};a.UN=function(){if(!u.pa())return m.error("No active scene"),!1;var a=u.p(),b=u.ea(a,"SHADOW_CAST");if(!b)return null;var c=a.e.hf,e=u.ea(a,"MAIN_OPAQUE"),h=u.ea(a,"DEPTH"),q={};q.csm_resolution=c.csm_resolution;q.self_shadow_polygon_offset=b.self_shadow_polygon_offset;h&&(q.self_shadow_normal_offset=h.self_shadow_normal_offset);q.enable_csm=c.enable_csm;q.csm_num=c.csm_num;q.csm_first_cascade_border=c.csm_first_cascade_border;q.first_cascade_blur_radius=c.first_cascade_blur_radius;q.csm_last_cascade_border=
c.csm_last_cascade_border;q.last_cascade_blur_radius=c.last_cascade_blur_radius;q.fade_last_cascade=c.fade_last_cascade;q.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(q.csm_borders=u.dF(a,e.j),q.blur_radii=new Float32Array(c.csm_num),q.blur_radii.set(e.j.Tm.subarray(0,c.csm_num))):(q.csm_borders=null,q.blur_radii=null);return q};a.kQ=function(a){if(!u.pa())return m.error("No active scene"),!1;var h=u.p();"number"==typeof a.self_shadow_polygon_offset&&b.V(h.e.ub,function(b,c){"SHADOW_CAST"===
c.type&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var q=u.ea(h,"DEPTH");q&&("number"==typeof a.self_shadow_normal_offset&&(q.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(q.pcf_blur_radius=a.pcf_blur_radius));var w=u.ea(h,"MAIN_BLEND");w&&("number"==typeof a.self_shadow_normal_offset&&(w.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(w.pcf_blur_radius=a.pcf_blur_radius),w.ua=!0);w=h.e.hf;
"number"==typeof a.csm_first_cascade_border&&(w.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(w.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(w.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(w.last_cascade_blur_radius=a.last_cascade_blur_radius);if(q){for(var y=q.q,G=0;G<y.length;G++){var D=y[G];D.Dd.Gc&&(D=D.B,e.Dt(D,w),e.Qb(D))}q.ua=!0}q=h.camera.e.J;
for(G=0;G<q.length;G++)c.hs(q[G],w);u.qr(h)};a.Kv=function(){if(!u.pa())return m.error("No active scene"),!1;var a=u.p();return u.Kv(a)};a.Ay=function(a,b,c){if(!u.pa())return m.error("No active scene"),!1;var e=u.p();u.Ay(e,parseFloat(a),b,c)};a.Qv=function(a){if(!u.pa())return m.error("No active scene"),!1;var b=u.p();return u.Qv(b,a)};a.Cy=function(a){if(!u.pa())return m.error("No active scene"),!1;var b=u.p();u.Cy(b,a)};a.hw=function(){if(!u.pa())return m.error("No active scene"),!1;var a=u.p();
return u.hw(a)};a.Ky=function(a){if(!u.pa())return m.error("No active scene"),!1;var b=u.p();u.Ky(b,a)};a.tN=function(){if(!u.pa())return m.error("No active scene"),null;var a=u.p(),a=u.ea(a,"COMPOSITING");if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.EP=function(a){if(!u.pa())return m.error("No active scene"),null;var b=u.p(),b=u.ea(b,"COMPOSITING");if(!b)return null;"number"==typeof a.brightness&&(b.brightness=
a.brightness);"number"==typeof a.contrast&&(b.contrast=a.contrast);"number"==typeof a.exposure&&(b.exposure=a.exposure);"number"==typeof a.saturation&&(b.saturation=a.saturation);b.ua=!0};a.fw=function(){if(!u.pa())return m.error("No active scene"),!1;var a=u.p();return u.fw(a)};a.Iy=function(a){if(!u.pa())return m.error("No active scene"),!1;var b=u.p();u.Iy(b,a)};a.Hv=function(){if(!u.pa())return m.error("No active scene"),!1;var a=u.p();return u.ea(a,"DOF")?u.Hv(a):null};a.zy=function(a){if(!u.pa())return m.error("No active scene"),
!1;var b=u.p();u.zy(b,a)};a.Tv=function(){if(!u.pa())return m.error("No active scene"),!1;var a=u.p();return u.ea(a,"GOD_RAYS")?u.Tv(a):null};a.Ey=function(a){if(!u.pa())return m.error("No active scene"),!1;var b=u.p();u.Ey(b,a)};a.Bv=function(){if(!u.pa())return m.error("No active scene"),!1;var a=u.p();return u.ea(a,"BLOOM")?u.Bv(a):null};a.qy=function(a){if(!u.pa())return m.error("No active scene"),!1;var b=u.p();u.qy(b,a)};a.Sv=function(){if(!u.pa())return m.error("No active scene"),!1;var a=
u.p();return u.ea(a,"GLOW_COMBINE")?u.Sv(a):null};a.Dy=function(a){if(!u.pa())return m.error("No active scene"),!1;var b=u.p();u.Dy(b,a)};a.pw=function(){return u.pw()};a.Py=function(a){if(!u.pa())return m.error("No active scene"),!1;var b=u.p();u.Py(b,a)};a.nw=u.nw;a.Oy=function(a){if(!u.pa())return m.error("No active scene"),!1;var b=u.p();u.Oy(b,a)};a.mw=function(a){if(!u.pa())return m.error("No active scene"),!1;var b=u.p();u.mw(b,a)};a.MQ=function(){if(!u.pa())return m.error("No active scene"),
!1;var a=u.p();u.Ez(a)};a.ik=function(a){h.nq(a)||w.vm(a)?u.ik(a):m.error("show/hide is only supported for dynamic meshes/empties")};a.Ar=function(a){h.nq(a)||w.vm(a)?u.Ar(a):m.error("show/hide is only supported for dynamic meshes/empties")};a.oq=function(a){if(h.nq(a)||w.vm(a))return u.oq(a);m.error("show/hide is only supported for dynamic meshes/empties");return!1};a.zm=function(a){return a.e.zm};a.fu=function(a){return u.pa()?u.fu(a,u.p()):(m.error("No active scene"),!1)};a.gM=function(a,b){return u.$d(u.tg,
a,b|0)?!0:!1};a.eM=function(a,b,c){return u.$d(u.Tn,a,b,c|0)?!0:!1};a.fM=function(a,b){return u.$d(u.Un,a,b|0)?!0:!1};a.nN=function(a,b){var c=u.p();a||(a="ALL");b||0===b||(b=u.L);return u.Ab(c,a,b)};a.MN=function(a){return a?a.name:(m.error("Wrong object name"),"")};a.NN=function(a){return a&&a.type?a.type:(m.error("Wrong object"),"UNDEFINED")};a.LN=function(a){return a.Fa};a.KN=function(a){return a.nd.slice(0)};a.Ov=function(){for(var a=u.Ab(u.p(),"MESH",u.L),b=0;b<a.length;b++){var c=a[b];if(q.jk(c))return c}return null};
a.dw=function(a,b){b||0===b||(b=1);return u.dw(a,b)};a.Cv=function(){return u.Cv()};a.$N=function(a){return"MESH"==a.type?a.e.type:null};a.ek=function(){if(!u.pa())return m.error("No active scene"),!1;var a=u.p();return u.ek(a)};a.yf=function(a){if(!a.e.mq)return m.error('object "'+a.name+'" has been created not by coping.'),!1;var b=a.name;if(u.$d(u.tg,a.name,0))for(var c=1;;){b=a.name+(3>String(c).length?"."+("000"+String(c)).slice(-3):"."+String(c));if(!u.$d(u.tg,b,0)){a.name=b;m.error('object "'+
a.name+'" already exists. Name was replaced by "'+b+'".');break}c++}u.yf(u.p(),a,!0)};a.hy=function(a){u.hy(a)||m.error('object "'+a.name+'" was not copied.')};a.gx=function(a){var b=u.p();if(b.timeline_markers&&a in b.timeline_markers)return u.gx(b,a);m.error('"'+a+'" marker not found.');return 0};a.GN=function(){var a=u.p();return(a=u.ea(a,"MOTION_BLUR"))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.$P=function(a){var b=u.p();(b=u.ea(b,"MOTION_BLUR"))?("number"==typeof a.mb_decay_threshold&&
(b.mb_decay_threshold=a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):m.error("The motion blur subscene doesn't exist.")}};b4w.module.transform=function(a,y){var e=y("__print"),c=y("__physics"),b=y("__transform"),h=y("__util"),m=y("__objects"),q=new Float32Array(3),u=new Float32Array(4);a.ol=b.ol;a.pl=b.pl;a.Hd=function(a,g,h,u){m.Sc(a)?(q[0]=g,q[1]=h,q[2]=u,b.Hd(a,q),b.w(a),c.P(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.xr=function(a,g){m.Sc(a)?(b.Hd(a,g),b.w(a),c.P(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.nQ=function(a,g,l,u,y){m.Sc(a)?(q[0]=g,q[1]=l,q[2]=u,h.Fh(q,1,y.e.quat,y.e.h,
q),b.Hd(a,q),b.w(a),c.P(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.be=function(a,c){c||(c=new Float32Array(3));b.be(a,c);return c};a.gf=function(a,g,h,q,y){m.Sc(a)?(u[0]=g,u[1]=h,u[2]=q,u[3]=y,b.gf(a,u),b.w(a),c.P(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.iQ=function(){e.error("set_rotation_quat() deprecated, use set_rotation() instead");return a.gf};a.TH=function(a,g){m.Sc(a)?(b.gf(a,g),b.w(a),c.P(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.jQ=
function(){e.error("set_rotation_quat_v() deprecated, use set_rotation_v() instead");return a.TH};a.If=function(a,c){c||(c=new Float32Array(4));b.If(a,c);return c};a.RN=function(){e.error("get_rotation_quat() deprecated, use get_rotation() instead");return a.If};a.vr=function(a,g,h,u){m.Sc(a)?(q[0]=g,q[1]=h,q[2]=u,b.vr(a,q),b.w(a),c.P(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.hQ=function(a,g){m.Sc(a)?(b.vr(a,g),b.w(a),c.P(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.ge=function(a,c){m.Sc(a)?(b.ge(a,c),b.w(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Vg=function(a){return b.Vg(a)};a.NM=function(a){if("EMPTY"!=a.type)return e.error("Wrong object: "+a.name),!1;for(var g=0;g<a.nd.length;g++)if(!m.Sc(a.nd[g])){e.error('Wrong object: "'+a.nd[g].name+'" is not dynamic.');return}b.Hd(a,[0,0,0]);b.gf(a,[0,0,0,1]);b.ge(a,1);b.w(a);c.P(a)};a.Rp=function(a){return h.ac(a)?b.Rp(a):(e.error("Wrong object: "+a.name),0)};a.jm=function(a,c,l){return h.ac(a)?
b.jm(a,c,l):(e.error("Wrong object: "+a.name),null)};a.Uc=function(a,g,h,q){m.Sc(a)?(b.Uc(a,g,h,q),b.w(a),c.P(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Wv=function(a){return b.Wv(a)};a.gk=function(a,c){c||(c=new Float32Array(8));if(m.Sc(a))return b.gk(a,c),c;e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Pk=function(a,g){m.Sc(a)?(b.Pk(a,g),b.w(a),c.P(a)):e.error('Wrong object: "'+a.name+'" is not dynamic.')};a.distance=function(a,c){return b.distance(a,c)}};b4w.module.util=function(a,y){var e=y("__print"),c=y("__util"),b=y("vec3");y("mat4");a.tf=new Float32Array([1,0,0]);a.jb=new Float32Array([0,1,0]);a.te=new Float32Array([0,0,1]);a.Pn=new Float32Array([-1,0,0]);a.Wb=new Float32Array([0,-1,0]);a.sg=new Float32Array([0,0,-1]);a.UM=function(a){return new Float32Array(a||0)};a.assert=c.assert;a.Xw=c.Xw;a.vb=c.vb;a.Sf=function(a){return c.Sf(a)};a.Gf=function(a,b){b||(b=new Float32Array(4));return c.Gf(a,b)};a.Yx=function(a,b){b||(b=new Float32Array(3));
return c.Yx(a,b)};a.sign=c.sign;a.qa=c.qa;a.va=c.va;a.jO=function(a,b){return c.cr(a,c.Wb,c.jb,c.sg,b)};a.Fo=function(a,b){return c.Fo(a,b)};a.cr=function(a,m,q,u,w){return 0!=b.dot(q,u)?(e.error("Wrong in-plane direction"),null):c.cr(a,m,q,u,w)};a.Bw=c.Bw;a.fc=c.fc;a.Ui=c.Ui;a.We=c.We;a.So=c.So;a.Xx=c.Xx;a.$x=c.$x;a.Uz=c.Uz;a.yq=c.yq;a.ac=c.ac;a.Se=c.Se;a.Qd=c.Qd;a.ye=c.ye;a.Fr=c.Fr;a.lerp=c.lerp};b4w.module.camera_anim=function(a,y){function e(a,b,c,d){b=g.Qd(a-b);a=g.Qd(c-a);if(1E-6>Math.abs(b)||1E-6>2*Math.PI-Math.abs(b))b=0;if(1E-6>Math.abs(a)||1E-6>2*Math.PI-Math.abs(a))a=0;d[0]=b;d[1]=a;return d}var c=y("camera"),b=y("controls"),h=y("print"),m=y("scenes"),q=y("time"),u=y("transform"),w=y("tsr"),g=y("util"),l=y("vec3"),z=y("quat"),C=new Float32Array(2),F=new Float32Array(2),G=new Float32Array(3),D=new Float32Array(3),H=new Float32Array(3),x=new Float32Array(4),A=new Float32Array(2),r=
new Float32Array(2),k=new Float32Array(8),d=new Float32Array(8),n=new Float32Array(8),B=!1,I=!1;a.CQ=function(a,d,e,k,f,m,n,q){if(!c.Tc(a))h.error("track_to_target(): wrong object");else if(a&&d){if(g.We(d))var r=d;else r=H,u.jm(d,!1,r);d=e||1;e=k||2;var w=f||1;f=m||1;D[0]=0;D[1]=-1;D[2]=0;var y=u.If(a);m=g.va(y,D);k=c.Ad(a,C);var A=u.be(a);l.subtract(r,A,G);l.normalize(G,G);var B=z.rotationTo(m,G,z.create());z.multiply(B,y,x);g.So(x,!1);l.subtract(r,A,D);var F=l.length(D)*(1-1/e),r=Math.asin(G[1]);
e=Math.acos(-G[2]/Math.abs(Math.cos(r)));0<G[0]&&(e=2*Math.PI-e);var I=e-k[0],R=r-k[1];H[0]=0;H[1]=0;H[2]=-1;e=u.If(a);0>g.va(e,H)[1]?(R=0<m[1]?r-Math.PI+k[1]:r+Math.PI+k[1],I=0<I?-Math.PI+I:Math.PI+I):Math.abs(I)>Math.PI&&(I=0<I?I-2*Math.PI:I+2*Math.PI);var oa=0,r=b.di();m=Math.abs(I/d);d=Math.abs(R/d);var ea=m>d?m:d,ba=ea+w,V=ba+f,aa=V+w,Y=I,O=R,pa=F,na=function(){b.bf(a,"TRACK_TO_TARGET");n&&n()};b.R(a,"TRACK_TO_TARGET",b.ia,[r],null,function(a,d,e){if(e)if(c.Tc(a))if(e=b.vc(a,d,0),oa+=e,oa<ea){var f=
I/ea*e;e*=R/ea;d=oa/ea;d=6*d*(1-d);f*=d;e*=d;Y-=f;O-=e;c.ad(a,f,e)}else oa<ba?(Y&&(c.ad(a,Y,O),Y=0,q&&q()),d=(oa-ea)/w,e=-F*e/w,pa-=f,u.Uc(a,0,6*e*d*(1-d),0)):oa<V?pa&&(u.Uc(a,0,pa,0),pa=0):oa<aa?(d=(oa-V)/w,e=F*e/w,e=6*e*d*(1-d),u.Uc(a,0,e,0)):(u.xr(a,A),na());else na()})}};a.Jt=function(a){function d(a,h,m){if(1==m)if(m=c.Bd(a),m==c.ld)k();else if(m!=c.Hb&&c.KF(a)){m=c.mF(a,r);if(null===f||m[0]!=f[0]||m[1]!=f[1]){f=f||A;f.set(m);n=Math.min(.2,g.Qd(f[1]-f[0])/2);m=f;var u=c.Ad(l,C)[0];m=e(u,m[0],
m[1],F);q=.3*Math.min(1,m[0]/.2,m[1]/.2)}h=b.vc(a,h,0);m=c.Ad(a,C)[0];m=e(m,f[0],f[1],F);m[1]>n&&m[0]>n?q=.3*g.sign(q):m[1]<n?q-=Math.pow(.3,2)/.4*h:m[0]<n&&(q+=Math.pow(.3,2)/.4*h);c.Oi(a,h*q,0)}else f=null,h=b.vc(a,h,0),c.Oi(a,.3*h,0)}function k(){b.bf(l,"AUTO_ROTATE");b.bf(l,"DISABLE_AUTO_ROTATE");a()}a=a||function(){};var l=m.oi();if(c.Bd(l)==c.ld)h.error("auto_rotate(): wrong camera type");else{var f=null,n=0,q=0;if(b.$h(l,"AUTO_ROTATE"))k();else{var u=b.fi("X"),w=b.fi("Y"),x=b.Ql(),y=b.Ij(),
z=b.Tl(),B=b.di();b.R(l,"DISABLE_AUTO_ROTATE",b.Md,[u,w,x,y,z],function(a){return a[0]&&a[2]||a[1]&&a[2]||a[3]||a[4]},k);b.R(l,"AUTO_ROTATE",b.ia,[B],function(a){return a[0]},d)}}};a.SF=function(){var a=m.oi();return b.$h(a,"AUTO_ROTATE")};a.HC=function(){var a=m.oi();return c.Bd(a)==c.ld?!1:!0};a.VO=function(a,b,e,m,f){if(c.Bd(a)!=c.ld)h.error("move_camera_to_point(): wrong camera type");else if(!B)if(a)if(b){e=e||1;m=m||.01;var p=u.gk(a,k),r=u.gk(b,d);b=l.distance(w.ri(p),w.ri(r))/e;e=g.va(w.qi(p),
g.Wb,G);var x=g.va(w.qi(r),g.Wb,D);e=Math.min(Math.abs(l.dot(e,x)),1);m=1E3*Math.max(b,Math.acos(e)/m);B=!0;q.Sh(0,1,m,function(b){var c=w.lq(p,r,g.Fr(b),n);u.Pk(a,c);1==b&&(B=!1,f&&f())})}else h.error("move_camera_to_point(): you mast specify point object");else h.error("move_camera_to_point(): you mast specify camera object")};a.Oi=function(a,b,d,e,f){if(!I)if(a)if(b||d){I=!0;var g=0,k=0,l=0!=b?b:d;q.Sh(0,l,e||1E3,function(e){g-=e;k-=e;d&&b?c.Oi(a,g,k):d?c.Oi(a,0,k):b&&c.Oi(a,g,0);k=g=e;e==l&&(I=
!1,f&&f())})}else h.error("rotate_camera(): you mast specify rotation angle");else h.error("rotate_camera(): you mast specify camera object")};a.FO=function(){return B};a.GO=function(){return I}};b4w.module.time=function(a,y){var e=y("__time");a.kn=e.kn;a.ai=e.ai;a.Jf=e.Jf;a.Sh=e.Sh;a.ku=e.ku};b4w.module.tsr=function(a,y){y("__print");var e=y("__tsr");a.create=e.create;a.ov=e.ov;a.copy=e.copy;a.identity=e.identity;a.Cf=e.Cf;a.Bh=e.Bh;a.ln=e.ln;a.ge=e.ge;a.wr=e.wr;a.Ok=e.Ok;a.ri=e.ri;a.Vg=e.Vg;a.qi=e.qi;a.invert=e.invert;a.sz=function(a,b){b||(b=new Float32Array(16));e.sz(a,b);return b};a.cm=e.cm;a.multiply=e.multiply;a.Fh=e.Fh;a.uz=e.uz;a.ij=e.ij;a.zn=e.zn;a.Eh=e.Eh;a.An=e.An;a.translate=e.translate;a.lq=e.lq};b4w.module.sfx=function(a,y){var e=y("__scenes"),c=y("__sfx"),b=y("__print");a.play=function(a,b,e){c.play(a,b,e)};a.Vq=function(a){c.Vq(a)};a.yi=function(a){return c.yi(a)};a.tQ=function(a,e,q,u){b.error("speaker_play() deprecated, use play() or play_def() instead");c.sc(a,e);u&&c.Dk(a,u);c.play(a,0,q)};a.vQ=function(a){b.error("speaker_stop() deprecated, use stop() instead");c.stop(a)};a.stop=function(a){c.stop(a)};a.pause=function(a){c.oI(a)};a.Fd=function(a){c.qI(a)};a.uQ=function(a,e){b.error("speaker_playback_rate() deprecated, use playrate() instead");
c.Dk(a,e)};a.Dk=function(a,b){c.Dk(a,b)};a.Zv=function(a){return c.Zv(a)};a.sc=function(a,b){c.sc(a,b)};a.xi=function(a){return c.xi(a)};a.cx=function(a,b){c.cx(a,b)};a.cz=function(a,b,e){c.cz(a,b,e)};a.lw=function(a){return a&&"object"===typeof a?c.lw(a):c.qF()};a.yr=function(a,b){a&&"object"===typeof a?c.yr(a,b):c.OH(b)};a.rk=function(a,b){a&&"object"===typeof a?c.rk(a,b):c.DG(b)};a.Nw=function(a){return a&&"object"===typeof a?c.Nw(a):c.aG()};a.fk=function(){return c.fk().slice(0)};a.YN=function(){b.error("get_speakers() deprecated, use get_speaker_objects() instead");
return a.fk()};a.bu=c.bu;a.xy=function(a){c.xy(e.p(),a)};a.Fv=function(){return c.Fv(e.p())};a.Xu=function(a,b,e){a&&"object"===typeof a?c.Xu(a,b,e):c.eE(b,e)};a.yz=function(a){a&&"object"===typeof a?c.yz(a):c.VI()};a.xt=c.xt;a.nu=c.nu;a.jp=c.jp;a.kp=c.kp;a.Gy=c.Gy;a.$v=c.$v;a.By=c.By;a.Nv=c.Nv;a.Mv=c.Mv;a.Iv=function(a){if(a&&c.Ve(a))return c.Iv(a);b.error('Object "'+(a?a.name:void 0)+'" is not a valid speaker')}};b4w.module.storage=function(a,y){function e(a){h=a;try{m=window.localStorage}catch(c){b.warn("Applying chrome localStorage bug workaround"),m=null}m||(b.warn("localStorage is not available, initializing temporary storage"),m={})}function c(){return m[h]?JSON.parse(m[h]):{}}var b=y("__print"),h="",m=null;a.$b=e;a.set=function(a,b){var e=c();e[a]=String(b);m[h]=JSON.stringify(e)};a.aa=function(){delete m[h]};a.get=function(a){var b=c();return b[a]?b[a]:""};a.debug=function(){b.log(c())};e("b4w")};"object"==typeof module&&module.tp&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,y){var e=y("__version");a.version=e.version;a.Zk=e.Zk;a.type=e.type;a.Ou=e.Ou;a.fp=e.fp};"object"==typeof module&&module.tp&&b4w.module.version(exports);b4w.register("embed_main",function(a,y){function e(a,b){V=document.querySelector("#circle_container");aa=document.querySelector("#preloader_caption");Y=document.querySelector("#first_stage");O=document.querySelector("#second_stage");pa=document.querySelector("#third_stage");na=document.querySelector("#load_container");ka=document.querySelector("#preloader_container");ca=document.querySelector("#opened_button");Z=document.querySelector("#logo_container");wa=document.querySelector("#buttons_container");
v=document.querySelector("#quality_buttons_container");S=document.querySelector("#help_info_container");fa=document.querySelector("#help_button");if(b){N.pause();var d=document.querySelector("#rel_version");X.Zk()&&(d.innerHTML=X.Zk());d=document.querySelector("#fullscreen_on_button");J.NC()||d.parentElement.removeChild(d);d=Q.get("quality");d&&"CUSTOM"!=d||(d="HIGH",Q.set("quality",d));v.className="control_panel_button";switch(d){case "LOW":v.className="control_panel_button low_mode_button";break;
case "HIGH":v.className="control_panel_button high_mode_button";break;case "ULTRA":v.className="control_panel_button ultra_mode_button"}c();if(d=h())m(d),J.lE(),window.addEventListener("resize",n,!1),n()}else if((d=J.km(!0))&&d.fallback_image){var e=document.createElement("div");e.className="image_wrapper";document.body.appendChild(e);ka.style.display="none";e.style.backgroundImage="url("+d.fallback_image+")"}else if(d&&d.fallback_video){var e=document.createElement("div"),f=document.createElement("video");
e.className="video_wrapper";e.appendChild(f);f.autoplay=!0;for(var g=0;g<d.fallback_video.length;g++){var k=document.createElement("source");k.src=d.fallback_video[g];f.appendChild(k)}document.body.appendChild(e);ka.style.display="none"}else K("Browser could not initialize WebGL")}function c(){window.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1};b();for(var a=0;a<va.length;a++){var c=va[a],d=document.getElementById(c.id);q(d);switch(c.type){case "simple_button":d&&d.addEventListener("mouseup",
c.callback,!1);break;case "menu_button":d&&d.addEventListener("mouseup",function(a){c.callback(a,c)},!1);break;case "trigger_button":(function(a){d&&d.addEventListener("mouseup",function(b){a.callback(b)},!1)})(c)}}}function b(){for(var a=document.querySelectorAll(".control_panel_button a"),b=0;b<a.length;b++){var c=a[b];c.hasAttribute("href")&&(c.href+=document.location.href);q(c.parentNode)}}function h(){var a=p.get("built_in_module_name");if(b4w.module_check(a)){var a=y(a).data.main_file,b=document.getElementById("built_in_scripts");
b.parentElement.removeChild(b);return a}a=J.km();Z.style.display="block";if(a&&a.load)return a=a.load;K("Please specify a scene to load");return null}function m(a){J.ic(Z,"opacity",0,1,300,"","",function(){aa.style.display="block";J.ic(aa,"opacity",0,1,300,"","",function(){N.Fd();L.load(a,B,I,!1)})})}function q(a){a&&(x()?(a.addEventListener("touchstart",function(){a.className+=" hover";k()},!1),a.addEventListener("touchend",function(){a.className=a.className.replace(" hover","");r()},!1)):(a.addEventListener("mouseenter",
function(){a.className+=" hover"},!1),a.addEventListener("mouseout",function(){a.className=a.className.replace(" hover","")},!1)))}function u(a){if(!A()){var b=a?a.target:document.querySelector("#auto_rotate_on_button");f.Jt(function(){b&&z(b)});b&&z(b);N.ym()&&(g(),C())}}function w(a){A()||(f.Jt(),a&&z(a.target))}function g(a){A()||(N.Fd(),a&&z(a.target))}function l(){!F("buttons_container")&&oa&&r();var a=document.querySelector("#fullscreen_on_button")||document.querySelector("#fullscreen_off_button");
a&&z(a)}function z(a){var b=a.id,c;a:{for(c=0;c<va.length;c++)if(va[c].id==a.id){c=va[c];break a}c=null}var d=c.callback;a.id=c.id=c.Lk;c.Lk=b;F(a.id)||(a.className=a.className.replace(" hover",""));c.callback=c.Kk;c.Kk=d}function C(){var a=document.querySelector("#play_button")||document.querySelector("#pause_button");a&&z(a)}function F(a){var b=!1;if(document.querySelectorAll)for(var c=document.querySelectorAll(":hover"),d=0;d<c.length;d++)if(c[d].id==a){b=!0;break}return b}function G(){if(!A()){wa.removeEventListener("mouseleave",
r);wa.removeEventListener("mouseenter",k);document.body.removeEventListener("touchmove",r);d();var a=document.querySelector("#help_button"),b=document.querySelector("#tw_button"),c=function(a){oa=!0;J.ic(a,"marginRight",0,-45,50,"","px");J.ic(a,"opacity",1,0,50,"","",function(){a.nextElementSibling&&"opened_button"!=a.nextElementSibling.id?c(a.nextElementSibling):setTimeout(function(){ha=oa=!1;H()},100)})},e=function(a){R=!0;J.ic(a,"marginBottom",0,-45,50,"","px");J.ic(a,"opacity",1,0,50,"","",function(){a.nextElementSibling&&
"opened_button"!=a.nextElementSibling.id?e(a.nextElementSibling):setTimeout(function(){U=R=!1;H()},100)})};c(a);e(b)}}function D(){k();if(!A())if(ca.removeEventListener("mouseup",D),U||ha)G();else{var a=document.querySelector("#fullscreen_on_button")||document.querySelector("#fullscreen_off_button")||document.querySelector("#quality_buttons_container"),b=document.querySelector("#vk_button"),c=function(a){oa=!0;a.style.marginRight="-45px";"help_button"==a.id&&ba?setTimeout(function(){oa=!1;ha=!0;H()},
100):(a.style.display="block",J.ic(a,"marginRight",-45,0,50,"","px",function(){a.previousElementSibling?c(a.previousElementSibling):setTimeout(function(){oa=!1;ha=!0;H()},100)}),J.ic(a,"opacity",0,1,50,"",""))},d=function(a){R=!0;a.style.marginBottom="-45px";a.style.display="block";J.ic(a,"marginBottom",-45,0,50,"","px",function(){a.previousElementSibling?d(a.previousElementSibling):setTimeout(function(){R=!1;U=!0;H()},100)});J.ic(a,"opacity",0,1,50,"","")};c(a);d(b);wa.addEventListener("mouseleave",
r,!1);wa.addEventListener("mouseenter",k,!1);document.body.addEventListener("touchmove",r,!1)}}function H(){A()||(ca.addEventListener("mouseup",D,!1),(!F("buttons_container")&&(U||ha)||x()&&(U||ha))&&r())}function x(){return!!("ontouchstart"in window&&!isFinite(navigator.vG)||navigator.vG)}function A(){return R||oa}function r(){A()||(k(),ia=setTimeout(G,2E3))}function k(){clearTimeout(ia)}function d(a){if(!A()&&ea){ea=!1;a?(a.stopPropagation(),a=a.target):a=document.querySelectorAll(".active_elem")[0];
v.style.marginRight="0px";for(var b=0,c=v.children;b<c.length;b++)c[b].style.display="none",c[b].style.opacity=0;v.className="control_panel_button "+a.id}}function n(){N.resize(window.innerWidth,window.innerHeight)}function B(a,b){if(b){var c=document.querySelector("#auto_rotate_on_button");f.HC()||c.parentElement.removeChild(c);J.kE();N.SH(E);n();(c=J.km())&&"autorotate"in c&&u();c=t.ek();c.title&&(document.title=c.title)}else K("Could not load the scene")}function I(a){aa.innerHTML=a+"%";33>a?(V.style.display=
"block",Y.style.width=4.7*a+"px",V.style.webkitTransform="rotate("+(3.6*a-503)+"deg)",V.style.transform="rotate("+(3.6*a-503)+"deg)"):66>a?(Y.style.width="142px",O.style.backgroundColor="#000",O.style.marginTop="135px",0<135-4.5*(a-33)&&(O.style.marginTop=135-3.5*(a-33)+"px"),V.style.webkitTransform="rotate("+(3.6*a-503)+"deg)",V.style.transform="rotate("+(3.6*a-503)+"deg)"):100!=a&&(O.style.marginTop="0px",pa.style.backgroundColor="#000",pa.style.height="0px",75<a&&(pa.style.height=.1*a+"px"),V.style.webkitTransform=
"rotate("+(3.6*a-503)+"deg)",V.style.transform="rotate("+(3.6*a-503)+"deg)");100==a&&(T.fk().length||(a=document.querySelector("#sound_on_button"),a.parentElement.removeChild(a)),Y.parentElement.removeChild(Y),O.parentElement.removeChild(O),pa.parentElement.removeChild(pa),V.parentElement.removeChild(V),na.style.backgroundColor="#000",J.ic(aa,"opacity",1,0,300,"","",function(){J.ic(na,"opacity",1,0,300,"","",function(){J.ic(Z,"opacity",1,0,300,"","",function(){J.ic(ka,"opacity",1,0,300,"","",function(){ka.parentElement.removeChild(ka);
D()})});ca.style.display="block";J.ic(ca,"transform",0,1,300,"scale(",")")})}))}function E(){}function M(a){if(p.get("quality")!=a){switch(a){case p.vg:var b="LOW";break;case p.ug:b="HIGH";break;case p.Nh:b="ULTRA"}Q.set("quality",b);setTimeout(function(){window.location.reload()},100)}}function K(a){var b=document.querySelector("#error_name"),c=document.querySelector("#error_info"),d=document.querySelector("#error_container");V.style.display="none";b.innerHTML=a;c.innerHTML="For more info visit <a href=https://www.blend4web.com/troubleshooting>"+
"https://www.blend4web.com/troubleshooting".replace("https://www.","")+"</a>";d.style.display="block";Z.style.opacity=1;Z.style.marginTop="-90px"}var J=y("app"),f=y("camera_anim"),p=y("config"),t=y("scenes"),L=y("data"),N=y("main"),T=y("sfx"),Q=y("storage"),X=y("version"),ia=null,U=!1,ha=!1,R=!1,oa=!1,ea=!1,ba=!1,V,aa,Y,O,pa,na,ka,ca,Z,wa,v,S,fa,va=[{type:"simple_button",id:"opened_button",callback:D},{type:"simple_button",id:"help_button",callback:function(){A()||(S.className=x()?"touch":"",S.style.display=
"block",fa.style.display="none",ba=!0)}},{type:"simple_button",id:"close_help",callback:function(){ba&&(S.style.display="none",fa.style.display="block",ba=!1)}},{type:"trigger_button",id:"fullscreen_on_button",callback:function(){A()||J.rH(l,l)},Lk:"fullscreen_off_button",Kk:function(){A()||J.oE()}},{type:"trigger_button",id:"pause_button",callback:function(a){A()||(N.pause(),a&&z(a.target),f.SF()&&(w(),(a=document.querySelector("#auto_rotate_on_button")||document.querySelector("#auto_rotate_off_button"))&&
z(a)))},Lk:"play_button",Kk:g},{type:"trigger_button",id:"auto_rotate_on_button",callback:u,Lk:"auto_rotate_off_button",Kk:w},{type:"trigger_button",id:"sound_on_button",callback:function(a){A()||(T.rk(null,!0),z(a.target))},Lk:"sound_off_button",Kk:function(a){A()||(T.rk(null,!1),z(a.target))}},{type:"menu_button",id:"quality_buttons_container",callback:function(a,b){if(!A()){ea=!0;v.style.marginRight="-30px";for(var c=b.VC,e=b.UC,f=0;f<c.length;f++){var g=document.getElementById(c[f]);0>v.className.indexOf(c[f])?
g.addEventListener("mouseup",e[f],!1):(g.className="active_elem",g.addEventListener("mouseup",d,!1))}v.className="quality_buttons_container";f=0;for(c=v.children;f<c.length;f++)c[f].style.display="block",c[f].style.opacity=1}},VC:["low_mode_button","high_mode_button","ultra_mode_button"],UC:[function(){M(p.vg)},function(){M(p.ug)},function(){M(p.Nh)}]}];a.$b=function(){p.set("background_color",[.224,.224,.224,1]);var a="DEBUG"==X.type(),b=!1,c=!1,d=!1,f=J.km();f&&"compressed_textures"in f&&!h&&!a&&
(d=c=!0);f&&"show_fps"in f&&(b=!0);f&&f.load?Q.$b("b4w_webplayer:"+f.load):Q.$b("b4w_webplayer:"+window.location.href);f=Q.get("quality");f&&"CUSTOM"!=f||(f="HIGH",Q.set("quality",f));switch(f){case "LOW":var g=p.vg;break;case "HIGH":g=p.ug;break;case "ULTRA":g=p.Nh}p.set("quality",g);var h=b4w.module_check(p.get("built_in_module_name"));J.$b({canvas_container_id:"main_canvas_container",callback:e,gl_debug:a,physics_enabled:!h,show_fps:b,report_init_failure:!1,console_verbose:a,error_purge_elements:["control_panel"],
alpha:!1,key_pause_enabled:!1,fps_elem_id:"fps_container",fps_wrapper_id:"fps_wrapper",assets_dds_available:c,assets_min50_available:d})}});window.addEventListener("load",function(){b4w.require("embed_main").$b()},!1);var zd=["b4w","$","jQuery"],Ad=[],Dd;for(Dd in window)-1!=zd.indexOf(Dd)||Dd in ud||Ad.push(Dd);Ad.length&&console.error("globals detected:",Ad);
