(function(g){var k=function(){var k=65,ya={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!1},K=function(b,c){var h=X(b);h.r=Math.round(1E3*Math.pow(h.r/255,2.2))/1E3;h.g=Math.round(1E3*Math.pow(h.g/255,2.2))/1E3;h.b=Math.round(1E3*Math.pow(h.b/255,2.2))/1E3;g(c).data("colorpicker").fields.eq(1).val(h.r).end().eq(2).val(h.g).end().eq(3).val(h.b).end()},S=function(b,c){g(c).data("colorpicker").fields.eq(4).val(b.h).end().eq(5).val(b.s).end().eq(6).val(b.b).end()},
x=function(b,c){g(c).data("colorpicker").fields.eq(0).val(N(b)).end()},T=function(b,c){g(c).data("colorpicker").selector.css("backgroundColor","#"+N({h:b.h,s:100,b:100}));g(c).data("colorpicker").selectorIndic.css({left:parseInt(150*b.s/100,10),top:parseInt(150*(100-b.b)/100,10)})},r=function(b,c){g(c).data("colorpicker").hue.css("top",parseInt(150-150*b.h/360,10))},ea=function(b,c){g(c).data("colorpicker").currentColor.css("backgroundColor","#"+N(b))},Y=function(b,c){g(c).data("colorpicker").newColor.css("backgroundColor",
"#"+N(b))},Z=function(b){b=b.charCode||b.keyCode||-1;if(b>k&&90>=b||32==b)return!1;!0===g(this).parent().parent().data("colorpicker").livePreview&&O.apply(this)},O=function(b){var c=g(this).parent().parent(),h;if(0<this.parentNode.className.indexOf("_hex")){h=c.data("colorpicker");var u=this.value,A=6-u.length;if(0<A){for(var k=[],U=0;U<A;U++)k.push("0");k.push(u);u=k.join("")}u=P(fa(u));h.color=h=u}else 0<this.parentNode.className.indexOf("_hsb")?c.data("colorpicker").color=h=ga({h:parseInt(c.data("colorpicker").fields.eq(4).val(),
10),s:parseInt(c.data("colorpicker").fields.eq(5).val(),10),b:parseInt(c.data("colorpicker").fields.eq(6).val(),10)}):(h=c.data("colorpicker"),u=parseInt(c.data("colorpicker").fields.eq(1).val(),10),A=parseInt(c.data("colorpicker").fields.eq(2).val(),10),k=parseInt(c.data("colorpicker").fields.eq(3).val(),10),u={r:Math.min(255,Math.max(0,u)),g:Math.min(255,Math.max(0,A)),b:Math.min(255,Math.max(0,k))},h.color=h=P(u));b&&(K(h,c.get(0)),x(h,c.get(0)),S(h,c.get(0)));T(h,c.get(0));r(h,c.get(0));Y(h,c.get(0));
c.data("colorpicker").onChange.apply(c,[h,N(h),X(h)])},qa=function(b){g(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus")},za=function(){k=0<this.parentNode.className.indexOf("_hex")?70:65;g(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus");g(this).parent().addClass("colorpicker_focus")},Aa=function(b){var c=g(this).parent().find("input").focus();b={el:g(this).parent().addClass("colorpicker_slider"),max:0<this.parentNode.className.indexOf("_hsb_h")?
360:0<this.parentNode.className.indexOf("_hsb")?100:255,y:b.pageY,field:c,val:parseInt(c.val(),10),preview:g(this).parent().parent().data("colorpicker").livePreview};g(document).bind("mouseup",b,ha);g(document).bind("mousemove",b,ia)},ia=function(b){b.data.field.val(Math.max(0,Math.min(b.data.max,parseInt(b.data.val+b.pageY-b.data.y,10))));b.data.preview&&O.apply(b.data.field.get(0),[!0]);return!1},ha=function(b){O.apply(b.data.field.get(0),[!0]);b.data.el.removeClass("colorpicker_slider").find("input").focus();
g(document).unbind("mouseup",ha);g(document).unbind("mousemove",ia);return!1},Ba=function(b){b.preventDefault();b={cal:g(this).parent(),y:g(this).offset().top};b.preview=b.cal.data("colorpicker").livePreview;g(document).bind("mouseup touchend",b,ra);g(document).bind("mousemove touchmove",b,sa)},sa=function(b){var c=b;"undefined"!==typeof event&&event.touches&&(c=event.touches[0]);O.apply(b.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,c.pageY-b.data.y)))/
150,10)).get(0),[b.data.preview]);return!1},ra=function(b){K(b.data.cal.data("colorpicker").color,b.data.cal.get(0));x(b.data.cal.data("colorpicker").color,b.data.cal.get(0));g(document).unbind("mouseup touchend",ra);g(document).unbind("mousemove touchmove",sa);return!1},Ca=function(b){b.preventDefault();b={cal:g(this).parent(),pos:g(this).offset()};b.preview=b.cal.data("colorpicker").livePreview;g(document).bind("mouseup touchend",b,ja);g(document).bind("mousemove touchmove",b,ta)},ta=function(b){var c=
b;"undefined"!==typeof event&&event.touches&&(c=event.touches[0]);O.apply(b.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,c.pageY-b.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,c.pageX-b.data.pos.left))/150,10)).get(0),[b.data.preview]);return!1},ja=function(b){K(b.data.cal.data("colorpicker").color,b.data.cal.get(0));x(b.data.cal.data("colorpicker").color,b.data.cal.get(0));g(document).unbind("mouseup touchend",ja);g(document).unbind("mousemove touchmove",
ta);return!1},Da=function(b){g(this).addClass("colorpicker_focus")},Ea=function(b){g(this).removeClass("colorpicker_focus")},Fa=function(b){b=g(this).parent();var c=b.data("colorpicker").color;b.data("colorpicker").origColor=c;ea(c,b.get(0));b.data("colorpicker").onSubmit(c,N(c),X(c),b.data("colorpicker").el)},Ga=function(b){var c=g("body"),h=c.data("colorpickerId"),u=g(this).data("colorpickerId");h&&h===u?(g(document).trigger("mousedown"),c.data("colorpickerId",null)):(ua.call(this,b),c.data("colorpickerId",
u))},ua=function(b){var c,h,u=g("#"+g(this).data("colorpickerId"));u.data("colorpicker").onBeforeShow.apply(this,[u.get(0)]);var k=g(this).offset(),r="CSS1Compat"==document.compatMode;b=window.pageXOffset||(r?document.documentElement.scrollLeft:document.body.scrollLeft);c=window.pageYOffset||(r?document.documentElement.scrollTop:document.body.scrollTop);h=window.innerWidth||(r?document.documentElement.clientWidth:document.body.clientWidth);var x=k.top+this.offsetHeight,k=k.left;x+176>c+(window.innerHeight||
(r?document.documentElement.clientHeight:document.body.clientHeight))&&(x-=this.offsetHeight+176);k+356>b+h&&(k=Math.max(0,k-356));u.css({left:k+"px",top:x+"px"});0!=u.data("colorpicker").onShow.apply(this,[u.get(0)])&&u.show();g(document).bind("mousedown",{cal:u},va);return!1},va=function(b){Ha(b.data.cal.get(0),b.target,b.data.cal.get(0))||(0!=b.data.cal.data("colorpicker").onHide.apply(this,[b.data.cal.get(0)])&&b.data.cal.hide(),g(document).unbind("mousedown",va))},Ha=function(b,c,h){if(b==c)return!0;
if(b.contains)return b.contains(c);if(b.compareDocumentPosition)return!!(b.compareDocumentPosition(c)&16);for(c=c.parentNode;c&&c!=h;){if(c==b)return!0;c=c.parentNode}return!1},ga=function(b){return{h:Math.round(Math.min(360,Math.max(0,b.h))),s:Math.round(Math.min(100,Math.max(0,b.s))),b:Math.round(Math.min(100,Math.max(0,b.b)))}},fa=function(b){b=parseInt(-1<b.indexOf("#")?b.substring(1):b,16);return{r:b>>16,g:(b&65280)>>8,b:b&255}},P=function(b){var c={h:0,s:0,b:0},h=Math.min(b.r,b.g,b.b),g=Math.max(b.r,
b.g,b.b),h=g-h;c.b=g;c.s=0!=g?255*h/g:0;c.h=0!=c.s?b.r==g?(b.g-b.b)/h:b.g==g?2+(b.b-b.r)/h:4+(b.r-b.g)/h:-1;c.h*=60;0>c.h&&(c.h+=360);c.s*=100/255;c.b*=100/255;c.h=Math.round(c.h);c.s=Math.round(c.s);c.b=Math.round(c.b);return c},X=function(b){var c,h,g;c=Math.round(b.h);var k=Math.round(255*b.s/100);b=Math.round(255*b.b/100);if(0==k)c=h=g=b;else{var k=(255-k)*b/255,r=c%60*(b-k)/60;360==c&&(c=0);60>c?(c=b,g=k,h=k+r):120>c?(h=b,g=k,c=b-r):180>c?(h=b,c=k,g=k+r):240>c?(g=b,c=k,h=b-r):300>c?(g=b,h=k,
c=k+r):360>c?(c=b,h=k,g=b-r):g=h=c=0}return{r:Math.round(c),g:Math.round(h),b:Math.round(g)}},aa=function(b){var c=[b.r.toString(16),b.g.toString(16),b.b.toString(16)];g.each(c,function(b,g){1==g.length&&(c[b]="0"+g)});return c.join("")},N=function(b){return aa(X(b))},L=function(){var b=g(this).parent(),c=b.data("colorpicker").origColor;b.data("colorpicker").color=c;K(c,b.get(0));x(c,b.get(0));S(c,b.get(0));T(c,b.get(0));r(c,b.get(0));Y(c,b.get(0))};return{init:function(b){b=g.extend({},ya,b||{});
if("string"==typeof b.color)b.color=P(fa(b.color));else if(void 0!=b.color.r&&void 0!=b.color.g&&void 0!=b.color.b)b.color=P(b.color);else if(void 0!=b.color.h&&void 0!=b.color.s&&void 0!=b.color.b)b.color=ga(b.color);else return this;return this.each(function(){if(!g(this).data("colorpickerId")){var c=g.extend({},b);c.origColor=b.color;var h="collorpicker_"+parseInt(1E3*Math.random());g(this).data("colorpickerId",h);h=g('<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>').attr("id",
h);c.flat?h.appendTo(this).show():h.appendTo(document.body);c.fields=h.find("input").bind("keyup",Z).bind("change",O).bind("blur",qa).bind("focus",za);h.find("span").bind("mousedown touchstart",Aa).end().find(">div.colorpicker_current_color").bind("click",L);c.selector=h.find("div.colorpicker_color").bind("touchstart mousedown",Ca);c.selectorIndic=c.selector.find("div div");c.el=this;c.hue=h.find("div.colorpicker_hue div");h.find("div.colorpicker_hue").bind("mousedown touchstart",Ba);c.newColor=h.find("div.colorpicker_new_color");
c.currentColor=h.find("div.colorpicker_current_color");h.data("colorpicker",c);h.find("div.colorpicker_submit").bind("mouseenter touchstart",Da).bind("mouseleave touchend",Ea).bind("click",Fa);K(c.color,h.get(0));S(c.color,h.get(0));x(c.color,h.get(0));r(c.color,h.get(0));T(c.color,h.get(0));ea(c.color,h.get(0));Y(c.color,h.get(0));c.flat?h.css({position:"relative",display:"block"}):g(this).bind(c.eventName,Ga)}})},showPicker:function(){return this.each(function(){g(this).data("colorpickerId")&&ua.apply(this)})},
hidePicker:function(){return this.each(function(){g(this).data("colorpickerId")&&g("#"+g(this).data("colorpickerId")).hide()})},setColor:function(b){if("string"==typeof b)b=P(fa(b));else if(void 0!=b.r&&void 0!=b.g&&void 0!=b.b)b=P(b);else if(void 0!=b.h&&void 0!=b.s&&void 0!=b.b)b=ga(b);else return this;return this.each(function(){if(g(this).data("colorpickerId")){var c=g("#"+g(this).data("colorpickerId"));c.data("colorpicker").color=b;c.data("colorpicker").origColor=b;K(b,c.get(0));S(b,c.get(0));
x(b,c.get(0));r(b,c.get(0));T(b,c.get(0));ea(b,c.get(0));Y(b,c.get(0))}})}}}();g.fn.extend({ColorPicker:k.init,ColorPickerHide:k.hidePicker,ColorPickerShow:k.showPicker,ColorPickerSetColor:k.setColor})})(jQuery);b4w.register("viewer_main",function(g,k){function cb(a,d){if(!d)return console.log("b4w init failure"),null;window.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1};window.ondragstart=function(a){a.preventDefault();a.stopPropagation();return!1};v.enable_controls();window.addEventListener("resize",Ha,!1);var b=document.createEvent("CustomEvent");b.initEvent("resize",!1,!1);window.dispatchEvent(b);Q.detect_mobile()||m(["gyro_use"],"disable");var ka=v.get_url_params();Pa.enqueue([["manifest",
Pa.AT_JSON,"assets.json"]],function(a,d,b,c){E=a;wa=document.getElementById("info_left_down");z=document.getElementById("lights_cont");document.getElementById("build_date").innerHTML=Qa.date();e(sa,"quality","string");switch(y.get("quality")){case y.P_ULTRA:var G=0;break;case y.P_HIGH:G=1;break;case y.P_LOW:G=2;break;case y.P_CUSTOM:G=3}document.getElementById("quality").options[G].selected=!0;$("#quality").selectmenu("refresh");v.set_onclick("reset_memory",ra);v.set_onclick("auto_rotate_cam",eb);
v.set_onclick("pause",Ca);v.set_onclick("resume",ta);v.set_onclick("auto_view",va);a=document.getElementById("manifest");if(E){b="";d=(d=v.get_url_params())&&d.load?d.load.split("/"):["misc","logo.json"];d="Home ("+d[d.length-1]+")";b=b+"<div class='min_font' id='default_scene'>"+("<h6 class='ui-collapsible-heading'><a class='ui-mini ui-btn ui-btn-icon-right ui-icon-home'>"+d+"</a></h6>");b+="</div>";for(d=0;d<E.length;d++){G=E[d];c=G.name;for(var G=G.items,f="",f=f+"<div data-role='collapsible' data-mini='true' >",
f=f+("<h6>"+c+"</h6>"),f=f+"<ul data-role='listview' data-mini='true' data-inset='true' style='margin: -10px 0;'>",g=0;g<G.length;g++)var h=G[g].name,f=f+("<li data-mini='true'><a href='#' class='min_font' id=\""+("MANIFEST_ITEM_"+h+"__SEPARATOR__"+c)+'">'+h+"</a></li>");f+="</ul>";f+="</div>";b+=f}$("#"+a.id).append(b);$("#"+a.id).trigger("create");a.addEventListener("mouseup",Y,!1)}else a.innerHTML="<p style='color: red;'>Failed loading scenes list.</p><p>Maybe a syntax error?</p>";ea();e(L,"anim_active_object",
"string");e(L,"animation","string");e(L,"anim_mix_factor","number");e(L,"anim_slot","number");e(L,"anim_cyclic","bool");e(L,"anim_frame_current","number");v.set_onclick("anim_play",ga);v.set_onclick("anim_stop",fa);e(N,"nla_frame_current","number");v.set_onclick("nla_play",P);v.set_onclick("nla_stop",X);e(aa,"shape_key_obj","string");e(aa,"shape_key_name","string");e(aa,"shape_key_value","number");e(V,"material_name","string");H(V,"material_diffuse_color");e(V,"material_reflectivity","number");e(V,
"material_fresnel","number");e(V,"material_fresnel_factor","number");e(V,"material_parallax_scale","number");e(V,"material_parallax_steps","number");e(q,"material_name","string");e(q,"shore_smoothing","bool");e(q,"absorb_factor","number");e(q,"sss_strength","number");e(q,"sss_width","number");H(q,"water_fog_color");e(q,"water_fog_density","number");H(q,"shallow_water_col");e(q,"shallow_water_col_fac","number");H(q,"shore_water_col");e(q,"shore_water_col_fac","number");e(q,"foam_factor","number");
e(q,"norm_uv_velocity","number");e(q,"water_dynamic","bool");e(q,"waves_height","number");e(q,"waves_length","number");e(q,"dst_noise_scale0","number");e(q,"dst_noise_scale1","number");e(q,"dst_noise_freq0","number");e(q,"dst_noise_freq1","number");e(q,"dir_min_shore_fac","number");e(q,"dir_freq","number");e(q,"dir_noise_scale","number");e(q,"dir_noise_freq","number");e(q,"dir_min_noise_fac","number");e(q,"dst_min_fac","number");e(q,"waves_hor_fac","number");e(Ia,"environment_energy","string");H(Ia,
"horizon_color");H(Ia,"zenith_color");e(ba,"light_name","string");H(ba,"light_color");e(ba,"light_energy","number");e(ba,"light_spot_size","number");e(ba,"light_spot_blend","number");e(ba,"light_distance","number");H(I,"sky_color");e(I,"rayleigh_brightness","number");e(I,"mie_brightness","number");e(I,"spot_brightness","number");e(I,"scatter_strength","number");e(I,"rayleigh_strength","number");e(I,"mie_strength","number");e(I,"rayleigh_collection_power","number");e(I,"mie_collection_power","number");
e(I,"mie_distribution","number");e(Ja,"date","string");e(Ja,"day_time","number");e(Ra,"sun_horizontal_position","number");e(Ra,"sun_vertical_position","number");e(fb,"max_sun_angle","number");v.set_onclick("run_sun",gb);v.set_onclick("stop_sun",hb);e(ca,"csm_first_cascade_border","number");e(ca,"csm_last_cascade_border","number");e(ca,"self_shadow_polygon_offset","number");e(ca,"self_shadow_normal_offset","number");e(ca,"first_cascade_blur_radius","number");e(ca,"last_cascade_blur_radius","number");
e(A,"ssao_quality","string");e(A,"ssao_hemisphere","bool");e(A,"ssao_blur_depth","bool");e(A,"ssao_blur_discard_value","number");e(A,"ssao_radius_increase","number");e(A,"ssao_influence","number");e(A,"ssao_dist_factor","number");e(A,"ssao_only","bool");e(A,"ssao_white","bool");e(Ka,"fog_density","number");e(Ka,"fog_density1000","number");H(Ka,"fog_color");e(la,"dof_distance","number");e(la,"dof_front","number");e(la,"dof_rear","number");e(la,"dof_power","number");e(la,"dof_on","bool");e(La,"god_rays_intensity",
"number");e(La,"god_rays_max_ray_length","number");e(La,"god_rays_steps","number");e(U,"brightness","number");e(U,"contrast","number");e(U,"exposure","number");e(U,"saturation","number");e(Ea,"sfx_mix_mode","bool");a=Number("true"===t.get("sfx_mix_mode"));document.getElementById("sfx_mix_mode").options[a].selected=!0;$("#sfx_mix_mode").slider("refresh");e(Fa,"anaglyph_use","bool");a=Number("true"===t.get("anaglyph_use"));document.getElementById("anaglyph_use").options[a].selected=!0;$("#anaglyph_use").slider("refresh");
e(Ga,"gyro_use","bool");a=Number("true"===t.get("gyro_use"));document.getElementById("gyro_use").options[a].selected=!0;$("#gyro_use").slider("refresh");e(Sa,"wind_dir","number");e(Sa,"wind_strength","number");e(Ma,"bloom_key","number");e(Ma,"bloom_blur","number");e(Ma,"bloom_edge_lum","number");e(xa,"small_glow_mask_coeff","number");e(xa,"large_glow_mask_coeff","number");e(xa,"small_glow_mask_width","number");e(xa,"large_glow_mask_width","number");e(Ta,"wireframe_mode","string");H(Ta,"wireframe_edge_color",
"object");e(Da,"show_hud_debug_info","bool");e(ua,"outlining_overview_mode","bool");a=""==t.get("outlining_overview_mode")?1:Number("true"===t.get("outlining_overview_mode"));document.getElementById("outlining_overview_mode").options[a].selected=!0;$("#outlining_overview_mode").slider("refresh");v.set_onclick("make_screenshot",ib);a=Number("true"===t.get("show_hud_debug_info"));document.getElementById("show_hud_debug_info").options[a].selected=!0;$("#show_hud_debug_info").slider("refresh");ya();a=
T();Z(a,!1,!1,ka&&ka.load)},null)}function ya(){$(document).ready(function(){$(".ui-slider-handle").off("keydown");$(".ui-slider-handle").on("keydown",function(a){var d=this.parentElement.parentElement.children[0].getAttribute("id");if(d){var b=parseFloat(document.getElementById(d).value),ka=parseFloat(document.getElementById(d).getAttribute("step"));188==a.keyCode&&f(d,b-ka);190==a.keyCode&&f(d,b+ka)}})})}function K(a){if(wa){$("#material_warning")[0].style.display="none";a.preventDefault&&a.preventDefault();
var d=a.clientX;a=a.clientY;var b=C;b&&l.clear_outline_anim(b);(C=d=l.pick_object(d,a))?Ua(d):Va();x();R||(d?(R=d,x(),v.enable_object_controls(d),w.create_kb_sensor_manifold(d,"QUIT",w.CT_SHOT,w.KEY_Q,function(a,d,b,c){R=null;x();v.disable_object_controls(a)})):S())}}function S(){var a=l.get_active_camera();R=a;x();v.enable_camera_controls();w.create_kb_sensor_manifold(a,"QUIT",w.CT_SHOT,w.KEY_Q,function(a,d,b,c){R=null;x();v.disable_camera_controls(a);w.remove_sensor_manifold(a,"ZOOM_TO")});var d=
w.create_keyboard_sensor(w.KEY_Z),b=w.create_keyboard_sensor(w.KEY_DEC_POINT);w.create_sensor_manifold(a,"ZOOM_TO",w.CT_SHOT,[d,b],function(a){return a[0]||a[1]},function(a,d,b){(d=C)&&Wa.zoom_object(a,d)})}function x(){if(wa){var a="CONTROLLED: "+(R?String(R.name):"NONE")+" | SELECTED: "+(C?String(C.name):"NONE"),d=C;d&&(d=l.get_type_mesh_object(d))&&(a+=" | TYPE: "+d);d=R;C&&d&&"CAMERA"===d.type&&(a+=" | DISTANCE: "+Xa);wa.innerHTML=a}}function T(){var a=t.get("last_item_name");if(!a)return null;
for(var d=0;d<E.length;d++){var b=E[d];if(ma.keyfind("name",a,b.items)[0])return{category:b.name,item:a}}return null}function r(a,d){var b=document.getElementById(a);b.innerHTML="";for(var c=0;c<d.length;c++){var e=document.createElement("option");e.text=e.value=d[c];0===c&&(e.selected=!0);b.appendChild(e)}$("#"+a).selectmenu();$("#"+a).selectmenu("refresh")}function ea(){var a=document.getElementById("default_scene");a&&(a.onclick=function(){na=!1;clearTimeout(Na);Z(null,!0,!1,!0)})}function Y(a){a=
a.target.id;if(-1!=a.indexOf("MANIFEST_ITEM_")){var d=a.split("__SEPARATOR__");a=d[1];d=d[0].split("MANIFEST_ITEM_")[1];na=!1;clearTimeout(Na);Z({category:a,item:d},!0,!1,!1)}}function Z(a,d,b,c){if(z)for(var e=0;e<z.children.length;e++)z.children[e].style.visibility="hidden";if((e=v.get_url_params())&&e.load){var f=e.load.split("/");da={load_file:e.load,name:f[f.length-1].split(".")[0],animated_objects:[]}}else da={load_file:y.get_std_assets_path()+"misc/logo.json",name:"Logo",animated_objects:[]};
J=n=null;if(!c)if(a){c=ma.keyfind("name",a.category,E)[0];c=ma.keyfind("name",a.item,c.items)[0];for(var g in c)da[g]="load_file"==g?y.get_std_assets_path()+c[g]:c[g];t.set("last_item_name",a.item)}else t.set("last_item_name","");d&&(Q.clear_render_callback(),Oa.cleanup());Q.get_canvas_elem().removeEventListener("mousedown",K);B.clear_errors_warnings();a=da.name;d=da.load_file;g=document.getElementById("current_file");g.innerHTML=a;g.setAttribute("title",a+" ("+d+")");Oa.load(d,O,za,b)}function O(a){Q.get_canvas_elem().addEventListener("mousedown",
K,!1);C=null;Aa(da);S();v.enable_debug_controls();ja()&&jb.enable_mixer_controls();y.get("gyro_use")&&kb.enable_camera_rotation();Q.set_render_callback(Ba);na&&(Na=setTimeout(qa,1E3));a=w.create_elapsed_sensor();w.create_sensor_manifold(l.get_active_camera(),"TO_OBJ",w.CT_CONTINUOUS,[a],null,function(a,b,c){if(1==c&&C){if(c=C)b=lb,mb.get_object_center(c,!0,b),a=Wa.get_eye(a,nb),Xa=ob.dist(b,a).toFixed(3);x()}})}function qa(){var a=T();if(a){var d=a.item,a=ma.keyfind("name",a.category,E)[0],d=ma.keyfind("name",
d,a.items)[0],d=a.items.indexOf(d);if(d=a.items[d+1])a={category:a.name,item:d.name};else if(a=E.indexOf(a),a=E[a+1])a={category:a.name,item:a.items[0].name};else{na=!1;return}}else a=E[0],d=a.items[0],a={category:a.name,item:d.name};Z(a,!0,!0,!1)}function za(a,d){document.getElementById("loading_progress").innerHTML=a+"% ("+Math.round(10*d/1E3)/10+"s)";var b=B.get_error_quantity(),c=B.get_warning_quantity();if(Oa.is_primary_loaded()){var e=B.num_vertices(),f=B.num_triangles(),g=B.num_draw_calls(),
h=B.num_shaders();document.getElementById("info_right_up").innerHTML=e+" verts, "+f+" tris, "+g+" draw calls, "+h+" shaders";var e=B.geometry_stats(),f=B.num_textures(),g=B.num_render_targets(),h=Math.round(10*(e.ibo_memory+e.vbo_memory))/10,k=Math.round(10*f.memory)/10,l=Math.round(10*g.memory)/10,m=Math.round(10*(h+k+l))/10;document.getElementById("info_right_down").innerHTML="Geometry: "+h+" MiB ("+e.ibo_number+"+"+e.vbo_number+")<br>Textures: "+k+" MiB ("+f.number+")<br>RTs: "+l+" MiB ("+g.number+
")<br><br>Total: "+m+" MiB";e=B.get_error_quantity();(f=B.get_warning_quantity())||e?z.setAttribute("title","Errors: "+e+", Warnings: "+f+"\nSee browser console for more info"):z.setAttribute("title","Loaded OK");c||b||(z.children[0].style.visibility="hidden",z.children[1].style.visibility="hidden",z.children[2].style.visibility="visible")}c&&!b&&(z.children[0].style.visibility="hidden",z.children[1].style.visibility="visible",z.children[2].style.visibility="hidden");b&&(z.children[0].style.visibility=
"visible",z.children[1].style.visibility="hidden",z.children[2].style.visibility="hidden")}function Aa(a){for(var d=l.get_active(),b=l.get_scenes(),c=0;c<b.length;c++){var e=b[c];if(e!==d){var g=ia(e,a);ha(e,g)}}g=ia(d,a);ha(d,g);Ua=function(a){var d=W.get_materials_names(a);r("material_name",d);Ya(a,d[0]);a=W.get_water_material_params(a,d[0]);d="shallow_water_col shallow_water_col_fac shore_water_col shore_water_col_fac water_fog_color water_fog_density absorb_factor sss_strength sss_width foam_factor norm_uv_velocity waves_height waves_length dst_noise_scale0 dst_noise_scale1 dst_noise_freq0 dst_noise_freq1 dir_min_shore_fac dir_freq dir_noise_scale dir_noise_freq dir_min_noise_fac dst_min_fac waves_hor_fac water_dynamic shore_smoothing".split(" ");
a?(m(d,"enable"),l.get_water_mat_params(a),a.shallow_water_col&&M("shallow_water_col",a.shallow_water_col),a.shallow_water_col_fac&&f("shallow_water_col_fac",a.shallow_water_col_fac),a.shore_water_col&&M("shore_water_col",a.shore_water_col),a.shore_water_col_fac&&f("shore_water_col_fac",a.shore_water_col_fac),a.water_fog_color&&(M("water_fog_color",a.water_fog_color),f("water_fog_density",a.water_fog_density)),f("absorb_factor",a.absorb_factor),f("sss_strength",a.sss_strength),f("sss_width",a.sss_width),
f("foam_factor",a.foam_factor),f("norm_uv_velocity",a.norm_uv_velocity),f("waves_height",a.waves_height),f("waves_length",a.waves_length),f("dst_noise_scale0",a.dst_noise_scale0),f("dst_noise_scale1",a.dst_noise_scale1),f("dst_noise_freq0",a.dst_noise_freq0),f("dst_noise_freq1",a.dst_noise_freq1),f("dir_min_shore_fac",a.dir_min_shore_fac),f("dir_freq",a.dir_freq),f("dir_noise_scale",a.dir_noise_scale),f("dir_noise_freq",a.dir_noise_freq),f("dir_min_noise_fac",a.dir_min_noise_fac),f("dst_min_fac",
a.dst_min_fac),f("waves_hor_fac",a.waves_hor_fac)):m(d,"disable")};pb();a=l.get_all_objects("LAMP");d=[];for(c=0;c<a.length;c++)d.push(a[c].name);r("light_name",d);0<a.length&&Za(a[0]);qb();u();rb();sb();tb();db();ub();vb();wb();xb();yb();zb();Va();$("#wireframe_mode").val("WM_NONE");$("#wireframe_mode").selectmenu("refresh",!0);$("#wireframe_edge_color div").css("backgroundColor","#333");c=new Date(document.getElementById("date").value);Ja({date:c})}function ia(a,d){function b(a,d){for(var c in a)d[c]=
a[c];return d}var c=d.scene_settings;if(c&&c[a]){var e={};b(d,e);b(c[a],e);delete e.scene_settings;return e}return d}function ha(a,d){l.set_active(a);l.get_active_camera();for(var b=[],c=l.get_all_objects(),e=0;e<c.length;e++){var f=c[e];p.is_animated(f)&&(n||(n=f),b.push(l.get_object_name(f)))}e="anim_active_object anim_slot animation anim_cyclic anim_frame_range anim_mix_factor anim_frame_current anim_play anim_stop".split(" ");n?(m(e,"enable"),r("anim_active_object",b),L({anim_active_object:l.get_object_name(n)})):
m(e,"disable");b=["nla_play","nla_stop","nla_status","nla_frame_current","nla_playing"];e=["nla_frame_range"];if(D.check_nla()){D.check_nla_scripts()?(m(b,"disable"),document.getElementById("nla_status").innerHTML="CONTROLLED BY NLA SCRIPT"):m(b,"enable");m(e,"enable");var b=document.getElementById("nla_frame_current"),e=document.getElementById("nla_frame_range"),f=D.get_frame_start(),g=D.get_frame_end();-1!=f&&-1!=g?(e.innerHTML=f+" - "+g,b.min=""+f,b.max=""+g):e.innerHTML="N/A"}else m(b,"disable"),
m(e,"disable");b=[];for(e=0;e<c.length;e++)f=c[e],oa.check_shape_keys(f)&&(J||(J=f),b.push(l.get_object_name(f)));c=["shape_key_obj","shape_key_name","shape_key_value"];J?(m(c,"enable"),r("shape_key_obj",b),aa({shape_key_obj:l.get_object_name(J)})):m(c,"disable")}function Ba(a,d){l.get_active_camera();if(n){var b=parseInt(document.getElementById("anim_slot").value),c=Math.round(p.get_frame(n,b));parseInt($("#anim_frame_current").val())!==c&&f("anim_frame_current",c);c=document.getElementById("anim_status");
p.is_play(n,b)?c.innerHTML="PLAYING":c.innerHTML="STOPPED"}D.check_nla()&&(D.check_nla_scripts()||(c=document.getElementById("nla_status"),D.is_play()?c.innerHTML="PLAYING":c.innerHTML="STOPPED"),c=parseInt(D.get_frame()),parseInt($("#nla_frame_current").val())!==c&&f("nla_frame_current",c))}function sa(a){t.set("quality",a.quality);setTimeout(function(){window.location.reload()},100)}function ra(){t.cleanup();window.location.reload()}function Ca(){Q.pause()}function ta(){Q.resume()}function ja(){return"true"===
t.get("sfx_mix_mode")?!0:!1}function Da(a){t.set("show_hud_debug_info",a.show_hud_debug_info);window.location.reload()}function Ea(a){t.set("sfx_mix_mode",a.sfx_mix_mode);window.location.reload()}function Fa(a){t.set("anaglyph_use",a.anaglyph_use);window.location.reload()}function Ga(a){t.set("gyro_use",a.gyro_use);window.location.reload()}function ua(a){t.set("outlining_overview_mode",a.outlining_overview_mode);window.location.reload()}function va(){na=!0;qa()}function Ha(a){v.resize_to_container();
a=Q.get_canvas_elem();document.getElementById("info_left_up").innerHTML=a.width+"x"+a.height+" ("+a.width/a.clientWidth+":1)"}function ga(){var a=document.getElementById("animation").value,d=parseInt(document.getElementById("anim_slot").value);"None"!==a&&p.play(n,null,d)}function fa(){document.getElementById("animation");var a=parseInt(document.getElementById("anim_slot").value);p.stop(n,a)}function P(){D.play()}function X(){D.stop()}function aa(a){if("shape_key_obj"in a){J=l.get_object_by_name(a.shape_key_obj);
var d=oa.get_shape_keys_names(J);d.length?(r("shape_key_name",d),pa=d[0],d=oa.get_shape_key_value(J,pa),f("shape_key_value",d)):r("shape_key_name",["N/K"])}"shape_key_name"in a&&(pa=a.shape_key_name,d=oa.get_shape_key_value(J,pa),f("shape_key_value",d));"shape_key_value"in a&&oa.set_shape_key_value(J,pa,a.shape_key_value)}function N(a){"nla_frame_current"in a&&!D.is_play()&&(a=parseInt(a.nla_frame_current),D.set_frame(a))}function L(a){if("anim_active_object"in a){n=l.get_object_by_name(a.anim_active_object);
var d=p.get_anim_names(n);if(d.length){for(var e=[],f=0;f<d.length&&8>f;f++)e.push(f);d.push("None");r("animation",d);r("anim_slot",e);d=parseInt(document.getElementById("anim_slot").value);b(n,d);c(n,d)}else r("animation",["N/A"]);h(n)}if("anim_slot"in a){if(!n)return;d=a.anim_slot;b(n,d);c(n,d);h(n)}"animation"in a&&(d=parseInt(document.getElementById("anim_slot").value),p.get_current_anim_name(n,d),"None"==a.animation?p.remove_slot_animation(n,d):(p.apply(n,a.animation,d),p.play(n,null,d)),c(n,
d),h(n));"anim_cyclic"in a&&(d=document.getElementById("animation").value,d=p.get_slot_num_by_anim(n,d),p.set_behavior(n,a.anim_cyclic?p.AB_CYCLIC:p.AB_FINISH_RESET,d));"anim_frame_current"in a&&(d=parseInt(document.getElementById("anim_slot").value),p.is_play(n,d)||(e=parseInt(a.anim_frame_current),p.set_frame(n,e,d)));"anim_mix_factor"in a&&p.set_skel_mix_factor(n,a.anim_mix_factor)}function b(a,d){for(var b=p.get_current_anim_name(a,d),b=b||"None",c=$("#animation"),e=c.children(),f=0;f<e.length;f++){var g=
e[f];if(g.value==b){g.selected=!0;c.selectmenu();c.selectmenu("refresh");break}}}function c(a,d){f("anim_cyclic",Number(p.get_behavior(a,d)==p.AB_CYCLIC));var b=document.getElementById("anim_frame_range"),c=p.get_anim_start_frame(a,d),e=p.get_anim_length(a,d);-1!=c&&-1!=e?(e=c+e,b.innerHTML=c+" - "+e,b=document.getElementById("anim_frame_current"),b.min=""+c,b.max=""+e):b.innerHTML="N/A"}function h(a){for(var d=$("#anim_slot-listbox").find("a"),b=parseInt(document.getElementById("anim_slot").value),
c=p.get_anim_type(a,b),b=0;b<d.length;b++){c=p.get_anim_type(a,b);switch(c){case p.OBJ_ANIM_TYPE_ARMATURE:c="ARMATURE";break;case p.OBJ_ANIM_TYPE_OBJECT:c="OBJECT";break;case p.OBJ_ANIM_TYPE_PARTICLES:c="PARTICLES";break;case p.OBJ_ANIM_TYPE_VERTEX:c="VERTEX";break;case p.OBJ_ANIM_TYPE_MATERIAL:c="MATERIAL";break;case p.OBJ_ANIM_TYPE_STATIC:c="STATIC";break;default:c="NONE"}d.eq(b);c=b+" ("+c+")";$("#anim_slot").children().eq(b).text(c)}$("#anim_slot").selectmenu();$("#anim_slot").selectmenu("refresh")}
function u(){var a=l.get_ssao_params(),d="ssao_quality ssao_hemisphere ssao_blur_depth ssao_blur_discard_value ssao_radius_increase ssao_influence ssao_dist_factor ssao_only ssao_white".split(" ");if(a){m(d,"enable");for(var b=document.getElementById("ssao_quality"),d=a.ssao_quality,b=b.options,c=0;c<b.length;c++){var e=b[c];e.selected=e.value==d?!0:!1}$("#ssao_quality").selectmenu("refresh");d=Number(a.ssao_hemisphere);document.getElementById("ssao_hemisphere").options[d].selected=!0;$("#ssao_hemisphere").slider("refresh");
d=Number(a.ssao_blur_depth);document.getElementById("ssao_blur_depth").options[d].selected=!0;$("#ssao_blur_depth").slider("refresh");f("ssao_blur_discard_value",a.blur_discard_value);f("ssao_radius_increase",a.radius_increase);f("ssao_influence",a.influence);f("ssao_dist_factor",a.dist_factor);d=Number(a.ssao_only);document.getElementById("ssao_only").options[d].selected=!0;$("#ssao_only").slider("refresh");d=Number(a.ssao_white);document.getElementById("ssao_white").options[d].selected=!0;$("#ssao_white").slider("refresh")}else m(d,
"disable")}function A(a){l.get_ssao_params();var d={};"ssao_quality"in a&&(d.ssao_quality=$a(document.getElementById("ssao_quality")));"ssao_hemisphere"in a&&(d.ssao_hemisphere=Number(a.ssao_hemisphere));"ssao_blur_depth"in a&&(d.ssao_blur_depth=Number(a.ssao_blur_depth));"ssao_blur_discard_value"in a&&(d.ssao_blur_discard_value=a.ssao_blur_discard_value);"ssao_radius_increase"in a&&(d.ssao_radius_increase=a.ssao_radius_increase);"ssao_influence"in a&&(d.ssao_influence=a.ssao_influence);"ssao_dist_factor"in
a&&(d.ssao_dist_factor=a.ssao_dist_factor);"ssao_only"in a&&(d.ssao_only=Number(a.ssao_only));"ssao_white"in a&&(d.ssao_white=Number(a.ssao_white));l.set_ssao_params(d)}function db(){var a=l.get_color_correction_params(),d=["brightness","contrast","exposure","saturation"];a?(m(d,"enable"),f("brightness",a.brightness),f("contrast",a.contrast),f("exposure",a.exposure),f("saturation",a.saturation)):m(d,"disable")}function U(a){var d=l.get_color_correction_params();d&&(d={},"brightness"in a&&(d.brightness=
parseFloat(a.brightness)),"contrast"in a&&(d.contrast=parseFloat(a.contrast)),"exposure"in a&&(d.exposure=parseFloat(a.exposure)),"saturation"in a&&(d.saturation=parseFloat(a.saturation)),l.set_color_correction_params(d))}function $a(a){a=a.options;for(var d=0;d<a.length;d++){var b=a[d];if(b.selected)return b.value}}function rb(){var a=l.get_fog_color_density();.2<a[3]?f("fog_density",a[3]):f("fog_density1000",1E3*a[3]);M("fog_color",a)}function Ka(a){var d=l.get_fog_color_density();"fog_density"in
a&&(d[3]=a.fog_density);"fog_density1000"in a&&(d[3]=a.fog_density1000/1E3);"fog_color"in a&&(d[0]=a.fog_color[0],d[1]=a.fog_color[1],d[2]=a.fog_color[2]);l.set_fog_color_density(d)}function qb(){var a=l.get_shadow_params(),d="csm_first_cascade_border csm_last_cascade_border self_shadow_polygon_offset self_shadow_normal_offset first_cascade_blur_radius last_cascade_blur_radius res_ui-block-b num_ui-block-b blur_ui-block-b".split(" ");if(!a)return m(d,"disable"),document.getElementById("csm_resolution").innerHTML=
"",document.getElementById("csm_num").innerHTML="",document.getElementById("csm_borders").innerHTML="",document.getElementById("blur_radii").innerHTML="",null;m(d,"enable");ab(a);f("self_shadow_polygon_offset",a.self_shadow_polygon_offset);f("self_shadow_normal_offset",a.self_shadow_normal_offset);f("first_cascade_blur_radius",a.first_cascade_blur_radius);a.enable_csm?(f("csm_first_cascade_border",a.csm_first_cascade_border),1<a.csm_num?(f("csm_last_cascade_border",a.csm_last_cascade_border),f("last_cascade_blur_radius",
a.last_cascade_blur_radius)):m(["csm_last_cascade_border","last_cascade_blur_radius"],"disable")):m(["csm_first_cascade_border","csm_last_cascade_border","last_cascade_blur_radius"],"disable")}function ca(a){var d={};"csm_first_cascade_border"in a&&(d.csm_first_cascade_border=a.csm_first_cascade_border);"csm_last_cascade_border"in a&&(d.csm_last_cascade_border=a.csm_last_cascade_border);"self_shadow_polygon_offset"in a&&(d.self_shadow_polygon_offset=a.self_shadow_polygon_offset);"self_shadow_normal_offset"in
a&&(d.self_shadow_normal_offset=a.self_shadow_normal_offset);"first_cascade_blur_radius"in a&&(d.first_cascade_blur_radius=a.first_cascade_blur_radius);"last_cascade_blur_radius"in a&&(d.last_cascade_blur_radius=a.last_cascade_blur_radius);l.set_shadow_params(d);ab(l.get_shadow_params())}function ab(a){document.getElementById("csm_resolution").innerHTML="&nbsp;&nbsp;"+a.csm_resolution;if(a.enable_csm){document.getElementById("csm_num").innerHTML=" "+a.csm_num;for(var d=["csm_borders","blur_radii"],
b=0;b<d.length;b++){var c=d[b],e=a[c],c=document.getElementById(c);c.innerHTML="(";for(var f=0;f<e.length;f++)0<f&&(c.innerHTML+=" __ "),c.innerHTML+=Math.round(10*e[f])/10;c.innerHTML+=")"}}else document.getElementById("cascades-info-block").style.display="none",document.getElementById("csm_first_cascade_border-info-block").style.display="none",document.getElementById("csm_last_cascade_border-info-block").style.display="none",document.getElementById("blur_radii-info-block").style.display="none",
document.getElementById("first_cascade_blur_radius-label").innerHTML="Blur radius",document.getElementById("last_cascade_blur_radius-info-block").style.display="none"}function pb(){var a=l.get_environment_colors();f("environment_energy",a[0]);M("horizon_color",a[1]);M("zenith_color",a[2])}function Ia(a){"environment_energy"in a&&l.set_environment_colors(a.environment_energy,null,null);"horizon_color"in a&&l.set_environment_colors(null,a.horizon_color,null);"zenith_color"in a&&l.set_environment_colors(null,
null,a.zenith_color)}function Ta(a){var d={};"string"==typeof a.wireframe_mode&&(d.wireframe_mode=$a(document.getElementById("wireframe_mode")));"object"==typeof a.wireframe_edge_color&&(d.wireframe_edge_color=a.wireframe_edge_color);B.set_debug_params(d)}function ib(){Ab.shot()}function wb(){var a=l.get_sky_params(),d="sky_color rayleigh_brightness mie_brightness spot_brightness scatter_strength rayleigh_strength mie_strength rayleigh_collection_power mie_collection_power mie_distribution".split(" ");
if(!a)return m(d,"disable"),null;m(d,"enable");M("sky_color",a.color);f("rayleigh_brightness",a.rayleigh_brightness);f("mie_brightness",a.mie_brightness);f("spot_brightness",a.spot_brightness);f("scatter_strength",a.scatter_strength);f("rayleigh_strength",a.rayleigh_strength);f("mie_strength",a.mie_strength);f("rayleigh_collection_power",a.rayleigh_collection_power);f("mie_collection_power",a.mie_collection_power);f("mie_distribution",a.mie_distribution)}function I(a){var d={};"sky_color"in a&&(d.color=
a.sky_color);"rayleigh_brightness"in a&&(d.rayleigh_brightness=a.rayleigh_brightness);"mie_brightness"in a&&(d.mie_brightness=a.mie_brightness);"spot_brightness"in a&&(d.spot_brightness=a.spot_brightness);"scatter_strength"in a&&(d.scatter_strength=a.scatter_strength);"rayleigh_strength"in a&&(d.rayleigh_strength=a.rayleigh_strength);"mie_strength"in a&&(d.mie_strength=a.mie_strength);"rayleigh_collection_power"in a&&(d.rayleigh_collection_power=a.rayleigh_collection_power);"mie_collection_power"in
a&&(d.mie_collection_power=a.mie_collection_power);"mie_distribution"in a&&(d.mie_distribution=a.mie_distribution);l.set_sky_params(d)}function Ya(a,d){var b=W.get_material_extended_params(a,d),c="material_diffuse_color material_name material_reflectivity material_fresnel material_fresnel_factor material_parallax_scale material_parallax_steps".split(" ");if(!b)return m(c,"disable"),$("#material_warning")[0].style.display="block",null;var e=W.get_diffuse_color(a,d);e.pop();b.diffuse_color=e;m(c,"enable");
M("material_diffuse_color",b.diffuse_color);f("material_reflectivity",b.reflect_factor);f("material_fresnel",b.fresnel);f("material_fresnel_factor",b.fresnel_factor);f("material_parallax_scale",b.parallax_scale);f("material_parallax_steps",b.parallax_steps)}function V(a){var d=C;"material_name"in a&&Ya(d,a.material_name);if("material_diffuse_color"in a){var b=a.material_diffuse_color.slice();b.push(1);W.set_diffuse_color(d,$("#material_name").val(),b)}b={};"material_reflectivity"in a&&(b.material_reflectivity=
a.material_reflectivity);"material_fresnel"in a&&(b.material_fresnel=a.material_fresnel);"material_fresnel_factor"in a&&(b.material_fresnel_factor=a.material_fresnel_factor);"material_parallax_scale"in a&&(b.material_parallax_scale=a.material_parallax_scale);"material_parallax_steps"in a&&(b.material_parallax_steps=a.material_parallax_steps);W.set_material_extended_params(d,$("#material_name").val(),b);l.update_scene_materials_params()}function q(a){var d=C,b="waves_height waves_length sss_strength sss_width dst_noise_scale0 dst_noise_scale1 dst_noise_freq0 dst_noise_freq1 dir_min_shore_fac dir_freq dir_noise_scale dir_noise_freq dir_min_noise_fac dst_min_fac waves_hor_fac".split(" ");
if(!d)return null;var c={},e=$("#water_dynamic").val(),f=$("#shore_smoothing").val();Boolean(Number(e))?m(b,"enable"):m(b,"disable");Boolean(Number(f))?m(["absorb_factor"],"enable"):m(["absorb_factor"],"disable");"shore_smoothing"in a&&(c.shore_smoothing=a.shore_smoothing);"absorb_factor"in a&&(c.absorb_factor=a.absorb_factor);"water_fog_color"in a&&(c.water_fog_color=a.water_fog_color);"water_fog_density"in a&&(c.water_fog_density=a.water_fog_density);"shallow_water_col"in a&&(c.shallow_water_col=
a.shallow_water_col);"shallow_water_col_fac"in a&&(c.shallow_water_col_fac=a.shallow_water_col_fac);"shore_water_col"in a&&(c.shore_water_col=a.shore_water_col);"shore_water_col_fac"in a&&(c.shore_water_col_fac=a.shore_water_col_fac);"foam_factor"in a&&(c.foam_factor=a.foam_factor);"norm_uv_velocity"in a&&(c.norm_uv_velocity=a.norm_uv_velocity);"sss_strength"in a&&(c.sss_strength=a.sss_strength);"sss_width"in a&&(c.sss_width=a.sss_width);"water_dynamic"in a&&(c.water_dynamic=a.water_dynamic);"waves_height"in
a&&(c.waves_height=a.waves_height);"waves_length"in a&&(c.waves_length=a.waves_length);"dst_noise_scale0"in a&&(c.dst_noise_scale0=a.dst_noise_scale0);"dst_noise_scale1"in a&&(c.dst_noise_scale1=a.dst_noise_scale1);"dst_noise_freq0"in a&&(c.dst_noise_freq0=a.dst_noise_freq0);"dst_noise_freq1"in a&&(c.dst_noise_freq1=a.dst_noise_freq1);"dir_min_shore_fac"in a&&(c.dir_min_shore_fac=a.dir_min_shore_fac);"dir_freq"in a&&(c.dir_freq=a.dir_freq);"dir_noise_scale"in a&&(c.dir_noise_scale=a.dir_noise_scale);
"dir_noise_freq"in a&&(c.dir_noise_freq=a.dir_noise_freq);"dir_min_noise_fac"in a&&(c.dir_min_noise_fac=a.dir_min_noise_fac);"dst_min_fac"in a&&(c.dst_min_fac=a.dst_min_fac);"waves_hor_fac"in a&&(c.waves_hor_fac=a.waves_hor_fac);if(!W.set_water_material_params(d,$("#material_name").val(),c))return null;l.update_scene_materials_params();l.set_water_params(c)}function Za(a){if(a=F.get_light_params(a)){M("light_color",a.light_color);f("light_energy",a.light_energy);var b=a.light_type;$("#light_type").text(b);
"SPOT"==a.light_type?(m(["light_spot_blend","light_spot_size"],"enable"),"light_spot_blend"in a&&f("light_spot_blend",a.light_spot_blend),"light_spot_size"in a&&f("light_spot_size",Math.round(a.light_spot_size*Bb))):m(["light_spot_blend","light_spot_size"],"disable");"SPOT"==a.light_type||"POINT"==a.light_type?(m(["light_distance"],"enable"),"light_distance"in a&&f("light_distance",a.light_distance)):m(["light_distance"],"disable")}}function ba(a){"light_name"in a&&Za(l.get_object_by_name(a.light_name));
var b={};"light_color"in a&&(b.light_color=a.light_color);"light_energy"in a&&(b.light_energy=parseFloat(a.light_energy));"light_spot_size"in a&&(b.light_spot_size=parseFloat(a.light_spot_size*Cb));"light_spot_blend"in a&&(b.light_spot_blend=parseFloat(a.light_spot_blend));"light_distance"in a&&(b.light_distance=parseFloat(a.light_distance));a=l.get_object_by_name($("#light_name").val());F.set_light_params(a,b)}function vb(){var a=F.get_sun_params(),b=["sun_horizontal_position","sun_vertical_position"];
if(!a)return m(b,"disable"),null;f("sun_horizontal_position",a.hor_position);f("sun_vertical_position",a.vert_position)}function Ra(a){var b={};"sun_horizontal_position"in a&&(b.hor_position=parseFloat(a.sun_horizontal_position),b.vert_position=parseFloat(document.getElementById("sun_vertical_position").value));"sun_vertical_position"in a&&(b.hor_position=parseFloat(document.getElementById("sun_horizontal_position").value),b.vert_position=parseFloat(a.sun_vertical_position));F.set_sun_params(b)}function fb(a){a=
parseFloat(a.max_sun_angle);F.set_max_sun_angle(a)}function Ja(a){"day_time"in a&&F.set_day_time(a.day_time);"date"in a&&F.set_date(new Date(a.date))}function gb(){var a=0,b=parseFloat(document.getElementById("day_time").value),c=w.create_elapsed_sensor(),e=F.get_lamps("SUN")[0];w.create_sensor_manifold(e,"ELAPSED",w.CT_CONTINUOUS,[c],function(a){return a[0]},function(c,e,g){1==g&&(a=document.getElementById("sun_time_multiplier").value,c=w.get_sensor_value(c,e,0),b+=c*a/3600,24<b&&(b-=Math.floor(b)),
f("day_time",b))})}function zb(){var a=F.get_lamps("SUN")[0],b=["sn-ui-grid-b"];F.get_lamps().length?a||m("run_sun stop_sun date sun_time_multiplier day_time max_sun_angle".split(" "),"disable"):m(b,"disable")}function Va(){m("material_diffuse_color material_name material_reflectivity material_fresnel material_fresnel_factor material_parallax_scale material_parallax_steps".split(" "),"disable");m("shallow_water_col shallow_water_col_fac shore_water_col shore_water_col_fac water_fog_color water_fog_density absorb_factor sss_strength sss_width foam_factor norm_uv_velocity waves_height waves_length dst_noise_scale0 dst_noise_scale1 dst_noise_freq0 dst_noise_freq1 dir_min_shore_fac dir_freq dir_noise_scale dir_noise_freq dir_min_noise_fac dst_min_fac waves_hor_fac water_dynamic shore_smoothing".split(" "),
"disable")}function hb(){var a=F.get_lamps("SUN")[0];w.check_sensor_manifolds(a)&&w.remove_sensor_manifold(a,"ELAPSED")}function sb(){var a=l.get_dof_params(),b="dof_distance dof_object dof_front dof_rear dof_power dof_on".split(" ");if(a){f("dof_front",a.dof_front);f("dof_rear",a.dof_rear);f("dof_power",a.dof_power);$("#dof_distance").parent().parent().parent().removeClass("ui-disabled");if(a.dof_object){var c=a.dof_object.name;$("#dof_object").text(c);b.splice(0,1);$("#dof_distance").parent().addClass("ui-disabled");
$("#dof_object").parent().removeClass("ui-disabled")}else f("dof_distance",a.dof_distance),b.splice(1,1),$("#dof_distance").parent().removeClass("ui-disabled"),$("#dof_object").parent().addClass("ui-disabled");m(b,"enable");a=0<a.dof_distance?1:0;document.getElementById("dof_on").options[a].selected=!0;$("#dof_on").slider("refresh")}else m(b,"disable")}function la(a){var b={};"dof_distance"in a&&Number($("#dof_on").val())&&(b.dof_distance=a.dof_distance);"dof_front"in a&&(b.dof_front=a.dof_front);
"dof_rear"in a&&(b.dof_rear=a.dof_rear);"dof_power"in a&&(b.dof_power=a.dof_power);"dof_on"in a&&(b.dof_on=Boolean($("#dof_on").val()),b.dof_distance=Number(a.dof_on)?parseFloat($("#dof_distance").val()):0);l.set_dof_params(b)}function tb(){var a=l.get_god_rays_params(),b=["god_rays_intensity","god_rays_max_ray_length","god_rays_steps"];a?(m(b,"enable"),a&&(f("god_rays_intensity",a.god_rays_intensity),f("god_rays_max_ray_length",a.god_rays_max_ray_length),f("god_rays_steps",a.god_rays_steps))):m(b,
"disable")}function La(a){var b={};"god_rays_intensity"in a&&(b.god_rays_intensity=a.god_rays_intensity);"god_rays_max_ray_length"in a&&(b.god_rays_max_ray_length=a.god_rays_max_ray_length);"god_rays_steps"in a&&(b.god_rays_steps=a.god_rays_steps);l.set_god_rays_params(b)}function xb(){var a=l.get_bloom_params(),b=["bloom_key","bloom_blur","bloom_edge_lum"];a?(m(b,"enable"),a&&(f("bloom_key",a.bloom_key),f("bloom_blur",a.bloom_blur),f("bloom_edge_lum",a.bloom_edge_lum))):m(b,"disable")}function Ma(a){var b=
{};"bloom_key"in a&&(b.bloom_key=a.bloom_key);"bloom_blur"in a&&(b.bloom_blur=a.bloom_blur);"bloom_edge_lum"in a&&(b.bloom_edge_lum=a.bloom_edge_lum);l.set_bloom_params(b)}function yb(){var a=l.get_glow_material_params(),b=["small_glow_mask_coeff","large_glow_mask_coeff","small_glow_mask_width","large_glow_mask_width"];a?(m(b,"enable"),f("small_glow_mask_coeff",a.small_glow_mask_coeff),f("large_glow_mask_coeff",a.large_glow_mask_coeff),f("small_glow_mask_width",a.small_glow_mask_width),f("large_glow_mask_width",
a.large_glow_mask_width)):m(b,"disable")}function xa(a){var b={};"small_glow_mask_coeff"in a&&(b.small_glow_mask_coeff=a.small_glow_mask_coeff);"large_glow_mask_coeff"in a&&(b.large_glow_mask_coeff=a.large_glow_mask_coeff);"small_glow_mask_width"in a&&(b.small_glow_mask_width=a.small_glow_mask_width);"large_glow_mask_width"in a&&(b.large_glow_mask_width=a.large_glow_mask_width);l.set_glow_material_params(b)}function M(a,b){b=Db(b);var c={r:Math.round(255*b[0]),g:Math.round(255*b[1]),b:Math.round(255*
b[2])};$("#"+a).ColorPickerSetColor(c);$("#"+a+" div").css("backgroundColor","#"+function(a){var b=[a.r.toString(16),a.g.toString(16),a.b.toString(16)];$.each(b,function(a,c){1==c.length&&(b[a]="0"+c)});return b.join("")}(c))}function Db(a){return[Math.pow(a[0],1/2.2),Math.pow(a[1],1/2.2),Math.pow(a[2],1/2.2)]}function ub(){var a=l.get_wind_params(),b=["wind_dir","wind_strength"];a?(f("wind_dir",a.wind_dir),f("wind_strength",a.wind_strength)):m(b,"disable")}function Sa(a){var b={};"wind_dir"in a&&
(b.wind_dir=a.wind_dir);"wind_strength"in a&&(b.wind_strength=a.wind_strength);l.set_wind_params(b)}function f(a,b){$("#"+a).val(b);$("#"+a).slider("refresh");$("#"+a).trigger("change")}function e(a,b,c){$("#"+b).bind("change",function(e){var f={};switch(c){case "string":f[b]=e.target.value;break;case "number":f[b]=parseFloat(e.target.value);break;case "bool":f[b]=Boolean(Number(e.target.value));break;default:return console.log("wrong value type"),null}a(f)})}function H(a,b){$("#"+b).ColorPicker({onChange:function(c,
e,f){$("#"+b+" div").css("backgroundColor","#"+e);c={};e=[];e[0]=f.r/255;e[1]=f.g/255;e[2]=f.b/255;f=e;f=[Math.pow(f[0],2.2),Math.pow(f[1],2.2),Math.pow(f[2],2.2)];c[b]=f;a(c)}})}function eb(){Eb.auto_rotate(.3)}function m(a,b){if(!a)return null;for(var c=0;c<a.length;c++){var e=$("#"+a[c]).parent().parent();"enable"==b?e.removeClass("ui-disabled"):"disable"==b&&e.addClass("ui-disabled")}}var p=k("animation"),v=k("app"),Pa=k("assets"),Wa=k("camera"),Eb=k("camera_anim"),y=k("config");k("constraints");
var w=k("controls"),Oa=k("data"),B=k("debug"),oa=k("geometry"),kb=k("gyroscope"),F=k("lights"),Q=k("main"),jb=k("mixer"),W=k("material"),D=k("nla"),Ab=k("screenshooter"),l=k("scenes");k("shaders");var t=k("storage"),mb=k("transform"),ma=k("util"),Qa=k("version"),ob=k("vec3"),bb="DEBUG"===Qa.type(),Cb=Math.PI/180,Bb=180/Math.PI,lb=new Float32Array(3),nb=new Float32Array(3),na=!1,Na,E=null,n=null,J=null,pa="",da=null,wa=null,z=null,C=null,Ua=function(){},R=null,Xa=null;g.init=function(){t.init("b4w_viewer");
var a=t.get("quality");if(a){switch(a){case "ULTRA":var b=y.P_ULTRA;break;case "HIGH":b=y.P_HIGH;break;case "LOW":b=y.P_LOW;break;case "CUSTOM":b=y.P_CUSTOM}y.set("quality",b)}y.set("anaglyph_use","true"===t.get("anaglyph_use"));y.set("gyro_use","true"===t.get("gyro_use"));""==t.get("outlining_overview_mode")?y.set("outlining_overview_mode",!0):y.set("outlining_overview_mode","true"===t.get("outlining_overview_mode"));v.init({canvas_container_id:"main_canvas_container",callback:cb,autoresize:!1,gl_debug:!0,
show_hud_debug_info:"true"===t.get("show_hud_debug_info")?!0:!1,sfx_mix_mode:ja(),show_fps:!0,fps_elem_id:"fps_logger",fps_wrapper_id:"fps_container",alpha:!0,assets_dds_available:!bb,assets_min50_available:!bb,console_verbose:!0,physics_enabled:!0,wireframe_debug:!0})}});b4w.require("viewer_main").init();
