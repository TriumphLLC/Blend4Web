

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>For Application Developers &mdash; Blend4Web 17.06 User Manual</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="author" title="About these documents"
              href="about.html"/>
    <link rel="top" title="Blend4Web 17.06 User Manual" href="index.html"/>
        <link rel="next" title="For Engine Developers" href="developers_advanced.html"/>
        <link rel="prev" title="Physics" href="physics.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Blend4Web. User Manual
        

        
        </a>

        
          
          
            <div class="version">
              v17.06
            </div>
          
        

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="engine_features.html">Engine Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Installing and Updating</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_manager.html">Project Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewer.html">Scene Viewer</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_player.html">Web Player</a></li>
<li class="toctree-l1"><a class="reference internal" href="addon.html">Add-on</a></li>
<li class="toctree-l1"><a class="reference internal" href="scene_settings.html">Scene Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="objects.html">Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="meshes.html">Meshes</a></li>
<li class="toctree-l1"><a class="reference internal" href="normal_editor.html">Normal Editor</a></li>
<li class="toctree-l1"><a class="reference internal" href="camera.html">Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="materials.html">Materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="material_library.html">Material Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="node_materials.html">Node Materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="logic_editor.html">Logic Editor</a></li>
<li class="toctree-l1"><a class="reference internal" href="lighting.html">Lighting, Shadows and Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="postprocessing_effects.html">Postprocessing Effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="stereo_rendering.html">Stereo Rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="textures.html">Textures</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles.html">Particle System. Fluids</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles_instancing.html">Particle System. Instancing</a></li>
<li class="toctree-l1"><a class="reference internal" href="animation.html">Animation</a></li>
<li class="toctree-l1"><a class="reference internal" href="outdoor_rendering.html">Outdoor Effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">Color Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="audio.html">Audio</a></li>
<li class="toctree-l1"><a class="reference internal" href="physics.html">Physics</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">For Application Developers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#application-development">Application Development</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#application-code-structure">Application Code Structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#writing-application-logic">Writing Application Logic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-system">Module System</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#background-transparency">Background Transparency</a></li>
<li class="toctree-l2"><a class="reference internal" href="#resource-conversion">Resource Conversion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#commands">Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#arguments">Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-formats">Data Formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dds-texture-compression">DDS Texture Compression</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pvrtc-texture-compression">PVRTC Texture Compression</a></li>
<li class="toctree-l4"><a class="reference internal" href="#seq-video-format">SEQ Video Format</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gzip-compression">GZIP Compression</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code-examples">Code Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loading-application-assets">Loading Application Assets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#event-driven-model">Event-Driven Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sensors">Sensors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sdk-file-structure">SDK File Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loading-local-resources">Loading Local Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quality-profiles">Quality Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#non-standard-canvas-position-and-orientation">Non-Standard Canvas Position and Orientation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mobile-web-apps">Mobile Web Apps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="developers_advanced.html">For Engine Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="git_short_manual.html">Team Work. Using Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems_and_solutions.html">Problems and Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Blend4Web. User Manual</a>
      </nav>


      
      <div class="wy-nav-content">
        <div id="lang_cont">
          <a href="#">RU</a>
          <a href="#">EN</a>
          <a href="#">ZH</a>
        </div>
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>For Application Developers</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="for-application-developers">
<span id="developers"></span><h1><a class="toc-backref" href="#id2">For Application Developers</a><a class="headerlink" href="#for-application-developers" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#for-application-developers" id="id2">For Application Developers</a><ul>
<li><a class="reference internal" href="#application-development" id="id3">Application Development</a><ul>
<li><a class="reference internal" href="#application-code-structure" id="id4">Application Code Structure</a></li>
</ul>
</li>
<li><a class="reference internal" href="#background-transparency" id="id5">Background Transparency</a></li>
<li><a class="reference internal" href="#resource-conversion" id="id6">Resource Conversion</a><ul>
<li><a class="reference internal" href="#commands" id="id7">Commands</a></li>
<li><a class="reference internal" href="#arguments" id="id8">Arguments</a></li>
<li><a class="reference internal" href="#dependencies" id="id9">Dependencies</a></li>
<li><a class="reference internal" href="#data-formats" id="id10">Data Formats</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gzip-compression" id="id11">GZIP Compression</a></li>
<li><a class="reference internal" href="#code-examples" id="id12">Code Examples</a></li>
<li><a class="reference internal" href="#loading-application-assets" id="id13">Loading Application Assets</a></li>
<li><a class="reference internal" href="#event-driven-model" id="id14">Event-Driven Model</a><ul>
<li><a class="reference internal" href="#sensors" id="id15">Sensors</a></li>
<li><a class="reference internal" href="#example" id="id16">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sdk-file-structure" id="id17">SDK File Structure</a></li>
<li><a class="reference internal" href="#loading-local-resources" id="id18">Loading Local Resources</a></li>
<li><a class="reference internal" href="#quality-profiles" id="id19">Quality Profiles</a></li>
<li><a class="reference internal" href="#non-standard-canvas-position-and-orientation" id="id20">Non-Standard Canvas Position and Orientation</a></li>
<li><a class="reference internal" href="#mobile-web-apps" id="id21">Mobile Web Apps</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="application-development">
<span id="app-building"></span><h2><a class="toc-backref" href="#id3">Application Development</a><a class="headerlink" href="#application-development" title="Permalink to this headline">¶</a></h2>
<p>To simplify development process, we recommend to use <a class="reference internal" href="project_manager.html#project-management"><span>Project Manager</span></a>. It can be used to quickly <a class="reference internal" href="project_manager.html#create-new-project"><span>create</span></a> a simple application with a generic code that is enough to load a simple scene and enable basic camera controls.</p>
<div class="section" id="application-code-structure">
<span id="app-init-loading"></span><h3><a class="toc-backref" href="#id4">Application Code Structure</a><a class="headerlink" href="#application-code-structure" title="Permalink to this headline">¶</a></h3>
<p>The process of initializing and loading an application is separated into several stages, which is reflected in the code of the application. If you are using Project Manager, a newly created <code class="docutils literal"><span class="pre">Copy</span></code> or <code class="docutils literal"><span class="pre">Compile</span></code> type project will include a main JS file, which will be placed in the SDK. The path to the file will look like this: <code class="docutils literal"><span class="pre">./projects/PROJECT_NAME/PROJECT_NAME.js</span></code>.</p>
<p>This file contains generic code shaped as a module. This module can be registered using the certain structure:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">b4w</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;my_module&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// module code</span>
    <span class="c1">//...</span>

<span class="p">});</span>
</pre></div>
</div>
<p>So, the code of a module is contained within a function that accepts <code class="docutils literal"><span class="pre">exports</span></code> and <code class="docutils literal"><span class="pre">require</span></code> parameters.</p>
<ol class="arabic">
<li><p class="first"><code class="docutils literal"><span class="pre">require</span></code> is the method used for loading engine modules. The generic example mentioned above loads several modules:</p>
<blockquote>
<div><p>The most important ones of them are the <code class="docutils literal"><span class="pre">app</span></code> and <code class="docutils literal"><span class="pre">data</span></code> modules. The <code class="docutils literal"><span class="pre">app</span></code> module simplifies application initialization while the <code class="docutils literal"><span class="pre">data</span></code> module contains API methods for loading 3D scene data.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To make module naming more convenient, <code class="docutils literal"><span class="pre">m_</span></code> prefix is often used (<code class="docutils literal"><span class="pre">m_app</span></code>, <code class="docutils literal"><span class="pre">m_data</span></code> etc.) to show that the variable is an engine module.</p>
</div>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">exports</span></code> is an object used for gaining access to module’s functions from outside (for example, from other modules). In this case, only the <code class="docutils literal"><span class="pre">init</span></code> function has been made external:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">b4w</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;my_module&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">)</span> <span class="p">{</span>

    <span class="p">...</span>

    <span class="nx">exports</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">m_app</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
        <span class="nx">canvas_container_id</span><span class="o">:</span> <span class="s2">&quot;main_canvas_container&quot;</span><span class="p">,</span>
        <span class="nx">callback</span><span class="o">:</span> <span class="nx">init_cb</span><span class="p">,</span>
        <span class="nx">show_fps</span><span class="o">:</span> <span class="nx">DEBUG</span><span class="p">,</span>
        <span class="nx">console_verbose</span><span class="o">:</span> <span class="nx">DEBUG</span><span class="p">,</span>
        <span class="nx">autoresize</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="p">...</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>Application initialization begins with this function, and it is called outside of the module:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">b4w</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;my_module&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">)</span> <span class="p">{</span>

    <span class="p">...</span>

    <span class="nx">exports</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">m_app</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
            <span class="nx">canvas_container_id</span><span class="o">:</span> <span class="s2">&quot;main_canvas_container&quot;</span><span class="p">,</span>
            <span class="nx">callback</span><span class="o">:</span> <span class="nx">init_cb</span><span class="p">,</span>
            <span class="nx">show_fps</span><span class="o">:</span> <span class="nx">DEBUG</span><span class="p">,</span>
            <span class="nx">console_verbose</span><span class="o">:</span> <span class="nx">DEBUG</span><span class="p">,</span>
            <span class="nx">autoresize</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="p">...</span>
<span class="p">});</span>

<span class="c1">// import the app module and start the app by calling the init method</span>
<span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;my_module&quot;</span><span class="p">).</span><span class="nx">init</span><span class="p">();</span>
</pre></div>
</div>
<p>After this, the <a class="reference external" href="https://www.blend4web.com/api_doc/module-app.html#.init">app.init</a> method is called. It creates Canvas HTML element and performs all necessary action for initializing WebGL. This method has many different attributes, the most important ones of which are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">canvas_container_id</span></code> set the id of the HTML element that acts as a container for the Canvas element. By default, an element with the <code class="docutils literal"><span class="pre">main_canvas_container</span></code> ID is used (this element is located in the main HTML file of the application).</li>
<li><code class="docutils literal"><span class="pre">callback</span></code> is the function that is called after finishing initialization.</li>
</ul>
<p>When application initialization is completed, the <a class="reference external" href="https://www.blend4web.com/api_doc/module-app.html#~AppInitCallback">init_cb</a> function set by the <code class="docutils literal"><span class="pre">callback</span></code> parameter is called:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">init_cb</span><span class="p">(</span><span class="nx">canvas_elem</span><span class="p">,</span> <span class="nx">success</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;b4w init failure&quot;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">m_preloader</span><span class="p">.</span><span class="nx">create_preloader</span><span class="p">();</span>

    <span class="c1">// ignore right-click on the canvas element</span>
    <span class="nx">canvas_elem</span><span class="p">.</span><span class="nx">oncontextmenu</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">};</span>

   <span class="nx">load</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It has following parameters:</p>
<ul class="simple">
<li>canvas_elem is the created Canvas HTML element that will be used for rendering 3D content</li>
<li>success it the flag that indicates the success of the initialization. The <code class="docutils literal"><span class="pre">false</span></code> value meant that the application is unable to work due to initialization errors (for example, WebGL is not supported by the device).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference external" href="https://www.blend4web.com/api_doc/module-app.html#.init">app.init</a> methods sets initialization to the <code class="docutils literal"><span class="pre">window.onload</span></code> event, so the <code class="docutils literal"><span class="pre">init_cb</span></code> function will have access to the entire DOM tree of the HTML document.</p>
</div>
<p>Now we can begin loading 3D scene. This is done in the <code class="docutils literal"><span class="pre">load</span></code> function that is called from the <code class="docutils literal"><span class="pre">init_cb</span></code>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">APP_ASSETS_PATH</span> <span class="o">=</span> <span class="nx">m_cfg</span><span class="p">.</span><span class="nx">get_assets_path</span><span class="p">(</span><span class="s2">&quot;my_project&quot;</span><span class="p">);</span>

<span class="p">...</span>

<span class="kd">function</span> <span class="nx">load</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">m_data</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">APP_ASSETS_PATH</span> <span class="o">+</span> <span class="s2">&quot;my_project.json&quot;</span><span class="p">,</span> <span class="nx">load_cb</span><span class="p">,</span> <span class="nx">preloader_cb</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <a class="reference external" href="https://www.blend4web.com/api_doc/module-data.html#.load">data.load</a> method is used for loading. The first parameter of this method is the path to a 3D scene file. The path to a JSON file should be relative to the main HTML application file. Projects created in Project Manager have a dedicated asset folder, and you can easily obtain the path to it. This is done in the generic example code by introducing the <code class="docutils literal"><span class="pre">APP_ASSETS_PATH</span></code> global variable that is later used in the <a class="reference external" href="https://www.blend4web.com/api_doc/module-data.html#.load">data.load</a>.</p>
<p>The second parameter of the method is the <a class="reference external" href="https://www.blend4web.com/api_doc/module-data.html#~LoadedCallback">load_cb</a> function which is called after the 3D scene is loaded and prepared for rendering.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">load</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">m_data</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">APP_ASSETS_PATH</span> <span class="o">+</span> <span class="s2">&quot;my_project.json&quot;</span><span class="p">,</span> <span class="nx">load_cb</span><span class="p">,</span> <span class="nx">preloader_cb</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">load_cb</span><span class="p">(</span><span class="nx">data_id</span><span class="p">,</span> <span class="nx">success</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;b4w load failure&quot;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">m_app</span><span class="p">.</span><span class="nx">enable_camera_controls</span><span class="p">();</span>

    <span class="c1">// place your code here</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Calling this function means that the application has finished loading and now starts scene rendering. As this is the very first moment when the 3D scene data will be available, it is a suitable moment for initializing and preparing everything related to the scene, its object, animations and other things. For example, standard camera controls can be enabled here with the <a class="reference external" href="https://www.blend4web.com/api_doc/module-app.html#.enable_camera_controls">enable_camera_controls</a> method.</p>
<div class="section" id="writing-application-logic">
<h4>Writing Application Logic<a class="headerlink" href="#writing-application-logic" title="Permalink to this headline">¶</a></h4>
<p>After initializing and loading 3D scene the application will proceed to work according to the logic set by the programmer such as interacting with input devices, manipulating scene objects, controlling camera behavior and so on.</p>
<p>By observing the <a class="reference internal" href="#app-init-loading"><span>application loading process</span></a>, we can determine several places suitable for performing various tasks.</p>
<ol class="arabic">
<li><p class="first">The <a class="reference external" href="https://www.blend4web.com/api_doc/module-app.html#.init">app.init</a> method used for starting the initialization accepts engine configuration parameters. So you can configure the engine right before calling this method using URL attributes as a base:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">b4w</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;my_module&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">)</span> <span class="p">{</span>

<span class="p">...</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">url_params</span> <span class="o">=</span> <span class="nx">m_app</span><span class="p">.</span><span class="nx">get_url_params</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">url_params</span> <span class="o">&amp;&amp;</span> <span class="s2">&quot;show_fps&quot;</span> <span class="k">in</span> <span class="nx">url_params</span><span class="p">)</span>
        <span class="kd">var</span> <span class="nx">show_fps</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="kd">var</span> <span class="nx">show_fps</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="nx">m_app</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
        <span class="nx">canvas_container_id</span><span class="o">:</span> <span class="s2">&quot;main_canvas_container&quot;</span><span class="p">,</span>
        <span class="nx">callback</span><span class="o">:</span> <span class="nx">init_cb</span><span class="p">,</span>
        <span class="nx">autoresize</span><span class="o">:</span> <span class="kc">true</span>
        <span class="nx">show_fps</span><span class="o">:</span> <span class="nx">show_fps</span>
    <span class="p">});</span>
<span class="p">}</span>

    <span class="p">...</span>
<span class="p">});</span>
<span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;my_module&quot;</span><span class="p">).</span><span class="nx">init</span><span class="p">();</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Initialization is started by the <code class="docutils literal"><span class="pre">window.onload</span></code> action, which means that after it is completed, the <a class="reference external" href="https://www.blend4web.com/api_doc/module-app.html#~AppInitCallback">init_cb</a> function will have access to the whole DOM tree. At this moment, you already can perform some preparations such as creating and setting up interface elements. However, the 3D scene itself is not yet loaded, and its objects are not yet available.</p>
</li>
<li><p class="first">After the 3D scene is loaded, the <a class="reference external" href="https://www.blend4web.com/api_doc/module-data.html#~LoadedCallback">load_cb</a> function is called. At this moment, all scene objects become available, thus any action that concerns them can be implemented in this function. Some examples can be found in the  <a class="reference internal" href="#code-snippets"><span>Code Snippets</span></a> application.</p>
</li>
</ol>
<p>Logic can be added to the application by using either browser or engine API:</p>
<ol class="arabic simple">
<li>Basic keyboard/mouse/gamepad input can be implemented with standard event handlers by using the <code class="docutils literal"><span class="pre">addEventListener</span></code> method. In more complex cases you can use the <a class="reference external" href="https://www.blend4web.com/api_doc/module-input.html">input</a> API module. The engine also features the <a class="reference external" href="https://www.blend4web.com/api_doc/module-input.html#.add_click_listener">add_click_listener</a> method that registers both mouse clicks and touch screen events which makes it useful for writing applications compatible with desktop and mobile devices alike.</li>
<li>Time-stretched events that have to be performed at every frame (procedural animation, for example) can be implemented with methods such as <a class="reference external" href="https://www.blend4web.com/api_doc/module-main.html#.set_render_callback">set_render_callback</a>, <a class="reference external" href="https://www.blend4web.com/api_doc/module-main.html#.append_loop_cb">append_loop_cb</a>, <a class="reference external" href="https://www.blend4web.com/api_doc/module-time.html#.animate">animate</a> and <a class="reference external" href="https://www.blend4web.com/api_doc/module-time.html#.set_timeout">set_timeout</a>. Standard <code class="docutils literal"><span class="pre">setTimeout</span></code> and <code class="docutils literal"><span class="pre">setInterval</span></code> methods can also be used.</li>
<li>For complex logic that takes into account both user actions and the state of the 3D scene can use engine’s <a class="reference internal" href="#event-model"><span>event-driven model</span></a> that is based on sensor system.</li>
</ol>
</div>
<div class="section" id="module-system">
<h4>Module System<a class="headerlink" href="#module-system" title="Permalink to this headline">¶</a></h4>
<p>Blend4Web engine is built upon modular structure: all engine API methods are separated into several modules. If necessary, a module can be plugged into the application with the <code class="docutils literal"><span class="pre">require</span></code> method. We recommend to structure the code of the actual application into modules as well.</p>
<ol class="arabic simple">
<li>Registering Modules</li>
</ol>
<p>A module is essentially a code block wrapped by a specific structure that is used to register it:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">b4w</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;my_module1&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// module code</span>
    <span class="p">...</span>
<span class="p">});</span>

<span class="nx">b4w</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;my_module2&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// module code</span>
    <span class="p">...</span>
<span class="p">});</span>

<span class="p">...</span>
</pre></div>
</div>
<p>The <a class="reference external" href="https://www.blend4web.com/api_doc/b4w.html#.register">register</a> method is used for registering modules. You can only register custom modules if their names do not coincide with the regular API modules. If necessary, the <a class="reference external" href="https://www.blend4web.com/api_doc/b4w.html#.module_check">module_check</a> method to check if a module with a given name is present:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nx">b4w</span><span class="p">.</span><span class="nx">module_check</span><span class="p">(</span><span class="s2">&quot;my_module&quot;</span><span class="p">))</span>
    <span class="k">throw</span> <span class="s2">&quot;Failed to register module: my_module&quot;</span><span class="p">;</span>

<span class="nx">b4w</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;my_module&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// module code</span>
    <span class="p">...</span>

<span class="p">});</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Loading Modules</li>
</ol>
<p>Custom modules, just like regular ones, can be plugged in with the <code class="docutils literal"><span class="pre">require</span></code> method:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">b4w</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;my_module1&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">mod2</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;my_module2&quot;</span><span class="p">)</span>

    <span class="p">...</span>
<span class="p">});</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Application Initialization</li>
</ol>
<p>Application initialization in Blend4Web is usually done with a call like this:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;my_module&quot;</span><span class="p">).</span><span class="nx">init</span><span class="p">();</span>
</pre></div>
</div>
<p>Here, the <code class="docutils literal"><span class="pre">my_module</span></code> custom module and its <code class="docutils literal"><span class="pre">init</span></code> external function do, in a certain sense, act as the entry point to the application.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the global visibility scope a module can be loaded with the same <a class="reference external" href="https://www.blend4web.com/api_doc/b4w.html#.require">require</a> method available as a method of the global <code class="docutils literal"><span class="pre">b4w</span></code> object: <code class="docutils literal"><span class="pre">b4w.require(&quot;MODULE_NAME&quot;)</span></code>.</p>
</div>
<ol class="arabic simple" start="4">
<li>Using Multiple Modules</li>
</ol>
<p>After a project is created in the <a class="reference internal" href="project_manager.html#project-management"><span>Project Manager</span></a>, its generic application JS-file will contain only one module. However, while developing the application, you might need to separate your code into several logic parts. In this case, you can either create several modules inside one file, or you can create several files each one of them contain one module.</p>
<p>If your application uses multiple modules, keep in mind that every one of them should be properly registered before initialization starts, or you will get an engine error if you try to call a module that is not yet registered. If you are using several JS files, the script that starts the initialization (contains application entry point) should the last one to be plugged into the main HTML application file.</p>
</div>
</div>
</div>
<div class="section" id="background-transparency">
<h2><a class="toc-backref" href="#id5">Background Transparency</a><a class="headerlink" href="#background-transparency" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">background_color</span></code> and <code class="docutils literal"><span class="pre">alpha</span></code> parameters are passed to the <a class="reference external" href="https://www.blend4web.com/api_doc/module-m_app.html#.init">init</a> method placed in the load callback function (a function that is called right after the scene is loaded), like this:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">m_app</span><span class="p">.</span><span class="nx">init</span> <span class="p">({</span>
    <span class="nx">alpha</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">background_color</span><span class="o">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
   <span class="c1">//this method sets the background to an opaque light gray color</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The combination of the parameters passed to the method defines how the backgrounds of the Blend4Web application and the HTML application blend together. Available options are:</p>
<ol class="arabic">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">alpha</span></code> = false</dt>
<dd><p class="first last">The color of the background is defined by the <code class="docutils literal"><span class="pre">background_color</span></code> of the Blend4Web application, the background of the HTML application is not taken into consideration.</p>
</dd>
</dl>
</li>
</ol>
<a class="reference internal image-reference" href="_images/developers_background_opaque.png"><img alt="_images/developers_background_opaque.png" class="align-center" src="_images/developers_background_opaque.png" style="width: 100%;" /></a>
<ol class="arabic" start="2">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">alpha</span></code> = true</dt>
<dd><p class="first">The background of the HTML application might influence the background of the Blend4Web application based on its transparency which is defined by the fourth component of the <code class="docutils literal"><span class="pre">background_color</span></code> parameter (<code class="docutils literal"><span class="pre">alpha</span></code> = <code class="docutils literal"><span class="pre">background_color[3]</span></code>, not to be confused with the <code class="docutils literal"><span class="pre">alpha</span></code> parameter mentioned above).</p>
<dl class="last docutils">
<dt>background_color[3] = 1</dt>
<dd><p class="first last">This produces the same result as if the alpha parameter has been turned off (<code class="docutils literal"><span class="pre">alpha</span></code> = false)</p>
</dd>
<dt>background_color[3] = 0</dt>
<dd><p class="first">Additive blending is used.</p>
<a class="reference internal image-reference" href="_images/developers_background_add.png"><img alt="_images/developers_background_add.png" class="align-center" src="_images/developers_background_add.png" style="width: 100%;" /></a>
<p class="last">Picture above shows an HTML page containing a Blend4Web application with a blue [0, 0, 1] background that blends with the page&#8217;s red (<code class="docutils literal"><span class="pre">Red</span></code>) color producing a violet tone.</p>
</dd>
<dt>background_color[3] &gt; 0</dt>
<dd><p class="first">Additive blending is used with the <code class="docutils literal"><span class="pre">background_color</span></code> having a greater influence.</p>
<a class="reference internal image-reference" href="_images/developers_background_semiopaque.png"><img alt="_images/developers_background_semiopaque.png" class="align-center" src="_images/developers_background_semiopaque.png" style="width: 100%;" /></a>
<p class="last">This picture shows the same HTML page with the same Blend4Web app, however, the <code class="docutils literal"><span class="pre">alpha</span></code> value is set to 0.5, leading to a darker tone of the application background.</p>
</dd>
</dl>
</dd>
</dl>
</li>
</ol>
<p>The mechanisms of alpha lending are described in greater detail in the <a class="reference internal" href="colors.html#alpha-compositing"><span>Color Management</span></a> chapter.</p>
<p>By default, the <code class="docutils literal"><span class="pre">alpha</span></code> parameter is set to true and the <code class="docutils literal"><span class="pre">background_color</span></code> is set to transparent black [0, 0, 0, 0], which means that the application will have an HTML background with no influences from the background of the Blend4Web application.</p>
<p>Background transparency can also be utilized in <a class="reference internal" href="project_manager.html#web-player-app"><span>Web Player applications</span></a> by using the <code class="docutils literal"><span class="pre">alpha</span></code> <a class="reference internal" href="web_player.html#webplayer-attributes"><span>URL attribute</span></a>. To use this feature, firstly you need to enable the <code class="docutils literal"><span class="pre">Background</span> <span class="pre">transparency</span> <span class="pre">(alpha)</span></code> parameter in the <a class="reference internal" href="project_manager.html#web-player-params"><span>Web Player Params</span></a> group while creating the application.</p>
<p>If Blend4Web application uses sky rendering, the application canvas will be fully covered by objects (including sky), so the background will be fully opaque and not influenced by alpha settings.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sky rendering is enabled by default in Blend4Web scenes created in <a class="reference internal" href="project_manager.html#project-management"><span>Project Manager</span></a>. Don&#8217;t forget, in order to use a transparent background you will need to manually disable sky rendering.</p>
</div>
</div>
<div class="section" id="resource-conversion">
<span id="converter"></span><h2><a class="toc-backref" href="#id6">Resource Conversion</a><a class="headerlink" href="#resource-conversion" title="Permalink to this headline">¶</a></h2>
<p>Currently, browsers do not fully support all possible media formats, so in order to create cross-browser applications (and also for optimization purposes) we recommend you to use the resource converter.</p>
<p>To support a wider range of platforms, a Python script (<em>scripts/converter.py</em>) for converting the source files into other formats is included into the distribution.</p>
<p>There are two ways to run this script.</p>
<p>Firstly, you can run it automatically using the project management system. The <code class="docutils literal"><span class="pre">Convert</span> <span class="pre">Resources</span></code> button can be found in the main page of the <a class="reference internal" href="project_manager.html#project-management"><span>Project Manager</span></a>, in the <code class="docutils literal"><span class="pre">Operations</span></code> tab at the right side of the screen.</p>
<a class="reference internal image-reference" href="_images/developers_convert_resources.png"><img alt="_images/developers_convert_resources.png" class="align-center" src="_images/developers_convert_resources.png" style="width: 100%;" /></a>
<p>Secondly, you can run the script manually:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt; <span class="nb">cd</span> &lt;path_to_sdk&gt;/scripts
&gt; python3 converter.py <span class="o">[</span>options<span class="o">]</span> resize_textures <span class="p">|</span> convert_dds <span class="p">|</span> convert_media
</pre></div>
</div>
<p>For MS Windows users:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">cd &lt;path_to_sdk&gt;\scripts</span>
<span class="go">python converter.py [options] resize_textures | convert_dds | convert_media</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To run the scripts the Python 3.x needs to be installed in your system.</p>
</div>
<p>With the -d parameter you can specify the path to a directory in which converting will take place.</p>
<p>To exclude some directory from resource conversion, it is enough to put a file named <code class="docutils literal"><span class="pre">.b4w_no_conv</span></code> in it. This will not affect conversion in nested directories.</p>
<p>The <strong>resize_textures</strong> argument is used for decreasing texture resolution for the <strong>LOW</strong> mode.</p>
<div class="section" id="commands">
<span id="converter-commands"></span><h3><a class="toc-backref" href="#id7">Commands</a><a class="headerlink" href="#commands" title="Permalink to this headline">¶</a></h3>
<p>Commands for conversion:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">resize_textures</span></code> converts textures to lower resolution.</li>
<li><code class="docutils literal"><span class="pre">convert_dds</span></code> converts textures to <a class="reference internal" href="#dds"><span>DDS format</span></a>.</li>
<li><code class="docutils literal"><span class="pre">convert_pvr</span></code> converts textures to <a class="reference internal" href="#pvrtc"><span>PVR format</span></a>.</li>
<li><code class="docutils literal"><span class="pre">convert_media</span></code> converts audio and video files to <a class="reference internal" href="#converter-data-format"><span>alternative formats</span></a>.</li>
<li><code class="docutils literal"><span class="pre">convert_gzip</span></code> generates GZIP-compressed versions of &#8221;.json&#8221; and &#8221;.bin&#8221; scene files and &#8221;.dds&#8221; and &#8221;.pvr&#8221; textures.</li>
</ul>
<p>Commands for resource cleanup:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cleanup_textures</span></code> removes low resolution textures generated by the <code class="docutils literal"><span class="pre">resize_textures</span></code> command.</li>
<li><code class="docutils literal"><span class="pre">cleanup_dds</span></code> removes DDS texture files generated by the <code class="docutils literal"><span class="pre">convert_dds</span></code> command.</li>
<li><code class="docutils literal"><span class="pre">cleanup_pvr</span></code> removes PVR texture files generated by the <code class="docutils literal"><span class="pre">convert_pvr</span></code> command.</li>
<li><code class="docutils literal"><span class="pre">cleanup_media</span></code> removes audio and video files in alternative formats that were generated by the <code class="docutils literal"><span class="pre">convert_media</span></code> command.</li>
<li><code class="docutils literal"><span class="pre">cleanup_gzip</span></code> removes GZIP-compressed files generated by the <code class="docutils literal"><span class="pre">convert_gzip</span></code> command.</li>
</ul>
<p>Commands for image compression:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">compress_png</span></code> compresses PNG files in order to decrease their size. This option requires OptiPNG tool to be installed and set up in the <code class="docutils literal"><span class="pre">PATH</span></code> environment variable.</li>
</ul>
<p>Other commands:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">check_dependencies</span></code> checks <a class="reference internal" href="#converter-deps"><span>converter dependencies</span></a></li>
</ul>
</div>
<div class="section" id="arguments">
<span id="converter-arguments"></span><h3><a class="toc-backref" href="#id8">Arguments</a><a class="headerlink" href="#arguments" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-d</span></code>, <code class="docutils literal"><span class="pre">--dir</span> <span class="pre">&lt;dir_path&gt;</span></code> enables using an alternative directory to store converted files. The &lt;dir_path&gt; value specifies the path to this directory.</li>
<li><code class="docutils literal"><span class="pre">-j</span></code>, <code class="docutils literal"><span class="pre">--jobs</span> <span class="pre">&lt;jobs&gt;</span></code> specifies the number of jobs (threads) to run simultaneously. If this parameter is set to zero or is not specified, the number will be calculated automatically based on the number of CPUs.</li>
<li><code class="docutils literal"><span class="pre">-v</span></code>, <code class="docutils literal"><span class="pre">--verbose</span></code> enables outputting more information about files that are being converted. For example, when converting textures into DDS format, the script will show progress percentage for every file that is being converted.</li>
</ul>
</div>
<div class="section" id="dependencies">
<span id="converter-deps"></span><h3><a class="toc-backref" href="#id9">Dependencies</a><a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<p>Please make sure that you have all converter dependencies installed. You can do it with the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt; python3 &lt;path_to_sdk&gt;/scripts/converter.py check_dependencies
</pre></div>
</div>
<p>If some program is not installed, the following message will be displayed:</p>
<p><em>Couldn&#8217;t find PROGRAM_NAME.</em></p>
<p><strong>Linux</strong></p>
<p>The list of dependencies is listed in the following table:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Ubuntu 16.04 package</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ImageMagick</td>
<td>imagemagick</td>
</tr>
<tr class="row-odd"><td>NVIDIA Texture Tools</td>
<td>libnvtt-bin</td>
</tr>
<tr class="row-even"><td>Libav</td>
<td>libav-tools</td>
</tr>
<tr class="row-odd"><td>FFmpeg</td>
<td>ffmpeg</td>
</tr>
<tr class="row-even"><td>PVRTC</td>
<td>install manually</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Linux users can additionally install the package qt-faststart which is used to optimize loading media files.</p>
</div>
<p><strong>Windows</strong></p>
<p>For MS Windows users it is not necessary to install these packages since they are already present in the SDK.</p>
<p><strong>macOS</strong></p>
<p>macOS users can install the <a class="reference external" href="http://www.brew.sh/">brew</a> package manager first and then install any missing packages.</p>
<p>Before installing packages, install the libpng and libjpeg libraries using these commands:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt; brew install libpng
&gt; brew install libjpeg
</pre></div>
</div>
<p>Now you can proceed with installing required dependencies:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt; brew install imagemagick
&gt; brew install --with-theora --with-libvpx --with-fdk-aac ffmpeg
</pre></div>
</div>
<p>In order to install NVIDIA Texture Tools, clone the repository with the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt; git clone https://github.com/TriumphLLC/NvidiaTextureTools.git
</pre></div>
</div>
<p>Now you can build and install the package:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt; <span class="nb">cd</span> NvidiaTextureTools
&gt; ./configure
&gt; make
&gt; make install
</pre></div>
</div>
</div>
<div class="section" id="data-formats">
<span id="converter-data-format"></span><h3><a class="toc-backref" href="#id10">Data Formats</a><a class="headerlink" href="#data-formats" title="Permalink to this headline">¶</a></h3>
<p>The conversion is performed as follows:</p>
<dl class="docutils">
<dt>for audio (convert_media):</dt>
<dd><ul class="first last simple">
<li>ogg (ogv, oga) -&gt; mp4</li>
<li>mp3 -&gt; oga</li>
<li>mp4 (m4v, m4a) -&gt; oga</li>
<li>webm -&gt; m4a</li>
</ul>
</dd>
</dl>
<p>We recommend to use <code class="docutils literal"><span class="pre">ogg</span></code> as a base format. In this case the only conversion required for cross-browser compatibility will be <code class="docutils literal"><span class="pre">ogg</span></code> to <code class="docutils literal"><span class="pre">mp4</span></code>. Example of an input file: <code class="docutils literal"><span class="pre">file_name.ogg</span></code>, example of an output file: <code class="docutils literal"><span class="pre">file_name.altconv.mp4</span></code>.</p>
<dl class="docutils">
<dt>for video (convert_media):</dt>
<dd><ul class="first last simple">
<li>ogg (ogv, oga) -&gt; m4v / seq</li>
<li>mp3 -&gt; webm / seq</li>
<li>mp4 (m4v, m4a) -&gt; webm / seq</li>
<li>webm -&gt; m4v / seq</li>
</ul>
</dd>
</dl>
<p>We recommend to use <code class="docutils literal"><span class="pre">WebM</span></code> as a base format. In this case the only conversion required for cross-browser compatibility will be <code class="docutils literal"><span class="pre">webm</span></code> to <code class="docutils literal"><span class="pre">m4v</span></code> (<code class="docutils literal"><span class="pre">webm</span></code> to <code class="docutils literal"><span class="pre">seq</span></code> for iPhone). Example of an input file: <code class="docutils literal"><span class="pre">file_name.webm</span></code>, example of an output file: <code class="docutils literal"><span class="pre">file_name.altconv.m4v</span></code>.</p>
<dl class="docutils">
<dt>for images (convert_dds):</dt>
<dd><ul class="first last simple">
<li>png -&gt; dds/pvr</li>
<li>jpg -&gt; dds/pvr</li>
<li>bmp -&gt; dds/pvr</li>
<li>gif -&gt; dds</li>
</ul>
</dd>
</dl>
<p>Example of an input file: <code class="docutils literal"><span class="pre">file_name.jpg</span></code>, example of an output file: <code class="docutils literal"><span class="pre">file_name.altconv.jpg.dds</span></code>.</p>
<p>For the purpose of optimizing application performance it&#8217;s possible to use <code class="docutils literal"><span class="pre">min50</span></code> (halved) and <code class="docutils literal"><span class="pre">DDS</span></code> or <code class="docutils literal"><span class="pre">PVRTC</span></code> (compressed) textures. In order to do this, we need to pass the following parameters during initialization of the application:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">exports</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">m_app</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
        <span class="c1">// . . .</span>
        <span class="nx">assets_dds_available</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">assets_min50_available</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="c1">// . . .</span>
    <span class="p">});</span>
    <span class="c1">// . . .</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you are planning to use textures compressed into <a class="reference internal" href="#pvrtc"><span>PVRTC</span></a> format, then replace this line of code</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">assets_dds_available</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</pre></div>
</div>
</div></blockquote>
<p>with the following:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">assets_pvr_available</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</pre></div>
</div>
</div></blockquote>
<p class="last">This will tell the engine to load PVRTC textures, if such are present in the <code class="docutils literal"><span class="pre">./assets/</span></code> folder.</p>
</div>
<div class="section" id="dds-texture-compression">
<span id="dds"></span><h4>DDS Texture Compression<a class="headerlink" href="#dds-texture-compression" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">DDS</span></code> textures require less memory (4 times less for <code class="docutils literal"><span class="pre">RGBA</span></code> data and 6 times for <code class="docutils literal"><span class="pre">RGB</span></code> data), but using them has following downsides:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">DDS</span></code> textures might not work on some devices, especially the mobile ones, as not all of them support the <code class="docutils literal"><span class="pre">WEBGL_compressed_texture_s3tc</span></code> extension;</li>
<li>as <code class="docutils literal"><span class="pre">DDS</span></code> is a lossy compression format, compression artifacts might be visible, especially on <a class="reference internal" href="textures.html#normal-map"><span>normal</span></a> and <a class="reference internal" href="textures.html#stencil-map"><span>stencil</span></a> maps; it is recommended to <a class="reference internal" href="textures.html#texture-disable-compression"><span>disable compression</span></a> for such textures.</li>
</ul>
<a class="reference internal image-reference" href="_images/compression_artifacts.png"><img alt="_images/compression_artifacts.png" class="align-center" src="_images/compression_artifacts.png" style="width: 100%;" /></a>
<p>An example of the <code class="docutils literal"><span class="pre">DDS</span></code> compression artifacts, particularly visible on the edges of the shadow.</p>
</div></blockquote>
<p>During exporting the scene from Blender to the <code class="docutils literal"><span class="pre">JSON</span></code> format (but not the <code class="docutils literal"><span class="pre">HTML</span></code> format), <code class="docutils literal"><span class="pre">DDS</span></code> textures will be plugged in automatically, if they are present.</p>
<p>Textures can be converted to the <code class="docutils literal"><span class="pre">DDS</span></code> format using the <a class="reference internal" href="project_manager.html#project-management"><span>project manger</span></a> or the <em>scripts/converter.py</em> script described above.</p>
</div>
<div class="section" id="pvrtc-texture-compression">
<span id="pvrtc"></span><h4>PVRTC Texture Compression<a class="headerlink" href="#pvrtc-texture-compression" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">PVRTC</span></code> is another texture compression format used primarily on iOS devices. In some cases it can produce texture files up to two times smaller than same texture images would take in <code class="docutils literal"><span class="pre">DDS</span></code> format.</p>
<p>The format has two compression settings that are supported by the engine: 2-bpp (two bits per pixel) and 4-bpp (four bits per pixel).</p>
<p>As with <code class="docutils literal"><span class="pre">DDS</span></code> format, textures compressed using the <code class="docutils literal"><span class="pre">PVRTC</span></code> algorithm may not work on some platforms, especially mobile, because using this compression format require support for the <code class="docutils literal"><span class="pre">IMG_texture_compression_pvrtc</span></code> WebGL extension.</p>
<p>The PVRTC library and SDK are available for Windows, Linux and macOS systems alike. Installation packages can be downloaded from the <a class="reference external" href="https://community.imgtec.com/developers/powervr/">Power VR Insider</a> web page.</p>
<p>The Blend4Web engine uses a console PVRTC tool. To use it, you need to add the path to it to the <code class="docutils literal"><span class="pre">PATH</span></code> environmental variable, like the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">PATH</span> <span class="o">=</span> &lt;InstallDir&gt;<span class="se">\P</span>VRTexTool<span class="se">\C</span>LI<span class="se">\&lt;</span>PLATFORM&gt;<span class="se">\</span>
</pre></div>
</div>
<p>where &lt;InstallDir&gt; is the PVRTexTool installation directory and &lt;PLATFORM&gt; is a folder that contains the version of the tool that corresponds to your OS, for example, <code class="docutils literal"><span class="pre">\Windows_x86_64\</span></code> for 64-bit Windows OS.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In Windows systems, environment variables can be set in the <code class="docutils literal"><span class="pre">System</span></code> (in Windows 10 and 8) or <code class="docutils literal"><span class="pre">Properties</span></code> (in Windows 7 and Vista) dialogue window by choosing <code class="docutils literal"><span class="pre">Advanced</span> <span class="pre">System</span> <span class="pre">Settings</span></code> -&gt; <code class="docutils literal"><span class="pre">Environment</span> <span class="pre">Variables</span></code>, or by using console commands:</p>
<div class="last highlight-bash"><div class="highlight"><pre><span></span>SET <span class="nv">PATH</span> <span class="o">=</span> &lt;InstallDir&gt;<span class="se">\P</span>VRTexTool<span class="se">\C</span>LI<span class="se">\&lt;</span>PLATFORM&gt;<span class="se">\</span>
</pre></div>
</div>
</div>
<p>After this, you will be able to convert the textures to the PVR format by using converter.py script with the <code class="docutils literal"><span class="pre">convert_dds</span></code> command.</p>
</div>
<div class="section" id="seq-video-format">
<span id="seq"></span><h4>SEQ Video Format<a class="headerlink" href="#seq-video-format" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal"><span class="pre">.seq</span></code> file format is used for sequential video. This is applied for IE 11 and iPhone because they are currently missing support for standard video formats for textures. Using dds format for images is more optimal compared to other formats.</p>
<p>The engine can use files which are manually created by a user if they have the following names: <code class="docutils literal"><span class="pre">file_name.altconv.m4v</span></code>, <code class="docutils literal"><span class="pre">file_name.altconv.mp3</span></code> and so on. Such files should be placed in the same directory as the media files used in Blender.</p>
<p>You can also use the free and cross-platform application <a class="reference external" href="http://www.mirovideoconverter.com/">Miro Video Converter</a> to convert media files.</p>
</div>
</div>
</div>
<div class="section" id="gzip-compression">
<span id="gzip"></span><h2><a class="toc-backref" href="#id11">GZIP Compression</a><a class="headerlink" href="#gzip-compression" title="Permalink to this headline">¶</a></h2>
<p>Typical Blend4Web application can use various resource formats from standard  HTML, JS, CSS, PNG or JPEG files to engine-specific JSON- and BIN-files that contain scene data. Compressed  DDS/PVR image formats are also an option. Both big and small applications benefit from decreasing the size of the resources, as this also decreases the loading time.</p>
<p>Usually, loading time can be decreased by setting up caching on the server that contains web application. You can also enable GZIP compression for various file types.</p>
<p>Speaking of the specific file types, GZIP compression should be used for  JSON, BIN, DDS and PVR files. JSON and BIN files, being the main scene files, can contain large amounts of data, while DDS and PVR also can be quite large (at least when compared to standard PNG and JPEG files), and there can be quite a lot of them.</p>
<p>But if for some reason GZIP compression cannot be set up on the server, it can be enabled in the application itself.</p>
<p>The engine can load compressed resources in the form of <code class="docutils literal"><span class="pre">.gz</span></code> files. To use this feature in a <code class="docutils literal"><span class="pre">WebPlayer</span> <span class="pre">JSON</span></code> type project, you need to pass the <code class="docutils literal"><span class="pre">compressed_gzip</span></code> URL parameter. If you are developing your own application, you need to pass the <code class="docutils literal"><span class="pre">assets_gzip_available</span></code> configuration parameter during the initialization.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">m_app</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;app&quot;</span><span class="p">);</span>

<span class="nx">m_app</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
    <span class="nx">canvas_container_id</span><span class="o">:</span> <span class="s2">&quot;main_canvas_container&quot;</span><span class="p">,</span>
    <span class="nx">callback</span><span class="o">:</span> <span class="nx">init_cb</span><span class="p">,</span>
    <span class="nx">show_fps</span><span class="o">:</span> <span class="nx">DEBUG</span><span class="p">,</span>
    <span class="nx">console_verbose</span><span class="o">:</span> <span class="nx">DEBUG</span><span class="p">,</span>
    <span class="nx">autoresize</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">assets_gzip_available</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
<p>Compressed <code class="docutils literal"><span class="pre">.gz</span></code> files should be placed alongside the original ones, for example, like this:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">my_project</span><span class="o">/</span>
    <span class="nx">assets</span><span class="o">/</span>
        <span class="nx">my_scene</span><span class="p">.</span><span class="nx">json</span>
        <span class="nx">my_scene</span><span class="p">.</span><span class="nx">json</span><span class="p">.</span><span class="nx">gz</span>
        <span class="nx">my_scene</span><span class="p">.</span><span class="nx">bin</span>
        <span class="nx">my_scene</span><span class="p">.</span><span class="nx">bin</span><span class="p">.</span><span class="nx">gz</span>
</pre></div>
</div>
</div></blockquote>
<p>This also applies to the <code class="docutils literal"><span class="pre">.dds</span></code> and <code class="docutils literal"><span class="pre">.pvr</span></code> files and their compressed counterparts <code class="docutils literal"><span class="pre">.dds.gz</span></code> and <code class="docutils literal"><span class="pre">.pvr.gz</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If a compressed <code class="docutils literal"><span class="pre">.gz</span></code> is not present, engine will load the original file and output a corresponding message to the console.</p>
</div>
<p>GZIP compressed files can be generated with the <code class="docutils literal"><span class="pre">convert</span> <span class="pre">resources</span></code> <a class="reference internal" href="project_manager.html#project-manager"><span>command</span></a> that can be found in the Project Manager interface. This can also be done in the console by running the <a class="reference internal" href="#converter"><span>./scripts/converter.py</span></a> script with the <code class="docutils literal"><span class="pre">compress_gzip</span></code> (for compressing resources) or the <code class="docutils literal"><span class="pre">cleanup_gzip</span></code> (for removing compressed files) command.</p>
</div>
<div class="section" id="code-examples">
<span id="code-snippets"></span><h2><a class="toc-backref" href="#id12">Code Examples</a><a class="headerlink" href="#code-examples" title="Permalink to this headline">¶</a></h2>
<p>The SDK includes the Code Snippets application which demonstrates how to use the engine&#8217;s functionality.</p>
<p>Currently, this application contains the following examples:</p>
<blockquote>
<div><ul class="simple">
<li>Bone API - an example of individual bones position control</li>
<li>Camera Animation - procedural camera animation</li>
<li>Camera Move Styles - changing control modes for the camera</li>
<li>Canvas Texture - working with canvas textures</li>
<li>Change Image - changing texture images on-the-fly</li>
<li>Custom Anchors - creating custom annotations</li>
<li>Dynamic Geometry - procedural geometry modification</li>
<li>Gamepad - an example of controlling a character via gamepad</li>
<li>Gyro (Mobile Only) - working with mobile devices&#8217; gyroscopes</li>
<li>Instancing - copying scene objects in runtime</li>
<li>Lines - procedural lines rendering</li>
<li>Material API - tweaking material properties and replacing objects&#8217; materials</li>
<li>Morphing - using shape keys</li>
<li>Multitouch (Mobile Only) - using mobile devices multitouch sensor</li>
<li>Pathfinding - an example of calculating paths and using navigation meshes</li>
<li>Ray Test - the usage of raycasting for obstacles detection</li>
<li>VR - a VR application example</li>
<li>Webcam - using media stream from a web camera</li>
</ul>
</div></blockquote>
<p>The Code Snippets application is available at <code class="docutils literal"><span class="pre">./apps_dev/code_snippets/code_snippets_dev.html</span></code>. It can be also run by using a link in the <code class="docutils literal"><span class="pre">index.html</span></code> file located in the SDK root.</p>
</div>
<div class="section" id="loading-application-assets">
<h2><a class="toc-backref" href="#id13">Loading Application Assets</a><a class="headerlink" href="#loading-application-assets" title="Permalink to this headline">¶</a></h2>
<p>To simplify project maintenance and server deployment always keep your application asset files (exported scenes, textures, sounds, etc) separate from other project files (JavaScript, CSS, HTML, etc). Inside your SDK this asset directory is located at <code class="docutils literal"><span class="pre">projects/my_project/assets</span></code>.</p>
<p>To load files (e.g by using <a class="reference external" href="https://www.blend4web.com/api_doc/module-data.html#.load">load()</a>) from this directory use the <a class="reference external" href="https://www.blend4web.com/api_doc/module-config.html#.get_assets_path">get_assets_path()</a> method:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">m_data</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">m_config</span><span class="p">.</span><span class="nx">get_assets_path</span><span class="p">(</span><span class="s2">&quot;my_project&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;loaded_scene.json&quot;</span><span class="p">,</span> <span class="nx">load_cb</span><span class="p">);</span>
</pre></div>
</div>
<p>This way you ensure that your applications will find assets independently of the current development stage (developed, built or deployed).</p>
</div>
<div class="section" id="event-driven-model">
<span id="event-model"></span><h2><a class="toc-backref" href="#id14">Event-Driven Model</a><a class="headerlink" href="#event-driven-model" title="Permalink to this headline">¶</a></h2>
<p>The event-driven model provides a universal interface for describing the 3D scene&#8217;s change of state. It simplifies the processing of physics events and user actions.</p>
<div class="section" id="sensors">
<span id="index-0"></span><h3><a class="toc-backref" href="#id15">Sensors</a><a class="headerlink" href="#sensors" title="Permalink to this headline">¶</a></h3>
<p>The basic unit of the event-driven model is a sensor. A sensor is a programming entity and can only be active (1, one) or inactive (0, zero). Some sensors may carry a payload which can be received in the manifold&#8217;s callback function with corresponding API. For example, the ray-tracing sensor (Ray Sensor) provides the relative length of the intersection ray.</p>
<p id="index-1">Users cannot directly control sensors via the external API. Instead, all sensors must be present in one or multiple collections - so called sensor manifolds. A manifold is a logic container associated with a scene object. It generates a response to a defined set of sensor events by executing a callback function. To define the manifold it is required to have the following information (see also the API documentation for description of the <code class="docutils literal"><span class="pre">controls.create_sensor_manifold</span></code> function):</p>
<ul class="simple">
<li>An object to carry the manifold (e.g. a thrown object).</li>
<li>A unique id of the manifold (e.g. &#8220;IMPACT&#8221;).</li>
<li>Callback execution mode (the options are: <code class="docutils literal"><span class="pre">CT_POSITIVE</span></code> - logic function positive result, <code class="docutils literal"><span class="pre">CT_CONTINUOUS</span></code> - every frame with a positive logic function result and once with a zero result, <code class="docutils literal"><span class="pre">CT_LEVEL</span></code> - any logic, function result change, <code class="docutils literal"><span class="pre">CT_SHOT</span></code> - one-stage logic function result change, <code class="docutils literal"><span class="pre">CT_TRIGGER</span></code> - logic function result switch, <code class="docutils literal"><span class="pre">CT_CHANGE</span></code> - any sensor value change).</li>
<li>An array of sensors.</li>
<li>A logic function to define the combination of the sensor states for which the callback function is executed.</li>
<li>A callback function.</li>
<li>An optional parameter to pass into the callback function.</li>
</ul>
<p>You can read more about engine API in the <a class="reference external" href="https://www.blend4web.com/api_doc/module-controls.html">controls</a> module documentation.</p>
</div>
<div class="section" id="example">
<h3><a class="toc-backref" href="#id16">Example</a><a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s consider the task to insonify the impact of a thrown stone. A distinctive sound should be produced for impacting different media (for example terrain and wall). There are collision meshes with physical materials in the Blender scene, material ids are &#8220;TERRAIN&#8221; and &#8220;WALL&#8221;. There is also a physical object being thrown in the scene, the object is named &#8220;Stone&#8221;.</p>
<p>Let&#8217;s define a collision sensor for each medium, by the type of the sound produced.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// import the modules</span>
<span class="kd">var</span> <span class="nx">m_scenes</span> <span class="o">=</span> <span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;scenes&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">m_controls</span> <span class="o">=</span> <span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;controls&quot;</span><span class="p">);</span>

<span class="c1">// get the object being thrown</span>
<span class="kd">var</span> <span class="nx">stone</span> <span class="o">=</span> <span class="nx">m_scenes</span><span class="p">.</span><span class="nx">get_object_by_name</span><span class="p">(</span><span class="s2">&quot;Stone&quot;</span><span class="p">);</span>

<span class="c1">// create the sensors</span>
<span class="kd">var</span> <span class="nx">sensor_impact_terrain</span> <span class="o">=</span> <span class="nx">m_controls</span><span class="p">.</span><span class="nx">create_collision_sensor</span><span class="p">(</span><span class="nx">stone</span><span class="p">,</span> <span class="s2">&quot;TERRAIN&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sensor_impact_wall</span>    <span class="o">=</span> <span class="nx">m_controls</span><span class="p">.</span><span class="nx">create_collision_sensor</span><span class="p">(</span><span class="nx">stone</span><span class="p">,</span> <span class="s2">&quot;WALL&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Add the sensors into an array. Use the <code class="docutils literal"><span class="pre">OR</span></code> logic in the logic function. Place the sound processing code in the callback function. Create the sensor manifold with the &#8220;IMPACT&#8221; id and the <code class="docutils literal"><span class="pre">CT_SHOT</span></code> type.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// array of the sensors</span>
<span class="kd">var</span> <span class="nx">impact_sens_array</span> <span class="o">=</span> <span class="p">[</span><span class="nx">sensor_impact_terrain</span><span class="p">,</span> <span class="nx">sensor_impact_wall</span><span class="p">];</span>

<span class="c1">// manifold logic function</span>
<span class="kd">var</span> <span class="nx">impact_sens_logic</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="p">(</span><span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="nx">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])};</span>

<span class="c1">// callback</span>
<span class="kd">var</span> <span class="nx">impact_cb</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">manifold_id</span><span class="p">,</span> <span class="nx">pulse</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// NOTE: it&#39;s possible to play both sounds simultaneously</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">m_controls</span><span class="p">.</span><span class="nx">get_sensor_value</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">manifold_id</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;play the terrain impact sound&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">m_controls</span><span class="p">.</span><span class="nx">get_sensor_value</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">manifold_id</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;play the wall impact sound&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// create the manifold</span>
<span class="nx">m_controls</span><span class="p">.</span><span class="nx">create_sensor_manifold</span><span class="p">(</span><span class="nx">stone</span><span class="p">,</span> <span class="s2">&quot;IMPACT&quot;</span><span class="p">,</span> <span class="nx">m_ctl</span><span class="p">.</span><span class="nx">CT_SHOT</span><span class="p">,</span>
    <span class="nx">impact_sens_array</span><span class="p">,</span> <span class="nx">impact_sens_logic</span><span class="p">,</span> <span class="nx">impact_cb</span><span class="p">);</span>
</pre></div>
</div>
<p>When the &#8220;Stone&#8221; object collides with any physical material of &#8220;TERRAIN&#8221; or &#8220;WALL&#8221;, the callback function is executed. Inside this function we get the values of both sensors by their indices in the sensor array (0 - &#8220;TERRAIN&#8221;, 1 - &#8220;WALL&#8221;). The sensor value = 1 (active) means that the collision happened with the corresponding physical material. As a result the corresponding sound is produced (the code is not shown).</p>
</div>
</div>
<div class="section" id="sdk-file-structure">
<span id="repo-file-structure"></span><h2><a class="toc-backref" href="#id17">SDK File Structure</a><a class="headerlink" href="#sdk-file-structure" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><strong>addons</strong></dt>
<dd><dl class="first last docutils">
<dt><strong>blend4web</strong></dt>
<dd>Blender addon</dd>
</dl>
</dd>
<dt><strong>apps_dev</strong></dt>
<dd><p class="first">SDK apps source code</p>
<dl class="last docutils">
<dt><strong>code_snippets</strong></dt>
<dd><p class="first">source files of the Code Snippets application</p>
<dl class="last docutils">
<dt><strong>scripts</strong></dt>
<dd>Blend4Web API usage examples&#8217; source files</dd>
</dl>
</dd>
<dt><strong>dairy_plant</strong></dt>
<dd>source files of the Dairy Plant demo (available only in SDK Pro)</dd>
<dt><strong>demos_animation</strong></dt>
<dd>project files of the basic animation demos</dd>
<dt><strong>demos_environment</strong></dt>
<dd>project files of the basic environment demos</dd>
<dt><strong>demos_interactivity</strong></dt>
<dd>project files of the basic interactivity demos</dd>
<dt><strong>demos_materials</strong></dt>
<dd>project files of the basic materials demos</dd>
<dt><strong>demos_media</strong></dt>
<dd>project files of the basic media demos</dd>
<dt><strong>demos_particles</strong></dt>
<dd>project files of the basic particles demos</dd>
<dt><strong>demos_physics</strong></dt>
<dd>project files of the basic physics demos</dd>
<dt><strong>demos_postprocessing</strong></dt>
<dd>project files of the basic postprocessing demos</dd>
<dt><strong>farm</strong></dt>
<dd>source files of the Farm demo (available only in SDK Pro)</dd>
<dt><strong>fashion</strong></dt>
<dd>source files of the Fashion Show demo (available only in SDK Pro)</dd>
<dt><strong>flight</strong></dt>
<dd>source files of the Island demo</dd>
<dt><strong>new_year</strong></dt>
<dd>source files of the New Year 2015 greeting card</dd>
<dt><strong>project.py</strong></dt>
<dd>script for application developers</dd>
<dt><strong>space_disaster</strong></dt>
<dd>source files of the Space Disaster app</dd>
<dt><strong>tutorials</strong></dt>
<dd>source files of the Blend4Web tutorials</dd>
<dt><strong>victory_day_2015</strong></dt>
<dd>source files of the V-Day 70 greeting card</dd>
<dt><strong>viewer</strong></dt>
<dd>the sources files of the Viewer application</dd>
<dt><strong>webplayer</strong></dt>
<dd>source files of the Web Player app</dd>
<dt><strong>website</strong></dt>
<dd>source files of applications from the Blend4Web official website</dd>
</dl>
</dd>
<dt><strong>blender</strong></dt>
<dd>source files of the Blender scenes</dd>
<dt><strong>csrc</strong></dt>
<dd>source code (in C) of the binary part of the engine exporter and of the other utilities</dd>
<dt><strong>deploy</strong></dt>
<dd><p class="first">the resource directory for deploying on the server (scene source files, compiled applications and documentation)</p>
<dl class="last docutils">
<dt><strong>api_doc</strong></dt>
<dd>API documentation for developers (built automatically, based on the engine&#8217;s source code)</dd>
<dt><strong>apps</strong></dt>
<dd><p class="first">3D applications intended for deploying; the directory duplicates <em>apps_dev</em></p>
<dl class="last docutils">
<dt><strong>common</strong></dt>
<dd>Compiled engine files. Shared by all applications from SDK (hence the name).</dd>
</dl>
</dd>
<dt><strong>assets</strong></dt>
<dd>application assets: scenes, textures and sounds</dd>
<dt><strong>doc</strong></dt>
<dd>the current user manual in HTML format, built automatically from <em>doc_src</em></dd>
<dt><strong>webglreport</strong></dt>
<dd>WebGL report application</dd>
</dl>
</dd>
<dt><strong>distfiles</strong></dt>
<dd>distribution builder lists</dd>
<dt><strong>doc_src</strong></dt>
<dd>source files of the current manual written in reST</dd>
<dt><strong>index.html</strong> and <strong>index_assets</strong></dt>
<dd>main SDK webpage files</dd>
<dt><strong>license</strong></dt>
<dd>files with license texts</dd>
<dt><strong>Makefile</strong></dt>
<dd>makefile for building the engine, the applications, and the documentation</dd>
<dt><strong>projects</strong></dt>
<dd>directory for user projects</dd>
<dt><strong>README.rst</strong></dt>
<dd>README file</dd>
<dt><strong>scripts</strong></dt>
<dd><p class="first">scripts</p>
<dl class="last docutils">
<dt><strong>check_resources.py</strong></dt>
<dd>script for checking of and reporting about unused resources (images and sounds referenced by the exported files)</dd>
<dt><strong>compile_b4w.py</strong></dt>
<dd>script for building engine code and applications</dd>
<dt><strong>converter.py</strong></dt>
<dd>script which halves the texture dimensions, compresses the textures into the DDS format, converts sound files into mp4 and ogg formats</dd>
<dt><strong>custom_json_encoder.py</strong></dt>
<dd>fork of the json Python module, sorts the keys in reverse order</dd>
<dt><strong>gen_glmatrix.sh</strong></dt>
<dd>script for generating the math module based on the source code of glMatrix 2</dd>
<dt><strong>graph.sh</strong></dt>
<dd>SVG generator for the current scene graph, used for debugging rendering</dd>
<dt><strong>make_dist.py</strong></dt>
<dd>distributions builder script</dd>
<dt><strong>memory.sh</strong></dt>
<dd>script for checking memory (RAM) and video memory (VRAM)</dd>
<dt><strong>mod_list.py</strong></dt>
<dd>script for generating the list of modules to use in new applications</dd>
<dt><strong>plot.sh</strong></dt>
<dd>debugging information graph builder</dd>
<dt><strong>process_blend.py</strong></dt>
<dd>script for automatic reexport of all scenes from the SDK</dd>
<dt><strong>remove_alpha_channel.sh</strong></dt>
<dd>script for removing the images&#8217; alpha channel</dd>
<dt><strong>screencast.sh</strong></dt>
<dd>script for screen video recording</dd>
<dt><strong>shader_analyzer.py</strong></dt>
<dd>script starting the local web server which calculates complexity of the shaders</dd>
<dt><strong>translator.py</strong></dt>
<dd>script for building add-on translations</dd>
</dl>
</dd>
<dt><strong>shaders</strong></dt>
<dd>GLSL shaders of the engine</dd>
<dt><strong>src</strong></dt>
<dd><p class="first">main source code of the engine&#8217;s kernel</p>
<dl class="last docutils">
<dt><strong>addons</strong></dt>
<dd>source code of engine add-ons</dd>
<dt><strong>ext</strong></dt>
<dd>source code of the external declarations that form the engine&#8217;s API</dd>
<dt><strong>libs</strong></dt>
<dd>source code of the libraries</dd>
</dl>
</dd>
<dt><strong>tmp</strong></dt>
<dd>directory for temporary files (e.g. Fast Preview)</dd>
<dt><strong>tools</strong></dt>
<dd><p class="first">various tools for building the engine, apps or convert resources</p>
<dl class="last docutils">
<dt><strong>converter_utils</strong></dt>
<dd>binary builds of the tools for resource conversion</dd>
<dt><strong>closure-compiler</strong></dt>
<dd>Google Closure compiler, its externs and their generators</dd>
<dt><strong>glsl</strong></dt>
<dd><dl class="first last docutils">
<dt><strong>compiler</strong></dt>
<dd>compiler for the engine&#8217;s GLSL shaders</dd>
<dt><strong>pegjs</strong></dt>
<dd>grammars of the PEG.js parser generator for implementing the GLSL preprocessor, and also the script for generating the parser modules from these grammars</dd>
</dl>
</dd>
<dt><strong>yuicompressor</strong></dt>
<dd>utility for compressing CSS files</dd>
</dl>
</dd>
<dt><strong>uranium</strong></dt>
<dd>source code and building scripts of the Uranium physics engine (the fork of Bullet)</dd>
<dt><strong>VERSION</strong></dt>
<dd>contains the current version of the engine</dd>
</dl>
</div>
<div class="section" id="loading-local-resources">
<span id="browser-for-local-loading"></span><h2><a class="toc-backref" href="#id18">Loading Local Resources</a><a class="headerlink" href="#loading-local-resources" title="Permalink to this headline">¶</a></h2>
<p>The engine&#8217;s renderer is a web application and it works when you view an HTML file in a browser. After initialization the resources (scenes, textures) are loaded. This process is subject to the <a class="reference external" href="http://en.wikipedia.org/wiki/Same-origin_policy">same-origin policy</a> rule. In particular this rule forbids loading from a local directory.</p>
<p>Since version 15.02, the Blend4Web SDK includes the <a class="reference internal" href="addon.html#local-development-server"><span>development server</span></a> to solve the problem of loading local resources.</p>
</div>
<div class="section" id="quality-profiles">
<span id="quality-settings"></span><h2><a class="toc-backref" href="#id19">Quality Profiles</a><a class="headerlink" href="#quality-profiles" title="Permalink to this headline">¶</a></h2>
<p>Several quality profiles are implemented in order to support platforms with different functionality.</p>
<blockquote>
<div><ul class="simple">
<li><em>low quality</em> (<code class="docutils literal"><span class="pre">P_LOW</span></code>) - a range of functions is turned off (such as shadows, dynamic reflection, postprocessing), the size of textures is halved when using a release version, anti-aliasing is disabled</li>
<li><em>high quality</em> (<code class="docutils literal"><span class="pre">P_HIGH</span></code>) - all features requested by the scene are used, the anti-aliasing method is FXAA</li>
<li><em>maximum quality</em> (<code class="docutils literal"><span class="pre">P_ULTRA</span></code>) - rendering resolution is doubled, resolution of shadow maps is increased, the anti-aliasing method is FXAA (uses higher quality settings and works slower).</li>
<li><em>custom quality</em> (<code class="docutils literal"><span class="pre">P_CUSTOM</span></code>) - any quality parameter can be set to any possible value. This option is used when you need to set certain quality parameters manually. By default, it uses the same settings as <code class="docutils literal"><span class="pre">High</span></code> quality profile.</li>
</ul>
</div></blockquote>
<a class="reference internal image-reference" href="_images/developers_quality.png"><img alt="_images/developers_quality.png" class="align-center" src="_images/developers_quality.png" style="width: 100%;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Switching the quality profiles can be performed in runtime before initialization of the WebGL context. The default profile is <code class="docutils literal"><span class="pre">P_HIGH</span></code>.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">m_cfg</span> <span class="o">=</span> <span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">m_main</span> <span class="o">=</span> <span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">);</span>

<span class="nx">m_cfg</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;quality&quot;</span><span class="p">,</span> <span class="nx">m_cfg</span><span class="p">.</span><span class="nx">P_LOW</span><span class="p">);</span>
<span class="nx">m_main</span><span class="p">.</span><span class="nx">init</span><span class="p">(...);</span>
</pre></div>
</div>
<p>Application developers can also set the <strong>quality</strong> parameter upon engine initialization using the <code class="docutils literal"><span class="pre">app.js</span></code> add-on:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">m_cfg</span> <span class="o">=</span> <span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">m_app</span> <span class="o">=</span> <span class="nx">b4w</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;app&quot;</span><span class="p">);</span>

<span class="nx">m_app</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
    <span class="nx">canvas_container_id</span><span class="o">:</span> <span class="s2">&quot;body_id&quot;</span><span class="p">,</span>
    <span class="nx">quality</span><span class="o">:</span> <span class="nx">m_cfg</span><span class="p">.</span><span class="nx">P_HIGH</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="non-standard-canvas-position-and-orientation">
<span id="non-standard-canvas-pos"></span><h2><a class="toc-backref" href="#id20">Non-Standard Canvas Position and Orientation</a><a class="headerlink" href="#non-standard-canvas-position-and-orientation" title="Permalink to this headline">¶</a></h2>
<p>The Canvas element, to which the rendering is performed, can change its position relative to the browser window. This can occur due to some manipulations over the DOM tree, or as a result of page scrolling which is especially relevant for non-fullscreen web applications.</p>
<p>In most cases this will not affect the performance of the app by any means. However, some DOM events related to mouse cursor or touch position may carry incorrect information. This occurs because the coordinates obtained from the corresponding events are measured relative to the origin of the browser window, while the engine works with the coordinate space of the Canvas element itself (its origin is located in the top left corner).</p>
<ol class="arabic simple">
<li>If the top left corner of the Canvas element matches the top left corner of the browser window and is fixed in its position (non-movable) then it&#8217;s sufficient to use event.clientX and event.clientY coordinates of the input events or <a class="reference external" href="https://www.blend4web.com/api_doc/module-mouse.html#.get_coords_x">get_coords_x()</a> and <a class="reference external" href="https://www.blend4web.com/api_doc/module-mouse.html#.get_coords_y">get_coords_y()</a> methods.</li>
</ol>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">m_mouse</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;mouse&quot;</span><span class="p">);</span>

<span class="c1">// . . .</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientX</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientY</span><span class="p">;</span>
<span class="c1">// . . .</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">m_mouse</span><span class="p">.</span><span class="nx">get_coords_x</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">m_mouse</span><span class="p">.</span><span class="nx">get_coords_y</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
<span class="c1">// . . .</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="2">
<li>In the case of more sophisticated manipulations with the Canvas element (scrolling of the page elements, displacement from the top level corner of the browser window, changes in the DOM-tree) it&#8217;s needed to obtain properly calculated coordinates. This can be done by using the aforementioned <a class="reference external" href="https://www.blend4web.com/api_doc/module-mouse.html#.get_coords_x">get_coords_x()</a> and <a class="reference external" href="https://www.blend4web.com/api_doc/module-mouse.html#.get_coords_y">get_coords_y()</a> methods with a <code class="docutils literal"><span class="pre">true</span></code> value as a third parameter:</li>
</ol>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">m_mouse</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;mouse&quot;</span><span class="p">);</span>

<span class="c1">// . . .</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">m_mouse</span><span class="p">.</span><span class="nx">get_coords_x</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">m_mouse</span><span class="p">.</span><span class="nx">get_coords_y</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="c1">// . . .</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Another option in this case is to use the <a class="reference external" href="https://www.blend4web.com/api_doc/module-container.html#.client_to_canvas_coords">client_to_canvas_coords()</a> method as follows:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">m_cont</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;container&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">_vec2_tmp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="c1">// . . .</span>
<span class="kd">var</span> <span class="nx">coords_xy</span> <span class="o">=</span> <span class="nx">m_cont</span><span class="p">.</span><span class="nx">client_to_canvas_coords</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientY</span><span class="p">,</span> <span class="nx">_vec2_tmp</span><span class="p">);</span>
<span class="c1">// . . .</span>
</pre></div>
</div>
</div>
<div class="section" id="mobile-web-apps">
<span id="id1"></span><h2><a class="toc-backref" href="#id21">Mobile Web Apps</a><a class="headerlink" href="#mobile-web-apps" title="Permalink to this headline">¶</a></h2>
<p>An option to scale the whole webpage and change the orientation of a mobile device should be considered when creating user interface for a web application. It is recommended to prevent scaling and keep the aspect ratio of a webpage constant to avoid possible problems. This can be achieved by adding the following meta-tag to the page header:</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0, user-scalable=no&quot;</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Sometimes you might need to lock a mobile device to a certain orientation, especially when you don&#8217;t want to make both landscape and portrait interface variants. Since the native screenlock API is experimental and isn&#8217;t widespread, this might be easier to do using CSS rules.</p>
<p>To keep the orientation in landscape mode only, one can set rotation for the &lt;html&gt; element by 90 degrees in the portrait mode:</p>
<div class="highlight-css"><div class="highlight"><pre><span></span><span class="k">@media</span> <span class="o">(</span><span class="nt">orientation</span> <span class="o">:</span> <span class="nt">portrait</span><span class="o">)</span> <span class="p">{</span>
    <span class="nt">html</span> <span class="p">{</span>
        <span class="nb">position</span><span class="o">:</span> <span class="nb">absolute</span><span class="p">;</span>
        <span class="nb">width</span><span class="o">:</span> <span class="m">100</span><span class="n">vh</span><span class="p">;</span>
        <span class="nb">height</span><span class="o">:</span> <span class="m">100</span><span class="n">vw</span><span class="p">;</span>
        <span class="nb">overflow</span><span class="o">:</span> <span class="nb">hidden</span><span class="p">;</span>

        <span class="o">-</span><span class="n">moz</span><span class="o">-</span><span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">90</span><span class="n">deg</span><span class="p">);</span>
        <span class="o">-</span><span class="n">ms</span><span class="o">-</span><span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">90</span><span class="n">deg</span><span class="p">);</span>
        <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">90</span><span class="n">deg</span><span class="p">);</span>
        <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">90</span><span class="n">deg</span><span class="p">);</span>
        <span class="o">-</span><span class="n">moz</span><span class="o">-</span><span class="n">transform</span><span class="o">-</span><span class="n">origin</span><span class="o">:</span> <span class="nb">top</span> <span class="nb">left</span><span class="p">;</span>
        <span class="o">-</span><span class="n">ms</span><span class="o">-</span><span class="n">transform</span><span class="o">-</span><span class="n">origin</span><span class="o">:</span> <span class="nb">top</span> <span class="nb">left</span><span class="p">;</span>
        <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">transform</span><span class="o">-</span><span class="n">origin</span><span class="o">:</span> <span class="nb">top</span> <span class="nb">left</span><span class="p">;</span>
        <span class="n">transform</span><span class="o">-</span><span class="n">origin</span><span class="o">:</span> <span class="nb">top</span> <span class="nb">left</span><span class="p">;</span>

        <span class="nb">left</span><span class="o">:</span> <span class="m">100%</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Similarly, the CSS rule for the portrait mode only should look like the following:</p>
<div class="highlight-css"><div class="highlight"><pre><span></span><span class="k">@media</span> <span class="o">(</span><span class="nt">orientation</span> <span class="o">:</span> <span class="nt">landscape</span><span class="o">)</span> <span class="p">{</span>
    <span class="nt">html</span> <span class="p">{</span>
        <span class="nb">position</span><span class="o">:</span> <span class="nb">absolute</span><span class="p">;</span>
        <span class="nb">width</span><span class="o">:</span> <span class="m">100</span><span class="n">vh</span><span class="p">;</span>
        <span class="nb">height</span><span class="o">:</span> <span class="m">100</span><span class="n">vw</span><span class="p">;</span>
        <span class="nb">overflow</span><span class="o">:</span> <span class="nb">hidden</span><span class="p">;</span>

        <span class="o">-</span><span class="n">moz</span><span class="o">-</span><span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">-90</span><span class="n">deg</span><span class="p">);</span>
        <span class="o">-</span><span class="n">ms</span><span class="o">-</span><span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">-90</span><span class="n">deg</span><span class="p">);</span>
        <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">-90</span><span class="n">deg</span><span class="p">);</span>
        <span class="n">transform</span><span class="o">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">-90</span><span class="n">deg</span><span class="p">);</span>
        <span class="o">-</span><span class="n">moz</span><span class="o">-</span><span class="n">transform</span><span class="o">-</span><span class="n">origin</span><span class="o">:</span> <span class="nb">top</span> <span class="nb">left</span><span class="p">;</span>
        <span class="o">-</span><span class="n">ms</span><span class="o">-</span><span class="n">transform</span><span class="o">-</span><span class="n">origin</span><span class="o">:</span> <span class="nb">top</span> <span class="nb">left</span><span class="p">;</span>
        <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">transform</span><span class="o">-</span><span class="n">origin</span><span class="o">:</span> <span class="nb">top</span> <span class="nb">left</span><span class="p">;</span>
        <span class="n">transform</span><span class="o">-</span><span class="n">origin</span><span class="o">:</span> <span class="nb">top</span> <span class="nb">left</span><span class="p">;</span>

        <span class="nb">top</span><span class="o">:</span> <span class="m">100%</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="developers_advanced.html" class="btn btn-neutral float-right" title="For Engine Developers" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="physics.html" class="btn btn-neutral" title="Physics" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2017, Triumph.
      Last updated on 2017-06-30.

    </p>
  </div>

  <a href="https://www.blend4web.com">www.blend4web.com</a>

  <!-- Yandex.Metrika counter -->
  <script type="text/javascript">
  (function() {
    if (window.document.domain != "www.blend4web.com")
      return;

    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter24512171 = new Ya.Metrika({
                    id:24512171,
                    clickmap:false,
                    trackLinks:true,
                    accurateTrackBounce:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
  })();
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/24512171" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
  <!-- /Yandex.Metrika counter -->

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'v17.06',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();

          var lang_cont = $("#lang_cont");
          var links = lang_cont.children();

          var link_ru = links[0];
          var link_en = links[1];
          var link_zh = links[2];

          var loc = document.location.href;

          var href_ru = loc;
          var href_en = loc;
          var href_zh = loc; 

          if (loc.search("/ru/") != -1) {
              href_en = loc.replace("/ru/", "/en/");
              href_zh = loc.replace("/ru/", "/zh/");
          } else if (loc.search("/en/") != -1) {
              href_ru = loc.replace("/en/", "/ru/");
              href_zh = loc.replace("/en/", "/zh/");
          } else {
              href_ru = loc.replace("/zh/", "/ru/");
              href_en = loc.replace("/zh/", "/en/");
          }

          link_ru.href = href_ru;
          link_en.href = href_en;
          link_zh.href = href_zh;

          lang_cont.css("display", "inline-block")
      });
  </script>
   

</body>
</html>